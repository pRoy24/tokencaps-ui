"use strict";(function(){var h="integ";var b={LOCAL:"LOCAL",PROD:"PROD",GAMMA:"GAMMA"};var i={PUBLIC:{NAME:"PUBLIC",SUFFIX:"aws.amazon.com",PROD:"console.aws.amazon.com",GAMMA:"awsc-integ.aws.amazon.com"},CN:{NAME:"CN",SUFFIX:"amazonaws.cn",PROD:"console.amazonaws.cn",GAMMA:"aws-console-platform-proxy-integ-bjs.integ.amazonaws.cn"},GOV:{NAME:"GOV",SUFFIX:"amazonaws-us-gov.com",PROD:"console.amazonaws-us-gov.com",GAMMA:"aws-console-proxy-staging.integ.amazonaws-us-gov.com"},ISO:{NAME:"ISO",SUFFIX:"c2shome.ic.gov",PROD:"console.c2shome.ic.gov",GAMMA:"awsc-integ.dca.amazon.com"},"ISO-B":{NAME:"ISO-B",SUFFIX:"sc2shome.sgov.gov",PROD:"console.sc2shome.sgov.gov",GAMMA:"awsc-integ.lck.amazon.com"}};var l="s3";var d=[l,"batchOpsServlet","sns","sqs","lambda","kms","cloudwatch","glacier","cloudtrail"];var g={PUBLIC:"us-east-1",CN:"cn-north-1",GOV:"us-gov-west-1",ISO:"us-iso-east-1","ISO-B":"us-isob-east-1"};var m=["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-west-2","eu-west-3","eu-central-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","sa-east-1"];var f={PUBLIC:{PROD:["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-west-2","eu-west-3","eu-central-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","sa-east-1","ca-central-1"],GAMMA:["us-east-1","eu-west-1"]},CN:{PROD:["cn-north-1","cn-northwest-1"],GAMMA:["cn-north-1","cn-northwest-1"]},GOV:{PROD:["us-gov-west-1"],GAMMA:["us-gov-west-1"]},ISO:{PROD:["us-iso-east-1"],GAMMA:["us-iso-east-1"]},"ISO-B":{PROD:["us-isob-east-1"],GAMMA:["us-isob-east-1"]}};_.remove(f.PUBLIC.PROD,function(n){return n!==g.PUBLIC&&!e(n)});if(f.PUBLIC.PROD.length===1){f.PUBLIC.PROD=m}var k={PUBLIC:["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-west-2","eu-west-3","eu-central-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","ca-central-1","sa-east-1"],CN:["cn-north-1","cn-northwest-1"],GOV:["us-gov-west-1"],ISO:["us-iso-east-1"],"ISO-B":["us-isob-east-1"]};var j=b.LOCAL;var a=b.LOCAL;_.forEach(i,function(n){if(_.contains(window.location.host,n.SUFFIX)||_.contains(window.location.host,n.GAMMA)){a=n.NAME;j=_.contains(window.location.host,h)?b.GAMMA:b.PROD}});var c={};if(a===i.PUBLIC.NAME){d.forEach(function(n){c[n]={};k[a].forEach(function(o){var p=_.includes(f[a][j],o)?o:g[a];if(n!==l){c[n][o]="https://"+p+"."+i[a][j]+"/s3/"+n+"-proxy"}else{c[n][o]="https://"+p+"."+i[a][j]+"/s3/proxy"}})});angular.module("awsconsole.common").constant("S3Endpoint",c[l]);angular.module("awsconsole.common").constant("S3CWSEndpoint",c.batchOpsServlet);angular.module("awsconsole.common").constant("SNSEndpoint",c.sns);angular.module("awsconsole.common").constant("SQSEndpoint",c.sqs);angular.module("awsconsole.common").constant("LambdaEndpoint",c.lambda);angular.module("awsconsole.common").constant("KMSEndpoint",c.kms);angular.module("awsconsole.common").constant("CloudWatchEndpoint",c.cloudwatch);angular.module("awsconsole.common").constant("GlacierEndpoint",c.glacier);angular.module("awsconsole.common").constant("CloudTrailEndpoint",c.cloudtrail)}else{if(a===i.CN.NAME){d.forEach(function(n){c[n]={};k[a].forEach(function(o){var p=_.includes(f[a][j],o)?o:g[a];if(n!==l){if(p===g.CN){c[n][o]="https://"+i[a][j]+"/s3/"+n+"-proxy"}else{if(j===b.GAMMA){c[n][o]="https://"+p+".awsc-integ.amazonaws.cn/s3/"+n+"-proxy"}else{c[n][o]="https://"+p+"."+i[a][j]+"/s3/"+n+"-proxy"}}}else{if(p===g.CN){c[n][o]="https://"+i[a][j]+"/s3/proxy"}else{if(j===b.GAMMA){c[n][o]="https://"+p+".awsc-integ.amazonaws.cn/s3/proxy"}else{c[n][o]="https://"+p+"."+i[a][j]+"/s3/proxy"}}}})});angular.module("awsconsole.common").constant("S3Endpoint",c[l]);angular.module("awsconsole.common").constant("S3CWSEndpoint",c.batchOpsServlet);angular.module("awsconsole.common").constant("SNSEndpoint",c.sns);angular.module("awsconsole.common").constant("SQSEndpoint",c.sqs);angular.module("awsconsole.common").constant("LambdaEndpoint",c.lambda);angular.module("awsconsole.common").constant("KMSEndpoint",c.kms);angular.module("awsconsole.common").constant("CloudWatchEndpoint",c.cloudwatch);angular.module("awsconsole.common").constant("GlacierEndpoint",c.glacier);angular.module("awsconsole.common").constant("CloudTrailEndpoint",c.cloudtrail)}else{angular.module("awsconsole.common").constant("S3Endpoint","/s3/proxy");angular.module("awsconsole.common").constant("S3CWSEndpoint","/s3/batchOpsServlet-proxy");angular.module("awsconsole.common").constant("SNSEndpoint","/s3/sns-proxy");angular.module("awsconsole.common").constant("KMSEndpoint","/s3/kms-proxy");angular.module("awsconsole.common").constant("LambdaEndpoint","/s3/lambda-proxy");angular.module("awsconsole.common").constant("SQSEndpoint","/s3/sqs-proxy");angular.module("awsconsole.common").constant("CloudWatchEndpoint","/s3/cloudwatch-proxy");angular.module("awsconsole.common").constant("GlacierEndpoint","/s3/glacier-proxy");angular.module("awsconsole.common").constant("CloudTrailEndpoint","/s3/cloudtrail-proxy")}}angular.module("awsconsole.common").constant("IAMEndpoint","/s3/iam-proxy");angular.module("awsconsole.common").constant("IAMAdminEndpoint","/s3/iamadmin-proxy");angular.module("awsconsole.common").constant("OptOutEndpoint","/s3/optOutServlet-proxy");function e(q){var o={};var n=$("#meta-features-json");if(!n||!n.attr("data-featuresjson")){return false}var p=JSON.parse(n.attr("data-featuresjson"));if(angular.isArray(p)){p.forEach(function(r){o[r.externalId]=r.enabled})}return o["s3-prod-stack-"+q]===true}})();"use strict";(function(){var a=angular.module("s3",["AWS-DBUX-FAC","AWS-UI-Components","awsCommonComponents","awsconsole.common","ngCookies","ngRoute","ui.ace","pascalprecht.translate","storageconsole.common"]);a.config(["$routeProvider","$locationProvider","S3Constants",function(d,b,c){b.html5Mode({enabled:true});d.when("/"+c.PATH_SEGMENTS.OBJECT_DETAILS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME+"/:"+c.PATH_SEGMENTS.KEY_PREFIX+"*",{templateUrl:"/s3/partials/object-details/objectdetails.html",controller:"ObjectDetailsController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME+"/:"+c.PATH_SEGMENTS.KEY_PREFIX+"*",{templateUrl:"/s3/partials/bucketdetails.html",controller:"ObjectController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME+"/",{templateUrl:"/s3/partials/bucketdetails.html",controller:"ObjectController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/ot/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME+"/:"+c.PATH_SEGMENTS.KEY_PREFIX+"*/"+c.PATH_SEGMENTS.OBJECT_DETAILS,{templateUrl:"/s3/partials/object-details/objectdetails.html",controller:"ObjectDetailsController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/lc/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME,{templateUrl:"/s3/partials/bucketdetails.html",controller:"ObjectController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/oi/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME,{templateUrl:"/s3/partials/bucketdetails.html",controller:"ObjectController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/si/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME,{templateUrl:"/s3/partials/bucketdetails.html",controller:"ObjectController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.otherwise({templateUrl:"/s3/partials/buckets.html",controller:"LambController",resolve:{translations:["$translate",function(e){return e.onReady()}]}})}]);a.config(["$httpProvider",function(b){b.defaults.useXDomain=true;b.defaults.withCredentials=true}]);a.config(["$translateProvider",function(d){var b={en:"/s3/translations/messages_en.json",en_US:"/s3/translations/messages_en.json",zh:"/s3/translations/messages_zh_cn.json",zh_CN:"/s3/translations/messages_zh_cn.json",ja:"/s3/translations/messages_ja_jp.json",ja_JP:"/s3/translations/messages_ja_jp.json",fr:"/s3/translations/messages_fr.json",fr_FR:"/s3/translations/messages_fr.json",ko:"/s3/translations/messages_ko.json"};var c=$("meta[property='requestLocale']").attr("content");d.useStaticFilesLoader({filePath:b[c]}).preferredLanguage(c);d.useSanitizeValueStrategy("escapeParameters");d.forceAsyncReload(true)}]);a.filter("humanReadableBytes",["S3Constants",function(b){return function(d,c){if(d===0||d==="0"){return d+" "+b.UNITS[d]}if(isNaN(d)){return""}if(typeof c==="undefined"){c=1}var e=Math.floor(Math.log(d)/Math.log(1024));return(d/Math.pow(1024,Math.floor(e))).toFixed(c)+" "+b.UNITS[e]}}])})();"use strict";(function(){angular.module("s3").constant("S3Constants",{API_MAX_ITEMS:{LAMBDA_LIST_FUNCTIONS:10000,IAM_LIST_ROLES:1000,IAM_ATTACHED_POLICIES:10,IAM_ATTACHED_POLICIES_VERSIONS:5},CLOG_PAGE_ID:"s3v2",CLOG_OBJECTS_PAGE_ID:"s3v2-objects",CLOG_OBJECTS_DETAILS_PAGE_ID:"s3v2-objectdetails",DELIMITER:"/",PATH_SEGMENTS:{HOME:"home",BUCKETS:"buckets",BUCKET_NAME:"bucketName",KEY_PREFIX:"prefix",OBJECT_DETAILS:"object"},SHOW_DELETED_PARAM:"showdeleted",SHOW_VERSION_PARAM:"showversions",PREFIX_SEARCH_PARAM:"prefixSearch",CURRENT_MARKER:"currentmarker",CURRENT_VERSIONS_KEY_MARKER:"currentversionkeymarker",CURRENT_VERSIONS_ID_MARKER:"currentversionidmarker",VERSION_ID_PARAM:"versionid",UPLOAD:{TIMEOUT_MSECS:3600000,PART_SIZE_IN_BYTES:16777216,MAX_NUMBER_OF_PARTS:10000,MIN_NUMBER_OF_PARTS:1,ZERO_BYTE_MD5:"d41d8cd98f00b204e9800998ecf8427e",CUSTOM_ARN:"CUSTOM_ARN",USER_ERROR_MESSAGES:["Access Denied","Forbidden","Bad Request","Your proposed upload is smaller than the minimum allowed size","OptionsRequestDenied","OptionsResponseMissingHeaders"]},OBJECT_SSE:{AES256:"AES256",CUSTOM_ARN:"CUSTOM_ARN",KMS_ENCRYPTION:"aws:kms",NONE:"NONE",KMS:{ALIAS:":alias/",KEY:":key/"}},INITIATE_RESTORE:{BULK_RETRIEVAL:"Bulk",STANDARD_RETRIEVAL:"Standard",EXPEDITED_RETRIEVAL:"Expedited",EXPEDITED_RETRIEVAL_COST:{"ap-northeast-1":110,"ap-northeast-2":110,"ap-south-1":120,"ap-southeast-2":120,"ca-central-1":110,"cn-north-1":110,"cn-northwest-1":110,"eu-central-1":120,"eu-west-1":100,"eu-west-2":105,"eu-west-3":105,"us-east-1":100,"us-east-2":100,"us-gov-west-1":130,"us-iso-east-1":150,"us-isob-east-1":150,"us-west-1":110,"us-west-2":100}},MULTIPART_COPY:{PART_SIZE:16777216},HTTP_STATUS_CODES:{OK:200,PERMANENT_REDIRECT:301,ACCESS_DENIED:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,SERVER_ERROR_THRESHOLD:500,CLIENT_ERROR_THRESHOLD:300},NETWORK_ERROR:"NETWORK_ERROR",BATCH_OPS_MAX_KEYS_PER_OP:20,DATE_FORMAT:"MMM d, y h:mm:ss a 'GMT'Z",LIST_OBJECTS_MAX_KEYS_PER_LISTING:300,LIST_DELETED_OBJECTS_MAX_KEYS_PER_LISTING:1000,FAC:{ACCELERATE:"s3-x-acceleration",ACCESS:"s3-access",CRR:"s3-crr",CRR_V2:"s3-crr-v2",CRR_KMS:"s3-crr-kms",OBJECT_TAGGING:"s3-ot",TAG_QUERY:"s3-tq",QUICKSIGHT:"s3-qs",NEW_MULTIPART_COPY:"s3-new-multipart-copy",ANALYTICS:"s3-an",INVENTORY:"s3-oi",DEFAULT_ENCRYPTION:"s3-default-encryption",KMS:"s3-kms",METRICS:"s3-me",NO_ENC:"s3-no-enc",S3_RRS:"s3-rrs",QUICKSIGHT_LINK:"aws-quicksight",VERSIONED_VIEW:"s3-versioned-view",PROD_STACK:"s3-prod-stack-"},OPERATION:{NAME:"opName",ID:"opId",STEP:"opStep",INITIAL_BUCKET:"initialBucket",INITIAL_PATH:"initialPath",BUCKET_REGION:"bucketRegion",TIMESTAMP:"timestamp",CURRENT_BUCKET:"currentBucket",CURRENT_PATH:"currentPath",CWS_OP_ID:"cwsOpId",ERROR_STATUS:"errorStatus",THRESHOLD_PERCENTAGE:10},OPERATION_MANAGER_LOGGING:{STARTED:"S3ConsoleOperationStarted",ADDED:"S3ConsoleOperationsAdded",ENQUEUED:"S3ConsoleOperationsEnqueued",DEQUEUED:"S3ConsoleOperationsDequeued",CANCELED:"S3ConsoleOperationCanceled",COMPLETED:"S3ConsoleOperationCompleted"},OPERATION_PER_KEY_STATUS:{DONE:"SUCCESS",IN_PROGRESS:"IN_PROGRESS",ERROR:"ERROR"},S3_RESPONSE_HEADERS:{X_AMZ_ID_2:"x-amz-id-2",X_AMZ_REQUEST_ID:"x-amz-request-id",X_AMZ_BUCKET_REGION:"x-amz-bucket-region"},OPERATION_STATE:{ACTIVE:"active",WAITING:"waiting",CANCEL:"cancel",ERROR:"error",COMPLETED:"completed"},OPERATION_NAME:{ADD_OBJECT_TAG:"Add object tags",COPY:"Copy",CUT:"Cut",PASTE:"Paste",GET_INFO:"GetInfo",MAKE_PUBLIC:"Make public",DELETE_OBJECTS:"Delete objects",RESTORE_OBJECTS:"Restore objects",EDIT_PERMISSIONS:"Edit permissions",CHANGE_STORAGE_CLASS:"Change storage class",CHANGE_SSE:"Change SSE",UPLOAD:"Upload",LAMB:"LAMB",RENAME:"Rename",GET_OBJECT_DETAILS:"GetObjectDetails",LIST_DELETED_OBJECTS:"ListDeletedObjects",LIST_VERSIONS:"ListVersions",SWITCH_VERSION:"SwitchVersion",EMPTY_BUCKET:"Empty bucket",DELETE_BUCKET:"Delete bucket",CHANGE_METADATA:"Change metadata",GET_OBJECT_TAGGING:"GetObjectTagging",PUT_OBJECT_TAGGING:"PutObjectTagging",INITIATE_RESTORE:"Initiate restore",GET_METADATA:"Get object metadata",GET_OBJECT_METADATA:"getObjectMetadataProxy",METRICS_GET_CONFIG:"GetMetricsConfig",METRICS_PUT_CONFIG:"PutMetricsConfig",METRICS_DELETE_CONFIG:"DeleteMetricsConfig",ANALYTICS_GET_CONFIG:"GetAnalyticsConfig",ANALYTICS_PUT_CONFIG:"PutAnalyticsConfig",ANALYTICS_DELETE_CONFIG:"DeleteAnalyticsConfig",ANALYTICS_GET_DATA:"GetAnalyticsData",ANALYTICS_GET_STATUS:"GetAnalyticsStatus",INVENTORY_GET_STATUS:"GetInventoryStatus",SWITCH_BACK_TO_OLD_CONSOLE:"SwitchBackToOriginal",IS_INVENTORY_ENABLED:"isInventoryEnabled",IS_ANALYTICS_ENABLED:"isAnalyticsEnabled",IS_LIFECYCLE_ENABLED:"isLifecycleEnabled",IS_METRICS_ENABLED:"isMetricsEnabled",GET_BUCKET_POLICY:"GetBucketPolicy",PUT_BUCKET_POLICY:"PutBucketPolicy",OPEN:"Open",GET_KMS_DEFAULT_ENCRYPTION:"GetKMSKeysForDefaultEncryption",GET_DEFAULT_ENCRYPTION:"GetDefaultEncryption",PUT_DEFAULT_ENCRYPTION:"PutDefaultEncryption",DELETE_DEFAULT_ENCRYPTION:"DeleteDefaultEncryption",ANALYZE_ACCESS:"AnalyzeBucketAccess"},METRIC_NAME:{LIFECYCLE_RULE_MISMATCH:"LifecycleRuleMismatch",LIFECYCLE_DELETE_MISMATCH:"LifecycleDeleteMismatch"},CWS_OPERATION_NAME:{ADD_OBJECT_TAG:"AddObjectVersionsTags",CHANGE_METADATA:"ChangeMetadata",CHANGE_SSE:"ChangeSSE",CHANGE_STORAGE_CLASS:"ChangeStorageClass",COMPLETE_MULTIPART_COPY:"CompleteMultipartCopy",COPY:"CopyObject",GENERATE_COUNT:"Count",GENERATE_VERSIONS_COUNT:"VersionsCount",GENERATE_PRESIGNED_URL:"GeneratePresignedUrl",GET_METADATA:"GetObjectMetadata",INITIATE_RESTORE:"RestoreObjectVersions",MAKE_PUBLIC:"MakePublicVersions",MULTIPART_COPY:"MultipartCopy",ANALYZE_ACCESS:"AnalyzeAccess"},OPERATION_PROGRESS_UPDATE_TYPE:{SINGLE_PART_RESULTS:"SinglePart",MULTIPART_COPY_RESULT:"MultipartCopy",MULTIPART_COPY_COMPLETE:"MultipartCopyComplete",MULTIPART_COPY_ALL_COMPLETE:"MultipartCopyAllComplete",MULTIPART_COPY_ERROR:"MultipartCopyError"},PROGRESS_BAR:{USER_CONFIRM_CANCEL_FROM_PROGRESS_BAR:"S3ConsoleUserConfirmCancelProgressBar",USER_CONFIRM_CANCEL_FROM_DETAIL_MODAL:"S3ConsoleUserConfirmCancelDetailModal"},CACHE:{SIZE:{BUCKET_LOCATION:1000,BUCKET_PROPERTIES:11,LAMB:1,LIST_OBJECTS:50,ACCESS:1000}},DIRECTORY_CONTENT_TYPE:"application/x-directory",OPT_OUT_COOKIE:{COOKIE_KEY:"awsc-experiment-override",PATH:"/s3",VALUE:{PUBLIC:'{"s3_v2":"ltVMV9Q2TD"}',CN:'{"s3_v2":"ltVMV9Q2TD"}'}},HEADERS:{CACHE_CONTROL:"Cache-Control",CONTENT_DISPOSITION:"Content-Disposition",CONTENT_ENCODING:"Content-Encoding",CONTENT_LENGTH:"Content-Length",CONTENT_MD5:"Content-MD5",CONTENT_TYPE:"Content-Type",CONTENT_TYPE_JSON:"application/x-amz-json-1.1",EXPECT:"Expect",EXPIRES:"Expires",X_AMZ_MFA:"x-amz-mfa",X_AMZ_STORAGE_CLASS:"x-amz-storage-class",X_AMZ_SERVER_SIDE_ENCRYPTION:"x-amz-server-side-encryption",X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID:"x-amz-server-side-encryption-aws-kms-key-id",X_AMZ_GRANT_READ:"x-amz-grant-read",X_AMZ_RESTORE:"x-amz-restore",X_AMZ_GRANT_READ_ACP:"x-amz-grant-read-acp",X_AMZ_GRANT_WRITE:"x-amz-grant-write",X_AMZ_GRANT_WRITE_ACP:"x-amz-grant-write-acp",X_AMZ_WEBSITE_REDIRECT_LOCATION:"x-amz-website-redirect-location",X_AMZ_REPLICATION_STATUS:"x-amz-replication-status",OPERATION:"X-Amazon-S3Console-Operation",X_AMZ_ID_2:"x-amz-id-2",X_AMZ_REQUEST_ID:"x-amz-request-id",X_AMZ_DATE:"X-Amz-Date",X_AMZ_EXPIRATION:"x-amz-expiration",X_AMZ_TAGGING:"x-amz-tagging",X_AMZ_TAGGING_COUNT:"x-amz-tagging-count",X_AMZ_ACL:"x-amz-acl",X_AMZ_ACL_PRIVATE:"private"},STORAGE_CLASSES:{DEFAULT:"default",GLACIER:"GLACIER",Glacier:"GLACIER",REDUCED_REDUNDANCY:"REDUCED_REDUNDANCY","Reduced redundancy":"REDUCED_REDUNDANCY",STANDARD:"STANDARD",Standard:"STANDARD",STANDARD_INFREQUENT_ACCESS:"STANDARD_IA","Standard - IA":"STANDARD_IA"},UNITS:["B","KB","MB","GB","TB","PB"],LOGGING:{S3_REQUEST_PREFIX:"s3Req",S3_RESPONSE_PREFIX:"s3Res",CWS_REQUEST_PREFIX:"cwsReq",CWS_RESPONSE_PREFIX:"cwsRes"},ACL_PERMISSIONS:{READ:"READ",WRITE:"WRITE",READ_ACP:"READ_ACP",WRITE_ACP:"WRITE_ACP",FULL_CONTROL:"FULL_CONTROL"},VERSIONS:{LIST_VERSIONS_COMPLETED:"ListVersionsCompleted"},GRANTEE_GROUP:{OWNER:"owner",SYSTEM:"system",ACCOUNTS:"accounts",GROUP:"group"},PUBLIC_PERMISSIONS_LIST:["AuthenticatedUsers","AllUsers"],SYSTEM_PERMISSIONS_LIST:["LogDelivery"],LOG_DELIVERY_VALUE:"LogDelivery",BUCKET_PERMISSIONS:{PUT_BUCKET_PERMISSIONS_REQUEST:"put-bucket-permissions-request",GET_BUCKET_OWNER:"get-bucket-owner",CREATE_BUCKET_PERMISSIONS:"CreateBucketPermissions",INITIALIZE_ACLS:{publicPermissions:[{detail:{text:"Any AWS user",value:"AuthenticatedUsers",Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AuthenticatedUsers"},permissions:{READ:false,READ_ACP:false,WRITE:false,WRITE_ACP:false}},{detail:{text:"Everyone",value:"AllUsers",Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AllUsers"},permissions:{READ:false,READ_ACP:false,WRITE:false,WRITE_ACP:false}}],userPermissions:[{permissions:{READ:true,READ_ACP:true,WRITE:true,WRITE_ACP:true},revokeAll:false}],awsAccountPermissions:[],systemPermissions:[{detail:{text:"LogDelivery",value:"LogDelivery",Type:"Group",URI:"http://acs.amazonaws.com/groups/s3/LogDelivery"},permissions:{READ:false,READ_ACP:false,WRITE:false,WRITE_ACP:false}}]},SAMPLE_CORS_POLICY:"<!-- Sample policy -->\n<CORSConfiguration>\n\t<CORSRule>\n\t\t<AllowedOrigin>*</AllowedOrigin>\n\t\t<AllowedMethod>GET</AllowedMethod>\n\t\t<MaxAgeSeconds>3000</MaxAgeSeconds>\n\t\t<AllowedHeader>Authorization</AllowedHeader>\n\t</CORSRule>\n</CORSConfiguration>",POLICY_GEN:{PUBLIC:"http://awspolicygen.s3.amazonaws.com/policygen.html",CN:"https://awspolicygen.s3.cn-north-1.amazonaws.com.cn/policygen.html",GOV:"https://awspolicygen.s3-fips-us-gov-west-1.amazonaws.com/policygen.html",ISO:"https://awspolicygen.s3.us-iso-east-1.c2s.ic.gov/policygen.html","ISO-B":"https://awspolicygen.s3.us-isob-east-1.sc2s.sgov.gov/policygen.html"}},BUCKET_PROPERTIES:{WEBSITE:{USE_BUCKET:"useBucket",PROPERTY_NAME:"website",INDEX_FILE:"index.html",CREATE_BUCKET_CARD:"create-bucket-website-card",REDIRECT_REQUEST:"redirectRequest",CONFIGURE_BUCKET_WEBSITE:"configureBucketWebsite",REDIRECT_BUCKET_WEBSITE_REQUESTS:"redirectBucketWebsiteRequests",NO_WEBSITE_CONFIGURATION_MESSAGE:"The specified bucket does not have a website configuration",DISABLE:"disable",REGION_TO_WEBSITE_ENDPOINT_MAP:{"us-east-1":"s3-website-us-east-1.amazonaws.com","us-west-2":"s3-website-us-west-2.amazonaws.com","us-west-1":"s3-website-us-west-1.amazonaws.com","eu-west-1":"s3-website-eu-west-1.amazonaws.com","eu-west-2":"s3-website.eu-west-2.amazonaws.com","eu-west-3":"s3-website.eu-west-3.amazonaws.com",EU:"s3-website-eu-west-1.amazonaws.com","ap-southeast-1":"s3-website-ap-southeast-1.amazonaws.com","ap-northeast-1":"s3-website-ap-northeast-1.amazonaws.com","ap-southeast-2":"s3-website-ap-southeast-2.amazonaws.com","sa-east-1":"s3-website-sa-east-1.amazonaws.com","eu-central-1":"s3-website.eu-central-1.amazonaws.com","ap-northeast-2":"s3-website.ap-northeast-2.amazonaws.com","ap-south-1":"s3-website.ap-south-1.amazonaws.com","us-east-2":"s3-website.us-east-2.amazonaws.com","ca-central-1":"s3-website.ca-central-1.amazonaws.com","us-gov-west-1":"s3-website-us-gov-west-1.amazonaws.com","us-iso-east-1":"s3-website.us-iso-east-1.c2s.ic.gov","us-isob-east-1":"s3-website.us-isob-east-1.sc2s.sgov.gov","cn-north-1":"s3-website.cn-north-1.amazonaws.com.cn","cn-northwest-1":"s3-website.cn-northwest-1.amazonaws.com.cn"}},TAGGING:{PROPERTY_NAME:"tagging",CREATE_BUCKET_CARD:"create-bucket-tagging-card",PUT_BUCKET_TAGGING:"putBucketTagging",TAG_SET_NOT_EXIST_MESSAGE:"The TagSet does not exist"},OBJECT_LOGGING:{READ_ONLY:"ReadOnly",WRITE_ONLY:"WriteOnly",ALL:"All"},PUT_BUCKET_ACL:"putBucketACL",GET_BUCKET_ACL:"getBucketACL",LOGGING:{ENABLE_BUCKET_LOGGING:"enableBucketLogging",CREATE_BUCKET_CARD:"create-bucket-logging-card",ENABLE:"enable"},DEFAULT_ENCRYPTION:{NONE:"None",AES256:"AES-256",AWSKMS:"AWS-KMS",API_PARAMS:{NONE:"NONE",AES256:"AES256",AWSKMS:"aws:kms"},CUSTOM_ARN:"CUSTOM_ARN",DEFAULT_ENCRYPTION_CARD:"create-bucket-default-encryption-card",NOT_FOUND_ERROR:"The server side encryption configuration was not found"},VERSIONING:{ENABLE_BUCKET_VERSIONING:"enableBucketVersioning",CREATE_BUCKET_CARD:"create-bucket-versioning-card",ENABLED:"Enabled",SUSPENDED:"Suspended",ENABLE:"enable"},REPLICATION:{CREATE_BUCKET_CARD:"create-bucket-replication-card",PUT_REPLICATION:"putBucketReplication",DISABLED:"Disabled",ENABLED:"Enabled"},EVENTS:{PUT_NOTIFICATION:"putBucketNotification",CREATE_BUCKET_CARD:"create-bucket-events-card"},EVENT_SELECTORS:{CREATE_BUCKET_CARD:"create-event-selectors-card"},REPORTS:{CREATE_BUCKET_CARD:"create-bucket-reports-card",FREQUENCY:{DAILY:"DAILY",WEEKLY:"WEEKLY"},VERSIONING:{ALL:"All",CURRENT:"Current"},TYPE:{OBJECT:"OBJECT"},FORMAT:{CSV:"CSV"}},ENABLE:"enable",DISABLE:"disable",GROUP_GANTEE_TYPE:"Group",LOG_DELIVERY_GROUP:"http://acs.amazonaws.com/groups/s3/LogDelivery"},BULK_OPERATION_KEYS_PER_REQUEST:{S3_API:1000,CWS_API:20},BULK_OPERATION_KEY_COUNT_PER_ERROR_TYPE:100,BUCKET_EVENTS:{PUT:"s3:ObjectCreated:Put",POST:"s3:ObjectCreated:Post",COPY:"s3:ObjectCreated:Copy",COMPLETE_MULTIPART_UPLOAD:"s3:ObjectCreated:CompleteMultipartUpload",DELETE:"s3:ObjectRemoved:Delete",DELETE_MARKER_CREATED:"s3:ObjectRemoved:DeleteMarkerCreated",RRS_OBJECT_LOST:"s3:ReducedRedundancyLostObject",CREATE_OBJECT_ALL:"s3:ObjectCreated:*",DELETE_OBJECT_ALL:"s3:ObjectRemoved:*"},EVENTS:{PREFIX:"Prefix",SUFFIX:"Suffix",SNS:"SNS",SQS:"SQS",LAMBDA:"Lambda",CUSTOM:"custom",CLOUDCONFIG:"CloudFunctionConfiguration",QUEUECONFIG:"QueueConfiguration",TOPICCONFIG:"TopicConfiguration",TOPIC:"Topic",QUEUE:"Queue",CLOUDFN:"CloudFunction",CUSTOM_PLACEHOLDER:{LAMBDA:"us-east-1:123456789:function:my_function_name",SNS:"us-east-1:123456789012:my_topic",SQS:"us-east-1:123456789012:my_queue"}},REPLICATION:{ENABLED:"Enabled",DISABLED:"Disabled",CONFIGNOTFOUND:"The replication configuration was not found",NEWROLE:"newrole",ERROR_CODE:{ENTITY_EXIST:"EntityAlreadyExists",ACCESS_DENIED:"AccessDenied",LIMIT_EXCEED:"LimitExceeded"}},TAGGING:{ERROR_CODES:{NO_SUCH_TAG_SET:"NoSuchTagSet"},MAX_ALLOWED_TAGS:10},USER_DEFINED_METADATA:["Cache-Control","Content-Disposition","Content-Encoding","Content-Language","Content-Type","Expires","x-amz-website-redirect-location"],CONTENT_TYPE_VAL_FROM_EXT:{mp3:"audio/mp3",wav:"audio/wav",aac:"audio/aac",png:"image/png",jpeg:"image/jpeg",jpg:"image/jpeg",gif:"image/gif",bmp:"image/bmp",tiff:"image/tiff",svg:"image/svg+xml",txt:"text/plain",rtf:"text/rtf",css:"text/css",html:"text/html",csv:"text/csv",doc:"application/msword",zip:"application/zip",json:"application/json",js:"application/javascript",pdf:"application/pdf",gz:"application/x-gzip",gzip:"application/x-gzip",z:"application/x-compressed","7z":"application/x-7z-compressed",apk:"application/vnd.android.package-archive",azw:"application/vnd.amazon.ebook",dmg:"application/x-apple-diskimage",mpkg:"application/vnd.apple.installer+xml",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",m3u8:"application/x-mpegURL",flv:"video/x-flv",mp4:"video/mp4",mpeg:"video/mpeg",ts:"video/MP2T","3gp":"video/3gpp",mov:"video/quicktime",avi:"video/x-msvideo",wmv:"video/x-ms-wmv"},CONTENT_TYPE_VALUES:[{text:"binary/octet-stream"},{text:"image/png"},{text:"image/jpeg"},{text:"image/gif"},{text:"image/bmp"},{text:"image/tiff"},{text:"image/svg+xml"},{text:"text/plain"},{text:"text/rtf"},{text:"application/msword"},{text:"application/zip"},{text:"audio/mpeg"},{text:"application/pdf"},{text:"application/x-gzip"},{text:"application/x-compressed"},{text:"application/zip"},{text:"application/vnd.android.package-archive"}],CONTENT_DISPOSITION:[{text:"attachment"}],USER_DEFINED_METADATA_PREFIX:"x-amz-meta-",FILE_EXTENSIONS_ICON_MAP:{"default":"file-o","7z":"file-archive-o",dmg:"file-archive-o",gz:"file-archive-o",iso:"file-archive-o",jar:"file-archive-o",rar:"file-archive-o",tar:"file-archive-o",tgz:"file-archive-o",war:"file-archive-o",z:"file-archive-o",zip:"file-archive-o",mp3:"file-audio-o",bin:"file-code-o",c:"file-code-o","c++":"file-code-o",css:"file-code-o",html:"file-code-o",java:"file-code-o",js:"file-code-o",py:"file-code-o",sh:"file-code-o",xml:"file-code-o",xl:"file-excel-o",xlsx:"file-excel-o",xlsm:"file-excel-o",gif:"file-image-o",jpeg:"file-image-o",jpg:"file-image-o",png:"file-image-o",pdf:"file-pdf-o",ppt:"file-powerpoint-o",rt:"file-text-o",rtf:"file-text-o",rtx:"file-text-o",text:"file-text-o",txt:"file-text-o",avi:"file-video-o",flv:"file-video-o",m4v:"file-video-o",mov:"file-video-o",movie:"file-video-o",mp4:"file-video-o",qt:"file-video-o",wmv:"file-video-o",doc:"file-word-o",docm:"file-word-o",docx:"file-word-o",word:"file-word-o",trash:"trash-o"},LIFECYCLE:{NAME:"lifecycle",ENABLED:"Enabled",DISABLED:"Disabled",SIA:"SIA",GLACIER:"Glacier",EXPIRE:"Expire",AMU:"AMU",PREFIX_PROPERTY:"Prefix",PERMANENTLY_DELETE:"PermanentlyDelete",LIST_VIEW:{STANDARD_IA:"Standard-IA",GLACIER:"Amazon Glacier",PREFIX:"prefix : ",WHOLE:"Whole bucket",PermanentlyDelete:"Permanently Delete"},REVIEW_SECTION_TRANSITIONS:{SIA:"Standard-IA",Glacier:"Amazon Glacier",Expire:"Expire",PermanentlyDelete:"Permanently delete"},MAX_DAYS_ALLOWED:2147483647,EXPONENTIAL:"e",EXPIRATION:"Expiration",NON_CURRENT_VERSION_EXPIRATION:"NoncurrentVersionExpiration",NON_CURRENT_DAYS:"NoncurrentDays",DAYS:"Days",STORAGE_CLASS:"StorageClass",TRUE:"true",FALSE:"false",WHOLE_BUCKET:"whole",PREFIX:"prefix",TOTAL_OPTIONS:2,RULE_ACTIONS_MAP:{STANDARD_IA:"SIA",GLACIER:"Glacier",Expiration:"Expire",NoncurrentVersionExpiration:"PermanentlyDelete"},KEY:"Key",VALUE:"Value",TAGSET:"Tags",NONCURRENT_RULE_OPTIONS_MAP:{SIA:0,Glacier:1,PermanentlyDelete:2},CURRENT_RULE_OPTIONS_MAP:{SIA:0,Glacier:1,Expire:2},TAGS:"Tags",KEY_STRING:"Key",VALUE_STRING:"Value",BUCKET_LIFECYCLE:"BucketLifecycle",GET_BUCKET_LIFECYCLE:"getBucketLifecycle",PUT_BUCKET_LIFECYCLE:"putBucketLifecycle",ENABLED_LIFECYCLE_RULE_ACTIONS:"enabledLifecycleRuleActions",CREATE_BUCKET_LIFECYCLE:"createLifecycleRule",EDIT_BUCKET_LIFECYCLE:"editLifecycleRule",CURRENT:"current",NONCURRENT:"noncurrent",AMU_DEFAULT_DAYS:"7",LIFECYCLE_RULE_ACTION_MIN_DAYS:{SIA:30,Glacier:0,Expire:1,PermanentlyDelete:1,AMU:1,Delete:1},RECOMMENDED_DAYS:{SIA:"30",GLACIER:"1",EXPIRATION:"365"},RULE_ACTION_ERRORS:{SIA:0,GLACIER:1,EXPIRE:2,PERMANENTLY_DELETE:2,DELETE_RULE_ACTION:2,GLACIER_GREATER_THAN_SIA:"GlacierGreaterThanSIA",DELETE_RULE_ACTION_GREATER_THAN_SIA:"DeleteGreaterThanSIA",DELETE_RULE_ACTION_GREATER_THAN_GLACIER:"DeleteGreaterThanGlacier"},LIFECYCLE_DOES_NOT_EXIST_MESSAGE:"The lifecycle configuration does not exist",CONFIRMATION_MODAL:{ENABLE_POLICY:"enablePolicy",DISABLE_POLICY:"disablePolicy",DELETE_POLICY:"deletePolicy"},LIST_VIEW_MAX_LENGTH:25,ENABLE_LIFECYCLE_POLICY:"enableLifecyclePolicy",DISABLE_LIFECYCLE_POLICY:"disableLifecyclePolicy",DELETE_LIFECYCLE_POLICY:"deleteLifecyclePolicy"},KEY_CODES:{BACKSPACE:8,DOWN:40,ENTER:13,ESC:27,UP:38},ENTITY_MAX_LENGTH:{ROLE:64,POLICY:128,PATH:512,TAG_KEY:128,TAG_VALUE:256},REQUEST_METRICS:{SERVER_AVAILABILITY_SUFFIX:"-SerAvail",CLIENT_AVAILABILITY_SUFFIX:"-CliAvail",STATUS_CODE_INFIX:"-Code-",LATENCY_SUFFIX:"-latency"},PROXY_API_NAMES:{KMS:{LIST_KEYS:"KMS-ListKeys",PUT_POLICY:"KMS-PutPolicy",GET_POLICY:"KMS-GetPolicy"},SNS:{LIST_TOPICS:"SNS-ListTopics"},SQS:{LIST_QUEUES:"SQS-ListQueues"},LAMBDA:{LIST_FUNCTIONS:"LAMBDA-listFunctions"},IAM:{LIST_ROLES:"IAM-ListRoles",LIST_ATTACHED_ROLE_POLICIES:"IAM-ListAttachedRolePolicies",GET_POLICY_VERSIONS:"IAM-GetPolicyVersion",LIST_POLICY_VERSIONS:"IAM-ListPolicyVersions"},S3:{LAMB:"S3-LAMB",HEAD_BUCKET:"S3-HeadBucket",PUT_OBJECT:"S3-PutObject",HEAD_OBJECT:"S3-HeadObject",GET_BUCKET_LOCATION:"S3-GetBucketLocation",CREATE_BUCKET:"S3-CreateBucket",LIST_OBJECT:"S3-ListObject",LIST_VERSION:"S3-ListVersion",GET_OBJECT_TAG:"S3-GetObjectTag",PUT_OBJECT_TAG:"S3-PutObjectTag",GET_OBJECT_ACL:"S3-GetObjectAcl",PUT_OBJECT_ACL:"S3-PutObjectAcl",INITIAL_MULTIPART_UPLOAD:"S3-InitialMPUpload",COMPLETE_MULTIPART_UPLOAD:"S3-CompleteMPUpload",GET_OBJECT_METADATA:"S3-GetObjectMD",GET_PROPERTY_PREFIX:"S3-Get",PUT_PROPERTY_PREFIX:"S3-Put",DELETE_PROPERTY_PREFIX:"S3-Delete",DELETE:"S3-Delete",GET_OBJECT:"S3-GetObject",TAG_QUERY:"S3-TagQuery",LIST_BUCKET_ISIDORE_CONFIGURATION:"S3-ListBucketIsidoreConfiguration"},GLACIER:{LIST_PROVISIONED_CAPACITY:"GLACIER-ListCapacity",PURCHASE_PROVISIONED_CAPACTIY:"GLACIER-PurchaseCapacity"},CLOUDTRAIL:{DESCRIBE_TRAILS:"CLOUDTRAIL-DescribeTrails",GET_EVENT_SELECTORS:"CLOUDTRAIL-GetEventSelectors",PUT_EVENT_SELECTORS:"CLOUDTRAIL-PutEventSelectors"}},S3_DEFAULT_ENDPOINT:"https://s3.amazonaws.com",S3_ENDPOINTS:{"us-east-1":"https://s3.amazonaws.com","us-west-2":"https://s3-us-west-2.amazonaws.com","us-west-1":"https://s3-us-west-1.amazonaws.com","eu-west-1":"https://s3-eu-west-1.amazonaws.com","eu-west-2":"https://s3.eu-west-2.amazonaws.com","eu-west-3":"https://s3.eu-west-3.amazonaws.com","ap-southeast-1":"https://s3-ap-southeast-1.amazonaws.com","ap-northeast-1":"https://s3-ap-northeast-1.amazonaws.com","ap-southeast-2":"https://s3-ap-southeast-2.amazonaws.com","sa-east-1":"https://s3-sa-east-1.amazonaws.com","eu-central-1":"https://s3.eu-central-1.amazonaws.com","ap-northeast-2":"https://s3.ap-northeast-2.amazonaws.com","ap-south-1":"https://s3.ap-south-1.amazonaws.com","us-east-2":"https://s3.us-east-2.amazonaws.com","ca-central-1":"https://s3.ca-central-1.amazonaws.com","cn-north-1":"https://s3.cn-north-1.amazonaws.com.cn","cn-northwest-1":"https://s3.cn-northwest-1.amazonaws.com.cn","us-gov-west-1":"https://s3-us-gov-west-1.amazonaws.com","us-iso-east-1":"https://s3.us-iso-east-1.c2s.ic.gov","us-isob-east-1":"https://s3.us-isob-east-1.sc2s.sgov.gov"},SESSION_TIMEOUT_MESSAGE:"Please (re)authenticate or return to https://console.aws.amazon.com",METRICS:{RANGE:{H1:"H1",H3:"H3",H12:"H12",H24:"H24",D3:"D3",W1:"W1",W2:"W2"},TYPE:{STORAGE:"storage",REQUESTS:"requests",DATA:"data"},UNIT:{COUNT:"Count",BYTES:"Bytes",MILLIS:"Milliseconds"}},MANAGEMENT:{VIEWS:{LIFECYCLE:0,REPLICATION:1,ANALYTICS:2,CLOUDWATCH:3,INVENTORY:4},ACTION:{APPLYING_CONFIG:"applyingConfig",SAVING_FILTER:"savingFilter",CONFIG_LOADING:"configLoading",DELETE_FILTER:"deleteFilter",DATA_LOADING:"dataLoading"},FILTER_NAME_REGEX:/^[a-zA-Z0-9\-_.]+$/,POLICY:{SPACING:4,ID:"S3-Console-Auto-Gen-Policy",ACTION:["s3:PutObject","s3:*"],SID:"S3PolicyStmt-DO-NOT-MODIFY",SERVICE_KEY:"Service",SERVICE_VAL:"s3.amazonaws.com",SOURCE_ARN:"aws:SourceArn",ACCOUNT_KEY:"aws:SourceAccount",X_AMZ_ACL_KEY:"s3:x-amz-acl",X_AMZ_ACL_VAL:"bucket-owner-full-control",STATUS:{FAILED:0,CREATED:1,MODIFIED:2,FOUND:3,WARN:4,DENY:5},ALLOW:"Allow",DENY:"Deny"}},ENTRY_STATE:{CREATE:0,ADDED:1,SAVED:2,REMOVE:3,UPDATE:4},STATUS_CODE_MAP:{"403":"Access Denied","404":"Data not found","500":"Internal Error"},ACCELERATE:{COMPARISON_ENDPOINT:"http://s3-accelerate-speedtest.s3-accelerate.amazonaws.com/en/accelerate-speed-comparsion.html?",ENDPOINT:{PUBLIC:".s3-accelerate.amazonaws.com"}},ANALYTICS:{STORAGE_CLASS:{STANDARD:"STANDARD",STANDARD_IA:"STANDARD-IA",GLACIER:"GLACIER",REDUCED_REDUNDANCY:"REDUCED_REDUNDANCY"},ERROR:{USER_INFO_MISSING:"USER_INFO_MISSING",DATA_FILE_NOT_FOUND:"DATA_FILE_NOT_FOUND"},TAB_VIEW:"Tab",DETAILS:"Details",CREATE_BUCKET_MODAL:"CreateBucketModal",UPLOAD_OBJECTS_MODAL:"UploadObjectsModal",LIFECYCLE_RULES_MODAL:"LifecycleRulesModal",LATEST_VERSION:"LatestVersion",DOWNLOAD_AS:"DownloadAs",ADD_GRANTEE:"AddGrantee",SAVE_LOGGING:"SaveLogging",CANCEL_LOGGING:"CancelLogging",SAVE_WEBSITE:"SaveWebsite",CANCEL_WEBSITE:"CancelWebsite",SAVE_REPLICATION:"SaveReplication",CANCEL_REPLICATION:"CancelReplication",SAVE_EVENTS:"SaveEvents",CANCEL_EVENTS:"CancelEvents",SAVE_VERSIONING:"SaveVersioning",CANCEL_VERSIONING:"CancelVersioning",CONFIRMATION_MODAL:"ConfirmationModal",CARD_OPEN:"CardOpen",SAVE_TAGGING:"SaveTagging",CANCEL_TAGGING:"CancelTagging",SAVE_OBJECT_METADATA:"SaveObjectMetadata",CANCEL_OBJECT_METADATA:"CancelObjectMetadata",SAVE_OBJECT_TAGS:"SaveObjectTags",CANCEL_OBJECT_TAGS:"CancelObjectTags",SAVE_OBJECT_SSE:"SaveObjectSSE",CANCEL_OBJECT_SSE:"CancelObjectSSE",SAVE_OBJECT_STORAGE_CLASS:"SaveObjectStorageClass",CANCEL_OBJECT_STORAGE_CLASS:"CancelObjectStorageClass",SAVE_REQUESTER_PAYS:"SaveRequesterPays",CANCEL_REQUESTER_PAYS:"CancelRequesterPays",SAVE_EVENT_SELECTORS:"SaveEventSelectors",CANCEL_EVENT_SELECTORS:"CancelEventSelectors",CREATE_BUCKET_S3:"CreateBucketS3",START_CREATE_BUCKET:"Start_CreateBucket",NAME_REGION_CREATE_BUCKET:"NameRegion_CreateBucket",SET_PROP_CREATE_BUCKET:"SetProp_CreateBucket",SET_PERM_CREATE_BUCKET:"SetPerm_CreateBucket",REVIEW_CREATE_BUCKET:"Review_CreateBucket",END_CREATE_BUCKET:"End_CreateBucket",SUCCESS_CREATE_BUCKET:"Success_CreateBucket",UPLOAD_FILE_S3:"UploadFileS3",START_UPLOAD_FILE:"Start_UploadFileS3",SELECT_UPLOAD_FILE:"Select_UploadFileS3",SET_PERMISSIONS_UPLOAD_FILE:"SetPerm_UploadFileS3",SET_PROPERTIES_UPLOAD_FILE:"SetProp_UploadFileS3",REVIEW_UPLOAD_FILE:"Review_UploadFileS3",END_UPLOAD_FILE:"End_UploadFileS3",LIFECYCLE_S3:"LifeCycleS3",START_LIFECYCLE:"Start_LifeCycleS3",NAME_SCOPE_LIFECYCLE:"NameScope_LifeCycleS3",TRANSITION_LIFECYCLE:"Transition_LifeCycleS3",EXPIRATIONS_LIFECYCLE:"Expirations_LifeCycleS3",REVIEW_LIFECYCLE:"Review_LifeCycleS3",END_LIFECYCLE:"End_LifeCycleS3",CANCEL_ACCELERATE:"CancelAccelerate",GET_BUCKET_ACCELERATE:"GetBucketAccelerate",PUT_BUCKET_ACCELERATE:"PutBucketAccelerate",SAVE_ACCELERATE:"SaveAccelerate",MANAGEMENT:{ADD_CONFIG:"AddConfig",SAVE_CONFIG:"SaveConfig",DELETE_CONFIG:"DeleteConfig",EDIT_CONFIG:"EditConfig",SEARCH_CONFIG:"SearchConfig",CANCEL_CONFIG:"CancelAddConfig",ANALYTICS:{CONTEXT:"StorageClassAnalysis",QUICKSIGHT_LINK:"QuicksightDeepLink",CHANGE_STORAGE_CLASS:"ChangeStorageClass"},METRICS:{CONTEXT:"StorageCloudwatchMetrics",CLOUDWATCH_LINK:"CloudwatchDeepLink",REFRESH:"RefreshMetrics",PERIOD:{W2:"MetricsPeriod2Weeks",W1:"MetricsPeriod1Week",H24:"MetricsPeriod1Day",H12:"MetricsPeriodHalfDay",H3:"MetricsPeriod3Hours",H1:"MetricsPeriod1Hour"},TYPE:{storage:"StorageMetrics",requests:"RequestsMetrics",data:"DataTransferMetrics"}},INVENTORY:{CONTEXT:"ObjectInventoryContext"}}},INVENTORY:{GET_STATUS_ERROR:"STATUS_FILE_NOT_FOUND"},LEARN_MORE_LINKS:{ACCELERATE:"console/s3/transfer-acceleration",AES256_ENCRYPTION:"console/s3/using-sse-encryption-s3-managed",ENCRYPTION:"console/s3/usingencryption",DEFAULT_ENCRYPTION:"console/s3/bucket-encryption",INVENTORY_ENCRYPTION:"console/s3/inventory-kms-key-policy",EVENTS:"console/s3/event-notifications",LAMB:{MAIN:"documentation/s3/",ACCESS:"console/s3/acl-overview-permissions"},LOGGING:"console/s3/server-access-logging",CLOUDTRAIL:"awscloudtrail/latest/userguide/logging-management-and-data-events-with-cloudtrail.html?icmpid=docs_cloudtrail_console#logging-data-events",METADATA:"console/s3/using-metadata",OBJECT_TAGGING:"console/s3/object-tagging",PERMISSIONS:{POLICY:"console/s3/using-iam-policies",CORS:"console/s3/enablecors"},CRR_KMS:"console/s3/crr-kms-key-policy",REPLICATION:"console/s3/replication",STORAGE_CLASS:"console/s3/storageclasses",TAGGING:"console/s3/cost-allocation-tagging",VERSIONING:"console/s3/enable-bucket-versioning",REQUESTER_PAYS:"console/s3/requesterpaysbucket",WEBSITE:{configure:"console/s3/configurebucketforwebsite",redirect:"console/s3/website-redirect",hosting:"console/s3/hostingstaticwebsite"},bucket:["console/s3/usingbucket","console/s3/upload-object","console/s3/accesscontrol"],object:["console/s3/upload-object","console/s3/object-properties","console/s3/accesscontrol"],lifecycle:["console/s3/lifecyclerules","console/s3/lifecycle-transitions","console/s3/lifecycle-expire"],"storage-management":{"analytics-storage-class":"console/s3/analytics-storage-class","configure-metrics-filter":"console/s3/cloudwatch-request-metrics-filter","configure-inventory":"console/s3/configure-inventory",quicksight:"https://quicksight.aws"},replication:["console/s3/replication"]},SUCCESS_MESSAGE_TIMEOUT:5000,TARGET_MEDIATOR:{SUPPORTED_LANGUAGES:["en","jp","cn","fr"],LANGUAGE_MAP:{en:"en",en_us:"en",ja:"jp",ja_jp:"jp",zh:"cn",zh_cn:"cn",fr:"fr",fr_fr:"fr"}},FALLBACK_REGION_LIST:{PUBLIC:["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-west-2","eu-west-3","eu-central-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","ca-central-1","sa-east-1"],CN:["cn-north-1","cn-northwest-1"],GOV:["us-gov-west-1"],ISO:["us-iso-east-1"],"ISO-B":["us-isob-east-1"]},REGION_DOMAIN:{ISOB:"ISOB","ISO-B":"ISO-B"},DEFAULT_REGION:{PUBLIC:"us-east-1",CN:"cn-north-1",GOV:"us-gov-west-1",ISO:"us-iso-east-1","ISO-B":"us-isob-east-1"},ARN_SERVICE:{KMS:"kms:",IAM:"iam::",LAMBDA:"lambda:",S3:"s3:::",SNS:"sns:",SQS:"sqs:"},AWS_SERVICE:{KMS:"KMS",S3:"S3",LAMBDA:"LAMBDA",IAM:"IAM",SQS:"SQS",SNS:"SNS"},BUCKET_PERMISSION_TYPE:{ACL:"acl",CORS:"cors",POLICY:"policy"},CARD_SUMMARY_INIT:{isActive:false,isMultiValue:false,isLoading:false,activeSummary:{text:"",value:""},inactiveSummary:{text:""}},YOUTUBE_VIDEO_LINK:"https://youtu.be/U7e97oK_Elg?list=PLhr1KZpdzukeIOiqk59BgvpmHXOfPon92",CONTEXT_MENU:{OBJECT:{METRIC_NAME:"ObjectContextMenu",Y_OFFSET:125}},OBJECT_VERSION_OPERATION:{SHOW_VERSIONS:"ShowObjectVersions",HIDE_VERSIONS:"HideObjectVersions"},PROPERTIES_TITLE_OPNAME_MAPPING:{StorageClass:"Change storage class",Encryption:"Change SSE",Metadata:"Change metadata",Tags:"Add object tags"},LBR_ENDPOINTS:{PUBLIC:"s3.console.aws.amazon.com"},S3_SHARED_DATA:{DATA:"data",STATUS:"status",FAILED:"FAILED",SUCCESS:"SUCCESS",OBJECT_TEMPLATE:"<account-id>/<bucket-name>/<config-id>/data.csv",STATUS_TEMPLATE:"<account-id>/<bucket-name>/<config-id>/status.csv",ANALYTICS_BUCKET_TEMPLATE:"s3-analytics-export-shared-<region>-prod",INVENTORY_BUCKET_TEMPLATE:"s3-inventory-reporter-shared-<region>-prod"},TABS:{OBJECT:{OBJECTS:0,PROPERTIES:1,PERMISSIONS:2,MANAGEMENT:3},OBJECT_DETAILS:{OVERVIEW:0,PROPERTIES:1,PERMISSIONS:2},OBJECT_LIST:{OVERVIEW:"overview",PROPERTIES:"properties",PERMISSIONS:"permissions"}},MODAL_TYPE:{CREATE_BUCKET:"createbucket",UPLOAD:"upload"},FALLBACK_REGION_LIST_FOR_LAMB_AND_HEADBUCKET:{PUBLIC:["us-east-1","eu-west-1","ap-northeast-1"],CN:["cn-north-1","cn-northwest-1"],GOV:["us-gov-west-1"],ISO:["us-iso-east-1"],"ISO-B":["us-isob-east-1"]},IAM_ENDPOINT_MAPPING:{PUBLIC:"us-east-1",CN:"cn-north-1",GOV:"us-gov-west-1",ISO:"us-iso-east-1"}})})();"use strict";(function(){angular.module("s3").directive("fileread",function(){return{restrict:"A",link:function a(d,c,b){c.bind("change",function(e){d.filesSelected(e.target);this.value=""})}}})})();"use strict";(function(){angular.module("s3").controller("LambController",["$filter","$location","$parse","$scope","$window","$translate","AnalyzeAccessConstants","AnalyzeAccessUtilService","APIProxyService","AWSC","AwsUrlsService","BucketPropertiesService","BulkOperationService","CachingService","ConsoleOperation","FAC","Region","S3Constants","SCLogService","UtilService",a]);function a(C,y,I,l,H,t,s,b,G,F,v,A,r,m,f,K,o,J,h,p){var B=new f("InitialLAMBcall","StartLAMBcall");var n;l.bucketsLeftToAnalyze=0;l.regionFromUrl=y.search().region;var i=t.instant("accesssearch.publicread"),q=t.instant("accesssearch.publicwrite");l.loadBuckets=function(M){var L=arguments.length<=1||arguments[1]===undefined?false:arguments[1];var N=arguments.length<=2||arguments[2]===undefined?true:arguments[2];l.numPublic=0;h.log("LoadBucketsReceived",1,M);F.Clog.setPageId(J.CLOG_PAGE_ID);G.listAllMyBuckets(M,N).then(function(O){l.bucketList=O.response.ListAllMyBucketsResult.Buckets.Bucket;n=l.bucketList;F.Timer.customerReady();h.log("LoadBuckets",1,M);l.bucketList.forEach(function(P){A.getBucketLocation(P.Name).then(function(Q){l.regions.forEach(function(R){if(R.value===Q){P.Location=R.text;P.Region=R.value;l.analyzeAccess(P)}})})})})["catch"](function(P){var O=p.handleErrors(P);F.Timer.customerReady();h.log("LoadBuckets",0,M,{errorMessage:O});l.error=O})["finally"](function(){l.isRefreshing=false;if(L){l.isLoadingPage=false}})};l.isReloadDisabled=function(){if(K.isFeatureEnabled(J.FAC.ACCESS)){return l.bucketsLeftToAnalyze!==0}return false};l.analyzeAccess=function(M){if(!K.isFeatureEnabled(J.FAC.ACCESS+"-"+M.Region)){M.Access=t.instant(s.LABELS.NOT_SUPPORTED);return}var L=new f(J.OPERATION_NAME.ANALYZE_ACCESS);l.bucketsLeftToAnalyze++;A.analyzeAccess(M.Name,L).then(function(O){var N=b.getAccessStatus(O);var P=b.getAccessLabels(O,N);M.Access=P.bucketPublic;M.Read=P.bucketReadPublic;M.Write=P.bucketWritePublic;M.Source=P.source;M.isPublic=N.bucketPublic;M.isReadPublic=N.bucketReadPublic;M.isWritePublic=N.bucketWritePublic;if(N.bucketPublic){l.numPublic+=1}})["catch"](function(O){var N=O.errorMessageLocalized;if(N){M.Access=N}else{M.Access=t.instant(s.LABELS.ERROR)}})["finally"](function(){l.bucketsLeftToAnalyze--;E()})};l.showPublic=function(){if(l.filters.accessFilters.indexOf(i)===-1){l.filters.accessFilters.push(i)}if(l.filters.accessFilters.indexOf(q)===-1){l.filters.accessFilters.push(q)}};l.$watchCollection("filters.accessFilters",function(M,L){if(M!==L){E()}});function E(){var L=l.filters.accessFilters;if(L.length!==0){if(L.length===2){l.bucketList=_.filter(n,function(M){return M.isReadPublic||M.isWritePublic})}else{if(L.indexOf(i)>-1){l.bucketList=_.filter(n,{isReadPublic:true})}else{if(L.indexOf(q)>-1){l.bucketList=_.filter(n,{isWritePublic:true})}}}}else{l.bucketList=n}}h.setEndpoint();l.docLink=v.getMarketingUrl(J.LEARN_MORE_LINKS.LAMB.MAIN);l.accessDocLink=v.getDocUrl(J.LEARN_MORE_LINKS.LAMB.ACCESS);l.currentRegion=o.getCurrentRegion();l.isConfirmationModalOpen={flag:false};l.bucketConfirmationDetails={headerTitle:"",warningMessage:"",operation:"",isDelete:false};l.isLoadingPage=true;l.loadBuckets(B,true);l.isRefreshing=false;l.panelHide=true;l.selectBucket=function(L,M){y.path(""+J.DELIMITER+J.PATH_SEGMENTS.BUCKETS+J.DELIMITER+L+J.DELIMITER).search("tab",M)};l.configData={properties:{eventsCount:null,versioning:null,mfaDelete:null,logging:null,staticWebHost:null,tags:null,requesterpays:null},permissions:{owner:null,bucketPolicy:null,accessControlList:null,corsConfiguration:null},management:{lifecycle:null}};if(p.CRRFACHandle().v1){l.configData.properties.replication=null}if(p.CRRFACHandle().v2){l.configData.management.replication=null}if(K.isFeatureEnabled(J.FAC.ACCELERATE)){l.configData.properties.accelerate=null}if(K.isFeatureEnabled(J.FAC.ANALYTICS)){l.configData.management.analytics=null}if(K.isFeatureEnabled(J.FAC.INVENTORY)){l.configData.management.inventory=null}if(K.isFeatureEnabled(J.FAC.METRICS)){l.configData.management.metrics=null}l.regions=[];p.getFACRegions(o.regionMapping,l.regions);l.openConfigPanel=function(L){l.panelHide=false;l.selectedBucket=L;l.panelOpen=true;l.getConfigData(L.Name)};l.notificationShow=true;l.closeNotification=function(){l.notificationShow=false};var x=t.instant("bucketlambda.replicationconfig.notexist");var d=t.instant("bucketlambda.corsconfig.notexist");var g=t.instant("bucketlambda.tag.notexist");var u=t.instant("bucketlambda.website.notexist");l.bucket_more_dropdown=[{items:[{id:"pasteinto",text:t.instant("moreDropDown.pasteinto")}]},{items:[{id:"managecloudtraillog",text:t.instant("moreDropDown.managecloudtraillog")}]}];var c=[{servicesCall:A.getEventCount,scopeBinding:"configData.properties.eventsCount",resultDisplay:t.instant("bucketsidepanel.activenotification"),defaultValue:"0 ".concat(t.instant("bucketsidepanel.activenotification")),name:"getEventCount",isNumber:true},{servicesCall:A.isLoggingEnabled,scopeBinding:"configData.properties.logging",resultDisplay:t.instant("bucketproperty.enabled"),defaultValue:t.instant("bucketproperty.disabled"),name:"isLoggingEnabled"},{servicesCall:A.getTagCount,scopeBinding:"configData.properties.tags",resultDisplay:" ".concat(t.instant("bucketsidepanel.tags")),defaultValue:"0 ".concat(t.instant("bucketsidepanel.tags")),name:"getTagCount",isNumber:true,nomessage:g},{servicesCall:A.isReplicationEnabled,scopeBinding:p.CRRFACHandle().v2?"configData.management.replication":"configData.properties.replication",resultDisplay:t.instant("bucketproperty.enabled"),defaultValue:t.instant("bucketproperty.disabled"),name:"isReplicationEnabled",nomessage:x,facId:J.FAC.CRR},{servicesCall:A.getBucketAccelerate,scopeBinding:"configData.properties.accelerate",resultDisplay:t.instant("bucketproperty.enabled"),defaultValue:t.instant("bucketproperty.disabled"),name:"getBucketAccelerate",nomessage:t.instant("bucketproperty.disabled"),facId:J.FAC.ACCELERATE},{servicesCall:A.getBucketOwnerDisplayName,scopeBinding:"configData.permissions.owner",resultDisplay:"",defaultValue:t.instant("bucketproperty.no"),name:"getBucketOwnerDisplayName"},{servicesCall:A.isCORSEnabled,scopeBinding:"configData.permissions.corsConfiguration",resultDisplay:t.instant("bucketproperty.yes"),defaultValue:t.instant("bucketproperty.no"),name:"isCORSEnabled",nomessage:d},{servicesCall:A.getBucketGrantees,scopeBinding:"configData.permissions.accessControlList",resultDisplay:" ".concat(t.instant("bucketsidepanel.grantees")),defaultValue:"0 ".concat(t.instant("bucketsidepanel.grantees")),granteeCount:true,name:"getBucketGrantees",isNumber:true},{servicesCall:A.getBucketPolicy,scopeBinding:"configData.permissions.bucketPolicy",resultDisplay:t.instant("bucketproperty.yes"),defaultValue:t.instant("bucketproperty.no"),name:"getBucketPolicy"},{servicesCall:A.isLifecycleEnabled,scopeBinding:"configData.management.lifecycle",resultDisplay:t.instant("bucketproperty.enabled"),defaultValue:t.instant("bucketproperty.disabled"),name:"isLifecycleEnabled"},{servicesCall:A.isAnalyticsEnabled,scopeBinding:"configData.management.analytics",resultDisplay:t.instant("bucketproperty.enabled"),defaultValue:t.instant("bucketproperty.disabled"),name:"isAnalyticsEnabled",facId:J.FAC.ANALYTICS},{servicesCall:A.isMetricsEnabled,scopeBinding:"configData.management.metrics",resultDisplay:t.instant("bucketproperty.enabled"),defaultValue:t.instant("bucketproperty.disabled"),name:"isMetricsEnabled",facId:J.FAC.METRICS},{servicesCall:A.isInventoryEnabled,scopeBinding:"configData.management.inventory",resultDisplay:t.instant("bucketproperty.enabled"),defaultValue:t.instant("bucketproperty.disabled"),name:"isInventoryEnabled",facId:J.FAC.INVENTORY},{servicesCall:A.isRequesterPaysEnabled,scopeBinding:"configData.properties.requesterpays",resultDisplay:t.instant("bucketproperty.enabled"),defaultValue:t.instant("bucketproperty.disabled"),name:"isRequesterPaysEnabled"}];function j(L,O,N,M){if(O&&L!==O||L){h.log(N,0,M);l.bucketPanelInfoError=L}else{h.log(N,1,M)}}function D(N,M,L){angular.forEach(N,function(P){var O=I(P.scopeBinding);if(!P.facId||P.facId&&K.isFeatureEnabled(P.facId)){P.servicesCall(M,L).then(function(Q){h.log(P.name,1,L);if(P.hasOwnProperty("granteeCount")){Q=Object.keys(Q).length}if(Q&&Q!=="Suspended"){if(P.isNumber){O.assign(l,Q+" "+P.resultDisplay)}else{if(P.resultDisplay){O.assign(l,P.resultDisplay)}else{O.assign(l,Q)}}}else{O.assign(l,P.defaultValue)}})["catch"](function(Q){O.assign(l,P.defaultValue);j(Q,P.nomessage,P.name,L)})}})}function e(M,L){G.getBucketProperty(L,M,"website").then(function(P){var N=P.response;h.log("getBucketWebsite",1,L);var O=N.WebsiteConfiguration;if(O.RedirectAllRequestsTo){l.configData.properties.staticWebHost=t.instant("bucketproperty.websitehosting.redirectAll")}else{if(O.IndexDocument){l.configData.properties.staticWebHost=t.instant("bucketproperty.websitehosting.enableHosting")}}})["catch"](function(N){l.configData.properties.staticWebHost=t.instant("bucketproperty.disabled");j(N,u,"getBucketWebsite",L)});A.getVersioningAndMFAStatus(M).then(function(N){h.log("getVersioningAndMFAStatus",1,L);l.configData.properties.versioning=N.Status?t.instant("bucketproperty."+N.Status.toLowerCase()):t.instant("bucketproperty.disabled");l.configData.properties.mfaDelete=N.MfaDelete?t.instant("bucketproperty."+N.MfaDelete.toLowerCase()):t.instant("bucketproperty.disabled")})["catch"](function(){h.log("getVersioningAndMFAStatus",0,L);l.configData.properties.versioning="-";l.configData.properties.mfaDelete="-"})}var k=null;l.hoverSidePanelAction=function(L){if(!k){k=$(".storage-console-config-panel")}p.bodyFreezeScroll(L,k)};l.getConfigData=function(M){var L=new f("BucketProperties","getBucketConfigProperties");D(c,M,L);e(M,L)};l.closePanel=function(){var L=arguments.length<=0||arguments[0]===undefined?true:arguments[0];l.panelHide=true;if(L){l.hoverSidePanelAction(false)}};l.copyARNToClipboard=function(M){M.stopPropagation();var L=p.getBucketARN(l.selectedBucket.Name);p.copyToClipboard(L)};l.isCreateBucketModalOpen={flag:false};l.showCreateBucketModal=function(){var L=new f("CreateBucket","populateBucketSelectorDropdown");G.listAllMyBuckets(L).then(function(N){var M=N.response;h.log("listBucketsComplete",1,L);l.bucketList=M.ListAllMyBucketsResult.Buckets.Bucket;E();l.bucketList.forEach(function(O){A.getBucketLocation(O.Name).then(function(P){o.regionMapping.forEach(function(Q){if(Q.value===P){O.Location=Q.text;O.Region=Q.value}})})})});l.isCreateBucketModalOpen.flag=true;p.analyticsTrackClick(J.ANALYTICS.CREATE_BUCKET_MODAL,J.ANALYTICS.DETAILS);p.analyticsTrackClick(J.ANALYTICS.START_CREATE_BUCKET,J.ANALYTICS.CREATE_BUCKET_S3);p.analyticsTrackView(J.ANALYTICS.NAME_REGION_CREATE_BUCKET,J.ANALYTICS.CREATE_BUCKET_S3);p.bodyFreezeScroll(l.isCreateBucketModalOpen.flag)};l.moveToBucketTab=function(L){l.hoverSidePanelAction(false);H.scrollTo(0,0);y.path("/"+J.PATH_SEGMENTS.BUCKETS+"/"+l.selectedBucket.Name).search("tab",L)};l.reloadBuckets=function(){l.isRefreshing=true;var L=new f("RefreshLAMB","RefreshLAMB");l.loadBuckets(L,false,false)};l.deleteBucket=function(){var M=r.createBulkOperation(J.OPERATION_NAME.DELETE_BUCKET,[],[{Prefix:""}],1000,{});M.changeInitialBucketForOperation(l.selectedBucket.Name);M.defer.promise.then(function(){_.remove(l.bucketList,function(O){return O.Name===M.initialBucket});l.reloadBuckets();m.evictAllBucketData(M.initialBucket);l.closePanel()});l.bucketConfirmationDetails.headerTitle=t.instant("confirmationmodal.deletebucket.title");var N=l.selectedBucket.Name;var L=t.instant("confirmationmodal.deletebucketwarning");l.bucketConfirmationDetails.warningMessage=L+' "'+N+'" ?';l.bucketConfirmationDetails.operation=M;l.bucketConfirmationDetails.isDelete=true;l.isConfirmationModalOpen.flag=true};l.emptyBucket=function(){var L=r.createBulkOperation(J.OPERATION_NAME.EMPTY_BUCKET,[],[{Prefix:""}],1000,{});L.changeInitialBucketForOperation(l.selectedBucket.Name);L.defer.promise.then(function(){m.evictBucketObjects(l.selectedBucket.Name)});l.bucketConfirmationDetails.headerTitle=t.instant("confirmationmodal.emptybucket.title");var N=t.instant("confirmationmodal.emptybucketwarning");var M=l.selectedBucket.Name;l.bucketConfirmationDetails.warningMessage=N+' "'+M+'" ?';l.bucketConfirmationDetails.operation=L;l.isConfirmationModalOpen.flag=true};l.tableFiltering={};l.filters={};l.clearFilter=function(){l.tableFiltering.filterText=""};l.$watch(function(){var L=C("filter")(l.bucketList,l.filters.input);l.numRegions=_.without(_.uniq(_.pluck(L,"Location")),undefined).length;l.numPublic=_.filter(L,{isPublic:true}).length;return l.filters.input},function(M,L){if(L!==M){l.selectedItem=null;l.totalItems=l.bucketList?C("filter")(l.bucketList,l.filters.input).length:0}});l.setSortOrder=function(L){l.sortColumnName=L;l.reverseSortOrder=!l.reverseSortOrder};l.isFeatureEnabled=function(L){return K.isFeatureEnabled(L)};l.showEmptyBucketScreen=function(){if(K.isFeatureEnabled(J.FAC.ACCESS)){return _.get(l.bucketList,"length")===0&&_.get(l.filters,"accessFilters.length")===0}return _.get(l.bucketList,"length")===0};l.isAccessFilterDisabled=function(){return !l.filters.accessFilters||_.get(l.filters,"accessFilters.length")===0};if(y.search().bucket){var w=y.search().bucket;var z=y.search().prefix;if(z&&z!==""&&z.slice(-1)!=="/"){z=z+"/"}delete y.search().bucket;delete y.search().prefix;y.path("/"+J.PATH_SEGMENTS.BUCKETS+"/"+w+"/"+(z||""));y.replace()}if(B.initialBucket===""&&y.path().indexOf(J.PATH_SEGMENTS.BUCKETS+"/")===-1){y.path(""+J.DELIMITER+J.PATH_SEGMENTS.HOME)}m.resetLocationAndMarkers()}})();"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}angular.module("s3").controller("ObjectController",["$filter","$location","$rootScope","$q","$routeParams","$scope","$timeout","$translate","$window","AnalyzeAccessUtilService","APIProxyService","AWSC","AwsUrlsService","BucketPropertiesService","BulkOperationService","CachingService","ConsoleOperation","CopyService","CountService","DownloadService","DirectoryExplorerService","FAC","FACService","KeySelectionService","ListDeletedObjectsService","ObjectListingService","ObjectPropertiesService","OperationDispatcherService","PathService","S3CWSAPIService","S3Constants","SCLogService","UploadOperationService","UtilService","VersioningUtilService","XMLParser",ObjectController]);function ObjectController(aJ,aF,D,aj,d,K,ae,p,T,aw,ac,l,c,Q,aH,aI,i,aD,f,aB,G,aL,Y,ao,az,x,aa,u,X,z,b,B,am,m,aM,A){var j,aA,aq;var o={label:p.instant("details.tab.management"),id:"management"};K.currLocation={objects:{relativePaths:[],error:null},folders:{relativePaths:[]}};K.tabs=[{label:p.instant("details.tab.overview"),id:"overview"},{label:p.instant("details.tab.properties"),id:"properties"},{label:p.instant("details.tab.permissions"),id:"permissions"}];K.dateFormat=b.DATE_FORMAT;K.createFolder={displayed:false};K.displayCRRV1=m.CRRFACHandle().v1;var aO=(j={},_defineProperty(j,b.OPERATION_NAME.CHANGE_STORAGE_CLASS,{headTitle:p.instant("confirmationmodal.storageclass.title")}),_defineProperty(j,b.OPERATION_NAME.CHANGE_SSE,{headTitle:p.instant("confirmationmodal.sse.title")}),_defineProperty(j,b.OPERATION_NAME.CHANGE_METADATA,{headTitle:p.instant("confirmationmodal.metadata.title")}),_defineProperty(j,b.OPERATION_NAME.INITIATE_RESTORE,{headTitle:p.instant("confirmationmodal.initiaterestore.title")}),_defineProperty(j,b.OPERATION_NAME.ADD_OBJECT_TAG,{headTitle:p.instant("confirmationmodal.addtags.title")}),j);var ar=(aA={},_defineProperty(aA,b.OPERATION_NAME.CHANGE_STORAGE_CLASS,{values:[[b.STORAGE_CLASSES.STANDARD,p.instant("storageclasses.standard"),"sidepanel.storageclass.standarddescription",c.getDocUrl(b.LEARN_MORE_LINKS.STORAGE_CLASS)],[b.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,p.instant("storageclasses.standardia"),"sidepanel.storageclass.standardiadescription",c.getDocUrl(b.LEARN_MORE_LINKS.STORAGE_CLASS)],[b.STORAGE_CLASSES.REDUCED_REDUNDANCY,p.instant("storageclasses.rrs"),"sidepanel.storageclass.rrsdescription",c.getDocUrl(b.LEARN_MORE_LINKS.STORAGE_CLASS)]],setting:undefined}),_defineProperty(aA,b.OPERATION_NAME.CHANGE_SSE,{values:[[b.OBJECT_SSE.NONE,p.instant("sse.none"),""],[b.OBJECT_SSE.AES256,p.instant("sse.aes256"),"sidepanel.sse.aes256description",c.getDocUrl(b.LEARN_MORE_LINKS.AES256_ENCRYPTION)]],setting:undefined}),_defineProperty(aA,b.OPERATION_NAME.CHANGE_METADATA,{values:[{metadataKey:null,metadataValue:null}],setting:undefined}),_defineProperty(aA,b.OPERATION_NAME.INITIATE_RESTORE,{inputErrorMsg:"",setting:undefined}),_defineProperty(aA,b.OPERATION_NAME.ADD_OBJECT_TAG,{values:[{Key:"",Value:""}],setting:{maxKeys:b.TAGGING.MAX_ALLOWED_TAGS}}),aA);var w=aF.search().prefixSearch;K.customARN=b.OBJECT_SSE.CUSTOM_ARN;K.awsKMS=b.OBJECT_SSE.KMS_ENCRYPTION;var ad=b.OBJECT_SSE.NONE,R;if(aL.isFeatureEnabled(b.FAC.KMS)){var aE=[b.OBJECT_SSE.KMS_ENCRYPTION,p.instant("sse.aws.kms"),""];ar[b.OPERATION_NAME.CHANGE_SSE].values.push(aE)}if(!aL.isFeatureEnabled(b.FAC.NO_ENC)){var E=ar[b.OPERATION_NAME.CHANGE_SSE].values;E=_.reject(E,function(aP){return aP[0]===b.OBJECT_SSE.NONE});ar[b.OPERATION_NAME.CHANGE_SSE].values=E;ar[b.OPERATION_NAME.CHANGE_SSE].setting=b.OBJECT_SSE.AES256}K.maxKeys=b.LIST_OBJECTS_MAX_KEYS_PER_LISTING;K.toggleVersioning=false;K.toggleLogging=false;K.toggleWebsite=false;K.toggleEvents=false;K.toggleAccelerate=false;K.toggleCRR=false;K.toggleTagging=false;K.toggleRequesterPays=false;K.toggleEventSelectors=false;K.toggleDefaultEncryption=false;K.disabledButton=true;K.versioning={selectedValue:b.BUCKET_PROPERTIES.DISABLE};K.website={selectedValue:b.BUCKET_PROPERTIES.DISABLE,websiteEnabledOption:"",websiteEnabledContent:""};K.logging={selectedValue:b.BUCKET_PROPERTIES.DISABLE};K.eventSelectors={trailNames:[],access:{read:false,write:false},targetTrail:"",trailRegionMapping:{}};K.bucketTags={tagSet:{tags:[]}};K.selectedTab=aF.search().tab||"overview";K.confirmationSelectedFiles={folders:[],objects:[],currFolderPathPrefix:""};K.isUploadModalDisplayed={flag:false};K.isInitiateRestoreDisplayed={flag:false};K.flags={uploadDisabled:false};K.isRefreshing=false;K.isConfirmationModalOpen={flag:false,sidePanelOpen:false,dialogOpen:{flag:false},isRestorePanel:false};K.objectPropertiesPanel={show:false};K.showDeleted=false;K.copyFinished={flag:false};K.showVersions=false;K.predefinedMetadata=aa.getPredefinedMetadata();K.startWithMarker="";K.startWithVersionKeyMarker="";K.startWithVersionIdMarker="";K.filters={input:"",prefixFilters:[],tagFilters:[]};l.Clog.setPageId(b.CLOG_OBJECTS_PAGE_ID);K.tagQueryDeferred=aj.defer();K.allKeys={selected:false};K.getIconClass=function(aP){return aP.selected?"awsui-icon-light "+m.getIconClassFromFilename(aP.Key):m.getIconClassFromFilename(aP.Key)};K.hoverObjectPropertiesPanel=function(aP){m.bodyFreezeScroll(aP,true)};K.moveToObjectTab=function(aQ){K.hoverObjectPropertiesPanel(false);var aR=K.getSelectedObjects()[0];var aP=aR.Path?aR.Path+aR.Key:aR.Key;if(aR.ETag){if(!_.isEmpty(aR.ETag)){aI.setCurrentObject(aR)}aF.path("/"+b.PATH_SEGMENTS.OBJECT_DETAILS+"/"+X.getCurrentBucket()+"/"+encodeURIComponent(X.relativeToAbsoluteObjectPath(aP)).replace(/%2F/g,"/")).search("tab",aQ)}};K.hoverDownloadPanel=function(aP){m.bodyFreezeScroll(aP,true)};K.hoverConfirmationPanel=function(aP){m.bodyFreezeScroll(aP,true)};K.$watch("isConfirmationModalOpen",function(aP){m.bodyFreezeScroll(!!aP.dialogOpen.flag)},true);K.$watch("isInitiateRestoreDisplayed",function(aP){m.bodyFreezeScroll(!!aP.flag)},true);K.$watch("isUploadModalDisplayed",function(aP){m.bodyFreezeScroll(!!aP.flag)},true);K.more_dropdown=[{items:[{id:"open",text:p.instant("objectMoreDropDown.open"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.OPEN)}},{id:"getinfo",text:p.instant("objectMoreDropDown.getinfo"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.GET_INFO)}},{id:"download",text:p.instant("objectMoreDropDown.download"),disabled:false,action:function an(){K.openDownloadAsPanel()},facID:"s3-download"}]},{items:[{id:"rename",text:p.instant("objectMoreDropDown.rename"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.RENAME)},opName:b.OPERATION_NAME.RENAME,facID:"s3-rename"},{id:"delete",text:p.instant("objectMoreDropDown.delete"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.DELETE_OBJECTS)},opName:b.OPERATION_NAME.DELETE_OBJECTS,facID:"s3-delete"},{id:"undodelete",text:p.instant("objectMoreDropDown.undodelete"),disabled:true,action:function an(){K.takeActions(b.OPERATION_NAME.RESTORE_OBJECTS)},opName:b.OPERATION_NAME.RESTORE_OBJECTS,facID:"s3-delete"}]},{items:[{id:"cut",text:p.instant("objectMoreDropDown.cut"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.CUT)},opName:b.OPERATION_NAME.CUT,facID:"s3-copy"},{id:"copy",text:p.instant("objectMoreDropDown.copy"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.COPY)},opName:b.OPERATION_NAME.COPY,facID:"s3-copy"},{id:"paste",text:p.instant("objectMoreDropDown.paste"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.PASTE)},opName:b.OPERATION_NAME.PASTE,facID:"s3-copy"}]},{items:[{id:"changestorageclass",text:p.instant("objectMoreDropDown.changestorageclass"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.CHANGE_STORAGE_CLASS)},opName:b.OPERATION_NAME.CHANGE_STORAGE_CLASS,facID:"s3-change-storage-class"},{id:"initialrestore",text:p.instant("objectMoreDropDown.initialrestore"),disabled:true,action:function an(){K.takeActions(b.OPERATION_NAME.INITIATE_RESTORE)},opName:b.OPERATION_NAME.INITIATE_RESTORE,facID:"s3-initiate-restore"},{id:"changeencryption",text:p.instant("objectMoreDropDown.changeencryption"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.CHANGE_SSE)},opName:b.OPERATION_NAME.CHANGE_SSE,facID:"s3-change-encryption"},{id:"changemetadata",text:p.instant("objectMoreDropDown.changemetadata"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.CHANGE_METADATA)},opName:b.OPERATION_NAME.CHANGE_METADATA},{id:"makeobjectpublic",text:p.instant("objectdetails.button.makepublic"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.MAKE_PUBLIC)},opName:b.OPERATION_NAME.MAKE_PUBLIC,facID:"s3-make-public"},{id:"addobjecttags",text:p.instant("objectMoreDropDown.addtags"),disabled:false,action:function an(){K.takeActions(b.OPERATION_NAME.ADD_OBJECT_TAG)},opName:b.OPERATION_NAME.ADD_OBJECT_TAG,facID:b.FAC.OBJECT_TAGGING}]}];_.each(K.more_dropdown,function(aP){aP.items=_.filter(aP.items,function(aR){var aQ=aR.facID;return !aQ||aL.isFeatureEnabled(aQ)})});K.batchOps={error:null,numKeysOperatedOn:null,size:20};K.timing={fetchAllObjects:{start:null,end:null,duration:null}};K.validateInitialRestoreValue=function(aP){if(isNaN(aP.setting)||parseInt(aP.setting)<1){aP.inputErrorMsg="initialrestorevalue.invalidwarning"}else{aP.inputErrorMsg=""}};K.startKeyNum=0;K.fetchPageInProgress=false;K.markers=[];K.versionsKeyMarkers=[];K.versionsIdMarkers=[];K.tagContinuationTokens=[];K.sortColumnName="";K.reverseSortOrder=false;g();K.downloadAsPanel=false;K.operations={};K.objectSelectedForSidePanel={};var W=["Key","VersionId","Size","ExpirationDate","ExpirationRule","ETag","LastModified","Link"];var af=["Key","Size","ExpirationDate","ExpirationRule","ETag","LastModified","Link"];var J=Object.keys(b.PROPERTIES_TITLE_OPNAME_MAPPING);var aC="getObjectMetadata";var H="getObjectAcl";var ay=b.VERSIONS.LIST_VERSIONS_COMPLETED;var e={isTruncated:true,currentPage:0,lastCachedPage:0};var q="Tags";K.createFolder={show:false};K.selected={selectedItems:{currFolderPathPrefix:"",folders:[],objects:[]}};var al={flag:true,folders:0,objects:0,size:0,currLevelObjs:0,countResultEachFolder:{}};K.countInfo=_.cloneDeep(al);K.bucketName=d[b.PATH_SEGMENTS.BUCKET_NAME];K.setSortOrder=function(aP){K.sortColumnName=aP;K.reverseSortOrder=!K.reverseSortOrder};K.showCreateFolder=function(){K.operation=new i("CreateFolder");K.createFolder.displayed=true;K.showEmptyScreen=false;K.noResultsMessage=false};K.navigateIntoFolder=function(aT){var aV=arguments.length<=1||arguments[1]===undefined?false:arguments[1];var aS=""+aF.path()+encodeURIComponent(aT)+b.DELIMITER;var aR=encodeURIComponent(aS).replace(/%2F/g,"/");if(aV){var aU=aF.absUrl().replace(encodeURIComponent(aF.path()).replace(/%2F/g,"/"),aR);T.open(aU,"_blank")}else{var aQ=X.getFolderNamesList();var aP=aQ.length;if(K.showVersions){aI.addVersionMarkersList(aP,aT)}else{aI.addMarkersList(aP,aT)}aF.path(aS).search(b.CURRENT_VERSIONS_KEY_MARKER,null).search(b.CURRENT_VERSIONS_ID_MARKER,null).search(b.PREFIX_SEARCH_PARAM,null).search(b.CURRENT_MARKER,null)}};K.closeObjectPropertiesPanel=function(){var aP=arguments.length<=0||arguments[0]===undefined?true:arguments[0];K.objectPropertiesPanel.show=false;K.switchedFromSidePanel=false;if(aP){K.hoverObjectPropertiesPanel(false)}};K.closeDownloadAsPanel=function(){K.downloadAsPanel=false;K.hoverDownloadPanel(false)};K.openDownloadAsPanel=function(){K.objectPropertiesPanel.show=false;K.downloadAsPanel=true;K.downloadAsPanelGenerating=true;K.downloadPanelError=false;K.downloadPanel={};aB.generatePresignedUrlForCurrentObject(K.getSelectedObjects()[0]).then(function aP(aR){K.downloadAsPanelGenerating=false;K.downloadPanel.url=aR.data.presignedUrl},function aQ(aR){K.downloadAsPanelGenerating=false;K.downloadPanelError=true})};K.downloadSelectedObject=function(){var aP=arguments.length<=0||arguments[0]===undefined?false:arguments[0];if(!aP){aB.downloadCurrentSelection(K.versionsDropdownSelectedObject.obj,false)["catch"](function(aQ){if(aQ.error&&aQ.error.status){K.batchOpsError=aQ.error.status}})}};K.showAllObjects=function(){if(K.fetchPageInProgress){return}else{K.fetchPageInProgress=true}var aP=aF.path();aF.path(aP).search(b.SHOW_DELETED_PARAM,"false");aF.path(aP)};K.showDeletedObjects=function(){if(K.fetchPageInProgress){return}else{K.fetchPageInProgress=true}aI.resetDeletedObjects();var aP=aF.path();aF.path(aP).search(b.SHOW_DELETED_PARAM,"true");aF.path(aP)};K.showObjectVersions=function(){if(K.fetchPageInProgress||K.showVersions){return}else{K.fetchPageInProgress=true}var aP=aF.path();aF.path(aP).search(b.SHOW_VERSION_PARAM,"true").search(b.CURRENT_MARKER,null);aF.path(aP);B.log(b.OBJECT_VERSION_OPERATION.SHOW_VERSIONS,1,new i("ShowObjectVersions"))};K.hideObjectVersions=function(){if(K.fetchPageInProgress||!K.showVersions){return}else{K.fetchPageInProgress=true}var aP=aF.path();aF.path(aP).search(b.SHOW_VERSION_PARAM,"false").search(b.CURRENT_VERSIONS_ID_MARKER,null).search(b.CURRENT_VERSIONS_KEY_MARKER,null);aF.path(aP);B.log(b.OBJECT_VERSION_OPERATION.HIDE_VERSIONS,1,new i("HideObjectVersions"))};function S(){return K.isSingleObjectOnlySelected()}function ai(aP){for(var aQ in K.currLocation.objects.relativePaths){var aR=K.currLocation.objects.relativePaths[aQ];if(aR.Key===aP.Key&&aR.selected){K.currLocation.objects.relativePaths[aQ]=aP;return}}}K.getSelectedFolders=function(){return _.filter(K.currLocation.folders.relativePaths,function(aP){return aP.selected===true})};K.getSelectedObjects=function(){if(K.showVersions){var aP=function(){var aQ=[];if(K.currLocation.objects.relativePaths){K.currLocation.objects.relativePaths.forEach(function(aR){if(aR.isVersionRow&&aR.selected===true){aQ.push(aR)}})}return{v:aQ}}();if((typeof aP==="undefined"?"undefined":_typeof(aP))==="object"){return aP.v}}else{return _.filter(K.currLocation.objects.relativePaths,function(aQ){return aQ.selected===true})}};K.getSelectedKeys=function(){return K.getSelectedFolders().concat(K.getSelectedObjects())};K.isSingleObjectOnlySelected=function(){return K.getSelectedObjects().length===1&&K.getSelectedFolders().length===0};K.showVersionsDropdown={show:false};K.objectsPage={show:true};K.bucketForVersionsDropdown={name:K.bucketName};K.listVersions=function(aP){aP.stopPropagation();if(K.showVersionsDropdown.show){K.showVersionsDropdown.show=false}else{K.showVersionsDropdown.show=true;m.analyticsTrackClick(b.ANALYTICS.LATEST_VERSION,b.ANALYTICS.DETAILS)}};function s(){K.objectPropertiesConfig={};if(S()){var aP=function(){var aR=K.getSelectedObjects()[0];K.objectSelectedForSidePanel={};K.objectSelectedForSidePanel.obj=angular.copy(aR);K.objectSelectedForSidePanel.obj.disableDownload=false;K.objectSelectedForSidePanel.error="";K.versionDropdownKey={};K.versionDropdownKey.name=X.getCurrentAbsoluteFolderPath()?X.getCurrentAbsoluteFolderPath()+aR.Key:aR.Key;K.objectSelectedForSidePanel.obj.versionLabel=p.instant("versionsdropdown.label.latestVersion");K.versionsDropdownSelectedObject={obj:_.cloneDeep(aR)};K.versionsDropdownSelectedObject.obj.Key=X.relativeToAbsoluteObjectPath(K.versionsDropdownSelectedObject.obj.Key);if(!K.showVersions){(function(){var aT=new i(b.OPERATION_NAME.LIST_VERSIONS);aa.listVersions(K.bucketName,K.versionDropdownKey.name,aT).then(function(aU){K.objectSelectedForSidePanel.versions=aU;K.objectSelectedForSidePanel.versionId=aU&&aU[0]&&aU[0].VersionId;B.log(ay,1,aT,{objectKey:K.versionDropdownKey.name,versions:aU})})["catch"](function(aU){K.objectSelectedForSidePanel.error=m.handleErrors(aU);B.log(ay,0,aT,aU)})})()}if(_.isEmpty(aR.ETag)&&!K.showDeleted&&!K.showVersions){var aQ=new i(b.OPERATION_NAME.GET_OBJECT_DETAILS),aS={bucket:K.bucketName,prefix:aR.Path+aR.Key,maxKeys:1,cacheAllowed:true};ac.listObjects(aQ,aS).then(function(aT){var aU=aT.response.ListBucketResult.Contents[0];aU.ETag=aU.ETag.replace(/[\\"]+/g,"");aU.Path=aR.Path;aU.VersionId=aR.VersionId;aU.selected=true;if(aU.Key.lastIndexOf(b.DELIMITER)!==-1){aU.Key=aU.Key.substring(aU.Key.lastIndexOf(b.DELIMITER)+1)}ai(aU);s()});return{v:undefined}}K.setUpObjectMetadataForPropertiesPanel(aR);K.updateObjAcl(aR);K.updateObjMetadata(aR).then(function(){if(K.isSingleObjectOnlySelected()){K.showVersionsDropdown.show=false;K.objectPropertiesPanel.show=true;K.isConfirmationModalOpen.sidePanelOpen=false}})}();if((typeof aP==="undefined"?"undefined":_typeof(aP))==="object"){return aP.v}}else{K.objectPropertiesPanel.show=false}}function a(){if(K.isSingleObjectOnlySelected()){if(K.downloadAsPanel){K.openDownloadAsPanel()}}else{K.downloadAsPanel=false}}function U(){s();a()}function C(aP){for(var aQ=0;aQ<aP.length;aQ++){aP[aQ].selected=K.allKeys.selected}U()}K.selectAllKeys=function(){if(K.currLocation.folders.relativePaths!==undefined){C(K.currLocation.folders.relativePaths)}if(K.currLocation.objects.relativePaths!==undefined){C(K.currLocation.objects.relativePaths)}};K.selectOneMoreKey=function(aQ){var aR=arguments.length<=1||arguments[1]===undefined?true:arguments[1];var aP=arguments.length<=2||arguments[2]===undefined?true:arguments[2];if(aP){aQ.selected=_.has(aQ,"selected")&&aQ.selected?false:true;if(!aQ.selected){K.allKeys.selected=false}}else{aQ.selected=true}if(aR){K.shiftSelectAxis=aQ}U();n()};K.selectCurrentKeyOnly=function(aP){K.resetSelection();aP.selected=true;K.shiftSelectAxis=aP;U()};K.resetSelection=function(){K.allKeys.selected=false;ao.setSelectedFlagAsFalse(K.currLocation.folders.relativePaths,K.currLocation.objects.relativePaths);U()};K.shiftSelectAxis=null;K.shiftSelect=function(aT){K.resetSelection();var aP=aJ("orderBy")(K.currLocation.folders.relativePaths,K.sortColumnName,K.reverseSortOrder);var aX=aJ("orderBy")(K.currLocation.objects.relativePaths,K.sortColumnName,K.reverseSortOrder);if(!K.shiftSelectAxis){if(K.currLocation.folders.relativePaths&&K.currLocation.folders.relativePaths.length>0){K.shiftSelectAxis=aP[0]}else{if(K.currLocation.objects.relativePaths&&K.currLocation.objects.relativePaths.length>0){K.shiftSelectAxis=aX[0]}}}if(aT===K.shiftSelectAxis){K.selectOneMoreKey(aT);return}var aW=false;var aU=false;if(K.currLocation.folders.relativePaths){for(var aR=0;aR<K.currLocation.folders.relativePaths.length;aR++){if(aW&&aU){break}var aS=aP[aR];if(aW&&!aU){K.selectOneMoreKey(aS,false,false)}if(aS===K.shiftSelectAxis||aS===aT){if(!aW){K.selectOneMoreKey(aS,false,false);aW=true}else{aU=true}}}}if(K.currLocation.objects.relativePaths){for(var aQ=0;aQ<K.currLocation.objects.relativePaths.length;aQ++){if(aW&&aU){break}var aV=aX[aQ];if(aW&&!aU){K.selectOneMoreKey(aV,false,false)}if(aV===K.shiftSelectAxis||aV===aT){if(!aW){K.selectOneMoreKey(aV,false,false);aW=true}else{aU=true}}}}};K.clickObjectRow=function(aQ,aP){if(K.showVersions&&!aP.isVersionRow){return}else{if(aQ.ctrlKey||aQ.metaKey){K.selectOneMoreKey(aP,true,true)}else{if(aQ.shiftKey){K.shiftSelect(aP)}else{K.selectCurrentKeyOnly(aP)}}}};K.clickCheckBox=function(aQ,aP){if(aQ){aQ.stopPropagation();if(aQ.shiftKey){aQ.preventDefault();K.shiftSelect(aP)}}};var O=(aq={},_defineProperty(aq,b.OPERATION_NAME.DELETE_OBJECTS,{numberOfKeysPerBulkOperation:b.BULK_OPERATION_KEYS_PER_REQUEST.S3_API}),_defineProperty(aq,b.OPERATION_NAME.RESTORE_OBJECTS,{numberOfKeysPerBulkOperation:b.BULK_OPERATION_KEYS_PER_REQUEST.S3_API}),_defineProperty(aq,b.OPERATION_NAME.MAKE_PUBLIC,{numberOfKeysPerBulkOperation:b.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),_defineProperty(aq,b.OPERATION_NAME.CUT,{isCut:true,numberOfKeysPerBulkOperation:b.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),_defineProperty(aq,b.OPERATION_NAME.COPY,{isCut:false,numberOfKeysPerBulkOperation:b.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),_defineProperty(aq,b.OPERATION_NAME.RENAME,{isRename:true,numberOfKeysPerBulkOperation:b.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),aq);function V(){var aQ=0;var aP=K.getSelectedKeys();if(aP.length===1){if(aP[0].Key){K.currLocation.objects.relativePaths.forEach(function(aR){if(aR.Key===aP[0].Key){aR.beingRenamed=true}else{aQ++}})}}}K.addTag=function(aP){if($(aP.target).parents(".awsui-button-disabled").length===0){var aQ={Key:"",Value:""};if(K.panelSettingValues.values){K.panelSettingValues.values.push(aQ)}else{K.panelSettingValues.values=[aQ]}}};K.isAnyKeyEmpty=function(){return !_.isEmpty(K.panelSettingValues.values)&&_.some(K.panelSettingValues.values,function(aP){return _.isEmpty(aP.Key)})};K.removeTag=function(aP){K.panelSettingValues.values.splice(aP,1)};function I(aP){m.analyticsTrackClick(b.ANALYTICS.CONFIRMATION_MODAL,aP)}K.takeActionFromSidePanel=function(aP,aR,aQ){if(K.objectSelectedForSidePanel.obj.ETag){if(aP===b.TABS.OBJECT_LIST.PROPERTIES&&K.objectPropertiesConfig.properties.StorageClass.toUpperCase()!==b.STORAGE_CLASSES.GLACIER){if(!K.showVersions&&K.objectSelectedForSidePanel.obj.versionLabel===p.instant("versionsdropdown.label.latestVersion")||K.showVersions&&K.objectSelectedForSidePanel.obj.IsLatest==="true"||aR&&aR===q){aQ.stopPropagation();K.switchedFromSidePanel=true;K.takeActions(b.PROPERTIES_TITLE_OPNAME_MAPPING[aR])}}}};K.takeActions=function(aR){K.opName=aR;K.isConfirmationModalOpen.flag=false;K.isConfirmationModalOpen.dialogOpen.flag=false;K.tagError=false;K.isConfirmationModalOpen.sidePanelOpen=false;K.isConfirmationModalOpen.isRestorePanel=false;K.countInfo=_.cloneDeep(al);K.panelSettingValues=null;K.operation=null;K.modalInfo={headTitle:"",buttonName:"",warningInfo:{flag:false,text:""}};I(aR);var aT=undefined;switch(aR){case b.OPERATION_NAME.PASTE:K.isConfirmationModalOpen.flag=true;K.isConfirmationModalOpen.dialogOpen.flag=true;ag(aR);break;case b.OPERATION_NAME.COPY:case b.OPERATION_NAME.CUT:ag(aR);aD.setClipboardOperation(K.operation);break;case b.OPERATION_NAME.INITIATE_RESTORE:ag(aR,true);if(aL.isFeatureEnabled("s3-gl-tier-"+K.bucketRegion.value)){K.isInitiateRestoreDisplayed.flag=true}else{K.isConfirmationModalOpen.isRestorePanel=true;K.modalInfo=aO[aR];K.panelSettingValues=_.cloneDeep(ar)[K.operation.name];K.operation.panelSettingValues=K.panelSettingValues;K.isConfirmationModalOpen.sidePanelOpen=true}aT={currFolderPathPrefix:K.operation.initialPath,folders:K.operation.selectedFolders,objects:K.operation.selectedKeys};K.countInfo.countFinish=true;K.isCounting={flag:false};f.countAllFiles(aT,K.countInfo,K.operation,K.isCounting);break;case b.OPERATION_NAME.CHANGE_STORAGE_CLASS:ag(aR,true);K.modalInfo=aO[aR];K.panelSettingValues=_.cloneDeep(ar)[K.operation.name];var aS=_.get(K.objectPropertiesConfig,"properties.StorageClass");if(aS&&K.isSingleObjectOnlySelected()){K.panelSettingValues.setting=b.STORAGE_CLASSES[aS]}K.operation.panelSettingValues=K.panelSettingValues;K.isConfirmationModalOpen.sidePanelOpen=true;aT={currFolderPathPrefix:K.operation.initialPath,folders:K.operation.selectedFolders,objects:K.operation.selectedKeys};K.countInfo.countFinish=true;K.isCounting={flag:false};f.countAllFiles(aT,K.countInfo,K.operation,K.isCounting);break;case b.OPERATION_NAME.CHANGE_SSE:ag(aR,true);K.modalInfo=aO[aR];K.panelSettingValues=_.cloneDeep(ar)[K.operation.name];if(ad&&K.isSingleObjectOnlySelected()){if(ad===b.OBJECT_SSE.KMS_ENCRYPTION){K.panelSettingValues.setting=ad;ah().then(function(){K.panelSettingValues.kmsOption={kmsId:m.getKMSAliasForArn(R,K.kmsKeys)}})}else{K.panelSettingValues.setting=b.OBJECT_SSE[ad]}}K.operation.panelSettingValues=K.panelSettingValues;K.isConfirmationModalOpen.sidePanelOpen=true;aT={currFolderPathPrefix:K.operation.initialPath,folders:K.operation.selectedFolders,objects:K.operation.selectedKeys};K.countInfo.countFinish=true;K.isCounting={flag:false};f.countAllFiles(aT,K.countInfo,K.operation,K.isCounting);break;case b.OPERATION_NAME.ADD_OBJECT_TAG:ag(aR,true);K.modalInfo=aO[aR];K.panelSettingValues=_.cloneDeep(ar)[K.operation.name];K.operation.panelSettingValues=K.panelSettingValues;aT={currFolderPathPrefix:K.operation.initialPath,folders:K.operation.selectedFolders,objects:K.operation.selectedKeys};if(K.switchedFromSidePanel){M().then(function(aU){K.panelSettingValues.values=aU;K.panelSettingValues.disableFetchTag=true})["finally"](function(){K.isConfirmationModalOpen.sidePanelOpen=true})}else{K.isConfirmationModalOpen.sidePanelOpen=true}K.countInfo.countFinish=true;K.isCounting={flag:false};f.countAllFiles(aT,K.countInfo,K.operation,K.isCounting);break;case b.OPERATION_NAME.CHANGE_METADATA:ag(aR,true);K.modalInfo=aO[aR];K.panelSettingValues=_.cloneDeep(ar)[K.operation.name];K.operation.panelSettingValues=K.panelSettingValues;if(!K.isSingleObjectOnlySelected()){K.objectMetadata={}}else{if(!_.isEmpty(K.objectMetadata)){K.panelSettingValues.values.length=0;_.forEach(K.objectMetadata,function(aU,aV){if(aV===b.USER_DEFINED_METADATA[4]){K.panelSettingValues.values.push({metadataKey:{value:b.USER_DEFINED_METADATA[4],text:p.instant("objectdetail.metadata.content-type"),dropDownValue:b.CONTENT_TYPE_VALUES},metadataValue:{text:aU}})}else{if(aV===b.USER_DEFINED_METADATA[1]){K.panelSettingValues.values.push({metadataKey:{value:b.USER_DEFINED_METADATA[1],text:p.instant("objectdetail.metadata.content-disposition"),dropDownValue:b.CONTENT_DISPOSITION},metadataValue:{text:aU}})}else{if(aV===b.USER_DEFINED_METADATA[6]){K.panelSettingValues.values.push({metadataKey:_.find(K.predefinedMetadata,{value:aV}),metadataValue:{text:aU,value:aU}})}else{K.panelSettingValues.values.push({metadataKey:{text:aV,value:aV},metadataValue:{text:aU,value:aU}})}}}})}}K.isConfirmationModalOpen.sidePanelOpen=true;aT={currFolderPathPrefix:K.operation.initialPath,folders:K.operation.selectedFolders,objects:K.operation.selectedKeys};K.countInfo.countFinish=true;K.isCounting={flag:false};f.countAllFiles(aT,K.countInfo,K.operation,K.isCounting);break;case b.OPERATION_NAME.RENAME:ag(aR);aD.setClipboardOperation(K.operation);V();break;case b.OPERATION_NAME.GET_INFO:K.isConfirmationModalOpen.flag=true;K.isConfirmationModalOpen.dialogOpen.flag=true;ag(aR);break;case b.OPERATION_NAME.OPEN:var aP=K.getSelectedFolders();if(aP.length>0){_.forEach(aP,function(aU){K.navigateIntoFolder(aU.Prefix,true)})}var aQ=K.getSelectedObjects();if(aQ.length>0){_.forEach(aQ,function(aU){K.openObjectInBrowser(aU)})}break;default:K.isConfirmationModalOpen.flag=true;K.isConfirmationModalOpen.dialogOpen.flag=true;ag(aR)}K.closeObjectPropertiesPanel(false)};K.saveConfirmationPanel=function(aP){aP.stopPropagation();if(v()){K.isConfirmationModalOpen.sidePanelOpen=false;K.isConfirmationModalOpen.flag=true;K.isConfirmationModalOpen.isRestorePanel=false;K.isConfirmationModalOpen.dialogOpen.flag=true}};K.cancelConfirmationPanel=function(aP){aP.stopPropagation();if(!_.isEmpty(K.operation)){u.cancelOperation(K.operation)}K.isConfirmationModalOpen.countFinish=false;K.isConfirmationModalOpen.sidePanelOpen=false;K.isConfirmationModalOpen.isRestorePanel=false;K.panelSettingValues=null;K.sidepanelMetadataValidationError=null;K.operation=null;if(K.switchedFromSidePanel){U()}};function v(){K.sidepanelMetadataValidationError={text:null};if(K.opName===b.OPERATION_NAME.ADD_OBJECT_TAG){var aR=K.operation.panelSettingValues&&K.operation.panelSettingValues.values;if(aR){var aQ=aR.length;for(var aU=0;aU<aQ;aU++){var aT=aR[aU].Key;var aW=0;var aS=0;for(var aP=0;aP<aQ;aP++){if(aR[aP].Key===aT){aW++;if(aW>1){K.tagError=true;K.tagErrorMessage=p.instant("objectproperties.tags.duplicatekeynames");return false}}if(aR[aP].Key===""){aS++;if(aS>0){K.tagError=true;K.tagErrorMessage=p.instant("objectproperties.tags.emptykeyname");return false}}}}}}if(K.opName===b.OPERATION_NAME.CHANGE_METADATA){var aV=K.operation.panelSettingValues&&K.operation.panelSettingValues.values;if(aV){return aa.isValid(aV,K.sidepanelMetadataValidationError)}}return true}function ag(aQ,aR){if(aQ===b.OPERATION_NAME.PASTE){K.operation=aD.getClipboardOperation()}else{var aP=0;if(aQ===b.OPERATION_NAME.RENAME){aP=1}var aS=aR?null:O[aQ];K.operation=aH.createBulkOperation(aQ,K.getSelectedObjects(),K.getSelectedFolders(),aP,aS)}K.operation.defer.promise.then(function(){P(K.operation)},function(){},function(){P(K.operation)})}function P(aP){if(K.switchedFromSidePanel){U()}if(K.showDeleted){aI.evictBucketObjects(aP.initialBucket);K.showAllObjects()}else{if(aP.name===b.OPERATION_NAME.DELETE_OBJECTS||aP.name===b.OPERATION_NAME.CHANGE_STORAGE_CLASS||aP.name===b.OPERATION_NAME.RESTORE_OBJECTS){aI.evictBucketObjects(aP.initialBucket);K.refreshWithSelection()}else{if(aP.name===b.OPERATION_NAME.COPY||aP.name===b.OPERATION_NAME.CUT){aI.evictBucketObjects(aP.initialBucket);aI.evictBucketObjects(aP.dstBucket);K.refreshWithSelection()}}}}K.refreshAndClearObjectsCacheForCurrentBucket=function(){aI.evictBucketObjects(X.getCurrentBucket());K.refreshWithSelection()};K.refreshWithSelection=function(){K.isRefreshing=true;K.tagContinuationTokens=[];K.filters.prefixFilters=[];K.filters.tagFilters=[];aI.resetLocationAndMarkers();K.fetchObjects(false)};K.batchOpsAlertDismissed=function(){K.batchOps.error=null};K.goToObjectDetails=function(aQ){if(K.showDeleted||K.showVersions&&(!aQ.isVersionRow||!aQ.ETag)){return}var aP=aQ.Path?aQ.Path+aQ.Key:aQ.Key;if(!_.isEmpty(aQ.ETag)){aI.setCurrentObject(aQ)}aF.path("/"+b.PATH_SEGMENTS.OBJECT_DETAILS+"/"+X.getCurrentBucket()+"/"+encodeURIComponent(X.relativeToAbsoluteObjectPath(aP)).replace(/%2F/g,"/"));if(K.showVersions){aF.search(b.VERSION_ID_PARAM,aQ.VersionId)}};K.openObjectInBrowser=function(aP){if(aP.ETag&&(aP.StorageClass.toUpperCase()!==b.STORAGE_CLASSES.GLACIER||aP.withinRestoreExpiry)){if(!K.showVersions||K.showVersions&&aP.isVersionRow){aB.openInBrowser(aP.Key,aP.Size,aP.VersionId)}}};K.setUpObjectMetadataForPropertiesPanel=function(aU){K.objectPropertiesConfig={};K.objectMetadata={};var aX=undefined;if(K.showVersions){aX=W}else{aX=af}var aV={overview:aX,properties:J,permissions:[]};if(!K.isFeatureEnabled(b.FAC.OBJECT_TAGGING)){var aR=aV.properties.indexOf(q);aV.properties.splice(aR,1)}_.map(aV,function(aZ,aY){K.objectPropertiesConfig[aY]={};_.map(aZ,function(a0){K.objectPropertiesConfig[aY][a0]=aU[a0]})});var aW=X.relativeToAbsoluteObjectPath(aU.Key);var aP=aU.VersionId;aW=aU.Path?aU.Path+aW:aW;var aT=new i(b.OPERATION_NAME.GET_METADATA);z.getMetadata(K.bucketName,aW,aP,aT).then(function(aY){if(K.isSingleObjectOnlySelected()){B.log("getObjectMetadataCWS",aT,1);var aZ=_.get(aY,"data.metadata");if(aZ){K.objectMetadata=_.pick(aZ,function(a1,a0){return b.USER_DEFINED_METADATA.indexOf(a0)>-1||a0.indexOf(b.USER_DEFINED_METADATA_PREFIX)===0})}K.objectPropertiesConfig.properties.Metadata=Object.keys(K.objectMetadata).length}})["catch"](function(aY){if(K.isSingleObjectOnlySelected()){B.log("getObjectMetadataCWS",aT,0,{error:aY});K.objectPropertiesConfig.properties.Metadata="-"}});var aQ=K.objectPropertiesConfig.overview;var aS=K.objectPropertiesConfig.properties;aQ.LastModified=aJ("date")(aQ.LastModified,K.dateFormat);if(K.showDeleted){aQ.Size="-"}if(aQ.Size===undefined){aQ.Size="-"}aS.StorageClass=aS.StorageClass?m.getStorageClassTranslations()[aS.StorageClass]:"-";aS.Encryption=m.getEncryptionTranslations()[aS.Encryption];if(K.showDeleted||_.isEmpty(aS.Encryption)){aS.Encryption="-"}aQ.ETag=aQ.ETag?aQ.ETag.replace(/[\\"]+/g,""):"-";aQ.Link="-";aQ.ExpirationDate=aQ.ExpirationDate?aJ("date")(new Date(aQ.ExpirationDate),K.dateFormat):"N/A";aQ.ExpirationRule=aQ.ExpirationRule?aQ.ExpirationRule:"N/A";ac.getBucketLocation(K.operation,K.bucketName,{}).then(function(aY){var aZ=K.showDeleted||aQ.ETag==="-"?"":X.getObjectLink(aW,aY.region,aP);aQ.Link=aQ.Path?aQ.Path+aZ:aZ})};function g(){aK();K.flags.uploadDisabled=false;K.isUploadModalDisplayed.flag=false;K.isInitiateRestoreDisplayed.flag=false}function aK(){K.batchOps.error=null;K.batchOps.numKeysOperatedOn=null}K.updateObjMetadataForTest=function(aP){K.updateObjMetadata(aP)};K.updateObjMetadata=function(aT){var aQ=aj.defer();var aP=new i("getObjectMetadata");var aS=X.relativeToAbsoluteObjectPath(aT.Key);aS=aT.Path?aT.Path+aS:aS;var aR=aT.VersionId;var aU=X.getCurrentBucket();ac.getObjectMetadata(aP,aU,aS,aR).then(function(aW){B.log(aC,1,aP,{bucket:aU,key:aS});if(!K.objectPropertiesConfig){K.objectPropertiesConfig={}}if(!K.objectPropertiesConfig.properties){K.objectPropertiesConfig.properties={}}if(!K.objectPropertiesConfig.overview){K.objectPropertiesConfig.overview={}}if(ao.isCurrentlySelectedObject(aW.config.data.path,K.getSelectedObjects())){ad=b.OBJECT_SSE.NONE;K.objectPropertiesConfig.properties.Encryption=m.getEncryptionTranslations()[ad];K.objectPropertiesConfig.overview.ExpirationDate="N/A";K.objectPropertiesConfig.overview.ExpirationRule="N/A";if(aW.headers()&&K.isSingleObjectOnlySelected()){var a0=_.findIndex(K.currLocation.objects.relativePaths,{Key:aT.Key});var aZ=aW.headers();var aV=aZ[b.HEADERS.X_AMZ_RESTORE];if(aV){var aX=m.extractFromQuotes(aV);if(aX==="true"){if(a0>-1){K.currLocation.objects.relativePaths[a0].withinRestoreExpiry=false}K.objectPropertiesConfig.overview.Restoration=p.instant("objectdetails.value.restoration")}else{if(aX==="false"){K.objectPropertiesConfig.overview.RestorationExpiry=aJ("date")(new Date(m.extractFromQuotes(aV,1)),K.dateFormat);if(a0>-1){K.currLocation.objects.relativePaths[a0].withinRestoreExpiry=!_.isEmpty(K.objectPropertiesConfig.overview.RestorationExpiry)}}}}if(aZ[b.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]){ad=aZ[b.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION];K.objectPropertiesConfig.properties.Encryption=m.getEncryptionTranslations()[ad];if(ad===b.OBJECT_SSE.KMS_ENCRYPTION){R=aZ[b.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]}}if(aZ[b.HEADERS.X_AMZ_EXPIRATION]){var a1=aZ[b.HEADERS.X_AMZ_EXPIRATION];K.objectPropertiesConfig.overview.ExpirationDate=aJ("date")(new Date(m.extractFromQuotes(a1,0)),K.dateFormat);K.objectPropertiesConfig.overview.ExpirationRule=m.extractFromQuotes(a1,1)}if(aZ[b.HEADERS.X_AMZ_REPLICATION_STATUS]){K.objectPropertiesConfig.overview.ReplicationStatus=aZ[b.HEADERS.X_AMZ_REPLICATION_STATUS]}if(K.isFeatureEnabled(b.FAC.OBJECT_TAGGING)){var aY=aZ[b.HEADERS.X_AMZ_TAGGING_COUNT]||0;if(!_.isNaN(parseInt(aY))){K.objectPropertiesConfig.properties.Tags=p.instant("objectproperties.tags.keyvalue",{tagsCount:aY})}}}}aQ.resolve()},function(aW){var aV={};aV.error=m.handleErrors(aW);aV.key=aS;aV.bucket=aU;B.log(aC,0,aP,aV);if(!K.objectPropertiesConfig){K.objectPropertiesConfig={}}if(!K.objectPropertiesConfig.properties){K.objectPropertiesConfig.properties={}}if(!K.objectPropertiesConfig.overview){K.objectPropertiesConfig.overview={}}K.objectPropertiesConfig.properties.Encryption=m.getErrorMessage(aW);K.objectPropertiesConfig.overview.ExpirationDate="";K.objectPropertiesConfig.overview.ExpirationRule="";if(K.isFeatureEnabled(b.FAC.OBJECT_TAGGING)){K.objectPropertiesConfig.properties.Tags=m.getErrorMessage(aW)}aQ.resolve()});return aQ.promise};function ah(){var aP=aj.defer();K.kmsKeys=[];var aR=new i("GetKMSKeysForObjectSSE");var aQ={};ac.getKmsKeys(aR,K.bucketName,aQ).then(function(aT){var aS=aT.response.Keys;B.log("GetKMSKeys",1,aR);angular.forEach(aS,function(aU,aV){K.kmsKeys.push({value:aU.KeyId,text:m.getKmsKeyAlias(aU)})});K.kmsKeys.push({value:b.OBJECT_SSE.CUSTOM_ARN,text:p.instant("objectproperties.kms.customarn")});aP.resolve()})["catch"](function(aS){K.KMSServiceError=m.handleErrors(aS);B.log("GetKMSKeys",0,aR,aS);aP.reject()});return aP.promise}function M(){var aS=aj.defer();var aR=new i(b.OPERATION_NAME.GET_OBJECT_TAGGING);var aP=K.operation.selectedKeys&&K.operation.selectedKeys[0];var aW=aP.Key;var aU=aP.VersionId||null;var aT=K.bucketName;B.log("getObjectTagsReceived",1,aR,{objectName:aW});var aV="getObjectTags";var aQ="getObjectVersionTags";ac.getObjectTag(aR,aT,aW,aU).then(function(a0){var aX=a0.response;if(!aU){B.log(aV,1,aR,{objectName:aW})}else{B.log(aQ,1,aR,{objectName:aW,versionId:aU})}if(aX){var aY=A.convertXmlStringToJson(aX);var aZ=[];if(_.get(aY,"Tagging.TagSet.Tag")){aZ=aZ.concat(aY.Tagging.TagSet.Tag);angular.forEach(aZ,function(a1){if(_.isEmpty(a1.Value)){a1.Value=""}})}aS.resolve(aZ)}})["catch"](function(aX){if(aX){if(aX.status===b.HTTP_STATUS_CODES.NOT_FOUND){if(_.get(aX,"response.Error.Code")===b.TAGGING.ERROR_CODES.NO_SUCH_TAG_SET){if(!aU){B.log(aV,0,aR,{objectName:aW,error:aX})}else{B.log(aQ,0,aR,{objectName:aW,versionId:aU,error:aX})}}}}aS.reject()});return aS.promise}K.updateConfigPanel=function(){if(K.panelSettingValues.setting===b.OBJECT_SSE.KMS_ENCRYPTION){ah()}};K.updateObjAclForTest=function(aP){K.updateObjAcl(aP)};function Z(aP,aR){var aQ=function aQ(aS){return aS.URI?aS.URI.split("/").pop():aS.ID};if(aP&&aP.Grantee){return aP.Grantee.DisplayName||aQ(aP.Grantee)}else{return aR}}K.updateObjAcl=function(aQ){var aP=new i("getObjectAcl");var aS=X.getCurrentBucket();var aR=X.relativeToAbsoluteObjectPath(aQ.Key);ac.getObjectAcl(aP,aS,aR,aQ.VersionId).then(function(aX){if(aX&&aX.response&&aX.response.AccessControlPolicy&&aX.response.AccessControlPolicy.AccessControlList){var aV;var aT=aX.response.AccessControlPolicy;var aW=(aV={},_defineProperty(aV,b.ACL_PERMISSIONS.READ,[]),_defineProperty(aV,b.ACL_PERMISSIONS.WRITE,[]),_defineProperty(aV,b.ACL_PERMISSIONS.READ_ACP,[]),_defineProperty(aV,b.ACL_PERMISSIONS.WRITE_ACP,[]),aV);var aU=aT.AccessControlList.Grant;var aZ=aT.Owner.DisplayName;var aY=function aY(a0){var a2=Z(a0,aZ);if(a0.Permission===b.ACL_PERMISSIONS.FULL_CONTROL){for(var a1 in aW){if(aW[a1].indexOf(a2)===-1){aW[a1].push(a2)}}}else{if(aW[a0.Permission].indexOf(a2)===-1){aW[a0.Permission].push(a2)}}};if(aU){if(Array.isArray(aU)){aU.forEach(function(a0){aY(a0)})}else{aY(aU)}if(ao.isCurrentlySelectedObject(aX.request.path,K.getSelectedObjects())){if(!K.objectPropertiesConfig){K.objectPropertiesConfig={}}if(!K.objectPropertiesConfig.permissions){K.objectPropertiesConfig.permissions={}}K.objectPropertiesConfig.permissions.owner=aZ;K.objectPropertiesConfig.permissions.grantees={};K.objectPropertiesConfig.permissions.grantees.object={};K.objectPropertiesConfig.permissions.grantees.object[b.ACL_PERMISSIONS.READ]=aW[b.ACL_PERMISSIONS.READ].length;K.objectPropertiesConfig.permissions.grantees.object[b.ACL_PERMISSIONS.WRITE]=aW[b.ACL_PERMISSIONS.WRITE].length;K.objectPropertiesConfig.permissions.grantees.objectPermissions={};K.objectPropertiesConfig.permissions.grantees.objectPermissions[b.ACL_PERMISSIONS.READ_ACP]=aW[b.ACL_PERMISSIONS.READ_ACP].length;K.objectPropertiesConfig.permissions.grantees.objectPermissions[b.ACL_PERMISSIONS.WRITE_ACP]=aW[b.ACL_PERMISSIONS.WRITE_ACP].length}}B.log(H,1,aP,{bucket:aS,key:aR})}},function(aU){var aT={};aT.key=aR;aT.bucket=aS;aT.error=m.handleErrors(aU);B.log(H,0,aP,aT);if(!K.objectPropertiesConfig){K.objectPropertiesConfig={}}if(!K.objectPropertiesConfig.permissions){K.objectPropertiesConfig.permissions={}}K.objectPropertiesConfig.permissions=m.handleErrors(aU)})};function ax(aP){if(typeof aP!=="string"){return""}return aP}K.fetchObjects=function(aW){var aT=arguments.length<=1||arguments[1]===undefined?true:arguments[1];var aP=arguments.length<=2||arguments[2]===undefined?"":arguments[2];K.isRefreshing=true;K.filters.tagFilters=[];K.filters.prefixFilters=[];K.filters.input="";K.sortColumnName="";K.isConfirmationModalOpen.sidePanelOpen=false;K.resetSelection();K.timing.fetchAllObjects.start=new Date().getTime();var aV=X.getCurrentAbsoluteFolderPath();if(aV===undefined){aV=""}K.markers=[];K.versionsKeyMarkers=[];K.versionsIdMarkers=[];if(K.showDeleted){r(aV)}else{if(K.showVersions){if(!_.isEmpty(K.startWithVersionKeyMarker)){var aR=K.startWithVersionKeyMarker;var aS=!_.isEmpty(K.startWithVersionIdMarker)?K.startWithVersionIdMarker:"";var aQ=F(aR,aS);if(aQ<0){var aU=aF.path();aF.path(aU).search(b.CURRENT_VERSIONS_KEY_MARKER,null).search(b.CURRENT_VERSIONS_ID_MARKER,null)}else{ap(aV,aR,aS,aT)}}else{ap(aV,aP,"",aT)}}else{if(aW){ak(aV,aP,aT)}else{if(!_.isEmpty(K.startWithMarker)){var aQ=h(K.startWithMarker);if(aQ<0){var aU=aF.path();aF.path(aU).search(b.CURRENT_MARKER,null)}else{N(aV,K.startWithMarker,aT)}}else{N(aV,aP,aT)}}}}};function aN(aQ,a0){K.showEmptyScreen=false;K.noResultsMessage=undefined;var aU=ax(aQ.Prefix);if(w&&aU.indexOf(w)!==-1){aU=aU.substring(0,aU.length-w.length)}var aP=undefined;var aT=0;if(K.showVersions){var aZ=aM.getAllVersionsForDisplay(aQ,aU);aP=aZ.allVersions;aT=aZ.nonVersionRowCount}else{aP=X.absoluteToRelativeObjectPaths(aQ.Contents,aU)}K.currLocation.objects.relativePaths=a0?aP:K.currLocation.objects.relativePaths.concat(aP);if(K.showVersions&&aQ.CommonPrefixes){aQ.CommonPrefixes=m.transformObjectToArray(aQ.CommonPrefixes)}var aS=X.absoluteToRelativeFolderPaths(aQ.CommonPrefixes,aU);K.currLocation.folders.relativePaths=a0?aS:K.currLocation.folders.relativePaths.concat(aS);l.Timer.customerReady();var aX=0;if(aP){aX+=aP.length}if(aS){aX+=aS.length}if(aX===0){if(ax(aQ.Prefix)===""){if(K.showDeleted){K.noResultsMessage=p.instant("objectlisting.nodeletedobjects")}else{K.showEmptyScreen=true}}else{if(w){K.noResultsMessage=p.instant("prefixsearch.noresults")}else{K.noResultsMessage=p.instant("objectlisting.noobjects")}}}if(K.showVersions){if(_.isEmpty(K.filters.prefixFilters)){var aR=!_.isEmpty(K.versionsCurrentIdMarker)?K.versionsCurrentIdMarker:"";var aY=!_.isEmpty(K.versionsCurrentKeyMarker)?K.versionsCurrentKeyMarker:"";var aV=F(aY,aR);K.startKeyNum=aX===0?0:K.maxKeys*(aV+1)+1;K.endKeyNum=K.maxKeys*(aV+1)+aX-aT}else{K.startKeyNum=aX===0?0:K.maxKeys*K.versionsKeyMarkers.length+1;K.endKeyNum=K.maxKeys*K.versionsKeyMarkers.length+aX-aT}}else{if(_.isEmpty(K.filters.prefixFilters)){var aW=!_.isEmpty(K.currentMarker)?K.currentMarker:"";var aV=h(aW);K.startKeyNum=aX===0?0:K.maxKeys*(aV+1)+1;K.endKeyNum=K.maxKeys*(aV+1)+aX}else{K.startKeyNum=aX===0?0:K.maxKeys*K.markers.length+1;K.endKeyNum=K.maxKeys*K.markers.length+aX}}n();K.isRefreshing=false;K.fetchPageInProgress=false}function n(){var aP=K.currLocation.folders.relativePaths?K.currLocation.folders.relativePaths.concat(K.currLocation.objects.relativePaths):K.currLocation.objects.relativePaths;if(aP){K.allKeys.selected=_.every(aP,function(aQ){return _.has(aQ,"selected")&&aQ.selected===true})}else{K.allKeys.selected=false}}function N(aR,aP){var aQ=arguments.length<=2||arguments[2]===undefined?true:arguments[2];K.filters.input="";K.isConfirmationModalOpen.sidePanelOpen=false;K.resetSelection();K.isRefreshing=true;x.listObjects(aR,aP,K.maxKeys,b.DELIMITER,aQ).then(function(aT){var aS=aT.response.ListBucketResult;K.currentMarker=aS.Marker;K.nextMarker=aS.NextMarker;aN(aS,true);aG()})["catch"](function(aS){k(aS)})}function ap(aS,aP,aQ){var aR=arguments.length<=3||arguments[3]===undefined?true:arguments[3];K.isConfirmationModalOpen.sidePanelOpen=false;K.resetSelection();K.isRefreshing=true;x.listObjectVersions(aS,aP,aQ,K.maxKeys,b.DELIMITER,aR).then(function(aU){var aT=aU.response.ListVersionsResult;K.versionsCurrentKeyMarker=aT.KeyMarker;K.versionsCurrentIdMarker=aT.VersionIdMarker;K.versionsNextKeyMarker=aT.NextKeyMarker;K.nextVersionIdMarker=aT.NextVersionIdMarker;aN(aT,true);aG()})["catch"](function(aT){k(aT)})}function L(aR){var aP={Contents:aR.deletedFiles,CommonPrefixes:aR.folders},aQ={Contents:aR.cachedDeletedFiles,CommonPrefixes:aR.cachedFolders};aN(aP,true);K.startKeyNum=e.currentPage*K.maxKeys+1;K.endKeyNum=K.startKeyNum+aP.Contents.length+aP.CommonPrefixes.length-1;aI.setPageOfDeletedObjects(aP,e.currentPage);e.lastCachedPage=e.currentPage;if(aQ.Contents.length+aQ.CommonPrefixes.length>0){aI.setPageOfDeletedObjects(aQ,e.currentPage+1)}e.nextKeyMarker=aR.NextKeyMarker;e.nextVersionIdMarker=aR.NextVersionIdMarker;e.isTruncated=m.convertStringToBoolean(aR.IsTruncated)}function r(aP){K.currLocation.folders.relativePaths=[];K.currLocation.objects.relativePaths=[];K.isRefreshing=true;e.currentPage=0;e.lastCachedPage=0;K.startKeyNum=0;K.endKeyNum=0;aI.resetDeletedObjects();az.listDeletedObjects(new i(b.LIST_DELETED_OBJECTS),aP).then(function(aQ){L(aQ)},function(aQ){k(aQ)})}K.fetchOnePagePrefix=function(aR,aP,aQ){K.markers=[];K.versionsKeyMarkers=[];K.versionsIdMarkers=[];if(K.showVersions){ap(aR,aP,aQ)}else{N(aR,aP)}};K.fetchOnePageTag=function(aP){var aQ=arguments.length<=1||arguments[1]===undefined?true:arguments[1];K.showEmptyScreen=false;K.noResultsMessage=undefined;K.isConfirmationModalOpen.sidePanelOpen=false;K.resetSelection();if(aQ){K.currLocation.folders.relativePaths=[];K.currLocation.objects.relativePaths=K.nextTagObjs||[];K.startKeyNum=K.tagContinuationTokens.length===0?0:K.maxKeys*K.markers.length+1;K.endKeyNum=K.startKeyNum;K.isRefreshing=true}K.tagQueryDeferred=aj.defer();K.tagQueryDeferred.promise.then(function(aR){return av(aR)},function(aR){if(aR.status===b.HTTP_STATUS_CODES.METHOD_NOT_ALLOWED){K.currLocation.objects.error=p.instant("prefixtagsearch.methodnotallowed")}else{K.currLocation.objects.error=p.instant("utilities.unknown.error")}K.isRefreshing=false;K.fetchPageInProgress=false;K.showAllObjects()});x.tagQuery(K.filters.tagFilters,K.maxKeys,aP).then(function(aR){return K.tagQueryDeferred.resolve(aR)},function(aR){return K.tagQueryDeferred.reject(aR)})};function av(aS){var aP=A.convertXmlStringToJson(aS.response).TagQueryResult;var aR=true;if(aP.Contents){var aQ=[].concat(aP.Contents);angular.forEach(aQ,function(aT){return aR=y(aT.Key)})}if(aP.IsTruncated===true&&_.isString(aP.NextContinuationToken)){if(aR){K.fetchOnePageTag(aP.NextContinuationToken,false)}else{K.tagContinuationTokens.push(aP.NextContinuationToken);K.isRefreshing=false;K.showAllObjects()}}else{if(K.currLocation.objects.relativePaths.length===0){K.noResultsMessage=p.instant("tagsearch.noresults")}K.isRefreshing=false;K.showAllObjects()}K.fetchPageInProgress=false}function y(aQ,aP){var aS=aQ.split("/"),aR=aS[aS.length-1],aT={ETag:"",Key:aR,LastModified:"",Owner:{DisplayName:"",ID:""},Path:aS.length>1?aQ.substring(0,aQ.lastIndexOf(aR)):"",Size:"",StorageClass:"",VersionId:aP,beingRenamed:false};if(K.endKeyNum-K.startKeyNum<K.maxKeys-1){K.currLocation.objects.relativePaths.push(aT);if(K.startKeyNum===0){K.startKeyNum=1}K.endKeyNum++;return true}else{if(K.nextTagObjs){K.nextTagObjs.push(aT)}else{K.nextTagObjs=[aT]}return false}}function t(){if(e.currentPage>e.lastCachedPage){e.lastCachedPage=e.currentPage}var aP=aI.getPageOfDeletedObjects(e.currentPage);aN(aP,true);K.startKeyNum=e.currentPage*K.maxKeys+1;K.endKeyNum=K.startKeyNum+aP.Contents.length+aP.CommonPrefixes.length-1}function F(aX,aQ){var aP=aI.returnVersionMarkers();var aV=X.getFolderNamesList();var aU=-1;var aW=aP.length;var aY=aV.length;var aS=aV[aY-1];if(aW>=aY){var aR=aP[aY-1][aS];if(!_.isEmpty(aR)){for(var aT=0;aT<aR.length;aT++){if(aR[aT].marker===aX&&aR[aT].id===aQ){aU=aT;break}}}}return aU}function h(aU){var aS=aI.returnMarkers();var aW=X.getFolderNamesList();var aV=-1;var aP=aS.length;var aX=aW.length;var aR=aW[aX-1];if(aP>=aX){var aQ=aS[aX-1][aR];if(!_.isEmpty(aQ)){for(var aT=0;aT<aQ.length;aT++){if(aQ[aT]===aU){aV=aT;break}}}}return aV}K.fetchNextPageOfObjects=function(){if(K.fetchPageInProgress){return}else{K.fetchPageInProgress=true}var aU=X.getCurrentAbsoluteFolderPath();if(aU===undefined){aU=""}var aS=X.getFolderNamesList();if(K.showDeleted){e.currentPage++;if(e.currentPage<=e.lastCachedPage||!e.isTruncated){t();K.fetchPageInProgress=false}else{az.fetchDeletedPageOfObjects(aU,e.currentPage,e.nextKeyMarker,e.nextVersionIdMarker).then(function(aV){L(aV);K.fetchPageInProgress=false},function(aV){k(aV);K.fetchPageInProgress=false})}}else{if(K.showVersions){aU=aU.concat(w||"");if(_.isEmpty(K.filters.prefixFilters)){var aR=!_.isEmpty(K.nextVersionIdMarker)?K.nextVersionIdMarker:"";var aQ=!_.isEmpty(K.versionsNextKeyMarker)?K.versionsNextKeyMarker:"";var aP=F(aQ,aR);if(aP<0){aI.addVersionMarker(K.versionsNextKeyMarker,aS.length-1,aS[aS.length-1],aR)}var aT=aF.path();aF.path(aT).search(b.CURRENT_VERSIONS_KEY_MARKER,aQ).search(b.CURRENT_VERSIONS_ID_MARKER,aR)}else{K.versionsKeyMarkers.push(K.versionsCurrentKeyMarker);K.versionsIdMarkers.push(K.versionsCurrentIdMarker);K.startKeyNum=K.maxKeys*K.versionsKeyMarkers.length+1;ap(aU,K.versionsNextKeyMarker,K.nextVersionIdMarker)}}else{if(K.tagContinuationTokens.length>0){K.fetchOnePageTag(K.tagContinuationTokens[K.tagContinuationTokens.length-1])}else{aU=aU.concat(w||"");if(_.isEmpty(K.filters.prefixFilters)){var aP=h(K.nextMarker);if(aP<0){aI.addMarker(K.nextMarker,aS.length-1,aS[aS.length-1])}var aT=aF.path();aF.path(aT).search(b.CURRENT_MARKER,K.nextMarker)}else{K.markers.push(K.currentMarker);K.startKeyNum=K.maxKeys*K.markers.length+1;N(aU,K.nextMarker)}}}}};K.fetchPreviousPageOfObjects=function(){if(K.showDeleted){e.currentPage--;t()}else{var aW=X.getCurrentAbsoluteFolderPath();if(aW===undefined){aW=""}aW=aW.concat(w||"");var aZ=X.getFolderNamesList();var a2=aZ.length;if(K.showVersions){if(_.isEmpty(K.filters.prefixFilters)){var aS=!_.isEmpty(K.versionsCurrentIdMarker)?K.versionsCurrentIdMarker:"";var a1=!_.isEmpty(K.versionsCurrentKeyMarker)?K.versionsCurrentKeyMarker:"";var a3="";var aR="";var aY=F(a1,aS);if(aY>0){var aQ=aI.getVersionMarkers(a2-1,aZ[a2-1]);a3=aQ[aY-1].marker;aR=aQ[aY-1].id}var aX=aF.path();aF.path(aX).search(b.CURRENT_VERSIONS_KEY_MARKER,a3).search(b.CURRENT_VERSIONS_ID_MARKER,aR)}else{var aP=K.versionsKeyMarkers.pop();var aV=K.versionsIdMarkers.pop();K.startKeyNum=K.maxKeys*K.versionsKeyMarkers.length+1;if(!aP||Object.keys(aP).length===0){aP=""}if(!aV||Object.keys(aV).length===0){aV=""}ap(aW,aP,aV)}}else{if(_.isEmpty(K.filters.prefixFilters)){var aU=!_.isEmpty(K.currentMarker)?K.currentMarker:"";var aY=h(aU);var a0="";if(aY>0){var aT=aI.getMarkers(a2-1,aZ[a2-1]);a0=aT[aY-1]}var aX=aF.path();aF.path(aX).search(b.CURRENT_MARKER,a0)}else{var a0=K.markers.pop();if(!a0||Object.keys(a0).length===0){a0=""}K.startKeyNum=K.maxKeys*K.markers.length+1;N(aW,a0)}}}};function ak(aR,aP){var aQ=arguments.length<=2||arguments[2]===undefined?true:arguments[2];x.listObjects(aR,aP,K.maxKeys,b.DELIMITER,aQ).then(function(aT){var aS=aT.response.ListBucketResult;aN(aS);if(aS.IsTruncated&&m.convertStringToBoolean(aS.IsTruncated)){ak(aS.NextMarker)}else{aG()}})["catch"](function(aS){k(aS)})}function k(aP){K.currLocation.objects.error=m.handleErrors(aP);l.Timer.customerReady();K.currLocation.loading=false;K.isRefreshing=false}function aG(){K.timing.fetchAllObjects.duration=new Date().getTime()-K.timing.fetchAllObjects.start;K.currLocation.loading=false;K.currLocation.objects.error=false;K.isRefreshing=false;K.fetchPageInProgress=false}K.openUploadModal=function(){K.currentPath=X.getAbsolutePathWithBucket();K.flags.uploadDisabled=true;m.analyticsTrackClick(b.ANALYTICS.UPLOAD_OBJECTS_MODAL,b.ANALYTICS.DETAILS);m.analyticsTrackClick(b.ANALYTICS.START_UPLOAD_FILE,b.ANALYTICS.UPLOAD_FILE_S3);m.analyticsTrackView(b.ANALYTICS.SELECT_UPLOAD_FILE,b.ANALYTICS.UPLOAD_FILE_S3);K.isUploadModalDisplayed.flag=true};var ab=D.$on("fileDropEvent",function(aR,aQ){if(K.isUploadModalDisplayed.flag){return}aR.defaultFired=true;K.operations.dragAndDropOperation=am.createUploadOperation();var aP=G.createExplorer(aQ,K.operations.dragAndDropOperation);aP.then(function(aS){K.operations.dragAndDropOperation.explorers.push(aS);K.selected={selectedItems:aS.getSelectedItems()};K.flags.uploadDisabled=false},function(aS){K.error=aS});K.openUploadModal()});K.getPropertyTitleConditionally=function(aR,aP,aQ){if(aR){return p.instant(aP+aQ)}return""};K.setTabParam=function(aP){aF.search("tab",aP);m.analyticsTrackClick(""+b.ANALYTICS.TAB_VIEW+aP,b.ANALYTICS.DETAILS)};K.$on("$destroy",function(){ab();ao.setSelectedFlagAsFalse(K.currLocation.folders.relativePaths,K.currLocation.objects.relativePaths)});K.getStorageClassTranslation=function(aP){return m.getStorageClassTranslations()[aP]};K.isFeatureEnabled=function(aP){return aL.isFeatureEnabled(aP)};K.isFetchPreviousPageDisabled=function(){if(K.fetchPageInProgress){return true}if(K.showDeleted){return e.currentPage===0}else{if(K.showVersions){if(_.isEmpty(K.filters.prefixFilters)){var aQ=!_.isEmpty(K.versionsCurrentIdMarker)?K.versionsCurrentIdMarker:"";var aP=!_.isEmpty(K.versionsCurrentKeyMarker)?K.versionsCurrentKeyMarker:"";if(F(aP,aQ)<0){return true}else{return false}}else{return K.versionsKeyMarkers.length===0}}else{if(_.isEmpty(K.filters.prefixFilters)){var aR=!_.isEmpty(K.currentMarker)?K.currentMarker:"";if(h(aR)<0){return true}else{return false}}else{return K.markers.length===0}}}};K.isFetchNextPageDisabled=function(){if(K.fetchPageInProgress){return true}if(K.showDeleted){if(!e.isTruncated&&e.currentPage===e.lastCachedPage){if(aI.getPageOfDeletedObjects(e.currentPage+1)){return false}return true}return false}else{if(K.showVersions){return !K.versionsNextKeyMarker}else{return !K.nextMarker}}};K.copySelectedObjectPath=function(aP){m.copyPathToClipboard(aP,K.copyFinished)};K.rightClick=function(aP,aS){B.log(b.CONTEXT_MENU.OBJECT.METRIC_NAME,1,{details:aS});aP.stopPropagation();var aQ=angular.element("#context-menu");aQ.css({position:"absolute",top:aP.pageY-b.CONTEXT_MENU.OBJECT.Y_OFFSET,left:aP.pageX});if(aS){var aR=_.pluck(K.getSelectedObjects(),"Key").concat(_.pluck(K.getSelectedFolders(),"Prefix"));if(aR.length===0||_.indexOf(aR,aS.Key||aS.Prefix)===-1){K.clickObjectRow(aP,aS)}}ae(function(){aQ.find("awsui-button-dropdown").find("button").trigger("click")},0,false)};K.addMetadata=function(aP){aP.stopPropagation();K.panelSettingValues.values.push({metadataKey:null,metadataValue:null})};K.clearMetadataErrorMsg=function(aP){aP.inputError=null};K.removeMetadata=function(aP){K.panelSettingValues.values.splice(aP,1)};function at(){var aR="div:contains('"+K.tabs[2].label+"')";$(aR).css("text-decoration","underline");B.setEndpoint();if(K.isFeatureEnabled("s3-si")){K.tabs.push(o)}if(d[b.SHOW_DELETED_PARAM]){K.showDeleted=m.convertStringToBoolean(d[b.SHOW_DELETED_PARAM])}if(d[b.SHOW_VERSION_PARAM]){K.showVersions=m.convertStringToBoolean(d[b.SHOW_VERSION_PARAM])}if(d[b.PREFIX_SEARCH_PARAM]){if(!_.isEmpty(w)){K.filters.prefixFilters.length=0;K.filters.prefixFilters.push(w)}var aP=(X.getCurrentAbsoluteFolderPath()||"").concat(w);K.fetchOnePagePrefix(aP)}K.startWithMarker="";K.startWithVersionKeyMarker="";K.startWithVersionIdMarker="";if(d[b.CURRENT_MARKER]){K.startWithMarker=d[b.CURRENT_MARKER]}if(d[b.CURRENT_VERSIONS_ID_MARKER]){K.startWithVersionIdMarker=d[b.CURRENT_VERSIONS_ID_MARKER]}if(d[b.CURRENT_VERSIONS_KEY_MARKER]){K.startWithVersionKeyMarker=d[b.CURRENT_VERSIONS_KEY_MARKER]}var aQ=X.getFolderNamesList();aI.initializeMarkers(aQ);var aS=_.last(aF.path().split("/buckets/"+K.bucketName));if(aS!=="/"&&aS!==""){K.tabs.length=0;K.tabs.push({label:p.instant("details.tab.overview"),id:"overview"})}if(_.isEmpty(w)){K.fetchObjects(false)}K.showVersionedView=false;Q.getVersioningStatus(K.bucketName).then(function(aU){K.isVersionedBucket=aU===b.BUCKET_PROPERTIES.VERSIONING.ENABLED||aU===b.BUCKET_PROPERTIES.VERSIONING.SUSPENDED;if(aL.isFeatureEnabled(b.FAC.VERSIONED_VIEW)&&K.isVersionedBucket){K.showVersionedView=true}})["finally"](function(){Q.getBucketRegion(K.bucketName).then(function(aU){K.bucketRegion=aU;K.analyzeAccess();Y.isRegionalFeatureEnabled(b.FAC.ACCELERATE,K.bucketRegion.value).then(function(aV){K.displayAcceleration=aV});Y.isRegionalFeatureEnabled(b.FAC.DEFAULT_ENCRYPTION,K.bucketRegion.value).then(function(aV){K.enableDefaultDecryption=aV})})});var aT=new i(b.OPERATION_NAME.GET_DEFAULT_ENCRYPTION);ac.getBucketProperty(aT,K.bucketName,"defaultEncryption").then(function(){K.defaultEncryptionEnabled=true},function(aU){K.defaultEncryptionEnabled=false})}var au=new i(b.OPERATION_NAME.ANALYZE_ACCESS);K.access={};K.analyzeAccess=function(){var aQ=arguments.length<=0||arguments[0]===undefined?true:arguments[0];var aP=aj.defer();Y.isRegionalFeatureEnabled(b.FAC.ACCESS).then(function(aR){if(aR){Q.analyzeAccess(K.bucketName,au,aQ).then(function(aT){var aS=aw.getAccessStatus(aT);K.access.bucketPublic=aS.bucketPublic;K.access.aclPublic=aS.aclPublic;K.access.policyPublic=aS.policyPublic;aP.resolve()})["catch"](function(aS){aP.reject(aS)})}else{aP.resolve()}})["catch"](function(aR){aP.reject(aR)});return aP.promise};at()};"use strict";(function(){angular.module("s3").directive("createBucketModal",[function(){return{restrict:"E",scope:{isOpen:"=",bucketList:"=",regions:"=",numRegions:"=",loadBuckets:"="},templateUrl:"/s3/partials/createbucketmodal.html",controller:"CreateBucketController"}}]);angular.module("s3").controller("CreateBucketController",["$q","$scope","$timeout","$translate","APIProxyService","BucketPropertiesService","BucketPropertiesUtilService","CachingService","ConsoleOperation","FACService","PermissionsUtilService","Region","S3Constants","SCLogService","UtilService",a]);function a(A,t,C,v,w,n,h,k,q,o,m,f,s,d,D){t.STEP={NAME_AND_REGION:{name:"NAME_AND_REGION",value:v.instant("createbucketmodal.label.nameandregion")},PROPERTIES:{name:"PROPERTIES",value:v.instant("createbucketmodal.label.setproperties")},PERMISSIONS:{name:"PERMISSIONS",value:v.instant("createbucketmodal.label.setpermissions")},REVIEW:{name:"REVIEW",value:v.instant("createbucketmodal.label.review")}};t.state=t.STEP.NAME_AND_REGION;t.headerTitle=v.instant("createbucketmodal.header.title");t.createBucketValues={firstLoad:true};t.createBucketValues.region=_.find(t.regions,function(F){return F.value===f.getCurrentRegion()});t.createBucketProperties={getResponse:{tagging:{tags:[]},logging:{selectedValue:s.BUCKET_PROPERTIES.DISABLE},versioning:{selectedValue:s.BUCKET_PROPERTIES.DISABLE},eventSelectors:{trailNames:[],access:{read:false,write:false},targetTrail:"",enabled:false,trailRegionMapping:{}},defaultEncryption:{customKMSARN:"",encryption:s.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.NONE,kmsId:null}}};t.forCreateBucketModal=true;t.defaultAcls=_.cloneDeep(s.BUCKET_PERMISSIONS.INITIALIZE_ACLS);t.currPermissions=_.cloneDeep(s.BUCKET_PERMISSIONS.INITIALIZE_ACLS);t.sourceBucketPermissions={grantees:{},aclGrants:{},owner:{}};t.isCreatingBucket=false;t.propertyStatuses=[];t.isAddingAwsAccountAcl={flag:false};E();t.bucketNameValidationErrors=[];t.MODAL_TYPE=s.MODAL_TYPE;C(function(){angular.element(document).find("#bucket-name input").focus()});function x(){return A.reject()}function i(F){return F.then(function(){})["catch"](function(){return x()})}function u(G){var F=new q(s.BUCKET_PROPERTIES.VERSIONING.ENABLE_BUCKET_VERSIONING);return i(n.enableBucketVersioning(G,F))}function g(G,F){var H=new q(s.BUCKET_PROPERTIES.TAGGING.PUT_BUCKET_TAGGING);return i(n.putBucketTagging(G,F,H))}function p(G,F){var H=new q(s.OPERATION_NAME.PUT_DEFAULT_ENCRYPTION);return i(n.putBucketDefaultEncryption(G,F,H))}function y(F){var G=new q(s.BUCKET_PERMISSIONS.PUT_BUCKET_PERMISSIONS_REQUEST);return n.putBucketACL(F,m.updateAcl(t.sourceBucketPermissions,t.currPermissions),G).then(function(){})["catch"](function(H){return x(H)})}function E(){var F=new q(s.BUCKET_PERMISSIONS.GET_BUCKET_OWNER);w.getBucketOwner(F).then(function(G){d.log("getBucketOwner",1,F);t.currPermissions.ownerName=G.DisplayName;t.defaultAcls.userPermissions[0].detail=_.clone(G);t.currPermissions.userPermissions[0].detail=_.clone(G)})["catch"](function(G){d.log("getBucketOwner",0,F);t.sourceBucketPermissions.owner.isError=true;t.sourceBucketPermissions.owner.errorMessage=D.handleErrors(G)})}function z(){var F=new q("DescribeTrails");n.describeTrails(F,t.createBucketValues.region.value).then(function(G){t.createBucketProperties.getResponse.eventSelectors.trailRegionMapping={};t.createBucketProperties.getResponse.eventSelectors.trailNames=[];h.populateTrailNames(G,t.createBucketProperties.getResponse.eventSelectors.trailNames,t.createBucketProperties.getResponse.eventSelectors.trailRegionMapping);d.log("DescribeTrails",1,F)})["catch"](function(H){var G=D.handleErrors(H);d.log("DescribeTrails",0,F,{error:G});t.createBucketProperties.getResponse.eventSelectors.errorMessage=G})}function c(I,F,G,H){I.push({Grantee:{Type:s.BUCKET_PROPERTIES.GROUP_GANTEE_TYPE,DisplayName:"",EmailAddress:"",ID:"",URI:s.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:F});d.log("LogDeliveryGroupGranteeAdded",1,G,{bucketName:H})}function B(H,K,J,F){var G=new q(s.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING);var I=false;G.step=s.BUCKET_PROPERTIES.GET_BUCKET_ACL;return n.getBucketACL(K,G).then(function(L){var M=D.transformObjectToArray(L);if(_.findIndex(L,{Grantee:{URI:s.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:s.ACL_PERMISSIONS.WRITE})===-1){c(M,s.ACL_PERMISSIONS.WRITE,G,H);I=true}if(_.findIndex(L,{Grantee:{URI:s.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:s.ACL_PERMISSIONS.READ_ACP})===-1){c(M,s.ACL_PERMISSIONS.READ_ACP,G,H);I=true}if(I){G.step=s.BUCKET_PROPERTIES.PUT_BUCKET_ACL;return n.putBucketACL(K,M,G).then(function(){G.step=s.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING;return n.enableBucketLogging(H,K,J,F,G).then(function(){})["catch"](function(N){return x(N)})})["catch"](function(N){return x(N)})}else{return n.enableBucketLogging(H,K,J,F,G).then(function(){})["catch"](function(N){return x(N)})}})["catch"](function(L){return x(L)})}function b(){var F=new q("SaveEventSelectors");var I="";var H=t.createBucketValues.name;if(t.createBucketProperties.getResponse.eventSelectors.access.read&&t.createBucketProperties.getResponse.eventSelectors.access.write){I="All"}else{if(t.createBucketProperties.getResponse.eventSelectors.access.read){I="ReadOnly"}else{I="WriteOnly"}}var G=t.createBucketProperties.getResponse.eventSelectors.targetTrail;return n.getEventSelectors(t.createBucketProperties.getResponse.eventSelectors.targetTrail,F,t.createBucketProperties.getResponse.eventSelectors.trailRegionMapping[G]).then(function(L){var J=_.get(L,"response.EventSelectors");if(J){var K=h.generateEventSelectorsConfig(J,t.createBucketProperties.getResponse.eventSelectors.targetTrail,t.createBucketProperties.getResponse.eventSelectors.access,H);d.log("GetEventSelectors",1,F,{bucketName:H});return n.putEventSelectors(K,F,t.createBucketProperties.getResponse.eventSelectors.trailRegionMapping[G]).then(function(M){d.log("PutEventSelectors",1,F,{bucketName:H})})["catch"](function(M){d.log("PutEventSelectors",0,F,{bucketName:H,error:D.handleErrors(M)});return x(M)})}})["catch"](function(J){d.log("GetEventSelectors",0,F,{bucketName:H,error:D.handleErrors(J)});return x(J)})}function e(H,K){if(t.createBucketProperties.getResponse.versioning.selectedValue===s.BUCKET_PROPERTIES.ENABLE){K.push(u(H))}if(t.createBucketProperties.getResponse.tagging.tags.length>0){var G=t.createBucketProperties.getResponse.tagging.tags;K.push(g(H,G))}if(t.createBucketProperties.getResponse.logging.selectedValue===s.BUCKET_PROPERTIES.ENABLE){var J=t.createBucketProperties.getResponse.logging.targetBucket;var I=t.createBucketProperties.getResponse.logging.targetPrefix;var F=D.transformObjectToArray(t.createBucketProperties.getResponse.logging.targetGrants);K.push(B(H,J,I,F))}if(JSON.stringify(m.updateAcl(t.sourceBucketPermissions,t.currPermissions))!==JSON.stringify(m.updateAcl(t.defaultAcls,t.defaultAcls))){K.push(y(H))}if(t.createBucketProperties.getResponse.eventSelectors.enabled){K.push(b())}if(_.get(t.createBucketProperties.getResponse,"defaultEncryption")&&t.createBucketProperties.getResponse.defaultEncryption.encryption!==s.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.NONE){K.push(p(H,t.createBucketProperties.getResponse.defaultEncryption))}}t.createBucket=function(G,H){D.analyticsTrackClick(s.ANALYTICS.END_CREATE_BUCKET,s.ANALYTICS.CREATE_BUCKET_S3);t.isCreatingBucket=true;var F=new q("CreateBucket","CreateBucketRequestReceived");d.log("CreateBucketRequestReceived",1,F,{bucketName:G,region:H.value});w.createBucket(F,G,H.value).then(function(){D.analyticsTrackClick(s.ANALYTICS.SUCCESS_CREATE_BUCKET,s.ANALYTICS.CREATE_BUCKET_S3);k.evictLamb();d.log("CreateBucketSuccess",1,F,{bucketName:G,region:H.value});var K=[];e(G,K);A.all(K).then(function J(L){t.closeCreateBucketModal();t.loadBuckets(F)},function I(){t.createS3BucketWarning=v.instant("createbucketmodal.errormsg",{bucketName:G});t.loadBuckets(F)})})["catch"](function(I){t.createS3BucketError=D.handleErrors(I);d.log("CreateBucketSuccess",0,F,{bucketName:G,region:H.value,errorMessage:I})})["finally"](function(){t.isCreatingBucket=false;if(t.createS3BucketError){t.setState(t.STEP.REVIEW)}})};t.createBucketNow=function(F,G){t.isCreatingBucket=true;t.isBucketNameAvailable(F).then(function(){t.createBucket(F,G)})["catch"](function(){t.isCreatingBucket=false})};t.resetErrors=function(){t.createS3BucketError=undefined;t.createS3BucketWarning=null};t.closeCreateBucketModal=function(){t.isOpen.flag=false;t.resetErrors();t.createBucketValues.region=_.find(t.regions,function(F){return F.value===f.getCurrentRegion()});t.createBucketValues.name="";t.createBucketValues.copySettingsSourceBucket=undefined;t.state=t.STEP.NAME_AND_REGION;t.createBucketProperties={getResponse:{tagging:{tags:[]},logging:{selectedValue:s.BUCKET_PROPERTIES.DISABLE},versioning:{selectedValue:s.BUCKET_PROPERTIES.DISABLE},eventSelectors:{trailNames:[],access:{read:false,write:false},targetTrail:"",enabled:false,trailRegionMapping:{}}}};t.sourceBucketPermissions.aclGrants={};t.sourceBucketPermissions.grantees={};t.currPermissions.publicPermissions=_.cloneDeep(t.defaultAcls.publicPermissions);t.currPermissions.userPermissions=_.cloneDeep(t.defaultAcls.userPermissions);t.currPermissions.systemPermissions=_.cloneDeep(t.defaultAcls.systemPermissions);t.currPermissions.awsAccountPermissions=_.cloneDeep(t.defaultAcls.awsAccountPermissions);t.bucketNameValidationErrors=[];D.bodyFreezeScroll(false)};t.goToPreviousState=function(){t.bucketNameValidationErrors=[];t.previousState()};t.isBucketNameAvailable=function(F){return w.headBucket(new q("checkBucketAvailability"),F).then(function(G){t.bucketNameValidationErrors=[v.instant("createbucketmodal.bucketname.access.error")];return A.reject(false)})["catch"](function(G){if(G.status===s.HTTP_STATUS_CODES.NOT_FOUND){D.analyticsTrackClick(s.ANALYTICS.NAME_REGION_CREATE_BUCKET,s.ANALYTICS.CREATE_BUCKET_S3);D.analyticsTrackView(s.ANALYTICS.SET_PROP_CREATE_BUCKET,s.ANALYTICS.CREATE_BUCKET_S3);o.isRegionalFeatureEnabled(s.FAC.DEFAULT_ENCRYPTION,t.createBucketValues.region.value).then(function(H){t.enableDefaultEncryption=H});return A.resolve(true)}else{t.bucketNameValidationErrors=[v.instant("createbucketmodal.bucketname.access.error")];return A.reject(false)}})};t.generateSummary=function(){if(t.state===t.STEP.NAME_AND_REGION){t.checkingName=true;t.isBucketNameAvailable(t.createBucketValues.name).then(function(){z();t.nextState()})["finally"](function(){t.checkingName=false})}else{if(t.state===t.STEP.PROPERTIES){D.analyticsTrackClick(s.ANALYTICS.SET_PROP_CREATE_BUCKET,s.ANALYTICS.CREATE_BUCKET_S3);D.analyticsTrackView(s.ANALYTICS.SET_PERM_CREATE_BUCKET,s.ANALYTICS.CREATE_BUCKET_S3);var F=[{name:v.instant("bucketproperties.versioning.label.versioning"),value:"versioning"},{name:v.instant("bucketproperties.logging.label.logging"),value:"logging"},{name:v.instant("bucketproperties.tagging.label.tagging"),value:"tagging"},{name:v.instant("bucketproperties.dataevents.label.dataevents"),value:"eventSelectors"},{name:v.instant("bucketproperties.defaultencryption.title"),value:"defaultEncryption"}];t.propertyStatuses=[];F.forEach(function(G){t.propertyStatuses.push(r(G))});t.nextState()}else{if(t.state===t.STEP.PERMISSIONS){D.analyticsTrackClick(s.ANALYTICS.SET_PERM_CREATE_BUCKET,s.ANALYTICS.CREATE_BUCKET_S3);D.analyticsTrackView(s.ANALYTICS.REVIEW_CREATE_BUCKET,s.ANALYTICS.CREATE_BUCKET_S3);if(t.isAddingAwsAccountAcl.flag===true){t.isAddingAwsAccountAcl.warningMsg=v.instant("uploadmodal.awsaccounts.warningmsg")}else{t.isAddingAwsAccountAcl.warningMsg=null;t.aclsSummaries[0].value=t.currPermissions.awsAccountPermissions.length+t.currPermissions.userPermissions.length;t.aclsSummaries[1].value=j(t.currPermissions.publicPermissions);t.aclsSummaries[2].value=j(t.currPermissions.systemPermissions);t.nextState()}}}}};t.validateBucketName=function(){var F=[];if(D.isValidBucketName(t.createBucketValues.name,F)){if(l(t.createBucketValues.name)){t.bucketNameValidationErrors=[v.instant("createbucketmodal.bucketname.exists.error")]}else{t.bucketNameValidationErrors=[]}}else{t.bucketNameValidationErrors=F}if(_.isEmpty(t.bucketNameValidationErrors)){t.resetErrors()}};function l(F){return t.bucketList.some(function(G){return G.Name===F})}function r(I){var F=t.createBucketProperties.getResponse[I.value];var H={name:I.name};var G={enabled:v.instant("createbucketmodal.review.enabled"),disabled:v.instant("createbucketmodal.review.disabled"),activenotifs:v.instant("createbucketmodal.review.activenotifications"),tags:v.instant("createbucketmodal.review.tags")};switch(I.value){case"versioning":H.status=F.selectedValue;H.status=F.selectedValue===s.BUCKET_PROPERTIES.VERSIONING.ENABLE?G.enabled:G.disabled;break;case"logging":H.status=F.selectedValue===s.BUCKET_PROPERTIES.LOGGING.ENABLE?G.enabled:G.disabled;break;case"tagging":H.status=F.tags.length+" "+G.tags;break;case"eventSelectors":H.status=F.enabled?G.enabled:G.disabled;break;case"defaultEncryption":H.status=t.createBucketProperties.getResponse.defaultEncryption.encryption;break}return H}var j=function j(F){return _.map(F,"permissions").filter(function(G){return G&&(G.READ||G.READ_ACP||G.WRITE||G.WRITE_ACP)}).length>0?v.instant("modal.acl.summary.enabled"):v.instant("modal.acl.summary.disabled")};t.aclsSummaries=[{summaryTitle:v.instant("modal.acl.summary.users"),value:t.currPermissions.userPermissions.length},{summaryTitle:v.instant("modal.acl.summary.publicacls"),value:v.instant("modal.acl.summary.disabled")},{summaryTitle:v.instant("modal.acl.summary.systemacls"),value:v.instant("modal.acl.summary.disabled")}]}})();"use strict";angular.module("s3").factory("APIProxyService",["CachingService","FAC","Md5GenerationService","SCLogService","S3Service","S3WrapperService","S3Constants","UtilService","KMSService","GlacierService","$q","$window",function(r,ae,Y,h,t,Q,ac,x,Z,U,c,V){var u=function u(ag,al,aj,ai){ai.step=ac.LOGGING.S3_REQUEST_PREFIX+aj;if(al.path){al.path=x.escapePath(al.path)}h.log(ai.step.replace(/ /g,""),1,ai,al);var ah=aj.replace(/ /g,"");var ak=V.Date.now();return ag(al).then(function(an){var am=V.Date.now();var ao={};var ap=an.headers();ao[ac.S3_RESPONSE_HEADERS.X_AMZ_ID_2]=ap[ac.S3_RESPONSE_HEADERS.X_AMZ_ID_2];ao[ac.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID]=ap[ac.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID];h.log(""+ah+ac.REQUEST_METRICS.STATUS_CODE_INFIX+an.status,1,ai,ao);h.logWithSimplifiedOperation(""+ah+ac.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,ai);h.logWithSimplifiedOperation(""+ah+ac.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,ai);h.logWithSimplifiedOperation(""+ah+ac.REQUEST_METRICS.LATENCY_SUFFIX,am-ak,ai);if(an&&an.response&&an.response.error){return c.reject(x.handleErrors(an.response.error))}return an})["catch"](function(an){var am=V.Date.now();var ao={};var ap=an.headers();ao[ac.S3_RESPONSE_HEADERS.X_AMZ_ID_2]=ap[ac.S3_RESPONSE_HEADERS.X_AMZ_ID_2];ao[ac.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID]=ap[ac.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID];h.log(""+ah+ac.REQUEST_METRICS.STATUS_CODE_INFIX+an.status,1,ai,{response:an,details:ao});if(an.status>=ac.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD){h.logWithSimplifiedOperation(""+ah+ac.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,0,ai)}else{h.logWithSimplifiedOperation(""+ah+ac.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,ai)}if(an.status>=ac.HTTP_STATUS_CODES.CLIENT_ERROR_THRESHOLD&&an.status<ac.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD){h.logWithSimplifiedOperation(""+ah+ac.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,0,ai)}else{h.logWithSimplifiedOperation(""+ah+ac.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,ai)}h.logWithSimplifiedOperation(""+ah+ac.REQUEST_METRICS.LATENCY_SUFFIX,am-ak,ai);return c.reject(an)})};function a(ah,aj,ag,ai){return M(ah,aj,{path:aj+"/"+ag,params:{versionId:ai}}).then(function(ak){return u(t.getObjectMetadata,ak,ac.PROXY_API_NAMES.S3.GET_OBJECT_METADATA,ah)})}function z(ag){var aj=arguments.length<=1||arguments[1]===undefined?true:arguments[1];if(aj){var ak=r.getLamb();if(ak){return c.when(ak)}}function ai(am,al){return u(am,al,ac.PROXY_API_NAMES.S3.HEAD_BUCKET,ag)}var ah=x.getRegionOrder();_.remove(ah,function(al){return al===ac.DEFAULT_REGION[x.getCloudSystem()]});ah.unshift(ac.DEFAULT_REGION[x.getCloudSystem()]);return Q.lambWithFallback(ah,ai).then(function(am){var al=_.get(am,"response.ListAllMyBucketsResult.Buckets");al.Bucket=j(al.Bucket);r.putLamb(am);return am})}function G(ag){var ah=r.getLamb();if(ah){return c.when(ah.response.ListAllMyBucketsResult.Owner)}return u(t.listAllMyBuckets,{region:ac.DEFAULT_REGION[x.getCloudSystem()]},ac.PROXY_API_NAMES.S3.LAMB,ag).then(function(ai){return _.get(ai,"response.ListAllMyBucketsResult.Owner")})}function g(ag,ah){var ai={path:ah};return u(t.headBucket,ai,ac.PROXY_API_NAMES.S3.HEAD_BUCKET,ag)}function X(ag){var ah={path:ag.initialBucket};return M(ag,ag.initialBucket,ah).then(function(ai){return u(t.deleteBucket,ai,ag.name,ag)})}function s(ah,am,ai,ak,al){var ag=c.defer();ai=ai||"";var aj={path:am+"/"+ai+ak+"/"};if(al){aj.headers=al}M(ah,am,aj).then(function(an){u(t.putObject,an,ac.PROXY_API_NAMES.S3.PUT_OBJECT,ah).then(function(ao){ag.resolve(ao)})["catch"](function(ao){ag.reject(ao)})})["catch"](function(an){ag.reject(an)});return ag.promise}function N(ah,ak,ai){var ag=c.defer();var aj={path:ak+"/"+ai};M(ah,ak,aj).then(function(al){u(t.headObject,al,ac.PROXY_API_NAMES.S3.HEAD_OBJECT,ah).then(function(am){ag.resolve(am)})["catch"](function(am){ag.reject(am)})})["catch"](function(al){ag.reject(al)});return ag.promise}function l(ah,ai,ak){var ag;if(ak==="us-east-1"){ag=""}else{ag="<CreateBucketConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'><LocationConstraint>"+ak+"</LocationConstraint></CreateBucketConfiguration>"}var aj={content:ag,path:ai,region:ak};return u(t.createBucket,aj,ac.PROXY_API_NAMES.S3.CREATE_BUCKET,ah).then(function(al){return al})["catch"](function(al){if(al.response&&al.response.Error&&al.response.Error.Message){return c.reject(al.response.Error.Message)}else{return c.reject(al)}})}var M=function M(ah,aj,ai){if(x.isIE()){var ag=c.defer();d(ah,aj,ai).then(function(ak){ag.resolve(ak)})["catch"](function(ak){if(ak&&ak.status===ac.HTTP_STATUS_CODES.ACCESS_DENIED){e(ah,aj,ai).then(function(al){ag.resolve(al)})["catch"](function(al){ag.reject(al)})}else{ag.reject(ak)}});return ag.promise}return e(ah,aj,ai)};var e=function e(ag,aj,ai){function ah(ak,al){return u(ak,al,ac.PROXY_API_NAMES.S3.HEAD_BUCKET,ag)}return P(ag,aj,Q.getBucketLocationWithFallback,ah,ai)};var d=function d(ag,aj,ai){function ah(al,ak){return u(al,ak,ac.PROXY_API_NAMES.S3.GET_BUCKET_LOCATION,ag)}return P(ag,aj,Q.getBucketLocation,ah,ai)};var P=function P(ah,am,al,aj,ak){var ag=r.getBucketLocation(am);if(ag){if(ak){ak.region=ag}return c.when(ak)}var ai=x.getRegionOrder();return al(am,ai,aj).then(function(an){r.putBucketLocation(am,an);if(ak){ak.region=an}return ak})};var O=function O(ah,aj){var ai=aj.cacheAllowed;delete aj.cacheAllowed;if(ai){var ag=r.getBucketObjects(aj.path,JSON.stringify(aj));if(ag){return c.when(ag)}}return u(t.listObjects,aj,ac.PROXY_API_NAMES.S3.LIST_OBJECT,ah).then(function(am){var al=am.response.ListBucketResult;if(al.Contents){al.Contents=j(al.Contents);al.Contents=al.Contents.map(function(an){an.Size=parseInt(an.Size);return an})}if(al.CommonPrefixes){al.CommonPrefixes=j(al.CommonPrefixes)}if(al.IsTruncated&&al.IsTruncated==="true"&&!al.NextMarker){var ak=al.Contents[al.Contents.length-1].Key;al.NextMarker=ak}if(!ai||ai&&!ag){r.putBucketObjects(aj.path,JSON.stringify(aj),am)}return am})};function L(ah,ai){var ag={path:ai.bucket,params:{prefix:ai.prefix,"max-keys":ai.maxKeys,marker:ai.marker,delimiter:ai.delimiter},cacheAllowed:ai.cacheAllowed};if(ae.isFeatureEnabled("s3-log-response-data")){ag.details={shouldLogResponseData:true}}return M(ah,ai.bucket,ag).then(function(aj){return O(ah,aj)})}function p(ah,aj){var ag=c.defer(),ai={path:aj.bucket,params:{delimiter:aj.delimiter,"key-marker":aj.keyMarker,"max-keys":aj.maxKeys,prefix:aj.prefix,"version-id-marker":aj.versionIdMarker},cacheAllowed:aj.cacheAllowed};M(ah,aj.bucket,ai).then(function(ak){u(t.listVersions,ak,ac.PROXY_API_NAMES.S3.LIST_VERSION,ah).then(function(al){ag.resolve(al)})["catch"](function(al){ag.reject(al)})})["catch"](function(ak){ag.reject(ak)});return ag.promise}var ad=function ad(ag,ah){return u(t.getObjectAcl,ah,ac.PROXY_API_NAMES.S3.GET_OBJECT_ACL,ag).then(function(aj){var ai=aj.response.AccessControlPolicy.AccessControlList;ai.Grant=j(ai.Grant);return aj})};function C(ah,aj,ag,ai){return M(ah,aj,{path:aj+"/"+ag,params:{versionId:ai}}).then(function(ak){return ad(ah,ak)})}function k(ah,ai,aj){var ag=c.defer();M(ah,ai,{path:ai,content:aj}).then(function(ak){u(t.tagQuery,ak,ac.PROXY_API_NAMES.S3.TAG_QUERY,ah).then(function(al){return ag.resolve(al)},function(al){return ag.reject(al)})});return ag.promise}var A=function A(ah,ai){var ag=c.defer();u(t.getObjectTag,ai,ac.PROXY_API_NAMES.S3.GET_OBJECT_TAG,ah).then(function(aj){return ag.resolve(aj)},function(aj){return ag.reject(aj)});return ag.promise};function D(ai,ak,ah){var aj=arguments.length<=3||arguments[3]===undefined?null:arguments[3];var ag=c.defer(),al={path:ak+"/"+ah};if(!_.isEmpty(aj)){al.params={versionId:aj}}M(ai,ak,al).then(function(am){A(ai,am).then(function(an){ag.resolve(an)},function(an){ag.reject(an)})},function(am){ag.reject(am)});return ag.promise}function m(ah,aj,am,al){var ai=arguments.length<=4||arguments[4]===undefined?null:arguments[4];var ag=c.defer(),ak={path:aj+"/"+am,content:al};if(!_.isEmpty(ai)){ak.params={versionId:ai}}M(ah,aj,ak).then(function(an){u(t.putObjectTag,an,ac.PROXY_API_NAMES.S3.PUT_OBJECT_TAG,ah).then(function(ao){ag.resolve(ao)},function(ao){ag.reject(ao)})});return ag.promise}function T(ag,ai,ah,ak){var aj={path:ai+"/"+ah,content:ak};return M(ag,ai,aj).then(function(al){return u(t.putObjectAcl,al,ac.PROXY_API_NAMES.S3.PUT_OBJECT_ACL,ag).then(function(am){return am},function(am){return am})})["catch"](function(al){if(al.response){return c.reject(al.response.Error.Message)}else{return c.reject(al)}})}function q(ag,ah,ai){return M(ag,ah,ai).then(function(aj){return u(t.getObjectInventory,aj,"S3-GetObjectInventory",ag).then(function(ak){return ak})})["catch"](function(aj){if(aj.response){return c.reject(aj.response.Error.Message)}else{return c.reject(aj)}})}var f=function f(ag,ah,ai){return M(ag,ah,ai).then(function(aj){return u(t.deleteObjectInventoryConfig,aj,"S3-DeleteObjectInventoryConfig",ag).then(function(ak){return ak})})["catch"](function(aj){if(aj.response){return c.reject(aj.response.Error.Message)}else{return c.reject(aj)}})};var S=function S(ag,ah,ai){return M(ag,ah,ai).then(function(aj){return u(t.putObjectInventoryConfig,aj,"S3-PutObjectInventoryConfig",ag).then(function(ak){return ak})})["catch"](function(aj){if(aj.response){return c.reject(aj.response.Error.Message)}else{return c.reject(aj)}})};function j(ag){if(!ag){return[]}var ah;if(!angular.isArray(ag)){ah=new Array(ag)}else{ah=ag}return ah}function H(aj,ai,ak,ah,ag){var al={content:"",path:aj+"/"+ai,params:{uploads:""},headers:ak,config:{timeout:ah}};return M(ag,aj,al).then(function(am){return u(t.initiateMultipartUpload,am,ac.PROXY_API_NAMES.S3.INITIAL_MULTIPART_UPLOAD,ag)})}function B(al,ai,ak,am,ah,ag){var aj={content:ak,path:al+"/"+ai,params:{uploadId:am},config:{timeout:ah}};return M(ag,al,aj).then(function(an){return u(t.completeMultipartUpload,an,ac.PROXY_API_NAMES.S3.COMPLETE_MULTIPART_UPLOAD,ag)})}function R(ag,ah,aj){var ak=arguments.length<=3||arguments[3]===undefined?{}:arguments[3];var ai=arguments.length<=4||arguments[4]===undefined?true:arguments[4];return ai&&aa(ah,aj)||M(ag,ah,{path:ah}).then(function(al){angular.extend(al,ak);return u(F[aj].getterFunction,al,ac.PROXY_API_NAMES.S3.GET_PROPERTY_PREFIX+aj,ag).then(function(am){if(ai){r.putBucketProperty(ah,aj,am)}return am})})["catch"](function(al){if(al.response&&al.response.Error&&al.response.Error.Message){return c.reject(al.response.Error.Message)}else{return c.reject(al)}})}function aa(ag,ah){var ai=r.getBucketProperty(ag,ah);if(ai){return c.when(ai)}}function y(ag,ah,ai){var aj=arguments.length<=3||arguments[3]===undefined?{}:arguments[3];var ak=_.extend({path:ah},aj);return M(ag,ah,ak).then(function(al){return u(F[ai].deleteFunction,al,ac.PROXY_API_NAMES.S3.DELETE_PROPERTY_PREFIX+ai,ag).then(function(am){r.evictBucketProperty(ah,ai);return am})})["catch"](function(al){if(al.response&&al.response.Error&&al.response.Error.message){return c.reject(al.response.Error.Message)}else{return c.reject(al)}})}var F={acl:{name:"acl",getterFunction:function i(ag){return t.getBucketAcl(ag)},putterFunction:function ab(ag){return t.putBucketAcl(ag)}},cors:{name:"cors",getterFunction:function i(ag){return t.getBucketCORS(ag)},putterFunction:function ab(ag){return t.putBucketCORS(ag)},deleteFunction:function K(ag){return t.deleteBucketCORS(ag)}},policy:{name:"policy",getterFunction:function i(ag){return t.getBucketPolicy(ag)},putterFunction:function ab(ag){return t.putBucketPolicy(ag)},deleteFunction:function K(ag){return t.deleteBucketPolicy(ag)}},logging:{name:"logging",getterFunction:function i(ag){return t.getBucketLogging(ag)},putterFunction:function ab(ag){return t.putBucketLogging(ag)}},lifecycle:{name:"lifecycle",getterFunction:function i(ag){return t.getLifecycleConfiguration(ag)},putterFunction:function ab(ag){return t.putLifecycleConfiguration(ag)},deleteFunction:function K(ag){return t.deleteLifecycleConfiguration(ag)}},website:{name:"website",getterFunction:function i(ag){return t.getBucketWebsite(ag)},putterFunction:function ab(ag){return t.putBucketWebsite(ag)},deleteFunction:function K(ag){return t.deleteBucketWebsite(ag)}},notification:{name:"notification",getterFunction:function i(ag){return t.getBucketNotification(ag)},putterFunction:function ab(ag){return t.putBucketNotification(ag)}},versioning:{name:"versioning",getterFunction:function i(ag){return t.getBucketVersioning(ag)},putterFunction:function ab(ag){return t.putBucketVersioning(ag)}},replication:{name:"replication",getterFunction:function i(ag){return t.getBucketReplication(ag)},putterFunction:function ab(ag){return t.putBucketReplication(ag)},deleteFunction:function K(ag){return t.deleteBucketReplication(ag)}},tagging:{name:"tagging",getterFunction:function i(ag){return t.getBucketTagging(ag)},putterFunction:function ab(ag){return t.putBucketTagging(ag)},deleteFunction:function K(ag){return t.deleteBucketTagging(ag)}},requestPayment:{name:"requestPayment",getterFunction:function i(ag){return t.getRequestPayment(ag)},putterFunction:function ab(ag){return t.putRequestPayment(ag)}},metrics:{name:"metrics",getterFunction:function i(ag){return t.getBucketMetrics(ag)},putterFunction:function ab(ag){return t.putBucketMetrics(ag)},deleteFunction:function K(ag){return t.deleteBucketMetrics(ag)}},analytics:{name:"analytics",getterFunction:function i(ag){return t.getBucketAnalytics(ag)},putterFunction:function ab(ag){return t.putBucketAnalytics(ag)},deleteFunction:function K(ag){return t.deleteBucketAnalytics(ag)}},accelerate:{name:"accelerate",getterFunction:function i(ag){return t.getBucketAccelerate(ag)},putterFunction:function ab(ag){return t.putBucketAccelerate(ag)}},isidore:{name:"isidore",getterFunction:function i(ag){return t.getBucketIsidoreConfiguration(ag)},putterFunction:function ab(ag){return t.putBucketIsidoreConfiguration(ag)},deleteFunction:function K(ag){return t.deleteBucketIsidoreConfiguration(ag)}},defaultEncryption:{name:"defaultEncryption",getterFunction:function i(ag){return t.getBucketDefaultEncryption(ag)},putterFunction:function ab(ag){return t.putBucketDefaultEncryption(ag)},deleteFunction:function K(ag){return t.deleteBucketDefaultEncryption(ag)}}};var I=["tagging","cors","replication","lifecycle"];function J(ag,ah,ai,al){var aj=arguments.length<=4||arguments[4]===undefined?{}:arguments[4];var ak=_.extend({path:ah,content:al},aj);if(I.indexOf(ai)!==-1){ak.headers={"Content-Type":"application/x-amz-json-1.1","X-Amz-Date":new Date().toUTCString(),"Content-MD5":Y.getContentMd5(al)}}return M(ag,ah,ak).then(function(am){return u(F[ai].putterFunction,am,ac.PROXY_API_NAMES.S3.PUT_PROPERTY_PREFIX+ai,ag).then(function(an){r.evictBucketProperty(ah,ai);return an})})["catch"](function(ao){if(ao.response&&ao.response.Error&&ao.response.Error.Message){var an=ao.response.Error;var am=an.ArgumentValue1?an.Message+". "+an.ArgumentValue1+". ("+an.ArgumentName1+")":an.Message;return c.reject(am)}else{return c.reject(ao)}})}var n=function n(ag,ah){return u(t.getObject,ah,ac.PROXY_API_NAMES.S3.GET_OBJECT,ag).then(function(ai){return ai.response})["catch"](function(ai){if(ai.response&&ai.response.Error&&ai.response.Error.Message){return c.reject(ai.response.Error.Message)}else{return c.reject(ai)}})};function W(ah,ai,ag,aj){if(!aj){aj={"response-content-type":"text"}}return M(ah,ai,{path:ai+"/"+ag}).then(function(ak){ak.params=aj;return n(ah,ak)})}function w(ah,ai,aj){var ag=c.defer();if(!aj.region){M(ah,ai,aj).then(function(){h.log("GetBucketLocation",1,ah);ak(ag)})["catch"](function(al){h.log("GetBucketLocation",0,ah,al);ag.reject(al)})}else{ak(ag)}function ak(al){u(Z.listKeysForService,{Service:"s3",region:aj.region,Limit:1000},ac.PROXY_API_NAMES.KMS.LIST_KEYS,ah).then(function(am){h.log("ListKeysForService",1,ah);al.resolve(am)})["catch"](function(am){h.log("ListKeysForService",0,ah,am);al.reject(am)})}return ag.promise}function E(ah,ai){var ag=c.defer();u(Z.putKeyPolicy,{Service:"s3",region:x.extractRegionFromKmsArn(ai.keyArn),KeyId:x.extractKeyIDFromKmsArn(ai.keyArn),Policy:ai.policy,PolicyName:"default"},ac.PROXY_API_NAMES.KMS.PUT_POLICY,ah).then(function(aj){h.log("ListKeysForService",1,ah);ag.resolve(aj)})["catch"](function(aj){h.log("ListKeysForService",0,ah,aj);ag.reject(aj)});return ag.promise}function o(ah,ai){var ag=c.defer();u(Z.getKeyPolicy,{Service:"s3",region:x.extractRegionFromKmsArn(ai.keyArn),KeyId:x.extractKeyIDFromKmsArn(ai.keyArn),PolicyName:"default"},ac.PROXY_API_NAMES.KMS.GET_POLICY,ah).then(function(aj){h.log("ListKeysForService",1,ah);ag.resolve(JSON.parse(aj.response.Policy))})["catch"](function(aj){h.log("ListKeysForService",0,ah,aj);ag.reject(aj)});return ag.promise}function af(ah,ai,aj){var ag=c.defer();u(U.listProvisionedCapacity,{region:aj},ac.PROXY_API_NAMES.GLACIER.LIST_PROVISIONED_CAPACITY,ah).then(function(ak){h.log("ListProvisionedCapacity",1,ah);var al=_.get(ak,"response.ProvisionedCapacityList");ag.resolve(al)})["catch"](function(ak){h.log("ListProvisionedCapacity",0,ah,ak);ag.reject(ak)});return ag.promise}function v(ah,ai,aj){var ag=c.defer();u(U.purchaseProvisionedCapacity,{region:aj,content:JSON.stringify({})},ac.PROXY_API_NAMES.GLACIER.PURCHASE_PROVISIONED_CAPACTIY,ah).then(function(ak){h.log("PurchaseProvisionedCapacity",1,ah);ag.resolve(ak)})["catch"](function(ak){h.log("PurchaseProvisionedCapacity",0,ah,ak);ag.reject(ak)});return ag.promise}function b(ah,aj,ag){var ai={bucket:aj,continutationToken:ag};return u(t.listBucketIsidoreConfiguration,ai,ac.PROXY_API_NAMES.S3.LIST_BUCKET_ISIDORE_CONFIGURATION,ah).then(function(ak){return ak.response})["catch"](function(ak){if(ak.response&&ak.response.Error&&ak.response.Error.Message){return c.reject(ak.response.Error.Message)}else{return c.reject(ak)}})}return{bucketPropertiesMap:F,completeMultipartUpload:B,createBucket:l,deleteBucket:X,deleteBucketProperty:y,getBucketProperty:R,getBucketLocation:M,getBucketOwner:G,getObject:W,getObjectAcl:C,getObjectMetadata:a,getObjectTag:D,makeProxyRequest:u,putObjectTag:m,getObjectInventory:q,deleteObjectInventoryConfig:f,putObjectInventoryConfig:S,headBucket:g,headObject:N,initiateMultipartUpload:H,listAllMyBuckets:z,listObjects:L,listVersions:p,putBucketProperty:J,putObject:s,putObjectAcl:T,tagQuery:k,getKmsKeys:w,getKMSKeyPolicy:o,putKMSKeyPolicy:E,listProvisionedCapacity:af,purchaseProvisionedCapacity:v,listBucketIsidoreConfiguration:b}}]);"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};angular.module("s3").factory("S3CWSAPIService",["$q","APIProxyService","S3Constants","$http","UtilService","UUIDService","SCLogService","ConsoleOperation","Region","S3CWSEndpoint",function(h,b,f,k,m,e,o,i,q,j){var g=function g(u,y,s,t){if(!s){s={}}if(!s.headers){s.headers={}}s.headers[f.HEADERS.OPERATION]=y;var w=e.generateUUID();u.cwsRequestId=w;var v=f.OPERATION.CWS_OP_ID;var r={};r[v]=w;t.step=f.LOGGING.CWS_REQUEST_PREFIX+y;var x=u.region||q.getCurrentRegion();var z=(typeof j==="undefined"?"undefined":_typeof(j))==="object"?j[x]:j;return k.post(z,u,s).then(function(A){var B={};B[v]=w;t.step=f.LOGGING.CWS_RESPONSE_PREFIX+y;o.log(""+y+f.REQUEST_METRICS.STATUS_CODE_INFIX+A.status,1,t,B);o.logWithSimplifiedOperation(""+y+f.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,t);o.logWithSimplifiedOperation(""+y+f.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,t);if(A&&A.data&&A.data.error){return h.reject(m.handleErrors(A.data.error))}return A},function(A){var B={};B[v]=w;B.message=A.statusText;t.step=f.LOGGING.CWS_RESPONSE_PREFIX+y;o.log(""+y+f.REQUEST_METRICS.STATUS_CODE_INFIX+A.status,1,t,B);if(A.status>=f.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD){o.logWithSimplifiedOperation(""+y+f.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,0,t)}else{o.logWithSimplifiedOperation(""+y+f.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,t)}if(A.status>=f.HTTP_STATUS_CODES.CLIENT_ERROR_THRESHOLD&&A.status<f.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD){o.logWithSimplifiedOperation(""+y+f.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,0,t)}else{o.logWithSimplifiedOperation(""+y+f.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,t)}return h.reject(A)})};return{makeS3ConsoleOperationRequest:g,makePublic:function n(r,s,u){if(!r){r=new i("FAKE CWS CALL OPERATION IN "+f.CWS_OPERATION_NAME.MAKE_PUBLIC)}var t={};t.bucket=r.initialBucket;t.region=u;t.keys=s;return b.getBucketLocation(r,t.bucket,t).then(function(v){return g(v,f.CWS_OPERATION_NAME.MAKE_PUBLIC,{},r)})},fetchPresignedUrl:function d(v,z,s,A,x,w,r,u){if(!u){u=new i("FAKE CWS CALL OPERATION IN "+f.CWS_OPERATION_NAME.GENERATE_PRESIGNED_URL)}var y={};y.bucket=v;y.key=z;y.httpMethod=s;y.headerOverrides=A;y.subresourceMap=x;y.customRequestHeaders=r;var t={};if(w){t.timeout=w}return b.getBucketLocation(u,v,y).then(function(B){return g(B,f.CWS_OPERATION_NAME.GENERATE_PRESIGNED_URL,t,u)})},generateCount:function l(t,s,u,r){var v={};v.bucket=t;v.folders=s;v.continuationTokens=u;return b.getBucketLocation(r,t,v).then(function(w){return g(w,f.CWS_OPERATION_NAME.GENERATE_COUNT,{},r)})},generateVersionsCount:function a(v,u,r,t,s){var w={};w.bucket=v;w.folders=u;w.keyMarkers=r;w.versionIdMarkers=t;return b.getBucketLocation(s,v,w).then(function(x){return g(x,f.CWS_OPERATION_NAME.GENERATE_VERSIONS_COUNT,{},s)})},getMetadata:function c(u,t,s,r){var v={};v.bucket=u;v.key=t;v.versionId=s;return b.getBucketLocation(r,u,v).then(function(w){return g(w,f.CWS_OPERATION_NAME.GET_METADATA,{},r)})},wasOperationSuccessful:function p(r){return r.data.requestStatus==="success"}}}]);"use strict";angular.module("s3").factory("FileUpload",["$translate","S3Constants",function(c,b){function a(A,w,o,G,x,j,r,g){function d(){return w}function J(){return A}function h(){return o}function y(){return G}function e(){return x}function D(){return j}var k=c.instant("utilities.unknown.error");function L(){return k}function l(N){k=N}function M(){if(r&&r.storageClass){return r.storageClass}return b.STORAGE_CLASSES.STANDARD}function f(){if(r&&r.serverSideEncryption&&r.serverSideEncryption===b.OBJECT_SSE.KMS_ENCRYPTION){return r.kmsId}}function B(){if(r&&r.serverSideEncryption&&r.serverSideEncryption===b.OBJECT_SSE.KMS_ENCRYPTION&&r.kmsId===b.UPLOAD.CUSTOM_ARN){return r.kmsARN}}function p(){if(r&&r.metadata){return r.metadata}return undefined}function n(){if(r&&r.tags){var N="";angular.forEach(r.tags,function(Q,P){Q=!_.isEmpty(Q)?Q:"";var O=encodeURIComponent(P)+"="+encodeURIComponent(Q)+"&";N=N.concat(O)});return N.slice(0,-1)}return undefined}function E(N){var O=n();if(!_.isEmpty(O)){N[b.HEADERS.X_AMZ_TAGGING]=O}}function I(O){var N="";if(r&&r.permissions){if(r.permissions.publicPermissions){r.permissions.publicPermissions.forEach(function(P){if(P.permissions[O]===true){N+=N.length>0?", ":"";N+='uri="'+P.detail.URI+'"'}})}if(r.permissions.userPermissions){if(!Array.isArray(r.permissions.userPermissions)){r.permissions.userPermissions=[r.permissions.userPermissions]}r.permissions.userPermissions.forEach(function(P){if(P.permissions[O]===true){N+=N.length>0?", ":"";N+='id="'+P.detail.ID+'"'}})}if(r.permissions.awsAccountPermissions&&r.permissions.awsAccountPermissions.length>0){r.permissions.awsAccountPermissions.forEach(function(P){if(P.permissions[O]===true){N+=N.length>0?", ":"";if(!_.isEmpty(P.detail.EmailAddress)){N+='emailAddress="'+P.detail.EmailAddress+'"'}else{N+='id="'+P.detail.ID+'"'}}})}return N}}function s(Q){var N=I(b.ACL_PERMISSIONS.READ);if(N!==""){Q[b.HEADERS.X_AMZ_GRANT_READ]=N}var R=I(b.ACL_PERMISSIONS.READ_ACP);if(R!==""){Q[b.HEADERS.X_AMZ_GRANT_READ_ACP]=R}var O=I(b.ACL_PERMISSIONS.WRITE);if(O!==""){Q[b.HEADERS.X_AMZ_GRANT_WRITE]=O}var P=I(b.ACL_PERMISSIONS.WRITE_ACP);if(P!==""){Q[b.HEADERS.X_AMZ_GRANT_WRITE_ACP]=P}if(r&&!r.permissions){Q[b.HEADERS.X_AMZ_ACL]=b.HEADERS.X_AMZ_ACL_PRIVATE}}function m(O){var N=_.get(r,"serverSideEncryption");if(N===b.OBJECT_SSE.KMS_ENCRYPTION){O[b.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]=b.OBJECT_SSE.KMS_ENCRYPTION;O[b.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]=f()===b.UPLOAD.CUSTOM_ARN?B():f()}else{if(N===b.OBJECT_SSE.AES256){O[b.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]=b.OBJECT_SSE.AES256}else{if(N===b.OBJECT_SSE.NONE){}else{if(N){throw"$translate.instant('upload.encryption.error'): "+N}}}}}function i(){var O={};O[b.HEADERS.X_AMZ_STORAGE_CLASS]=M();m(O);s(O);E(O);if(p()){var N=p();O=angular.extend({},O,N)}if(!O[b.HEADERS.CONTENT_TYPE]){O[b.HEADERS.CONTENT_TYPE]=undefined}return O}var z;function t(){return z}function K(N){z=N}var H={};function F(){return H}this.addEtag=function(O,N){H[O]=N};var u=Math.ceil(w.size/g);function q(){return u}var C=0;function v(){return C}this.incrementCompletedParts=function(){C+=1};Object.defineProperties(this,{filePointer:{get:d},id:{get:J},cancelDeferredObject:{get:h},uploadDeferredObject:{get:y},destKey:{get:e},destBucket:{get:D},errorMessage:{get:L,set:l},headers:{get:i},timeoutPromise:{get:t,set:K},etags:{get:F},numberOfParts:{get:q},completedParts:{get:v}})}return a}]);"use strict";(function(){angular.module("s3").service("PathService",["$routeParams","$location","S3Constants",function(d,f,b){this.getCurrentBucket=function(){return c()};var c=function c(){var g=f.path();if(g.indexOf("/"+b.PATH_SEGMENTS.BUCKETS+"/")===0||g.indexOf("/"+b.PATH_SEGMENTS.OBJECT_DETAILS+"/")===0){return d[b.PATH_SEGMENTS.BUCKET_NAME]}return undefined};this.getCurrentAbsoluteFolderPath=function(){return a()};function a(){var g=f.path();if(g.indexOf("/"+b.PATH_SEGMENTS.BUCKETS+"/")===0){if(d[b.PATH_SEGMENTS.KEY_PREFIX]){return decodeURIComponent(d[b.PATH_SEGMENTS.KEY_PREFIX])}}if(g.indexOf("/"+b.PATH_SEGMENTS.OBJECT_DETAILS+"/")===0){if(d[b.PATH_SEGMENTS.KEY_PREFIX]){return decodeURIComponent(d[b.PATH_SEGMENTS.KEY_PREFIX].substring(0,d[b.PATH_SEGMENTS.KEY_PREFIX].lastIndexOf(b.DELIMITER)+1))}}return undefined}this.relativeToAbsoluteFolderPath=function(h){var g=a();if(g!==undefined){return g+h+b.DELIMITER}return h+b.DELIMITER};this.relativeToAbsoluteObjectPath=function(g){return e(g)};this.getObjectLink=function(h,i){var g=arguments.length<=2||arguments[2]===undefined?"":arguments[2];var j=b.S3_ENDPOINTS[i]||b.S3_DEFAULT_ENDPOINT;if(g){return j+"/"+c()+"/"+encodeURIComponent(h).replace(/%20/g,"+").replace(/%2F/g,"/")+"?versionId="+g}else{return j+"/"+c()+"/"+encodeURIComponent(h).replace(/%20/g,"+").replace(/%2F/g,"/")}};var e=function e(h){var g=a();if(g!==undefined){return g+h}return h};this.getAbsolutePathWithBucket=function(){var i=c();var g=a();var h=i;if(g){h=""+i+b.DELIMITER+g}return h};this.getAbsolutePathToObjectWithBucket=function(i){var j=c();var g=e(i);var h=j;if(g){h=""+j+b.DELIMITER+g}return h};this.absoluteToRelativeObjectPaths=function(h,g){if(!h){return}h=h.filter(function(i){return i.Key!==g});h.forEach(function(i){if(i.Key===g){i.Key=b.DELIMITER}else{i.Key=i.Key.replace(g,"")}i.beingRenamed=false});return h};this.absoluteToRelativeFolderPaths=function(g,h){if(!g){return}g.forEach(function(i){i.Prefix=i.Prefix.replace(h,"").replace(b.DELIMITER,"");i.beingRenamed=false});return g};this.getCurrentObject=function(){var h="/"+b.PATH_SEGMENTS.BUCKETS+"/",g="/"+b.PATH_SEGMENTS.OBJECT_DETAILS+"/",i=f.path();if(i.indexOf(h)===0){return decodeURIComponent(i.split(""+h+c()+"/")[1])}else{if(i.indexOf(g)===0){return decodeURIComponent(i.split(""+g+c()+"/")[1])}}};this.getUrlForBucketAndPrefix=function(h,i,k){var g=h.split("s3")[0];var j=h.split("region=")[1].split("&")[0];if(i){return g+"s3/buckets/"+i+b.DELIMITER+k+"?region="+j+"&tab=overview"}else{return g+"s3/home?region="+j}};this.getFolderList=function(){var m=d.bucketName;var j=f.path();var i=j.indexOf("/"+b.PATH_SEGMENTS.OBJECT_DETAILS+"/");j=j.substring(j.indexOf(m));var k=j.split(b.DELIMITER);var g="";var l="";var h=[];k.pop();k.forEach(function(n){g+="/"+encodeURIComponent(n);l+="/"+decodeURIComponent(n);h.push({displayName:decodeURIComponent(n),name:n,path:""+g+b.DELIMITER})});if(i!==0){delete h[h.length-1].path}return h};this.getFolderNamesList=function(){var i=d.bucketName;var g=f.path();g=g.substring(g.indexOf(i));var h=g.split(b.DELIMITER);h.pop();return h}}])})();"use strict";(function(){angular.module("s3").service("CachingService",["S3Constants","$cacheFactory","$location",function(d,k,g){var e=k(".bucketLocationCache",{capacity:d.CACHE.SIZE.BUCKET_LOCATION});var f=k(".lambCache",{capacity:d.CACHE.SIZE.LAMB});var h=k(".accessCache",{capacity:d.CACHE.SIZE.ACCESS});var i="lamb";var l=".properties";var b=".objects";var j;var m={};var n=[];var c=[];var a=[];this.putLamb=function(o){f.put(i,o)};this.evictLamb=function(){f.removeAll()};this.getLamb=function(){return f.get(i)};this.getBucketLocation=function(o){return e.get(o)};this.putBucketLocation=function(p,o){e.put(p,o)};this.evictBucketLocation=function(o){e.remove(o)};this.getBucketProperty=function(q,p){var o=k.get(q+l);if(o){return o.get(p)}return undefined};this.putBucketProperty=function(q,p,o){if(!k.get(q+l)){k(q+l,{capacity:d.CACHE.SIZE.BUCKET_PROPERTIES})}k.get(q+l).put(p,o)};this.evictBucketProperty=function(q,p){var o=k.get(q+l);if(o){o.remove(p)}};this.evictAllBucketProperties=function(p){var o=k.get(p+l);if(o){o.removeAll()}};this.getBucketObjects=function(q,p){var o=k.get(q+b);if(o){return o.get(p)}return undefined};this.putBucketObjects=function(q,o,p){if(!k.get(q+b)){k(q+b,{capacity:d.CACHE.SIZE.LIST_OBJECTS})}k.get(q+b).put(o,p)};this.evictBucketObjects=function(p){var o=k.get(p+b);if(o){o.removeAll()}};this.evictAllBucketData=function(o){e.remove(o);this.evictBucketObjects(o);this.evictAllBucketProperties(o)};this.setCurrentObject=function(o){j=o};this.getCurrentObject=function(){return j};this.setCurrentVersions=function(p,o){m[p]=o};this.getMarkers=function(o,p){return c[o][p]};this.addMarker=function(o,p,q){this.addMarkersList(p,q);c[p][q].push(o)};this.addMarkersList=function(o,q){if(o>=c.length){var r=o-c.length;for(var p=0;p<=r;p++){c.push({})}}if(!c[o][q]){c[o][q]=[]}};this.returnMarkers=function(){return c};this.resetMarkers=function(){c=[]};this.resetLocationAndMarkers=function(){c=[];a=[];g.search(d.CURRENT_MARKER,null);g.search(d.CURRENT_VERSIONS_ID_MARKER,null);g.search(d.CURRENT_VERSIONS_KEY_MARKER,null)};this.getVersionMarkers=function(o,p){return a[o][p]};this.addVersionMarker=function(o,p,q,r){this.addVersionMarkersList(p,q);a[p][q].push({marker:o,id:r})};this.addVersionMarkersList=function(o,q){if(o>=a.length){var r=o-a.length;for(var p=0;p<=r;p++){a.push({})}}if(!a[o][q]){a[o][q]=[]}};this.returnVersionMarkers=function(){return a};this.resetVersionMarkers=function(){a=[]};this.initializeMarkers=function(p){if(p.length>c.length){var q=p.length-c.length;for(var o=0;o<q;o++){c.push({})}}if(!c[p.length-1][p[p.length-1]]){c[p.length-1][p[p.length-1]]=[]}if(p.length>a.length){var q=p.length-a.length;for(var o=0;o<q;o++){a.push({})}}if(!a[p.length-1][p[p.length-1]]){a[p.length-1][p[p.length-1]]=[]}};this.getCurrentVersions=function(o){return m[o]};this.deleteCurrentVersions=function(o){delete m[o]};this.setPageOfDeletedObjects=function(p,o){n[o]=p};this.getPageOfDeletedObjects=function(o){return n[o]};this.resetDeletedObjects=function(){n=[]};this.getAccessAnalysis=function(o){return h.get(o)};this.putAccessAnalysis=function(p,o){h.put(p,o)};this.evictAccessAnalysis=function(o){h.remove(o)}}])})();"use strict";(function(){angular.module("s3").service("UploadRequestsService",["$q","S3Constants","S3CWSAPIService","APIProxyService","SCLogService","XMLParser",function(b,c,e,f,d,a){this.initiateMultipartUpload=function(i,k,j,h,g){return f.initiateMultipartUpload(k,i,j,h,g).then(function(m){var l=m.response;var n=m.headers();l=a.convertXmlStringToJson(l);if(l&&l.InitiateMultipartUploadResult&&l.InitiateMultipartUploadResult.UploadId){d.logS3("InitiateMultipart",1,g,n[c.HEADERS.X_AMZ_ID_2],n[c.HEADERS.X_AMZ_REQUEST_ID],m);return l.InitiateMultipartUploadResult.UploadId}d.logS3("InitiateMultipart",0,g,n[c.HEADERS.X_AMZ_ID_2],n[c.HEADERS.X_AMZ_REQUEST_ID],m);return b.reject(l)},function(l){var n=l.headers();var m=Number(l.status<c.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD);d.logS3("InitiateMultipart",m,g,n[c.HEADERS.X_AMZ_ID_2],n[c.HEADERS.X_AMZ_REQUEST_ID],l);return b.reject(l)})};this.completeMultipartUpload=function(n,g,m,h,j,i){var k="<CompleteMultipartUpload>";for(var o in h){var l="<Part><PartNumber>"+o+"</PartNumber>";l+="<ETag>"+h[o]+"</ETag>";l+="</Part>";k+=l}k+="</CompleteMultipartUpload>";return f.completeMultipartUpload(g,n,k,m,j,i).then(function(p){var q=p.headers();if(p.response&&p.response.CompleteMultipartUploadResult){d.logS3("CompleteMultipartUpload",1,i,q[c.HEADERS.X_AMZ_ID_2],q[c.HEADERS.X_AMZ_REQUEST_ID],p);return p.response.CompleteMultipartUploadResult}d.logS3("CompleteMultipartUpload",0,i,q[c.HEADERS.X_AMZ_ID_2],q[c.HEADERS.X_AMZ_REQUEST_ID],p);return b.reject({statusText:p.response})},function(p){var q=p.headers();d.logS3("CompleteMultipartUpload",0,i,q[c.HEADERS.X_AMZ_ID_2],q[c.HEADERS.X_AMZ_REQUEST_ID],p);return b.reject({statusText:p.response.Error.Message})})};this.generatePresignedUrlForUpload=function(i,l,h,k,j,g){return e.fetchPresignedUrl(l,i,"PUT",{},k,h,j).then(function(m){if(m.data&&m.data.presignedUrl){d.log("UploadPresignedUrl",1,g,m);return m}if(Array.isArray(_.get(m,"error"))&&m.error[0]===c.SESSION_TIMEOUT_MESSAGE){d.log("UploadPresignedUrl",1,g,m)}else{d.log("UploadPresignedUrl",0,g,m)}return b.reject(m)},function(m){var n=Number(m.status<c.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD);d.log("UploadPresignedUrl",n,g,m);return b.reject(m)})}}])})();"use strict";(function(){angular.module("s3").service("ReadAndSendBlobService",["$http","$q","$window","S3Constants","SCLogService",function(h,b,g,c,d){var f="UploadPut";this.readAndPutBlobToUrl=function(m,r,j,l,p,n){var o=b.defer();if(l&&!l[c.HEADERS.CONTENT_TYPE]){l["Content-Type"]=undefined}var q={method:"PUT",url:j,data:r,headers:l,timeout:p,uploadEventHandlers:{progress:function i(s){if(s.lengthComputable){if(s.loaded&&s.total){o.notify({fileId:m,uploadedBytes:s.loaded,totalBytes:s.total})}}}},transformRequest:[]};d.log("UploadReader",1,n,q);var k=g.Date.now();h(q).then(e(o,n,k),a(o,n));return o.promise};var e=function e(i,j,k){return function(m){var l=g.Date.now();i.resolve(m);d.log(f+"Time",l-k,j);var n=m.headers();d.logS3(f+"Request",1,j,n[c.HEADERS.X_AMZ_ID_2],n[c.HEADERS.X_AMZ_REQUEST_ID],m)}};var a=function a(i,j){return function(k){var m=k.headers();d.log(""+f+c.REQUEST_METRICS.STATUS_CODE_INFIX+k.status,1,j,k);var l=Number(k.status<c.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD);d.logS3(f+"Request",l,j,m[c.HEADERS.X_AMZ_ID_2],m[c.HEADERS.X_AMZ_REQUEST_ID]);if(k.status===-1){k.statusText="OptionsRequestDenied"}else{if(k.status===0){k.statusText="OptionsResponseMissingHeaders"}}i.reject(k)}}}])})();"use strict";(function(){angular.module("s3").service("UploadService",["$http","$q","$timeout","$translate","CachingService","S3Constants","FileUpload","UploadRequestsService","ReadAndSendBlobService","SCLogService","UploadVerificationService","UtilService",function(o,a,D,x,p,H,G,m,F,e,l,t){var c=0;var h={};var j=function j(){c++;return c};var v=function v(L){if(h[L]){D.cancel(h[L].timeoutPromise)}};function n(N,M,P,O,L){O.uploadedEtag=M[0].headers().etag;O.calculatedEtag=M[1];var Q=L?"MD5MPVerification":"MD5Verification";if(I(M)){if(B(P.filePointer)){O.errorReason="FileChanged";e.log("UploadFileChanged",1,N,O)}else{O.errorReason="EtagsDoNotMatch";e.log(Q,0,N,O)}}else{e.log(Q,1,N,O)}}var r=function r(L,M){return function(N){v(L,M);N=t.transformObjectToArray(N);var P=N[0];var O={fileName:h[L].filePointer.name};if(!P||!P.headers()||!P.headers().etag){J(L,{statusText:"No etag was provided by S3"},M)}else{if(z(M)&&M.shouldPerformETagVerification){n(M,N,h[L],O,false);if(O.errorReason){J(L,{statusText:O.errorReason},M)}else{s(L,P.headers().etag,M)}}else{s(L,P.headers().etag,M)}}}};var I=function I(L){var M=L[1];var N=L[0].headers().etag;return M!==N.substring(1,N.length-1)};var B=function B(L){return L.lastModified&&L.lastModified!==L.initialLastModified};var K=function K(M,L){if(h[L].isCancelled){return x.instant("upload.cancelled")}var N=t.transformObjectToArray(M)[0];if(N.statusText){return N.statusText}else{return t.handleErrors(N)}};var E=function E(L,M){return function(N){v(L,M);J(L,K(N,L),M)}};var b=function b(L,M){return function(N){s(L,N.ETag||"",M)}};var s=function s(M,O,N){var L={};L.id=M;L.name=h[M].filePointer.name;L.etag=O.substring(1,O.length-1);L.operation=N;if(Object.keys(h[M].etags).length>0){L.multiPartEtags=_.mapValues(h[M].etags,function(P){return P.substring(1,P.length-1)})}h[M].uploadDeferredObject.resolve(L);delete h[M]};var k=function k(L,M){return function(N){J(L,K(N,L),M)}};var J=function J(M,O,N){var L={};L.errorMessage=O;L.name=h[M].filePointer.name;L.id=M;L.operation=N;L.isCancelled=h[M].isCancelled;h[M].uploadDeferredObject.reject(L);delete h[M]};var z=function z(L){return !L.options.serverSideEncryption||L.options.serverSideEncryption===H.OBJECT_SSE.NONE};var g=function g(M,P,S,Q,O){var L=F.readAndPutBlobToUrl(M,h[M].filePointer,P,Q,S.promise,O);L.then(null,null,function(T){h[M].uploadedByte=T.uploadedBytes;h[M].totalBytes=T.totalBytes;d(h[M],O)});var N=undefined;if(z(O)&&O.shouldPerformETagVerification){var R=l.verifyUpload(h[M].filePointer,M,O.id);N=a.all([L,R])}else{N=L}N.then(r(M,O),E(M,O),function(T){T.destKey=h[M].destKey;T.destBucket=h[M].destBucket;T.operation=O;h[M].uploadDeferredObject.notify(T)});if(h[M]){d(h[M],O)}};var A=function A(N,L){var M=D(function(){N.cancelDeferredObject.resolve(N.id);N.errorMessage="Upload timed out."},H.UPLOAD.TIMEOUT_MSECS);N.timeoutPromise=M;m.generatePresignedUrlForUpload(N.destKey,N.destBucket,N.cancelDeferredObject.promise,{},N.headers,L).then(function(O){g(N.id,O.data.presignedUrl,N.cancelDeferredObject,N.headers,L)},function(){J(N.id,"There was an issue generating a presigned url for the upload",L)});d(N,L)};var y=function y(M,N,L){return function(){return m.generatePresignedUrlForUpload(M.destKey,M.destBucket,M.cancelDeferredObject.promise,N,undefined,L)}};var u=function u(M,P,N,L,O){return function(S){var T=M.filePointer.slice(P,N);T.name=M.filePointer.name;var Q=F.readAndPutBlobToUrl(M.id,T,S.data.presignedUrl,{},M.cancelDeferredObject.promise,L);Q.then(null,null,function(V){M.uploadedByte=V.uploadedBytes+(O-1)*H.UPLOAD.PART_SIZE_IN_BYTES;M.totalBytes=M.totalBytes;d(M,L)});var R=undefined;if(!L.options.serverSideEncryption||L.options.serverSideEncryption===H.OBJECT_SSE.NONE){var U=l.verifyUpload(T,M.id,L.id);R=a.all([Q,U])}else{R=Q}return R}};var C=function C(M,N,L){return function(O){O=t.transformObjectToArray(O);var Q=O[0];if(!Q||!Q.headers()||!Q.headers().etag){return a.reject(O[0])}var P={partNumber:N,fileName:M.filePointer.name};if(z(L)&&L.shouldPerformETagVerification){n(L,O,M,P,true);if(P.errorReason){return a.reject(O[0])}}M.incrementCompletedParts();M.uploadedByte+=Math.min(H.UPLOAD.PART_SIZE_IN_BYTES,M.totalBytes-(N-1)*H.UPLOAD.PART_SIZE_IN_BYTES);M.progress=100*M.uploadedByte/M.totalBytes;M.addEtag(N,Q.headers().etag)}};var q=function q(S,T,P,N){var U=0;var M=H.UPLOAD.PART_SIZE_IN_BYTES;var L=function L(V){if(V){V.operation=N;S.uploadDeferredObject.notify(V)}};var Q=function Q(V){P.reject(V)};S.uploadedByte=0;S.totalBytes=S.filePointer.size;var O;for(var R=1;R<=S.numberOfParts;R++){if(O){O=O.then(y(S,{uploadId:T,partNumber:R},N))}else{O=y(S,{uploadId:T,partNumber:R},N)()}O=O.then(u(S,U,M,N,R)).then(C(S,R,N),Q,L);U+=H.UPLOAD.PART_SIZE_IN_BYTES;M+=H.UPLOAD.PART_SIZE_IN_BYTES}if(!O){P.reject({statusText:x.instant("utilities.unknown.error")});return}O.then(function(){P.resolve(T)})};var d=function d(N,M){var L={};L.destKey=N.destKey;L.destBucket=N.destBucket;L.id=N.id;L.fileName=N.filePointer.name;L.uploadedByte=N.uploadedByte;L.totalBytes=N.totalBytes;L.progress=N.completedParts/N.numberOfParts*100;L.operation=M;N.uploadDeferredObject.notify(L)};var w=function w(M,L){return function(O){var N=a.defer();d(M,L);q(M,O,N,L);return N.promise}};var i=function i(M,L){if(M.numberOfParts>H.UPLOAD.MAX_NUMBER_OF_PARTS||M.numberOfParts<=H.UPLOAD.MIN_NUMBER_OF_PARTS){k(M.id,L)({statusText:"A multipart upload needs between 2 and 10000 parts to be a valid upload."});return}var N=m.initiateMultipartUpload(M.destKey,M.destBucket,M.headers,M.cancelDeferredObject.promise,L);N.then(w(M,L)).then(function(O){return m.completeMultipartUpload(M.destKey,M.destBucket,O,M.etags,M.cancelDeferredObject.promise,L)}).then(b(M.id,L))["catch"](k(M.id,L))};var f=function f(M,L){e.log("UploadFileSize",M.filePointer.size,L,{name:M.filePointer.name});if(M.filePointer.size<=H.UPLOAD.PART_SIZE_IN_BYTES){A(M,L)}else{i(M,L)}};this.upload=function(O,T,M,N,P,V){if(!M){e.log("UploadNoBucketError",1,P);return}p.evictBucketObjects(M);if(!N||h[N]!==undefined){e.log("InvalidUploadFileId",1,P);return}var S=a.defer();var Q=a.defer();var U=O.name;if(T){U=T+U}var L=angular.copy(V);if(!L.metadata["Content-Type"]){L.metadata["Content-Type"]=t.getContentType(O)}var R=new G(N,O,S,Q,U,M,L,H.UPLOAD.PART_SIZE_IN_BYTES);h[N]=R;f(R,P);p.deleteCurrentVersions(U);return R.uploadDeferredObject.promise};this.cancelUpload=function(M,L){if(h[M]){h[M].cancelDeferredObject.resolve(M);h[M].isCancelled=true;e.log("UploadCancel",1,L)}else{e.log("UploadCancel",0,L)}};this.fileSelected=function(){return j()}}])})();"use strict";(function(){angular.module("s3").service("DirectoryExplorerService",["$q","ConsoleOperation","S3Constants","SCLogService","UploadService","UtilService",function(n,h,k,a,i,p){var s={createExplorer:l,processFile:c};var f="CreatedExplorer",q="ExplorerTraversalComplete",e="GetFolderSize",b="InitialFolderTraversal",j="OverrideFolders",m="SkipOverriddenFolder";return s;function l(L,J){var B=n.defer(),E=J.explorers.length+1,A={getNext:C,getSelectedItems:F,explorerId:E,setOverriddenFolders:u,operation:J};var z=undefined,H=[],t=[],G=[],O=[],M=0,w=undefined,x=undefined,v=undefined,D={},P=true,K=L.length;for(var R=0;R<K;R++){z=L[R].webkitGetAsEntry();if(z.isDirectory){H.push(z)}else{o(z,G,t,"",J).then(function(){M++},function(T){a.log(J.name+f,0,J,{error:T,explorerId:E});B.reject(T)})}}for(var Q in H){var S=n.defer();w=H[Q];N(w,d(w.createReader()),0,0,p.createQueue(),S);t.push(S.promise);S.promise.then(function(T){O.push(T);if(T.objsCount===0){M++}})}n.all(t).then(function(){v=p.createQueue(H);w=undefined;x=undefined;a.log(J.name+f,1,J,{explorerId:E,selectedItems:F()});B.resolve(A)},function(T){a.log(J.name+f,0,J,{error:T,explorerId:E});B.reject(T)});function N(U,T,Z,Y,W,X){var V=[];T.readEntries(function(aa){var ac=undefined;if(aa.length===0){if(W.getLength()===0){a.log(J.name+b,1,J,{explorerId:E,folderSize:Z,folderName:U.name,fullPath:U.fullPath,objsCount:Y});X.resolve(r(U,Z,Y))}else{var ae=d(W.dequeue().createReader());N(U,ae,Z,Y,W,X)}return}for(var ab in aa){ac=aa[ab];if(ac.isDirectory){W.enqueue(ac)}else{Y++;M++;var ad=g(ac);V.push(ad);ad.then(function(af){Z+=af})}}n.all(V).then(function(){N(U,T,Z,Y,W,X)},function(ag){var af=r(U,Z,Y);a.log(J.name+e,0,J,{error:ag,explorerId:E,folder:af});X.resolve(af)})},function(aa){a.log(J.name+b,0,J,{error:aa,explorerId:E});X.reject(aa)})}function C(){var T=n.defer();if(!w){w=I();x=w?d(w.createReader()):undefined}if(!x){if(v.getLength()===0){a.log(J.name+q,1,J,{explorerId:E,selectedItems:F()});T.resolve(undefined);return T.promise}else{w=I();x=d(w.createReader());P=true}}y(T,J);return T.promise}function y(W,U){var X=undefined,V=[],T=[];x.readEntries(function(aa){var Y=undefined;if(aa.length===0){if(P){Y=r(w,0,0)}w=I();x=w?d(w.createReader()):undefined;P=true}else{P=false}for(var Z in aa){X=aa[Z];if(X.isDirectory){v.enqueue(X)}else{o(X,V,T,w.fullPath.substr(1)+"/",U)}}n.all(T).then(function(){W.resolve({fileList:V,emptyFolderToBeUploaded:Y})},function(ab){a.log(U.name+q,0,U,{error:ab,explorerId:E});W.reject(ab)})},function(Y){a.log(U.name+q,0,U,{error:Y,explorerId:E});W.reject(Y)})}function F(){return{currFolderPathPrefix:"",folders:O,objects:G,totalObjCount:M}}function u(T){for(var U in T){D[T[U]]=true}a.log(J.name+j,1,J,{explorerId:E,originalFolders:F().folders,newlyOveriddenFolders:T})}function I(){var T=v.dequeue();while(T){if(T.fullPath!=="/"+T.name||!D[T.name]){return T}else{a.log(J.name+m,1,J,{explorerId:E,skippedFolderName:T.name});T=v.dequeue()}}}return B.promise}function c(u,v,t){return{file:u,fullPath:t,id:v,Key:u.name,Size:u.size}}function r(t,w,v){var u=t.fullPath.substr(1);u=u.substr(0,u.length-t.name.length-1);u=u===""?u:u+"/";return{folderSize:w,fullPath:u,Prefix:t.name,objsCount:v||1}}function o(y,x,v,w,u){var t=n.defer();v.push(t.promise);y.file(function(A){var z=i.fileSelected(A,u);x.push(c(A,z,w));t.resolve()},function(z){t.reject(z)});return t.promise}function g(u){var t=n.defer();u.file(function(v){t.resolve(v.size)});return t.promise}function d(t){var v=3;var w=[];function u(y,x){if(w.length===0){t.readEntries(function(z){if(z.length>v){w=z;y(w.splice(0,v))}else{y(z)}},x)}else{y(w.splice(0,v))}}return{readEntries:u}}}])})();"use strict";(function(){angular.module("s3").controller("UploadController",["$scope","$rootScope","$translate","$window","APIProxyService","ConsoleOperation","DirectoryExplorerService","FAC","ObjectPropertiesService","OperationDispatcherService","PathService","S3Constants","SCLogService","UploadOperationService","UtilService","XMLParser",a]);function a(y,q,z,u,A,t,l,r,p,i,f,x,e,s,D,E){var B="FilesSelectedFor",c="MultipleDropEvents",h="OverrideExplorers",g="SimultaneousDrop",o="FolderRemoved",n="FileRemoved",j="STANDARD";var d=_.cloneDeep(x.BUCKET_PERMISSIONS.INITIALIZE_ACLS);A.getBucketOwner(new t("getBucketOwner")).then(function(F){d.userPermissions[0].detail=F;y.options.permissions.userPermissions[0].detail=F});var m=D.createQueue();y.operation=null;y.S3Constants=x;y.predefinedMetadata=p.getPredefinedMetadata();y.$watchCollection("selected",function(){y.selectedItems=y.selected.selectedItems});y.$watchCollection("flags",function(){y.uploadDisabled=y.flags.uploadDisabled});y.STEP={SELECT_FILES:{name:"SELECT_FILES",value:z.instant("uploadmodal.label.selectfiles")},PERMISSIONS:{name:"PERMISSIONS",value:z.instant("uploadmodal.label.setpermissions")},PROPERTIES:{name:"PROPERTIES",value:z.instant("uploadmodal.label.setproperties")},REVIEW:{name:"REVIEW",value:z.instant("uploadmodal.label.review")}};y.state=y.STEP.SELECT_FILES;y.headerTitle=z.instant("uploadmodal.header.title");y.currentTagging={Key:"",Value:""};y.MODAL_TYPE=x.MODAL_TYPE;var w=q.$on("fileDropEvent",function(H,G){if(!y.modalOpen.flag||H.defaultFired){return}y.state=y.STEP.SELECT_FILES;y.uploadDisabled=true;if(!y.operation){y.operation=s.createUploadOperation()}var F=l.createExplorer(G,y.operation);m.enqueue(F);if(m.getLength()===1){b(m.peek())}else{e.log(y.operation.name+g,1,y.operation,{numberOfDropsToBeProcessed:m.getLength()})}});function C(J,I){var K=I?y.operation.explorers.length-1:y.operation.explorers.length,F=[];for(var H=0;H<J.length;H++){F.push(J[H].Prefix)}for(var G=0;G<K;G++){y.operation.explorers[G].setOverriddenFolders(F)}e.log(y.operation.name+h,1,y.operation,{folderNames:F,numberOfExplorersOverridden:K,selectedFilesData:y.getSelectedFilesData()})}function b(F){F.then(function(O){var M=O.getSelectedItems(),J=M.folders,P=M.objects,H=undefined,K=undefined,I=function I(Q){return H.Prefix!==Q.Prefix},G=function G(Q){return K.Key!==Q.Key};for(var N=0;N<J.length;N++){H=J[N];y.selectedItems.folders=_.filter(y.selectedItems.folders,I)}for(var L=0;L<P.length;L++){K=P[L];y.selectedItems.objects=_.filter(y.selectedItems.objects,G)}y.selectedItems.folders=y.selectedItems.folders.concat(J);y.selectedItems.objects=y.selectedItems.objects.concat(P);y.operation.explorers.push(O);if(y.operation.explorers.length>1){e.log(y.operation.name+c,1,y.operation,{newExplorerId:O.explorerId,numberOfExplorersCreated:y.operation.explorers.length,selectedItems:O.getSelectedItems()});C(J,true)}m.dequeue();if(m.getLength()>0){b(m.peek())}else{y.uploadDisabled=false}},function(G){y.error=G})}y.goToNextState=function(){if(y.state===y.STEP.SELECT_FILES){D.analyticsTrackClick(x.ANALYTICS.SELECT_UPLOAD_FILE,x.ANALYTICS.UPLOAD_FILE_S3);D.analyticsTrackView(x.ANALYTICS.SET_PERMISSIONS_UPLOAD_FILE,x.ANALYTICS.UPLOAD_FILE_S3)}else{if(y.state===y.STEP.PERMISSIONS){D.analyticsTrackClick(x.ANALYTICS.SET_PERMISSIONS_UPLOAD_FILE,x.ANALYTICS.UPLOAD_FILE_S3);D.analyticsTrackView(x.ANALYTICS.SET_PROPERTIES_UPLOAD_FILE,x.ANALYTICS.UPLOAD_FILE_S3);if(y.isAddingAwsAccountAcl.flag===true){y.isAddingAwsAccountAcl.warningMsg=z.instant("uploadmodal.awsaccounts.warningmsg");return}else{y.isAddingAwsAccountAcl.warningMsg=null}}else{if(y.state===y.STEP.PROPERTIES){D.analyticsTrackClick(x.ANALYTICS.SET_PROPERTIES_UPLOAD_FILE,x.ANALYTICS.UPLOAD_FILE_S3);D.analyticsTrackView(x.ANALYTICS.REVIEW_UPLOAD_FILE,x.ANALYTICS.UPLOAD_FILE_S3);if(!_.isEmpty(y.tmpMetadata.metadataKey)||!_.isEmpty(y.tmpMetadata.metadataValue)){y.metadataWarningMsg=z.instant("uploadmodal.metadata.warningmsg");return}else{y.metadataWarningMsg=null}if(!_.isEmpty(y.currentTagging.key)){y.taggingError=z.instant("uploadmodal.tag.warningmsg");return}else{y.taggingError=null}}}}y.nextState()};y.removeItemFromUpload=function(F){if(F.Key){y.selectedItems.objects=_.filter(y.selectedItems.objects,function(G){return F.Key!==G.Key});e.log(y.operation.name+n,1,y.operation,{fileName:F.Key})}else{if(F.Prefix){y.selectedItems.folders=_.filter(y.selectedItems.folders,function(G){return F.Prefix!==G.Prefix});C([F],false);e.log(y.operation.name+o,1,y.operation,{folderName:F.Prefix})}}if(!y.haveSelectedItems()){y.uploadDisabled=true}};y.filesSelected=function(F){if(!y.operation){y.operation=s.createUploadOperation()}y.$apply(function(){if(F&&F.files&&F.files.length>0){y.operation.newlySelectedFiles=F.files;e.log(B+y.operation.name,F.files.length,y.operation);for(var H=0;H<F.files.length;H++){var G=F.files[H],I=k(G.name),J=s.selectFile(G,y.operation);if(I>-1){y.selectedItems.objects.splice(I,1,l.processFile(G,J))}else{y.selectedItems.objects.push(l.processFile(G,J))}}y.uploadDisabled=false}})};function k(G){for(var F=0;F<y.selectedItems.objects.length;F++){if(y.selectedItems.objects[F].Key===G){return F}}return -1}y.uploadNow=function(){if(!y.operation||!y.selectedItems.objects&&!y.selectedItems.folders||y.selectedItems.objects.length===0&&y.selectedItems.folders.length===0){throw"No file selected"}D.analyticsTrackClick(x.ANALYTICS.END_UPLOAD_FILE,x.ANALYTICS.UPLOAD_FILE_S3);function F(){y.$parent.refreshWithSelection()}if(_.eq(angular.toJson(y.options.permissions),angular.toJson(d))&&(!y.options.permissions.awsAccountPermissions||y.options.permissions.awsAccountPermissions.length===0)){y.options.permissions=undefined}var H=new t(x.OPERATION_NAME.GET_DEFAULT_ENCRYPTION),G=true;A.getBucketProperty(H,f.getCurrentBucket(),"defaultEncryption").then(function(K){if(_.get(K,"response")){e.log("GetDefaultEncryptionForUpload",1,H);var J=E.convertXmlStringToJson(K.response),I=undefined;I=_.get(J,"ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.SSEAlgorithm");if(I===x.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.API_PARAMS.AWSKMS){G=false}}else{e.log("GetDefaultEncryptionForUpload",0,H)}})["catch"](function(I){if(I!==x.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.NOT_FOUND_ERROR){e.log("GetDefaultEncryptionForUpload",0,H);G=false}else{e.log("GetDefaultEncryptionForUpload",1,H)}})["finally"](function(){s.setupUploadOperation(y.operation,y.selectedItems.folders,y.selectedItems.objects,y.getSelectedFilesData(),y.options,F,G);y.clearFileInput();i.addOperation(y.operation);y.closeModal();y.selected.selectedItems={currFolderPathPrefix:"",folders:[],objects:[]};y.resetOptions()})};y.clearFileInput=function(){var F=$("#uploadInput");if(F&&F.get(0)){F.wrap("<form>").closest("form").get(0).reset();F.unwrap()}};y.closeModal=function(){if(y.state===y.STEP.SELECT_FILES){y.clearFileInput()}y.state=y.STEP.SELECT_FILES;y.selected.selectedItems={currFolderPathPrefix:"",folders:[],objects:[]};y.modalOpen.flag=false;y.uploadDisabled=true;y.operation=undefined;y.resetOptions()};y.haveSelectedItems=function(){return y.selectedItems&&y.selectedItems.folders&&!_.isEmpty(y.selectedItems.folders)||y.selectedItems&&y.selectedItems.objects&&!_.isEmpty(y.selectedItems.objects)};y.addMetadataOptionsHeader=function(I){y.metadataErrorMsg="";y.metadataWarningMsg=null;if(p.isValid([I])){var G=p.getMetadataMap([I]);var H=Object.keys(G)[0];var F=y.predefinedMetadata[_.findIndex(y.predefinedMetadata,{value:H})];if(_.isEmpty(F)){F=H}else{F=F.text}if(Object.keys(y.options.metadata).indexOf(H)>-1){y.metadataErrorMsg=F}else{y.options.displayMetadata[F]=G[H];y.options.metadata[H]=G[H];y.tmpMetadata={}}}};y.clearMetadataErrorMsg=function(F){F.inputError=null};y.metaErrorReset=function(){y.metadataErrorMsg=""};y.resetMetadataOptionsHeader=function(){y.tmpMetadata={};y.metadataErrorMsg=null;y.metadataWarningMsg=null};y.resetTagKeyValue=function(){y.currentTagging.key="";y.currentTagging.value="";y.taggingError=null};y.deleteMetadataHeader=function(F){var G=y.predefinedMetadata[_.findIndex(y.predefinedMetadata,{text:F})];if(_.isEmpty(G)){G=F}else{G=G.value}delete y.options.displayMetadata[F];delete y.options.metadata[G]};y.addTag=function(F,G){if(_.isEmpty(F)){return}if(Object.keys(y.options.tags).indexOf(F)>-1){y.taggingError=z.instant("objectproperties.tags.duplicatekeynames");return}if(Object.keys(y.options.tags).length>=x.TAGGING.MAX_ALLOWED_TAGS){y.taggingError=z.instant("objectproperties.tags.morethantentagswarning");return}y.taggingError=null;y.options.tags[F]=G;y.currentTagging={Key:"",Value:""}};y.deleteTag=function(F){delete y.options.tags[F]};y.updateTaggingError=function(F){if(Object.keys(y.options.tags).indexOf(F)>-1||Object.keys(y.options.tags).length>=x.TAGGING.MAX_ALLOWED_TAGS){return}y.taggingError=null};y.resetOptions=function(){y.isAddingAwsAccountAcl={flag:false};y.options={};y.metadataHeaders={};y.metadataErrorMsg="";y.errorMessage=null;y.KMSServiceError=null;y.metadataHeaders.acceptedHeaders=[];y.tmpMetadata={};y.options.metadata={};y.options.displayMetadata={};y.options.tags={};y.taggingError=null;y.currentTagging={Key:"",Value:""};y.options.permissions=_.cloneDeep(d);y.metadataHeaders.headerNames=[x.HEADERS.CACHE_CONTROL,x.HEADERS.CONTENT_DISPOSITION,x.HEADERS.CONTENT_ENCODING,x.HEADERS.CONTENT_LENGTH,x.HEADERS.CONTENT_TYPE,x.HEADERS.EXPECT,x.HEADERS.EXPIRES,x.HEADERS.X_AMZ_WEBSITE_REDIRECT_LOCATION];y.metadataHeaders.headers=[];for(var G in y.metadataHeaders.headerNames){var F=y.metadataHeaders.headerNames[G];y.metadataHeaders.headers.push({value:F,text:F,disabled:false})}};y.getSelectedFilesData=function(){if(!y.selectedItems){return{files:0,size:0}}var F=0,J=0,K=undefined,H=undefined;for(var I in y.selectedItems.folders){K=y.selectedItems.folders[I];J+=K.objsCount;F+=K.folderSize}for(var G in y.selectedItems.objects){H=y.selectedItems.objects[G];J++;F+=H.Size}return{files:J,size:F}};y.getGranteeCount=function(){var F=0;Object.keys(y.options.permissions).forEach(function(G){y.options.permissions[G].forEach(function(H){if(_.findKey(H.permissions,function(I){return I===true})!==undefined){F++}})});return F};y.$on("$destroy",function(){w()});y.resetOptions();y.getStorageClassTranslation=function(){return D.getStorageClassTranslations()[y.options.storageClass]};y.getEncryptionTranslation=function(){var F=y.options.serverSideEncryption===x.OBJECT_SSE.NONE?"uploadmodal.review.encryption.no":"uploadmodal.review.encryption.yes";return z.instant(F)};y.setStorageClassOption=function(){if(!y.options.storageClass){y.options.storageClass=j}};y.updateKMSKey=function(F){if(F===x.OBJECT_SSE.KMS_ENCRYPTION){v()}else{if(!_.isEmpty(y.errorMessage)&&y.errorMessage===y.KMSServiceError){y.errorMessage=null}y.KMSServiceError=null}};y.setEncryptionOption=function(){if(!y.options.serverSideEncryption){if(r.isFeatureEnabled(x.FAC.NO_ENC)){y.options.serverSideEncryption=x.OBJECT_SSE.NONE}else{y.options.serverSideEncryption=x.OBJECT_SSE.AES256}}};function v(){y.kmsKeys=[];var G=new t("GetKMSKeysForUpload");var F={};A.getKmsKeys(G,f.getCurrentBucket(),F).then(function(I){var H=I.response.Keys;e.log("GetKMSKeys",1,G);angular.forEach(H,function(J,K){y.kmsKeys.push({value:J.KeyId,text:D.getKmsKeyAlias(J)})});y.kmsKeys.push({value:x.UPLOAD.CUSTOM_ARN,text:z.instant("uploadmodal.kms.customarn")});if(y.errorMessage===y.KMSServiceError){y.errorMessage=null}y.KMSServiceError=null})["catch"](function(H){y.KMSServiceError=D.handleErrors(H);y.errorMessage=D.handleErrors(H);e.log("GetKMSKeys",0,G,H)})}y.isDragAndDropAvailable=function(){return u.DataTransferItem!==undefined}}angular.module("s3").directive("uploadModal",[function(){return{scope:{modalOpen:"=",currentPath:"=",fetchObjects:"=",operation:"=",selected:"=",flags:"="},templateUrl:"/s3/partials/upload.html",controller:"UploadController"}}])})();"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};angular.module("s3").factory("SCLogService",["$filter","$location","AWSC","CachingService","ConsoleOperation","PathService","Region","S3Constants","UtilService",function(r,h,t,e,m,b,c,s,w){var a={unit:"",metricType:"",logLevel:""},p={explorers:true};function n(y){var x;for(x=0;x<y.length;++x){if(y[x]===undefined||y[x]===null){return false}}return true}function o(y,z){if(z!==null&&(typeof z==="undefined"?"undefined":_typeof(z))==="object"){for(var x in z){if(z.hasOwnProperty(x)&&!a.hasOwnProperty(x)){y[x]=z[x]}}}}function u(x,y){if(y!==undefined&&y!==null){for(var z in a){if(a.hasOwnProperty(z)&&y.hasOwnProperty(z)){x[z]=y[z]}}}}function j(y,z){for(var x in z){if(z.hasOwnProperty(x)){y[x]=z[x]}}}function f(H,G,B,E,C,A){var D={};D[s.OPERATION.NAME]=B.name;D[s.OPERATION.ID]=B.id;D[s.OPERATION.STEP]=B.step;D[s.OPERATION.INITIAL_BUCKET]=B.initialBucket;D[s.OPERATION.INITIAL_PATH]=B.initialPath;D[s.OPERATION.BUCKET_REGION]=B.bucketRegion;var y=Object.keys(B);for(var z in y){if(!p[y[z]]){D[y[z]]=B[y[z]]}}if(!(E instanceof Date)){E=new Date()}D[s.OPERATION.TIMESTAMP]=r("date")(E,"yyyy-MM-dd-HH-mm-ss.sss","UTC");D[s.OPERATION.CURRENT_BUCKET]=b.getCurrentBucket()||"";D[s.OPERATION.CURRENT_PATH]=b.getCurrentAbsoluteFolderPath()||"";j(D,C);o(D,A);var x="";if(D[s.OPERATION.CURRENT_BUCKET]){x=e.getBucketLocation(D[s.OPERATION.CURRENT_BUCKET])}var F={key:H,value:G,detail:JSON.stringify(D).replace(/\\\"/g," "),pageId:s.CLOG_PAGE_ID};u(F,A);t.Clog.log(F);return true}function i(x,A,C,z,y){if(!(C instanceof m)){return false}var B=[x,A,C,C.name,C.id,C.initialBucket,C.initialPath];if(!n(B)){return false}return f(x,A,C,y,{},z)}return{log:i,logCws:function d(y,B,E,x,A,z){if(!(E instanceof m)){return false}var C=[y,B,E.name,E.id,E.initialBucket,E.initialPath,x];if(!n(C)){return false}var D={};D[s.OPERATION.CWS_OP_ID]=x;return f(y,B,E,z,D,A)},logS3:function g(F,E,A,D,B,y,C){if(!(A instanceof m)){return false}var x=[F,E,A,A.name,A.id,A.initialBucket,A.initialPath,D,B];if(!n(x)){return false}var z={};z[s.S3_RESPONSE_HEADERS.X_AMZ_ID_2]=D;z[s.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID]=B;return f(F,E,A,C,z,y)},logWithSimplifiedOperation:function q(y,A,B){if(!(B instanceof m)){return false}var z={};z[s.OPERATION.ID]=B.id;z[s.OPERATION.TIMESTAMP]=r("date")(new Date(),"yyyy-MM-dd-HH-mm-ss.sss","UTC");var x={key:y,value:A,detail:JSON.stringify(z).replace(/\\\"/g," "),pageId:s.CLOG_PAGE_ID};t.Clog.log(x)},logRequestReceived:function k(y){var x=new m(y,"requestReceived");i(y,1,x);return x},logRequestComplete:function v(y,x){x.step="requestComplete";i(y,1,x)},setEndpoint:function l(){var y=w.getAWSCMezzRegion();var x=c.DOMAINS.PUBLIC;if(y&&w.getCloudSystem()===x.NAME&&h.host().indexOf(s.LBR_ENDPOINTS.PUBLIC)===0){t.Clog.setEndpointOverride("https://"+y+"."+x.PROD)}}}}]);"use strict";(function(){angular.module("s3").factory("UUIDService",[function(){return{generateUUID:function a(){var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var c=Math.floor(Math.random()*16);return(d==="x"?c:c&3|8).toString(16)});return b}}}])})();"use strict";(function(){angular.module("s3").service("ObjectListingService",["$q","ConsoleOperation","ListVerificationService","S3Constants","PathService","APIProxyService","SCLogService","XMLParser",function(h,i,b,f,k,a,m,j){var g={getBatchOfItems:c,listObjects:e,listObjectVersions:d,tagQuery:l};var n=undefined;return g;function e(s,p,o,q,r){var t={bucket:k.getCurrentBucket(),prefix:s,marker:p,maxKeys:o,delimiter:q,cacheAllowed:r};return a.listObjects(new i("listObjects"),t)}function d(t,p,r,o,q,s){var u={bucket:k.getCurrentBucket(),prefix:t,keyMarker:p,maxKeys:o,delimiter:q,cacheAllowed:s};if(r){u.versionIdMarker=r}return a.listVersions(new i("listObjects"),u)}function l(q,s,r){var p={TagQuery:{MaxKeys:s,IncludeTags:true,ContinuationToken:r,And:{Filter:[]}}};var o="";angular.forEach(q,function(t){var v=t.tagKey,w=t.tagVal,u=w.split(", ");p.TagQuery.And.Filter.push({Key:v,Or:{Value:u}})});o=j.jsonToXml(p);return a.tagQuery(new i("tagQuery"),k.getCurrentBucket(),o)}function c(u,w,A,r,q,z,x,s){if(!b.verifyPrefixesToBeListed(u,x)){m.log("BulkOpPrefixesMalformed",1,u);return h.reject({error:"Bulk operation prefixes malformed"})}var t={bucket:u.initialBucket,maxKeys:A,cacheAllowed:r};if(!s){n=A}s=s?s:{keys:[],truncated:false};var y=undefined;if(w){for(y=0;y<x.length;y++){if(!x[y].folderListed&&w.indexOf(x[y].Prefix)===0){t.prefix=x[y].Prefix;break}}if(q){t.keyMarker=w;t.versionIdMarker=z}else{t.marker=w}}else{for(y=0;y<x.length;y++){if(!x[y].folderListed){t.prefix=x[y].Prefix;break}}if(x[x.length-1].folderListed===true){s.truncated=false;var o=h.defer();o.resolve(s);return o.promise}}if(q===true){m.log("getBatchOfVersionsReceived",1,u,t);return a.listVersions(u,t).then(function(C){var B=C.response.ListVersionsResult;m.log("getBatchOfVersionsComplete",1,u,t);var p=[];if(B.Version){p=p.concat(B.Version)}if(B.DeleteMarker){p=p.concat(B.DeleteMarker)}return v(p,B.IsTruncated,B.NextKeyMarker,B.NextVersionIdMarker)})["catch"](function(p){t.error=p;m.log("getBatchOfVersionsComplete",0,u,t);return h.reject(p)})}else{m.log("getBatchOfObjectsReceived",1,u,t);return a.listObjects(u,t).then(function(B){var p=B.response.ListBucketResult;m.log("getBatchOfObjectsComplete",1,u,t);return v(p.Contents,p.IsTruncated,p.NextMarker)})["catch"](function(p){t.error=p;m.log("getBatchOfObjectsComplete",0,u,t);return h.reject(p)})}function v(E,p,D,B){if(E){s.keys=s.keys.concat(E);var C=_.uniq(_.pluck(s.keys,"Key"));if(b.verify(C,x)===false){if(b.verifyEmptyKeyInSelectedPrefixes(C,x)){m.log("batchListVerification",1,u,t);m.log("emptyKeyBatchListVerification",1,u,t)}else{m.log("batchListVerification",0,u,t)}s.error="List verification failed.";return h.reject(s)}else{m.log("batchListVerification",1,u,t)}}else{if(t.prefix!==""){a.headObject(u,u.initialBucket,t.prefix).then(function(){m.log("prefixNotExistForListing",0,u)})["catch"](function(){m.log("prefixNotExistForListing",1,u)})}}if(p==="true"){s.marker=D;if(B){s.versionIdMarker=B}s.truncated=true;return s}else{var F=undefined;for(F=0;F<x.length;F++){if(x[F].Prefix===t.prefix){x[F].folderListed=true;break}}s.truncated=F<x.length-1;if(s.keys.length===n||!s.truncated){return s}else{return c(u,null,A-E.length,r,q,null,x,s)}}}}}])})();"use strict";(function(){angular.module("s3").service("ListDeletedObjectsService",["$q","APIProxyService","CachingService","ConsoleOperation","S3Constants","UtilService",a]);function a(f,c,b,h,d,j){var g={fetchDeletedPageOfObjects:i,listDeletedObjects:e};return g;function e(p,q,o){var n=arguments.length<=3||arguments[3]===undefined?d.LIST_OBJECTS_MAX_KEYS_PER_LISTING:arguments[3];var r=arguments.length<=4||arguments[4]===undefined?{}:arguments[4];var k=arguments.length<=5||arguments[5]===undefined?d.LIST_DELETED_OBJECTS_MAX_KEYS_PER_LISTING:arguments[5];var m=arguments.length<=6||arguments[6]===undefined?d.DELIMITER:arguments[6];var l=f.defer();if(!o){o={cachedDeletedFiles:[],cachedFolders:[],deletedFiles:[],folders:[]}}r.bucket=p.initialBucket;r.delimiter=m;r.maxKeys=k;r.prefix=q;c.listVersions(p,r).then(function(u){var s=_.get(u,"response.ListVersionsResult");if(s){if(s.CommonPrefixes){var v=j.transformObjectToArray(s.CommonPrefixes);angular.forEach(v,function(w){if(!_.isEmpty(q)&&w.Prefix.lastIndexOf(q)!==-1){w.Prefix=w.Prefix.substring(w.Prefix.lastIndexOf(q)+q.length)}if(o.deletedFiles.length+o.folders.length<n){o.folders.push(w)}else{o.cachedFolders.push(w)}})}if(s.DeleteMarker){var t=j.transformObjectToArray(s.DeleteMarker);angular.forEach(t,function(w){if(j.convertStringToBoolean(w.IsLatest)){if(w.Key.lastIndexOf("/")!==-1){w.Key=w.Key.substring(w.Key.lastIndexOf(d.DELIMITER)+1)}w.Size="";w.StorageClass="";if(o.deletedFiles.length+o.folders.length<n){o.deletedFiles.push(w)}else{o.cachedDeletedFiles.push(w)}}})}o.IsTruncated=s.IsTruncated;if(s.IsTruncated==="true"){if(o.deletedFiles.length+o.folders.length<n){r.keyMarker=s.NextKeyMarker;r.versionIdMarker=s.NextVersionIdMarker;e(p,q,o,n,r).then(function(w){l.resolve(w)},function(w){l.reject(w)})}else{o.NextKeyMarker=s.NextKeyMarker;o.NextVersionIdMarker=s.NextVersionIdMarker;l.resolve(o)}}else{l.resolve(o)}}else{l.reject()}},function(s){l.reject(s)});return l.promise}function i(q,t,s,n){var v=f.defer(),r=b.getPageOfDeletedObjects(t);var m=d.LIST_OBJECTS_MAX_KEYS_PER_LISTING,l={keyMarker:s,versionIdMarker:n};if(r){m=m-(r.Contents.length+r.CommonPrefixes.length)}if(m>=0){e(new h(d.LIST_DELETED_OBJECTS),q,null,m,l).then(function(w){if(r){w.deletedFiles=r.Contents.concat(w.deletedFiles);w.folders=r.CommonPrefixes.concat(w.folders)}v.resolve(w)},function(w){v.reject(w)})}else{var k=r.CommonPrefixes,p=r.Contents,o={cachedDeletedFiles:[],cachedFolders:[],deletedFiles:[],folders:[],IsTruncated:"true",NextKeyMarker:s,NextVersionIdMarker:n};if(k.length>d.LIST_OBJECTS_MAX_KEYS_PER_LISTING){o.folders=k.slice(0,d.LIST_OBJECTS_MAX_KEYS_PER_LISTING);o.cachedFolders=k.slice(d.LIST_OBJECTS_MAX_KEYS_PER_LISTING);o.cachedDeletedFiles=p}else{var u=d.LIST_OBJECTS_MAX_KEYS_PER_LISTING-k.length;o.folders=k;o.deletedFiles=p.slice(0,u);o.cachedDeletedFiles=p.slice(u)}v.resolve(o)}return v.promise}}})();"use strict";(function(){angular.module("s3").service("ListVerificationService",["S3Constants",function(b){function a(g,f){return g.indexOf(f)===0}function e(g,f){return g.length>0&&g.lastIndexOf(f)===g.length-f.length}function c(h,g){var f=h.indexOf(g);return f>=0&&f===h.lastIndexOf(g)}function d(f){return f.name===b.OPERATION_NAME.DELETE_BUCKET||f.name===b.OPERATION_NAME.EMPTY_BUCKET}this.verifyPrefixesToBeListed=function(f,k){if(d(f)){return k.length===1&&k[0].Prefix===""}else{for(var g in k){var j=k[g];var i=undefined;if(f.initialPath.length===0){i=j.Prefix}else{var h=j.Prefix.split(f.initialPath);i=h[1];if(h.length===3&&i.lastIndexOf(b.DELIMITER)===-1){i=""+h[1]+f.initialPath}}if(!(a(j.Prefix,f.initialPath)&&c(i,b.DELIMITER)&&e(i,b.DELIMITER))){return false}}return true}};this.verify=function(l,f){if(!l){throw"keys is undefined."}if(l&&!angular.isArray(l)){l=new Array(l)}for(var k=0;k<l.length;k++){var h=false;for(var g=0;g<f.length;g++){if(a(l[k],f[g].Prefix)){h=true;break}}if(!h){return false}}return true};this.verifyEmptyKeyInSelectedPrefixes=function(k,f){var m=_.find(k,function(i){return i===""});if(m!==undefined){var o=_.find(f,function(i){return i.Prefix===""});if(o===undefined){var n=[];for(var l=0;l<k.length;l++){var h=false;for(var g=0;g<f.length;g++){if(_.startsWith(k[l],f[g].Prefix)){h=true;break}}if(!h){n.push(k[l])}if(n.length>1){break}}return n.length===1&&n[0]===""}}return false}}])})();"use strict";(function(){angular.module("s3").factory("ConsoleOperation",["$q","CachingService","KeySelectionService","PathService","S3Constants","UtilService","UUIDService",function(d,c,f,h,e,b,a){function g(an,X){var aa=a.generateUUID();var H=h.getCurrentBucket()||"";var A=c.getBucketLocation(H)||"";var ay=h.getCurrentAbsoluteFolderPath()||"";var L={};var K="";var ai="";var k="";var v="";var al=d.defer();var aI=0;var B=0;var i=0;var t="";var aG=0;var o=0;var az=0;var aH=[];var aj={};var C=function C(){};var aT=function aT(){};var ax=null;var y=null;var aA=function aA(aW){H=aW};var aP;var aC;var aK=0;var ao=0;var aR=e.OPERATION_STATE.WAITING;function aF(){return al}function aD(){if(b.isNumeric(aI)){if(aI>=0&&aI<=100){return Number(Number(aI).toFixed(2))}else{if(aI>100){return 100}}}return"--"}function J(aW){aI=aW}function aE(aW){B=aW}function aQ(){if(b.isNumeric(B)){if(B>=0&&B<=100){return Number(Number(B).toFixed(2))}else{if(B>100){return 100}}}return"--"}function P(){if(b.isNumeric(i)){return Math.min(Number(Number(i).toFixed(2)),100)}return"--"}function E(aW){i=aW}function G(){return A}function M(aW){A=aW}function R(aW){t=aW}function w(){return t}function aO(aW){aG=aW}function u(){return aG}function I(aW){o=aW}function l(){return o}function am(){return az}function ah(aW){az=aW}function ae(){return aH}function af(aW){aH=aW}function ap(){return aj}function aw(aW){aj=aW}function T(){return C}function W(aW){C=aW}function ad(){return aT}function ag(aW){aT=aW}function O(){return ax}function S(aW){ax=aW}function x(){return y}function V(aW){y=aW}function aB(aW){aR=aW}function z(){return aR}function aN(aW){L=aW}function aM(){return L}function Q(){return an}function q(){return X}function aU(aW){X=aW}function D(){return aa}function aJ(){return H}function N(){return ay}function F(){return aP}function p(aW){aP=aW}function aL(){return aC}function aS(aW){aC=aW}function Z(){return aK}function s(aW){aK=aW}function au(){return ao}function ak(aW){ao=aW}function n(){return aA}function at(){return""+H+e.DELIMITER+ay}function ar(){return""+K+e.DELIMITER+ai}function j(){return h.getUrlForBucketAndPrefix(window.location.href,H,ay)}function av(){return h.getUrlForBucketAndPrefix(window.location.href,K,ai)}function r(){return K}function m(aW){K=aW}function ab(){return ai}function Y(aW){ai=aW}function ac(){return v}function U(aW){v=aW}function aq(){return k}function aV(aW){k=aW}Object.defineProperties(this,{defer:{get:aF},name:{get:Q},step:{get:q,set:aU},id:{get:D},initialBucket:{get:aJ},initialPath:{get:N},bucketRegion:{get:G,set:M},dstBucket:{get:r,set:m},dstPrefix:{get:ab,set:Y},dstName:{get:aq,set:aV},dstBucketRegion:{get:ac,set:U},progressPercentage:{get:aD,set:J},succeedKeyCount:{get:u,set:aO},failedKeyCount:{get:l,set:I},totalOperatedObjectCount:{get:am,set:ah},successPercentage:{get:aQ,set:aE},errorPercentage:{get:P,set:E},progressText:{get:w,set:R},errorTypes:{get:ae,set:af},errorDetails:{get:ap,set:aw},state:{get:z,set:aB},start:{get:T,set:W},cancel:{get:ad,set:ag},errorCallBack:{get:O,set:S},finishCallBack:{get:x,set:V},parameters:{get:aM,set:aN},selectedObjects:{get:aL,set:aS},selectedFolders:{get:F,set:p},keyCount:{get:Z,set:s},totalSizeInBytes:{get:au,set:ak},changeInitialBucketForOperation:{get:n},operationPath:{get:at},operationDestinationPath:{get:ar},operationInitialLocationUrl:{get:j},operationDestinationUrl:{get:av}})}return g}])})();"use strict";(function(){angular.module("s3").service("UploadVerificationService",["$filter","$http","$log","$window","$q","$translate","ConsoleOperation","Md5WorkerService","S3Constants","SCLogService",function(h,p,j,g,n,k,f,q,i,a){var o=[];var e={};var r={verifyUpload:b};return r;function b(w,s,u){var t=new f("uploadVerification","requestReceived");var v={fileName:w.name,fileSize:w.size,uploadOpId:u};a.log("MD5CalculationSize",w.size,t,v);var x=n.defer();if(w.size===0){x.resolve(i.UPLOAD.ZERO_BYTE_MD5)}else{d(s,w,u,x,t)}return x.promise}function d(u,t,v,z,y){y.step="MD5CalculationStart";var s={fileName:t.name,uploadOpId:v};a.log("MD5CalculationStart",1,y,s);var x=u+"-";var A=q.generateWorker(u,t,v,z,y);A.worker.addEventListener("message",m(x));A.worker.addEventListener("error",c(x));e[x]=A;var w={file_size:t.size,start:0,end:t.size};A.worker.postMessage({message:t,block:w})}function c(s){return function(){var t=e[s];t.uploadVerificationDeferredObject.reject(k.instant("upload.md5calculation.error"));l(t,"MD5CalculationSuccess",0);delete e[s]}}function m(s){return function(u){if(u.data.result){var v=e[s];o[v.fileId]=u.data.result;var t=g.Date.now()-v.startTime;l(v,"MD5CalculationSuccess",1);l(v,"MD5CalculationTime",t);j.log("Etag calculated for "+v.file.name+": "+u.data.result);v.uploadVerificationDeferredObject.resolve(o[v.fileId]);delete e[s]}}}function l(v,u,t){v.operation.step=u;var s={fileName:v.file.name,uploadOpId:v.uploadOpId};a.log(u,t,v.operation,s)}}])})();"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};(function(){angular.module("s3").service("Md5WorkerService",["$window",function(c){this.generateWorker=function(d,g,f,h,e){if(!a){b()}var i=new c.Worker(a);var j={fileId:d,worker:i,file:g,startTime:c.Date.now(),uploadOpId:f,uploadVerificationDeferredObject:h,operation:e};return j};var a;function b(){if(_typeof(c.Blob)===(typeof Function==="undefined"?"undefined":_typeof(Function))||_typeof(c.Blob)==="object"){var d=new c.Blob(['/*                          * Crypto-JS v2.5.1                          * http://code.google.com/p/crypto-js/                          * (c) 2009-2011 by Jeff Mott. All rights reserved.                          * http://code.google.com/p/crypto-js/wiki/License                          */                         /*global Crypto, self*/                        (typeof Crypto=="undefined"||!Crypto.util)&&function(){var e=self.Crypto={},g=e.util={rotl:function(a,b){return a<<b|a>>>32-b},rotr:function(a,b){return a<<32-b|a>>>b},endian:function(a){if(a.constructor==Number)return g.rotl(a,8)&16711935|g.rotl(a,24)&4278255360;for(var b=0;b<a.length;b++)a[b]=g.endian(a[b]);return a},randomBytes:function(a){for(var b=[];a>0;a--)b.push(Math.floor(Math.random()*256));return b},bytesToWords:function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=a[c]<<24-                        d%32;return b},wordsToBytes:function(a){for(var b=[],c=0;c<a.length*32;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},bytesToHex:function(a){for(var b=[],c=0;c<a.length;c++)b.push((a[c]>>>4).toString(16)),b.push((a[c]&15).toString(16));return b.join("")},hexToBytes:function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b},bytesToBase64:function(a){if(typeof btoa=="function")return btoa(f.bytesToString(a));for(var b=[],c=0;c<a.length;c+=3)for(var d=a[c]<<16|a[c+1]<<8|                        a[c+2],e=0;e<4;e++)c*8+e*6<=a.length*8?b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>>6*(3-e)&63)):b.push("=");return b.join("")},base64ToBytes:function(a){if(typeof atob=="function")return f.stringToBytes(atob(a));for(var a=a.replace(/[^A-Z0-9+/]/ig,""),b=[],c=0,d=0;c<a.length;d=++c%4)d!=0&&b.push(("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c-1))&Math.pow(2,-2*d+8)-1)<<d*2|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c))>>>                        6-d*2);return b}},e=e.charenc={};e.UTF8={stringToBytes:function(a){return f.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(f.bytesToString(a)))}};var f=e.Binary={stringToBytes:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b},bytesToString:function(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}}}();                        function FF(a, b, c, d, x, s, t) {                            var n = a + (b & c | ~b & d) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function GG(a, b, c, d, x, s, t) {                            var n = a + (b & d | c & ~d) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function HH(a, b, c, d, x, s, t) {                            var n = a + (b ^ c ^ d) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function II(a, b, c, d, x, s, t) {                            var n = a + (c ^ (b | ~d)) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function md5(m, hash) {                            var a = hash[0], b = hash[1], c = hash[2], d = hash[3];                            for (var i = 0; i < m.length; i += 16) {                                var aa = a, bb = b, cc = c, dd = d;                                a = FF(a, b, c, d, m[i + 0], 7, -680876936);                                d = FF(d, a, b, c, m[i + 1], 12, -389564586);                                c = FF(c, d, a, b, m[i + 2], 17, 606105819);                                b = FF(b, c, d, a, m[i + 3], 22, -1044525330);                                a = FF(a, b, c, d, m[i + 4], 7, -176418897);                                d = FF(d, a, b, c, m[i + 5], 12, 1200080426);                                c = FF(c, d, a, b, m[i + 6], 17, -1473231341);                                b = FF(b, c, d, a, m[i + 7], 22, -45705983);                                a = FF(a, b, c, d, m[i + 8], 7, 1770035416);                                d = FF(d, a, b, c, m[i + 9], 12, -1958414417);                                c = FF(c, d, a, b, m[i + 10], 17, -42063);                                b = FF(b, c, d, a, m[i + 11], 22, -1990404162);                                a = FF(a, b, c, d, m[i + 12], 7, 1804603682);                                d = FF(d, a, b, c, m[i + 13], 12, -40341101);                                c = FF(c, d, a, b, m[i + 14], 17, -1502002290);                                b = FF(b, c, d, a, m[i + 15], 22, 1236535329);                                a = GG(a, b, c, d, m[i + 1], 5, -165796510);                                d = GG(d, a, b, c, m[i + 6], 9, -1069501632);                                c = GG(c, d, a, b, m[i + 11], 14, 643717713);                                b = GG(b, c, d, a, m[i + 0], 20, -373897302);                                a = GG(a, b, c, d, m[i + 5], 5, -701558691);                                d = GG(d, a, b, c, m[i + 10], 9, 38016083);                                c = GG(c, d, a, b, m[i + 15], 14, -660478335);                                b = GG(b, c, d, a, m[i + 4], 20, -405537848);                                a = GG(a, b, c, d, m[i + 9], 5, 568446438);                                d = GG(d, a, b, c, m[i + 14], 9, -1019803690);                                c = GG(c, d, a, b, m[i + 3], 14, -187363961);                                b = GG(b, c, d, a, m[i + 8], 20, 1163531501);                                a = GG(a, b, c, d, m[i + 13], 5, -1444681467);                                d = GG(d, a, b, c, m[i + 2], 9, -51403784);                                c = GG(c, d, a, b, m[i + 7], 14, 1735328473);                                b = GG(b, c, d, a, m[i + 12], 20, -1926607734);                                a = HH(a, b, c, d, m[i + 5], 4, -378558);                                d = HH(d, a, b, c, m[i + 8], 11, -2022574463);                                c = HH(c, d, a, b, m[i + 11], 16, 1839030562);                                b = HH(b, c, d, a, m[i + 14], 23, -35309556);                                a = HH(a, b, c, d, m[i + 1], 4, -1530992060);                                d = HH(d, a, b, c, m[i + 4], 11, 1272893353);                                c = HH(c, d, a, b, m[i + 7], 16, -155497632);                                b = HH(b, c, d, a, m[i + 10], 23, -1094730640);                                a = HH(a, b, c, d, m[i + 13], 4, 681279174);                                d = HH(d, a, b, c, m[i + 0], 11, -358537222);                                c = HH(c, d, a, b, m[i + 3], 16, -722521979);                                b = HH(b, c, d, a, m[i + 6], 23, 76029189);                                a = HH(a, b, c, d, m[i + 9], 4, -640364487);                                d = HH(d, a, b, c, m[i + 12], 11, -421815835);                                c = HH(c, d, a, b, m[i + 15], 16, 530742520);                                b = HH(b, c, d, a, m[i + 2], 23, -995338651);                                a = II(a, b, c, d, m[i + 0], 6, -198630844);                                d = II(d, a, b, c, m[i + 7], 10, 1126891415);                                c = II(c, d, a, b, m[i + 14], 15, -1416354905);                                b = II(b, c, d, a, m[i + 5], 21, -57434055);                                a = II(a, b, c, d, m[i + 12], 6, 1700485571);                                d = II(d, a, b, c, m[i + 3], 10, -1894986606);                                c = II(c, d, a, b, m[i + 10], 15, -1051523);                                b = II(b, c, d, a, m[i + 1], 21, -2054922799);                                a = II(a, b, c, d, m[i + 8], 6, 1873313359);                                d = II(d, a, b, c, m[i + 15], 10, -30611744);                                c = II(c, d, a, b, m[i + 6], 15, -1560198380);                                b = II(b, c, d, a, m[i + 13], 21, 1309151649);                                a = II(a, b, c, d, m[i + 4], 6, -145523070);                                d = II(d, a, b, c, m[i + 11], 10, -1120210379);                                c = II(c, d, a, b, m[i + 2], 15, 718787259);                                b = II(b, c, d, a, m[i + 9], 21, -343485551);                                a = (a + aa) >>> 0;                                b = (b + bb) >>> 0;                                c = (c + cc) >>> 0;                                d = (d + dd) >>> 0;                            }                            return [a, b, c, d];                        }                        var hash = [1732584193, -271733879, -1732584194, 271733878];                        onmessage = function (event) {                            var uint8_array, message, block, output, nBitsTotal, nBitsLeft, nBitsTotalH, nBitsTotalL;                            var reader = new FileReaderSync();                            uint8_array = new Uint8Array(reader.readAsArrayBuffer(event.data.message));                            message = Crypto.util.endian(Crypto.util.bytesToWords(uint8_array));                            block = event.data.block;                            event = null;                            uint8_array = null;                            output = {};                            nBitsTotal =  block.file_size * 8;                            nBitsLeft = (block.end - block.start) * 8;                            message[nBitsLeft >>> 5] |= 0x80 << (nBitsLeft % 32);                            nBitsTotalH = Math.floor(nBitsTotal / 0x100000000);                            nBitsTotalL = nBitsTotal & 0xFFFFFFFF;                            message[(((nBitsLeft + 64) >>> 9) << 4) + 15] = nBitsTotalH;                            message[(((nBitsLeft + 64) >>> 9) << 4) + 14] = nBitsTotalL;                            self.hash = md5(message, self.hash);                            output.result = Crypto.util.bytesToHex(Crypto.util.wordsToBytes(Crypto.util.endian(self.hash)));                            message = null;                            self.postMessage(output);                            close();                        }'],{type:"application/javascript"});a=c.URL.createObjectURL(d)}}}])})();"use strict";(function(){angular.module("s3").service("BucketPropertiesService",["$timeout","$q","$window","AnalyzeAccessConstants","APIProxyService","BulkOperationService","CachingService","CloudTrailService","Region","S3Constants","S3CWSAPIService","SCLogService","XMLParser","OperationDispatcherService","PermissionsUtilService","UtilService",function(Q,aa,N,B,P,aw,ax,S,V,e,y,D,A,v,aA,p){var aF={deleteBucketCORS:U,deleteBucketPolicy:ah,getBucketACL:q,getBucketACP:n,getBucketOwnerDisplayName:F,getBucketLocation:al,getBucketGranteeCounts:s,getBucketCORS:at,getBucketGrantees:ar,getBucketNotification:k,getBucketPolicy:b,getBucketVersioning:I,getEventCount:h,getBucketLifecycleConfiguration:aj,getLoggingTargetBucket:a,getTagCount:Z,getVersioningStatus:c,getVersioningAndMFAStatus:w,isAnalyticsEnabled:l,isBucketPolicyApplied:an,isCORSEnabled:r,isInventoryEnabled:Y,isLifecycleEnabled:o,isLoggingEnabled:aD,isMetricsEnabled:ae,isReplicationEnabled:ad,isRequesterPaysEnabled:ak,enableBucketRequestPayment:ai,disableBucketRequestPayment:L,isWebsiteEnabled:J,putBucketACL:T,putBucketNotification:E,parseBucketNotificationObject:W,putBucketCORS:H,putBucketPolicy:ao,enableBucketVersioning:g,disableBucketVersioning:f,enableBucketLogging:G,disableBucketLogging:m,putBucketTagging:aq,deleteBucketTagging:M,configureBucketWebsite:ay,redirectBucketWebsiteRequests:ac,deleteBucketWebsite:av,getBucketReplication:C,putBucketReplication:d,deleteBucketReplication:ag,parseBucketReplicationObject:aB,parseBucketReplicationObject_v1:am,getBucketLifecycle:aC,putBucketLifecycle:au,deleteBucketLifecycle:X,getBucketInventory:K,putBucketInventory:z,deleteBucketInventory:aE,getBucketAccelerate:R,putBucketAccelerate:af,getBucketRegion:x,describeTrails:ab,getEventSelectors:t,putEventSelectors:j,putBucketDefaultEncryption:az,analyzeAccess:i};var O=0;return aF;function F(){var aG=D.logRequestReceived("getBucketOwnerDisplayName");return P.getBucketOwner().then(function(aH){D.logRequestComplete("getBucketOwnerDisplayName",aG);return aH.DisplayName})}function x(aG){return aF.getBucketLocation(aG).then(function(aH){return _.find(V.regionMapping,{value:aH})})}function al(aH){var aG=D.logRequestReceived("getBucketLocation");return P.getBucketLocation(aG,aH,{}).then(function(aI){D.logRequestComplete("getBucketLocation",aG);return aI.region})}function s(aH){var aG=D.logRequestReceived("getBucketGranteeCounts");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.acl.name).then(function(aM){var aJ=aM.response;D.logRequestComplete("getBucketGranteeCounts",aG);var aL={READ:0,WRITE:0,READ_ACP:0,WRITE_ACP:0};if(aJ){var aI=aJ.AccessControlPolicy.AccessControlList.Grant;var aK=function aK(aN){if(aN.Permission==="FULL_CONTROL"){for(var aO in aL){aL[aO]++}}else{aL[aN.Permission]++}};if(aI){if(aI.forEach){aI.forEach(function(aN){aK(aN)})}else{aK(aI)}}}return aL})}function ar(aH,aG){D.log("getBucketGranteesReceived",1,aG,{bucketName:aH});aG.step="getBucketAclComplete";return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.acl.name).then(function(aL){var aJ=aL.response;var aK={};D.log("getBucketACL",1,aG,{bucketName:aH});var aI=_.get(aJ,"AccessControlPolicy.AccessControlList.Grant");if(aI){if(aI.forEach){aI.forEach(function(aM){aA.updateGranteesHelperFunction(aM,aK)})}else{aA.updateGranteesHelperFunction(aI,aK)}}D.logRequestComplete("getBucketGrantees",aG);return aK})["catch"](function(aI){D.log("getBucketGrantees",0,aG,{bucketName:aH,error:aI});return aa.reject(p.handleErrors(aI))})}function n(aH,aG){D.log("getBucketACPReceived",1,aG,{bucketName:aH});return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.acl.name).then(function(aJ){var aI=aJ.response;D.logRequestComplete("getBucketACP",aG);return aI.AccessControlPolicy})["catch"](function(aI){D.log("getBucketACP",0,aG,{bucketName:aH,error:aI});return aa.reject(p.handleErrors(aI))})}function q(aH,aG){D.log("getBucketACLReceived",1,aG,{bucketName:aH});return n(aH,aG).then(function(aI){D.logRequestComplete("getBucketACL",aG);return aI.AccessControlList.Grant})["catch"](function(aI){D.log("getBucketACL",0,aG,{bucketName:aH,error:aI});return aa.reject(p.handleErrors(aI))})}function T(aI,aG,aH){D.log("putBucketACLReceived",1,aH,{bucketName:aI});var aJ="";return n(aI,aH).then(function(aK){aJ+='<AccessControlPolicy xmlns="http://s3.amazonaws.com/doc/2006-03-01/"><Owner><ID>'+aK.Owner.ID+"</ID>";aJ+="<DisplayName>"+p.encodeXml(aK.Owner.DisplayName)+"</DisplayName></Owner><AccessControlList>";aG.forEach(function(aL){aL.Grantee.Type=aL.Grantee.URI?"Group":aL.Grantee.EmailAddress?"AmazonCustomerByEmail":"CanonicalUser";aJ+='<Grant><Grantee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="'+aL.Grantee.Type+'">';aJ+=aL.Grantee.ID?"<ID>"+aL.Grantee.ID+"</ID>":"";aJ+=aL.Grantee.DisplayName?"<DisplayName>"+p.encodeXml(aL.Grantee.DisplayName)+"</DisplayName>":"";aJ+=aL.Grantee.EmailAddress?"<EmailAddress>"+aL.Grantee.EmailAddress+"</EmailAddress>":"";aJ+=aL.Grantee.URI?"<URI>"+aL.Grantee.URI+"</URI>":"";aJ+="</Grantee>";aJ+="<Permission>"+aL.Permission+"</Permission></Grant>"});aJ+="</AccessControlList></AccessControlPolicy>";return P.putBucketProperty(aH,aI,P.bucketPropertiesMap.acl.name,aJ).then(function(aM){var aL=aM.response;D.logRequestComplete("putBucketACL",aH);return aL})["catch"](function(aL){D.log("putBucketACL",0,aH,{bucketName:aI,error:aL});return aa.reject(p.handleErrors(aL))})})["catch"](function(aK){return aa.reject(aK)})}function E(aJ,aH,aG){D.log("putBucketNotificationReceived",1,aH,{bucketName:aJ});var aI=W(aG);return P.putBucketProperty(aH,aJ,P.bucketPropertiesMap.notification.name,aI).then(function(aL){var aK=aL.response;D.log("putBucketNotification",1,aH,{bucketName:aJ});return aK})["catch"](function(aK){D.log("putBucketNotification",0,aH,{bucketName:aJ,error:aK});return aa.reject(p.handleErrors(aK))})}function W(aG){var aH={};var aI=[{name:e.EVENTS.TOPIC,value:e.EVENTS.TOPICCONFIG},{name:e.EVENTS.QUEUE,value:e.EVENTS.QUEUECONFIG},{name:e.EVENTS.CLOUDFN,value:e.EVENTS.CLOUDCONFIG}];aI.forEach(function(aK){var aJ=[];if(aG[aK.name]){aG[aK.name].forEach(function(aL){aJ.push(u(aL))});aH[aK.value]=aJ}});aH={NotificationConfiguration:aH};return A.jsonToXml(aH)}function u(aJ){var aI={};aI.Id=aJ.id;var aG=[];if(aJ.prefix&&aJ.prefix!==""){aG.push({Name:"Prefix",Value:aJ.prefix})}if(aJ.suffix&&aJ.suffix!==""){aG.push({Name:"Suffix",Value:aJ.suffix})}if(aG.length!==0){ap(aG);aI.Filter={S3Key:{FilterRule:aG}}}switch(aJ.type){case e.EVENTS.SNS:aI.Topic=aJ.arn;break;case e.EVENTS.SQS:aI.Queue=aJ.arn;break;case e.EVENTS.LAMBDA:aI.CloudFunction=aJ.arn}var aH=ap(aJ.events);aI.Event=aH;return aI}function ap(aG){if(aG.length===1){return aG[0]}return aG}function r(aH){var aG=D.logRequestReceived("isCORSEnabled");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.cors.name).then(function(aI){D.logRequestComplete("isCORSEnabled",aG);return aI.response!==undefined})}function H(aI,aH,aG){D.log("putBucketCORSReceived",1,aG,{bucketName:aI});return P.putBucketProperty(aG,aI,P.bucketPropertiesMap.cors.name,aH).then(function(aJ){D.logRequestComplete("putBucketCORS",aG);return aJ.response})["catch"](function(aJ){D.log("putBucketCORS",0,aG,{bucketName:aI,error:aJ});return aa.reject(p.handleErrors(aJ))})}function at(aH,aG){D.log("getBucketCORSReceived",1,aG,{bucketName:aH});return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.cors.name).then(function(aI){D.logRequestComplete("getBucketCORS",aG);return aI.response})["catch"](function(aJ){var aI=p.handleErrors(aJ);if(aI!=="The CORS configuration does not exist"){D.log("getBucketCORS",0,aG,{bucketName:aH,error:aJ});return aa.reject(aI)}else{D.logRequestComplete("getBucketCORS",aG)}})}function U(aH,aG){D.log("deleteBucketCORSReceived",1,aG,{bucketName:aH});return P.deleteBucketProperty(aG,aH,P.bucketPropertiesMap.cors.name).then(function(aI){D.logRequestComplete("deleteBucketCORS",aG);return aI.response})["catch"](function(aI){D.log("deleteBucketCORS",0,aG,{bucketName:aH,error:aI});return aa.reject(p.handleErrors(aI))})}function an(aH){var aG=D.logRequestReceived("isBucketPolicyApplied");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.policy.name).then(function(aI){D.logRequestComplete("isBucketPolicyApplied",aG);return aI.response!==undefined})}function b(aH,aG){var aI=arguments.length<=2||arguments[2]===undefined?true:arguments[2];D.log("getBucketPolicyReceived",1,aG,{bucketName:aH});return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.policy.name,{},aI).then(function(aJ){D.logRequestComplete("getBucketPolicy",aG);return aJ.response})["catch"](function(aK){var aJ=p.handleErrors(aK);if(aJ!=="The bucket policy does not exist"){D.log("getBucketPolicy",0,aG,{bucketName:aH,error:aK});return aa.reject(aJ)}else{D.logRequestComplete("getBucketPolicy",aG)}})}function ao(aH,aI,aG){D.log("putBucketPolicyReceived",1,aG,{bucketName:aH});return P.putBucketProperty(aG,aH,P.bucketPropertiesMap.policy.name,aI).then(function(aJ){D.logRequestComplete("putBucketPolicy",aG);return aJ.response})["catch"](function(aK){var aJ=p.handleErrors(aK);D.log("putBucketPolicy",0,aG,{bucketName:aH,error:aK});return aa.reject(aJ)})}function ah(aH,aG){D.log("deleteBucketPolicyReceived",1,aG,{bucketName:aH});return P.deleteBucketProperty(aG,aH,P.bucketPropertiesMap.policy.name).then(function(aI){D.logRequestComplete("deleteBucketPolicy",aG);return aI.response})["catch"](function(aI){D.log("deleteBucketPolicy",0,aG,{bucketName:aH,error:aI});return aa.reject(p.handleErrors(aI))})}function aj(aH){var aG=D.logRequestReceived("getBucketLifecycleConfiguration");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.lifecycle.name).then(function(aI){D.logRequestComplete("getBucketLifecycleConfiguration",aG);if(aI.response){return A.convertXmlStringToJson(aI.response)}else{return aI}})}function c(aH){var aG=D.logRequestReceived("getVersioningStatus");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.versioning.name).then(function(aI){D.logRequestComplete("getVersioningStatus",aG);var aJ=A.convertXmlStringToJson(aI.response);return aJ.VersioningConfiguration&&aJ.VersioningConfiguration.Status})}function w(aH){var aG=D.logRequestReceived("getVersioningAndMFAStatus");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.versioning.name).then(function(aI){D.logRequestComplete("getVersioningAndMFAStatus",aG);var aJ=A.convertXmlStringToJson(aI.response);return _.get(aJ,"VersioningConfiguration")})}function h(aH){var aG=D.logRequestReceived("getEventCount");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.notification.name).then(function(aI){D.logRequestComplete("getEventCount",aG);var aJ=A.convertXmlStringToJson(aI.response);var aL=0;for(var aK in aJ.NotificationConfiguration){aL+=aJ.NotificationConfiguration[aK].length||1}return aL})}function k(aH,aG){D.log("getBucketNotificationReceived",1,aG,{bucketName:aH});return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.notification.name).then(function(aI){D.logRequestComplete("getBucketNotification",aG);return aI})["catch"](function(aI){D.log("getBucketNotification",0,aG,{bucketName:aH,error:aI});return aa.reject(p.handleErrors(aI))})}function aD(aH){var aG=D.logRequestReceived("isLoggingEnabled");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.logging.name).then(function(aI){D.logRequestComplete("isLoggingEnabled",aG);return aI.response&&aI.response.BucketLoggingStatus.LoggingEnabled!==undefined})}function a(aH){var aG=D.logRequestReceived("getLoggingTargetBucket");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.logging.name).then(function(aI){D.logRequestComplete("getLoggingTargetBucket",aG);var aJ=aI.response.BucketLoggingStatus.LoggingEnabled;if(aJ){return aJ.TargetBucket}else{return"Logging is not enabled"}})}function ak(aH){var aG=D.logRequestReceived("isRequesterPaysEnabled");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.requestPayment.name).then(function(aI){D.logRequestComplete("isRequesterPaysEnabled",aG);var aJ=A.convertXmlStringToJson(aI.response);return aJ.RequestPaymentConfiguration.Payer==="Requester"})}function ad(aH){var aG=D.logRequestReceived("isReplicationEnabled");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.replication.name).then(function(aI){var aJ=A.convertXmlStringToJson(aI.response);var aK=false;if(aJ.ReplicationConfiguration){D.logRequestComplete("isReplicationEnabled",aG);if(aJ.ReplicationConfiguration.Rule.length){aK=_.filter(aJ.ReplicationConfiguration.Rule,function(aL){return aL.Status==="Enabled"}).length>0}else{aK=aJ.ReplicationConfiguration.Rule.Status==="Enabled"}}return aK})}function l(aH){var aI=e.OPERATION_NAME.IS_ANALYTICS_ENABLED;var aG=D.logRequestReceived(aI);return P.getBucketProperty(aG,aH,"analytics",{},false).then(function(aM){var aJ=aM.response;D.log(aI,1,aG);var aL=A.convertXmlStringToJson(aJ);var aK=aL.ListBucketAnalyticsConfigurationsResult;if(aK&&aK.AnalyticsConfiguration){return true}return false})["catch"](function(aJ){D.log(aI,0,aG,{bucketName:aH,error:aJ});return false})}function o(aH){var aI=e.OPERATION_NAME.IS_LIFECYCLE_ENABLED;var aG=D.logRequestReceived(aI);return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.lifecycle.name).then(function(aK){D.log(aI,1,aG);if(aK.response){var aJ=A.convertXmlStringToJson(aK.response);if(aJ&&aJ.LifecycleConfiguration&&aJ.LifecycleConfiguration.Rule){var aL=p.transformObjectToArray(aJ.LifecycleConfiguration.Rule);return _.some(aL,function(aM){return aM.Status==="Enabled"})}}return false})["catch"](function(aJ){D.log(aI,0,aG,{bucketName:aH,error:aJ});return false})}function Y(aH){var aI=e.OPERATION_NAME.IS_INVENTORY_ENABLED;var aG=D.logRequestReceived(aI);return P.getObjectInventory(aG,aH,{path:aH}).then(function(aK){var aJ=aK.response;D.log(aI,1,aG);if(aJ){var aL=A.convertXmlStringToJson(aJ);if(aL.ListInventoryConfigurationsResult&&aL.ListInventoryConfigurationsResult.InventoryConfiguration){return true}}return false})["catch"](function(aJ){D.log(aI,0,aG,{bucketName:aH,error:aJ});return false})}function ae(aH){var aI=e.OPERATION_NAME.IS_METRICS_ENABLED;var aG=D.logRequestReceived(aI);return P.getBucketProperty(aG,aH,"metrics",{},false).then(function(aL){var aJ=aL.response;D.log(aI,1,aG);if(aJ){var aM=A.convertXmlStringToJson(aJ);var aK=aM.ListMetricsConfigurationsResult;if(aM&&aK&&aK.MetricsConfiguration){return true}}return false})["catch"](function(aJ){D.log(aI,0,aG,{bucketName:aH,error:aJ});return false})}function Z(aH){var aG=D.logRequestReceived("getTagCount");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.tagging.name).then(function(aI){D.logRequestComplete("getTagCount",aG);var aJ=A.convertXmlStringToJson(aI.response);var aK=0;if(aJ.Tagging){aK=aJ.Tagging.TagSet.Tag.length||1}return aK})}function J(aH){var aG=D.logRequestReceived("isWebsiteEnabled");return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.website.name).then(function(aI){D.logRequestComplete("isWebsiteEnabled",aG);return aI.response!==undefined})}function I(aH,aG){var aI=arguments.length<=2||arguments[2]===undefined?true:arguments[2];D.log("getBucketVersioningReceived",1,aG,{bucketName:aH});return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.versioning.name,{},aI).then(function(aJ){D.logRequestComplete("getBucketVersioning",aG);var aK=A.convertXmlStringToJson(aJ.response);return aK.VersioningConfiguration&&aK.VersioningConfiguration.Status})["catch"](function(aJ){D.log("getBucketVersioning",0,aG,{bucketName:aH,error:aJ});return aa.reject(p.handleErrors(aJ))})}function g(aH,aG){D.log("putBucketVersioningReceived",1,aG,{bucketName:aH});var aI="<VersioningConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'><Status>Enabled</Status></VersioningConfiguration>";return P.putBucketProperty(aG,aH,P.bucketPropertiesMap.versioning.name,aI).then(function(aJ){D.logRequestComplete("putBucketVersioning",aG);return aJ})["catch"](function(aJ){D.log("putBucketVersioning",0,aG,{bucketName:aH,error:aJ});return aa.reject(p.handleErrors(aJ))})}function f(aH,aG){D.log("putBucketVersioningReceived",1,aG,{bucketName:aH});var aI="<VersioningConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'><Status>Suspended</Status></VersioningConfiguration>";return P.putBucketProperty(aG,aH,P.bucketPropertiesMap.versioning.name,aI).then(function(aJ){D.logRequestComplete("putBucketVersioning",aG);return aJ})["catch"](function(aJ){D.log("putBucketVersioning",0,aG,{bucketName:aH,error:aJ});return aa.reject(p.handleErrors(aJ))})}function ai(aI,aG){D.log("putBucketRequestPaymentReceived",1,aG,{bucketName:aI});var aH="<RequestPaymentConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'><Payer>Requester</Payer></RequestPaymentConfiguration>";return P.putBucketProperty(aG,aI,P.bucketPropertiesMap.requestPayment.name,aH).then(function(aJ){D.logRequestComplete("putBucketRequestPayment",aG);return aJ})["catch"](function(aJ){D.log("putBucketRequestPayment",0,aG,{bucketName:aI,error:aJ});return aa.reject(p.handleErrors(aJ))})}function L(aI,aG){D.log("putBucketRequestPaymentReceived",1,aG,{bucketName:aI});var aH="<RequestPaymentConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'><Payer>BucketOwner</Payer></RequestPaymentConfiguration>";return P.putBucketProperty(aG,aI,P.bucketPropertiesMap.requestPayment.name,aH).then(function(aJ){D.logRequestComplete("putBucketRequestPayment",aG);return aJ})["catch"](function(aJ){D.log("putBucketRequestPayment",0,aG,{bucketName:aI,error:aJ});return aa.reject(p.handleErrors(aJ))})}function G(aJ,aM,aL,aH,aI){D.log("enableBucketLoggingReceived",1,aI,{bucketName:aJ});var aG;if(aH===undefined||aH.length===0){aG=""}else{aG="<TargetGrants>";aH.forEach(function(aN){aN.Grantee.Type=aN.Grantee.URI?"Group":aN.Grantee.EmailAddress?"AmazonCustomerByEmail":"CanonicalUser";aG+='<Grant><Grantee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="'+aN.Grantee.Type+'">';aG+=aN.Grantee.ID?"<ID>"+aN.Grantee.ID+"</ID>":"";aG+=aN.Grantee.DisplayName?"<DisplayName>"+p.encodeXml(aN.Grantee.DisplayName)+"</DisplayName>":"";aG+=aN.Grantee.EmailAddress?"<EmailAddress>"+aN.Grantee.EmailAddress+"</EmailAddress>":"";aG+=aN.Grantee.URI?"<URI>"+aN.Grantee.URI+"</URI>":"";aG+="</Grantee>";aG+="<Permission>"+aN.Permission+"</Permission></Grant>"});aG+="</TargetGrants>"}var aK="<BucketLoggingStatus xmlns='http://doc.s3.amazonaws.com/2006-03-01'>"+("<LoggingEnabled><TargetBucket>"+aM+"</TargetBucket><TargetPrefix>"+aL+"</TargetPrefix>"+aG+"</LoggingEnabled></BucketLoggingStatus>");return P.putBucketProperty(aI,aJ,P.bucketPropertiesMap.logging.name,aK).then(function(aN){D.logRequestComplete("enableBucketLogging",aI);return aN})["catch"](function(aN){D.log("enableBucketLogging",0,aI,{bucketName:aJ,error:aN});return aa.reject(p.handleErrors(aN))})}function m(aH,aG){D.log("disableBucketLoggingReceived",1,aG,{bucketName:aH});var aI="<BucketLoggingStatus xmlns='http://doc.s3.amazonaws.com/2006-03-01/' />";return P.putBucketProperty(aG,aH,P.bucketPropertiesMap.logging.name,aI).then(function(aJ){D.logRequestComplete("disableBucketLogging",aG);return aJ})["catch"](function(aJ){D.log("disableBucketLogging",0,aG,{bucketName:aH,error:aJ});return aa.reject(p.handleErrors(aJ))})}function aq(aJ,aI,aH){var aK={Tagging:{TagSet:{Tag:[]}}};angular.forEach(aI,function(aL){aK.Tagging.TagSet.Tag.push({Key:aL.Key,Value:aL.Value})});var aG=A.jsonToXml(aK);D.log("putBucketTaggingReceived",1,aH,{bucketName:aJ});return P.putBucketProperty(aH,aJ,P.bucketPropertiesMap.tagging.name,aG).then(function(aL){D.logRequestComplete("putBucketTagging",aH);return aL})["catch"](function(aL){D.log("putBucketTagging",0,aH,{bucketName:aJ,error:aL});return aa.reject(p.handleErrors(aL))})}function M(aI,aH,aG){D.log("deleteBucketTaggingReceived",1,aG,{bucketName:aI});return P.deleteBucketProperty(aG,aI,P.bucketPropertiesMap.tagging.name).then(function(aJ){D.logRequestComplete("deleteBucketTagging",aG);return aJ})["catch"](function(aJ){D.log("deleteBucketTagging",0,aG,{bucketName:aI,error:aJ});return aa.reject(p.handleErrors(aJ))})}function ay(aJ,aK,aH,aL,aI){D.log("putBucketWebsiteReceived",1,aI,{bucketName:aJ});var aG="<WebsiteConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'>"+("<IndexDocument><Suffix>"+aK+"</Suffix></IndexDocument>");aG+=aH?"<ErrorDocument><Key>"+aH+"</Key></ErrorDocument>":"";aG+=aL+"</WebsiteConfiguration>";return P.putBucketProperty(aI,aJ,P.bucketPropertiesMap.website.name,aG).then(function(aM){D.logRequestComplete("putBucketWebsite",aI);return aM})["catch"](function(aM){D.log("putBucketWebsite",0,aI,{bucketName:aJ,error:aM});return aa.reject(p.handleErrors(aM))})}function ac(aI,aJ,aK,aH){D.log("putBucketWebsiteReceived",1,aH,{bucketName:aI});var aG="<WebsiteConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'>"+("<RedirectAllRequestsTo><HostName>"+aJ+"</HostName>");if(aK){aG+="<Protocol>"+aK+"</Protocol>"}aG+="</RedirectAllRequestsTo></WebsiteConfiguration>";return P.putBucketProperty(aH,aI,P.bucketPropertiesMap.website.name,aG).then(function(aL){D.logRequestComplete("putBucketWebsite",aH);return aL})["catch"](function(aL){D.log("putBucketWebsite",0,aH,{bucketName:aI,error:aL});return aa.reject(p.handleErrors(aL))})}function av(aH,aG){D.log("deleteBucketWebsiteReceived",1,aG,{bucketName:aH});return P.deleteBucketProperty(aG,aH,P.bucketPropertiesMap.website.name).then(function(aI){D.logRequestComplete("deleteBucketWebsite",aG);return aI})["catch"](function(aI){D.log("deleteBucketWebsite",0,aG,{bucketName:aH,error:aI});return aa.reject(p.handleErrors(aI))})}function C(aH,aG){D.log("getBucketReplicationReceived",1,aG,{bucketName:aH});return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.replication.name).then(function(aI){D.logRequestComplete("getBucketReplication",aG);return aI})["catch"](function(aI){D.log("getBucketReplication",0,aG,{bucketName:aH});return aa.reject(p.handleErrors(aI))})}function d(aK,aI,aG,aH){D.log("putBucketReplicationReceived",1,aI,{bucketName:aK});var aJ=aH?am(aG):aB(aG);return P.putBucketProperty(aI,aK,P.bucketPropertiesMap.replication.name,aJ).then(function(aL){D.logRequestComplete("putBucketReplication",aI);return aL})["catch"](function(aL){D.log("putBucketReplication",0,aI,{bucketName:aK});return aa.reject(p.handleErrors(aL))})}function am(aG){var aJ=[];var aH=aG.destinationBucket.value||aG.destinationBucket;aG.rules.forEach(function(aL){var aK={ID:aL.id,Status:aL.status,Prefix:aL.prefix,Destination:{Bucket:p.getBucketARN(aH),StorageClass:aL.storageClass}};aJ.push(aK)});if(aJ.length===1){aJ=aJ[0]}var aI={ReplicationConfiguration:{Role:aG.role,Rule:aJ}};return A.jsonToXml(aI)}function aB(aG){var aK=[];var aH=aG.destinationBucket;var aJ=aG.destAccountId;aG.rules.forEach(function(aN){var aL={ID:aN.ID,Status:_.isEmpty(aN.Status)?"Disabled":aN.Status,Prefix:_.isEmpty(aN.Prefix)?"":aN.Prefix,Destination:{Bucket:p.getBucketARN(aH),StorageClass:_.get(aN.Destination,"StorageClass.value",undefined)}};if(!_.isEmpty(aJ)){aL.Destination.Account=aJ}if(aN.Destination&&!_.isEmpty(aN.Destination.AccessControlTranslation)&&!_.isEmpty(aJ)){aL.Destination.AccessControlTranslation=aN.Destination.AccessControlTranslation}var aM=_.get(aN,"Destination.EncryptionConfiguration.ReplicaKmsKeyID","");if(!_.isEmpty(aM)&&_.get(aN,"SourceSelectionCriteria.SseKmsEncryptedObjects.Status","")==="Enabled"){aL.Destination.EncryptionConfiguration={ReplicaKmsKeyID:aM};aL.SourceSelectionCriteria={SseKmsEncryptedObjects:{Status:"Enabled"}}}aK.push(aL)});if(aK.length===1){aK=aK[0]}var aI={ReplicationConfiguration:{Role:aG.role,Rule:aK}};return A.jsonToXml(aI)}function ag(aH,aG){D.log("deleteBucketReplicationReceived",1,aG,{bucketName:aH});return P.deleteBucketProperty(aG,aH,P.bucketPropertiesMap.replication.name).then(function(aI){D.logRequestComplete("deleteBucketReplication",aG);return aI})["catch"](function(aI){D.log("deleteBucketReplication",0,aG,{bucketName:aH});return aa.reject(p.handleErrors(aI))})}function X(aJ,aI,aG,aL,aK,aH){D.log("deleteBucketLifecycleReceived",1,aH);return P.deleteBucketProperty(aH,aJ,P.bucketPropertiesMap.lifecycle.name).then(function(aM){D.log("deleteBucketLifecycle",1,aH,{initialXml:aI,finalXml:aG,ruleBeforeEdit:aL,ruleAfterEdit:aK,"x-amz-id-2":aM.headers(e.HEADERS.X_AMZ_ID_2),"x-amz-request-id":aM.headers(e.HEADERS.X_AMZ_REQUEST_ID)});return aM})["catch"](function(aM){D.log("deleteBucketLifecycle",0,aH,{initialXml:aI,finalXml:aG,ruleBeforeEdit:aL,ruleAfterEdit:aK,error:aM});return aa.reject(p.handleErrors(aM))})}function au(aJ,aI,aG,aL,aK,aH){D.log("putBucketLifecycleReceived",1,aH);return P.putBucketProperty(aH,aJ,P.bucketPropertiesMap.lifecycle.name,aG).then(function(aM){D.log("putBucketLifecycle",1,aH,{initialXml:aI,finalXml:aG,ruleBeforeEdit:aL,ruleAfterEdit:aK,"x-amz-id-2":aM.headers(e.HEADERS.X_AMZ_ID_2),"x-amz-request-id":aM.headers(e.HEADERS.X_AMZ_REQUEST_ID)});return aM})["catch"](function(aM){D.log("putBucketLifecycle",0,aH,{initialXml:aI,finalXml:aG,ruleBeforeEdit:aL,ruleAfterEdit:aK,error:aM});return aa.reject(p.handleErrors(aM))})}function aC(aH,aG){D.log("getBucketLifecycleReceived",1,aG);return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.lifecycle.name).then(function(aI){if(aI.response){D.log("getBucketLifecycle",1,aG,{content:aI.response});return aI.response}else{D.log("getBucketLifecycle",1,aG,{content:aI});return aI}})["catch"](function(aJ){var aI=p.handleErrors(aJ);if(aJ!==e.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE){D.log("getBucketLifecycle",0,aG,{error:aJ})}else{D.log("getBucketLifecycle",1,aG,{content:e.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE})}return aa.reject(aI)})}function K(aH,aG){D.log("getBucketInventoryReceived",1,aG,{bucketName:aH});return P.getBucketProperty(aH,P.bucketPropertiesMap.inventory.name).then(function(aI){D.logRequestComplete("getBucketInventory",aG);return aI})["catch"](function(aI){D.log("getBucketInventory",0,aG,{bucketName:aH,error:aI});return aa.reject(p.handleErrors(aI))})}function z(aH,aI,aG){D.log("putBucketInventoryReceived",1,aG);return P.putBucketProperty(aH,P.bucketPropertiesMap.inventory.name,aI).then(function(aJ){D.log("putBucketInventory",1,aG,{content:aI});return aJ})["catch"](function(aJ){D.log("putBucketInventory",0,aG,{error:aJ});return aa.reject(p.handleErrors(aJ))})}function aE(aH,aG){D.log("deleteBucketInventoryReceived",1,aG);return P.deleteBucketProperty(aH,P.bucketPropertiesMap.inventory.name).then(function(aI){D.logRequestComplete("deleteBucketInventory",aG);return aI})["catch"](function(aI){D.log("deleteBucketInventory",0,aG,{error:aI});return aa.reject(p.handleErrors(aI))})}function R(aH,aG){D.log("getBucketAccelerateReceived",1,aG,{bucketName:aH});return P.getBucketProperty(aG,aH,P.bucketPropertiesMap.accelerate.name).then(function(aI){D.logRequestComplete("getBucketAccelerate",aG);var aJ=A.convertXmlStringToJson(aI.response);return aJ.AccelerateConfiguration&&aJ.AccelerateConfiguration.Status})["catch"](function(aI){D.log("getBucketAccelerate",0,aG,{bucketName:aH,error:aI});return aa.reject(p.handleErrors(aI))})}function af(aI,aG,aH){var aK={},aJ=undefined;aK.AccelerateConfiguration={};aK.AccelerateConfiguration.Status=aH;aJ=A.jsonToXml(aK);aJ=aJ.replace("<AccelerateConfiguration>",'<?xml version="1.0" encoding="UTF-8"?> <AccelerateConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">');D.log("putBucketAccelerateReceived",1,aG);return P.putBucketProperty(aG,aI,P.bucketPropertiesMap.accelerate.name,aJ).then(function(aL){D.log("putBucketAccelerate",1,aG,{content:aJ});return aL})["catch"](function(aL){D.log("putBucketAccelerate",0,aG,{content:aJ,error:aL});return aa.reject(p.handleErrors(aL))})}function ab(aG,aH){return S.describeTrails({includeShadowTrails:true,trailNameList:[],region:aH}).then(function(aI){D.log(e.PROXY_API_NAMES.CLOUDTRAIL.DESCRIBE_TRAILS,1,aG,{content:aI.content});return aa.resolve(aI)})["catch"](function(aI){D.log(e.PROXY_API_NAMES.CLOUDTRAIL.DESCRIBE_TRAILS,0,aG,{error:aI});return aa.reject(p.handleErrors(aI))})}function t(aH,aG,aI){return S.getEventSelectors({TrailName:aH,region:aI}).then(function(aJ){D.log(e.PROXY_API_NAMES.CLOUDTRAIL.GET_EVENT_SELECTORS,1,aG,{content:aJ.content});return aa.resolve(aJ)})["catch"](function(aJ){D.log(e.PROXY_API_NAMES.CLOUDTRAIL.GET_EVENT_SELECTORS,0,aG,{error:aJ});return aa.reject(p.handleErrors(aJ))})}function j(aH,aG,aI){aH.region=aI;return S.putEventSelectors(aH).then(function(aJ){D.log(e.PROXY_API_NAMES.CLOUDTRAIL.PUT_EVENT_SELECTORS,1,aG,{content:aH});return aa.resolve(aJ)})["catch"](function(aJ){D.log(e.PROXY_API_NAMES.CLOUDTRAIL.PUT_EVENT_SELECTORS,0,aG,{content:aH,error:aJ});return aa.reject(p.handleErrors(aJ))})}function az(aI,aG,aH){var aK=undefined,aJ=undefined,aL=undefined;if(aG.encryption===e.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.AES256){aK=e.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.API_PARAMS.AES256}else{if(aG.encryption===e.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.AWSKMS){aK=e.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.API_PARAMS.AWSKMS}}aJ={ServerSideEncryptionConfiguration:{Rule:{ApplyServerSideEncryptionByDefault:{SSEAlgorithm:aK}}}};if(aG.encryption===e.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.AWSKMS){if(aG.kmsId.value===e.OBJECT_SSE.CUSTOM_ARN){aJ.ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.KMSMasterKeyID=aG.customKMSARN}else{aJ.ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.KMSMasterKeyID=aG.kmsId.value}}aL=A.jsonToXml(aJ);return P.putBucketProperty(aH,aI,"defaultEncryption",aL).then(function(aM){D.log("PutDefaultEncryption:createBucket",1,aH);return aa.resolve(aM)},function(aM){var aN=p.handleErrors(aM);D.log("PutDefaultEncryption:createBucket",0,aH,{error:aN});return aa.reject(aN)})}function i(aJ,aH){var aL=arguments.length<=2||arguments[2]===undefined?true:arguments[2];var aM={bucket:aJ};if(aL){var aK=ax.getAccessAnalysis(aJ);if(aK){return aa.when(aK)}}var aG=aa.defer();var aI=function aI(){if(aL){var aN=ax.getAccessAnalysis(aJ);if(aN){return aG.resolve(aN)}}if(O>=B.MAX_CALLS){Q(aI,B.SLEEP_TIME)}else{O++;y.makeS3ConsoleOperationRequest(aM,e.CWS_OPERATION_NAME.ANALYZE_ACCESS,{},aH).then(function(aO){var aQ=_.get(aO,"data.statusPerKey[0].result.additionalInfoWhenSuccess");var aP=_.get(aO,"data.statusPerKey[0].result.status");var aR=angular.fromJson(aQ);if(aP&&aP==="ERROR"){aG.reject(aO)}ax.putAccessAnalysis(aJ,aR);aG.resolve(aR)})["catch"](function(aO){aG.reject(aO)})["finally"](function(){O--})}};P.getBucketLocation(aH,aJ,aM).then(function(){aI()})["catch"](function(aN){aG.reject(p.handleErrors(aN,true))});return aG.promise}}])})();"use strict";(function(){angular.module("s3").service("ObjectPropertiesService",["$q","$translate","APIProxyService","CachingService","PathService","S3Constants","SCLogService","UtilService","XMLParser",function(s,m,n,e,b,l,a,w,x){var j="putObjectTagging";var h="putObjectVersionTagging";var q=[{value:l.USER_DEFINED_METADATA[0],text:m.instant("objectdetail.metadata.cache-control")},{value:l.USER_DEFINED_METADATA[1],text:m.instant("objectdetail.metadata.content-disposition"),dropDownValue:l.CONTENT_DISPOSITION},{value:l.USER_DEFINED_METADATA[2],text:m.instant("objectdetail.metadata.content-encoding")},{value:l.USER_DEFINED_METADATA[3],text:m.instant("objectdetail.metadata.content-language")},{value:l.USER_DEFINED_METADATA[4],text:m.instant("objectdetail.metadata.content-type"),dropDownValue:l.CONTENT_TYPE_VALUES},{value:l.USER_DEFINED_METADATA[5],text:m.instant("objectdetail.metadata.expires")},{value:l.USER_DEFINED_METADATA[6],text:m.instant("objectdetail.metadata.website-redirect-location")},{value:l.USER_DEFINED_METADATA_PREFIX,text:m.instant("objectdetail.metadata.x-amz-meta-"),displayTextField:true}];function t(z){var B=_.cloneDeep(z);for(var C in B){var A=B[C];if(A.StorageClass===l.STORAGE_CLASSES.GLACIER){A.downloadDisabled=true;A.deleteDisabled=true}A.StorageClass=w.getStorageClassTranslations()[A.StorageClass]}return B}function r(C,D){var A=_.cloneDeep(C);var z=undefined;D.downloadDisabled=true;for(var B=0;B<A.length;B++){z=A[B];if(z.LastModified<D.LastModified){A.splice(B,0,D);break}}return A}function y(D,C,B){var z=e.getCurrentVersions(C);if(z){B.isCached=true;a.log(B.name+"IsCached",0,B);return s.resolve(z)}var A=s.defer(),E={bucket:D,prefix:C};B.isCached=false;n.listVersions(B,E).then(function(L){var K=_.cloneDeep(L),H=undefined,G=undefined,I=undefined;if(K.response){if(typeof K.response==="string"){H=x.convertXmlStringToJson(K.response).ListVersionsResult}else{if(K.response.ListVersionsResult){H=K.response.ListVersionsResult}else{a.log(B.name+"ListVersionsCall",0,B);A.reject("There is no data in the listVersions response.");return}}G=H.Version;G=w.transformObjectToArray(G);G=_.filter(G,function(M){return M.Key===C});a.log(B.name+"ListVersionsCall",1,B)}else{a.log(B.name+"ListVersionsCall",0,B);A.reject("There is no data in the listVersions response.");return}B.listVersionsResponse=K;var F=w.getIconClassFromFilename(C);_.map(G,function(M){M.fileIconClass=F;return M});I=t(G);if(I&&H.DeleteMarker){var J=w.transformObjectToArray(H.DeleteMarker);_.each(J,function(M){M.fileIconClass=l.FILE_EXTENSIONS_ICON_MAP.trash;if(M.Key===C){I=r(I,M)}})}e.setCurrentVersions(C,I);A.resolve(I)})["catch"](function(F){A.reject(w.handleErrors(F))});return A.promise}function k(F,D,B,A){var C=b.getCurrentBucket();if(!D){a.log("putObjectTaggingReceived",1,A,{bucketName:C,object:F})}else{a.log("putObjectVersionTaggingReceived",1,A,{bucketName:C,object:F,versionId:D})}var E={Tagging:{TagSet:{Tag:[]}}};angular.forEach(B,function(G){if(G.Key){E.Tagging.TagSet.Tag.push({Key:G.Key,Value:G.Value})}});var z=x.jsonToXml(E);return n.putObjectTag(A,C,F,z,D).then(function(G){if(!D){a.logRequestComplete(j,A)}else{a.logRequestComplete(h,A)}return G})["catch"](function(G){if(!D){a.log(j,0,A,{objectName:F,error:G})}else{a.log(h,0,A,{objectName:F,versionId:D,error:G})}return s.reject(w.handleErrors(G))})}function c(z){if(!(z.metadataKey&&z.metadataKey.error)){if(z.metadataKey.hasOwnProperty("inputValue")&&!_.startsWith(z.metadataKey.inputValue,l.USER_DEFINED_METADATA_PREFIX)){z.metadataKey.error=m.instant("metadatacard.startingwith")}else{z.metadataKey.error=""}}}function u(z){if(!(z.metadataKey&&z.metadataKey.error)){if(z.metadataKey&&!/^[\x20-\x7E]+$/.test(z.metadataKey.text)||z.metadataKey.hasOwnProperty("inputValue")&&!/^[\x20-\x7E]+$/.test(z.metadataKey.inputValue)){z.metadataKey.error=m.instant("metadatacard.nonasc")}else{z.metadataKey.error=""}}}function f(z){if(!(z.metadataValue&&z.metadataValue.inputError)){if(z.metadataValue&&!_.isEmpty(z.metadataValue.text)&&!/^[\x20-\x7E]+$/.test(z.metadataValue.text)){z.metadataValue.inputError=m.instant("metadatacard.nonasc")}else{z.metadataValue.inputError=""}}}function p(z,B){z.forEach(function(C){if(!C.metadataKey){C.metadataKey={error:m.instant("objectdetail.metadata.emptyvaluewarning")}}else{if(C.metadataKey.hasOwnProperty("inputValue")&&_.isEmpty(C.metadataKey.inputValue)){C.metadataKey.error=m.instant("objectdetail.metadata.emptyvaluewarning")}else{if(_.isEmpty(C.metadataKey.text)){C.metadataKey.error=m.instant("objectdetail.metadata.emptyvaluewarning")}else{C.metadataKey.error=""}}}if(!C.metadataValue||C.metadataValue&&_.isEmpty(C.metadataValue.text)){if(C.metadataValue){C.metadataValue.inputError=m.instant("objectdetail.metadata.emptyvaluewarning")}else{C.metadataValue={inputError:m.instant("objectdetail.metadata.emptyvaluewarning")}}}else{if(C.metadataKey&&C.metadataKey.value===l.USER_DEFINED_METADATA[6]){if(!_.startsWith(C.metadataValue.text,"/")&&!_.startsWith(C.metadataValue.text,"http://")&&!_.startsWith(C.metadataValue.text,"https://")){C.metadataValue.inputError=m.instant("objectdetail.metadata.websitevaluewarning")}else{C.metadataValue.inputError=""}}else{C.metadataValue.inputError=""}}c(C);u(C);f(C)});var A=i(z);if(!_.isEmpty(A)&&B){B.text=A}return _.isEmpty(A)&&_.findIndex(z,function(C){return C.metadataValue.inputError&&C.metadataValue.inputError.length>0})===-1&&_.findIndex(z,function(C){return C.metadataKey.error&&C.metadataKey.error.length>0})===-1}function i(z){var B={};z.forEach(function(D){if(D&&D.metadataKey){var C=D.metadataKey.hasOwnProperty("inputValue")?D.metadataKey.inputValue:D.metadataKey.text;if(C){B[C]=B.hasOwnProperty(C)?B[C]+1:1}}});var A="";_.forEach(B,function(D,C){if(D>1){A+=C+", "}});return A.slice(0,A.lastIndexOf(","))}function d(A){var z={};_.forEach(A,function(C){var B=C.metadataKey.inputValue||C.metadataKey.value,D=C.metadataValue.text;z[B]=D});return z}function g(B,C,z){var A={addAndChangeMetadata:{},deleteMetadata:[],numberOfKeysPerBulkOperation:z};_.forEach(C,function(E,D){if(!B.hasOwnProperty(D)||B[D]!==E){A.addAndChangeMetadata[D]=E}});_.forEach(B,function(E,D){if(!C.hasOwnProperty(D)){A.deleteMetadata.push(D)}});return A}function v(){return q}var o={convertToReadableStorageClass:t,insertDeleteMarker:r,listVersions:y,putObjectTagging:k,isValid:p,getMetadataRequestParams:g,checkDuplicatedKey:i,getMetadataMap:d,getPredefinedMetadata:v};return o}])})();"use strict";(function(){angular.module("s3").service("VersioningUtilService",["PathService","S3Constants","UtilService",a]);function a(f,d,c){return{getAllVersionsForDisplay:e};function e(s,m){var h=s.Version,u=s.DeleteMarker,v={allVersions:[],nonVersionRowCount:0};if(!h&&!u){return v}if(h){h=f.absoluteToRelativeObjectPaths(c.transformObjectToArray(h),m)}else{h=[]}if(u){u=f.absoluteToRelativeObjectPaths(c.transformObjectToArray(u),m)}else{u=[]}var l=0,r=0,g=0,q=h.length+u.length;while(l<q){var p=undefined,j=[],k=[],t=[];if(r<h.length&&g<u.length){var o=h[r].Key,n=u[g].Key;if(o===n){p=o;h[r].isVersionRow=true;j.push(h[r]);u[g].isVersionRow=true;k.push(u[g]);r+=1;g+=1}else{if(o<n){p=o;h[r].isVersionRow=true;j.push(h[r]);r+=1}else{p=n;u[g].isVersionRow=true;k.push(u[g]);g+=1}}}else{if(g>=u.length&&r<h.length){p=h[r].Key;h[r].isVersionRow=true;j.push(h[r]);r+=1}else{if(r>=h.length&&g<u.length){p=u[g].Key;u[g].isVersionRow=true;k.push(u[g]);g+=1}}}while(r<h.length&&h[r].Key===p){h[r].isVersionRow=true;j.push(h[r]);r+=1}while(g<u.length&&u[g].Key===p){u[g].isVersionRow=true;k.push(u[g]);g+=1}l+=j.length+k.length;t=b(p,j,k);v.allVersions=v.allVersions.concat(t);v.nonVersionRowCount+=1}return v}function b(n,h,p){var g=0,o=0,i=h.length,q=[{isVersionRow:false,Key:n,LastModified:""}];h.forEach(function(r){r.isVersionRow=true});p.forEach(function(r){r.isVersionRow=true});if(h.length===0){q=q.concat(p);o=i}else{if(p.length===0){q=q.concat(h);o=i}}for(;o<i;o++){var l=h[o],j=new Date(l.LastModified),m=undefined,k=undefined;if(g<p.length){m=p[g];k=new Date(m.LastModified)}else{h.splice(0,o);q=q.concat(h);break}while(g<p.length&&j<k){q.push(m);g+=1;if(g<p.length){m=p[g];k=new Date(m.LastModified)}}q.push(l)}q[0].LastModified=q[1].LastModified;return q}}})();"use strict";(function(){angular.module("s3").directive("modal",[function(){return{restrict:"E",templateUrl:"/s3/partials/modal.html",scope:{isOpen:"=",closeCallback:"=?",headerTitle:"=",state:"=?",steps:"=?",nextState:"=?",previousState:"=?",setState:"=?"},transclude:{header:"?modalHeader",content:"modalContent",footer:"modalFooter"},controller:"ModalController"}}]);angular.module("s3").controller("ModalController",["$scope","UtilService",function(b,a){b.closeModal=function(){b.isOpen.flag=false;b.closeCallback();a.bodyFreezeScroll(b.isOpen&&b.isOpen.flag)};b.getState=function(c){var d=Object.keys(b.steps)[c];if(d){return b.steps[d]}return};b.setState=function(c){b.state=c};b.nextState=function(){var c=Object.keys(b.steps).indexOf(b.state.name);b.setState(b.getState(c+1))};b.previousState=function(){var c=Object.keys(b.steps).indexOf(b.state.name);b.setState(b.getState(c-1))}}])})();"use strict";(function(){angular.module("s3").directive("focusWhen",[function(){return{restrict:"A",link:function a(c,d,b){c.$on("focusOn",function(e,f){if(f===b.focusWhen){d[0].focus()}})}}}]);angular.module("s3").factory("focusOn",["$rootScope","$timeout",function(a,b){return function(c){b(function(){a.$broadcast("focusOn",c)})}}])})();"use strict";angular.module("s3").directive("clickoutside",["$document","UUIDService",function(c,a){return{restrict:"A",scope:{onClickOutside:"=",isEnabled:"=?"},link:function b(e,f,d){if(d.id){e.mainElementId=d.id}else{e.mainElementId=a.generateUUID();$(f).attr("id",e.mainElementId)}var g=function g(h){if(e.isEnabled===false){return}if(!h||!h.target){return}for(var i=h.target;i;i=i.parentNode){var j=i.id;if(j!==undefined&&j===e.mainElementId){return}}e.$apply(function(){e.onClickOutside()})};c.on("click",g);e.$on("$destroy",function(){c.off("click",g)})}}}]);"use strict";angular.module("s3").directive("bucketSelector",[function(){return{restrict:"E",controller:"BucketSelectorController",scope:{bucketList:"=?",copySettingsSourceBucket:"=?",operation:"=?",getSourceBucketProperties:"=?",getSourceBucketPermissions:"=?",currBucketPermissions:"=?",defaultAcls:"=?",editable:"=?",selectedReport:"=?",showBucketNameOnly:"=?",chooseAccounts:"=?",isOpen:"=?",sameRegion:"=?",bucketReplication:"=?",enableDeselect:"=?"},templateUrl:"/s3/partials/bucketselector.html"}}]);angular.module("s3").controller("BucketSelectorController",["$filter","$scope","$translate","BucketPropertiesService","BucketPropertiesUtilService","APIProxyService","XMLParser","SCLogService","ConsoleOperation","Region","PathService","PermissionsUtilService","S3Constants","UtilService",function(p,t,u,i,f,v,y,b,m,d,c,g,q,x){t.emptyText=u.instant("lamb.nobuckets");t.noSelectedBucketText=u.instant("bucketselector.selecteditem.placeholder");t.filterColumn="Name";var n=c.getCurrentBucket();var k="false";var e="";t.savingBucket=false;t.account={outside:k};t.tmpValues={accountId:"",bucket:"",regionError:""};t.tableFiltering={filter:{}};t.tableFiltering.filter[t.filterColumn]=t.defaultFilterValue;t.filterBlur=function(){if(!t.tableFiltering.filter[t.filterColumn]){t.tableFiltering.showClear=false}};t.clearFilter=function(){t.tableFiltering.filter[t.filterColumn]="";t.tableFiltering.showClear=false};t.filterKeyDown=function(z){if(z&&z.keyCode===q.KEY_CODES.ESC){$(".input-field").blur();t.clearFilter()}};function w(){i.getBucketLocation(t.copySettingsSourceBucket.Name).then(function(z){t.copySettingsSourceBucket.Location=d.twoWayMapping[z];if(t.selectedReport){t.selectedReport.Location=t.copySettingsSourceBucket.Location}})["catch"](function(z){if(t.selectedReport){t.selectedReport.bucketUnknown=u.instant("bucketselector.invalid.bucket");t.selectedReport.bucketError=true}})}t.$watch(function(){return t.tableFiltering.filter[t.filterColumn]},function(A,z){if(z!==A){t.selectedItem=null;if(t.bucketList){t.totalItems=p("filter")(t.bucketList,t.tableFiltering.filter).length}}});t.toggleDropDown=function(){t.isOpen=!t.isOpen;if(t.bucketList){t.bucketList.forEach(function(z){return z.isExpanded=false})}};t.closeDropDown=function(){t.isOpen=false;if(t.bucketList){t.bucketList.forEach(function(z){return z.isExpanded=false})}};t.getBucketPlaceHolder=function(){var z="bucketselector.selecteditem.placeholder";if(t.editable){z="bucketselector.selecteditem.notoptional.placeholder"}return u.instant(z)};t.getSearchPlaceHolder=function(){var z="bucketselector.inputfield.placeholder";if(t.editable){z="bucketselector.inputfield.enter.placeholder"}return u.instant(z)};t.getResultsMessage=function(){var z="bucketselector.nomatchesfound";if(t.editable&&!t.chooseAccounts){z="bucketselector.cross.account"}return u.instant(z)};function s(z){if(t.editable&&t.selectedReport){t.selectedReport.bucket=z.Name;t.selectedReport.Location=z.Location;t.selectedReport.bucketError=false;t.selectedReport.bucketUnknown=""}if(t.editable&&t.bucketReplication){t.bucketReplication.isLoading=true;t.bucketReplication.destinationBucket.name=z.Name;t.bucketReplication.destinationBucket.region=z.Location;if(!t.bucketReplication.isCrossAccount){t.bucketReplication.destinationBucket.accountId=null}i.getBucketVersioning(z.Name,new m("GetBucketVersioning"),false).then(function(A){l();t.bucketReplication.destinationBucket.versioningEnabled=A===q.BUCKET_PROPERTIES.VERSIONING.ENABLED})["catch"](function(A){l();t.bucketReplication.destinationBucket.Errors.getVersioningError=A})["finally"](function(){t.bucketReplication.isLoading=false;t.savingBucket=false;t.closeDropDown()})}}function l(){t.bucketReplication.destinationBucket.Errors={};t.bucketReplication.destinationBucket.versioningEnabled=null;t.bucketReplication.destinationBucket.createNewDestBucket=false;t.bucketReplication.destinationBucket.bucketNameValidationErrors.length=0}t.savePressed=function(z){z.stopPropagation();t.tmpValues.regionError="";t.tmpValues.accountIdError="";t.savingBucket=true;var A=f.stripBucketARN(t.tmpValues.bucket);if(A.length===0){return}if(!_.isEmpty(t.tmpValues.accountId)){t.tmpValues.accountId=t.tmpValues.accountId.trim();if(t.tmpValues.accountId.match(/^[0-9]+$/)===null){t.tmpValues.accountIdError=u.instant("bucketselector.invalidaccountid");t.savingBucket=false;return}}if(t.bucketReplication){t.bucketReplication.isCrossAccount=true;t.bucketReplication.isLoading=true;t.bucketReplication.destinationBucket.name=t.tmpValues.bucket;t.bucketReplication.destinationBucket.accountId=t.tmpValues.accountId;t.copySettingsSourceBucket={Name:A,Location:""};l();t.clearFilter();v.headBucket(new m("checkBucketAvailability"),t.bucketReplication.destinationBucket.name).then(function(){s(t.copySettingsSourceBucket)})["catch"](function(B){if(B.status===q.HTTP_STATUS_CODES.NOT_FOUND){t.bucketReplication.destinationBucket.Errors.bucketNotExistError=u.instant("crr.error.destinationbucketdoesnotexist");t.savingBucket=false;t.bucketReplication.isLoading=false;t.closeDropDown()}else{i.getBucketRegion(t.bucketReplication.destinationBucket.name).then(function(C){if(C.text===t.bucketReplication.sourceRegion){t.bucketReplication.destinationBucket.Errors.generalErrors={header:u.instant("crr.warningmsg.content.sameregion"),content:u.instant("crr.errormsg.bucketinsameregion")};t.savingBucket=false;t.bucketReplication.isLoading=false;t.closeDropDown()}else{t.copySettingsSourceBucket.Location=C.text;s(t.copySettingsSourceBucket)}})["catch"](function(){s(t.copySettingsSourceBucket)})}})}else{i.getBucketLocation(t.tmpValues.bucket).then(function(B){if(t.sameRegion){var C=d.twoWayMapping[B];if(e!==C){t.tmpValues.regionError=u.instant("management.analytics.bucket.region.error",{dest:C,src:e})}}})["catch"](function(B){t.tmpValues.regionError=u.instant("management.connection.error")})["finally"](function(){if(!t.tmpValues.regionError){if(t.selectedReport){t.selectedReport.bucket=t.tmpValues.bucket;t.selectedReport.accountId=t.tmpValues.accountId}t.copySettingsSourceBucket={Name:A,Location:""};t.closeDropDown();t.clearFilter();s(t.copySettingsSourceBucket);w();z.stopPropagation()}t.savingBucket=false})}};t.createNewBucket=function(){l();t.bucketReplication.destinationBucket.name=null;t.bucketReplication.destinationBucket.region=null;t.bucketReplication.destinationBucket.createNewDestBucket=true;t.copySettingsSourceBucket={Name:u.instant("bucketselector.createnew")};t.closeDropDown()};t.selectBucket=function(z){t.copySettingsSourceBucket=z;if(t.bucketReplication){t.bucketReplication.isCrossAccount=false;t.bucketReplication.destinationBucket.createNewDestBucket=false;l();s(z)}else{(function(){s(z);t.getSourceBucketProperties={tagging:{tags:[]},logging:{selectedValue:q.BUCKET_PROPERTIES.DISABLE},versioning:{selectedValue:q.BUCKET_PROPERTIES.DISABLE},eventSelectors:{trailNames:[],access:{read:false,write:false},targetTrail:"",enabled:false,trailRegionMapping:{}}};var C=new m("CreateBucketLogging");var B=new m("CreateBucketTagging");var A=new m("CreateBucketVersioning");v.getBucketProperty(B,z.Name,"tagging").then(function(F){var D=F.response;r("getBucketTagging",true,B,"");var E=y.convertXmlStringToJson(D);if(E.Tagging){f.populateTagsFields(E,t.getSourceBucketProperties.tagging.tags)}})["catch"](function(E){var D=x.handleErrors(E);if(D!==q.BUCKET_PROPERTIES.TAGGING.TAG_SET_NOT_EXIST_MESSAGE){r("getBucketTagging",false,B,E);t.getSourceBucketProperties.tagging.isError=true;t.getSourceBucketProperties.tagging.errorMessage=D}else{r("getBucketTagging",true,B,"")}});i.getBucketVersioning(t.copySettingsSourceBucket.Name,A).then(function(D){if(D===q.BUCKET_PROPERTIES.VERSIONING.ENABLED){t.getSourceBucketProperties.versioning.selectedValue=q.BUCKET_PROPERTIES.ENABLE;if(t.bucketReplication&&t.bucketReplication.destinationBucket){l();t.bucketReplication.destinationBucket.Errors.versioningEnabled=true}}else{t.getSourceBucketProperties.versioning.selectedValue=q.BUCKET_PROPERTIES.DISABLE;if(t.bucketReplication&&t.bucketReplication.destinationBucket){l();t.bucketReplication.destinationBucket.Errors.versioningEnabled=false}}})["catch"](function(D){t.getSourceBucketProperties.versioning.isError=true;t.getSourceBucketProperties.versioning.errorMessage=D;if(t.bucketReplication&&t.bucketReplication.destinationBucket){l();t.bucketReplication.destinationBucket.Errors.getVersioningError=D;t.bucketReplication.destinationBucket.versioningEnabled=null}});v.getBucketProperty(C,t.copySettingsSourceBucket.Name,"logging").then(function(E){var D=E.response;r("getBucketLogging",true,C,"");if(D){f.populateLoggingFields(D,t.getSourceBucketProperties.logging)}})["catch"](function(D){r("getBucketLogging",false,C,D);t.getSourceBucketProperties.logging.isError=true;t.getSourceBucketProperties.logging.errorMessage=x.handleErrors(D)});o()})()}t.isOpen=false;if(!t.account.outside&&(t.selectedReport||t.bucketReplication)){t.tmpValues.accountId="";t.tmpValues.bucket="";t.tmpValues.regionError=""}};function o(){if(!_.isEmpty(t.currBucketPermissions)&&!_.isEmpty(t.defaultAcls)){t.currBucketPermissions.publicPermissions=_.cloneDeep(t.defaultAcls.publicPermissions);t.currBucketPermissions.userPermissions=_.cloneDeep(t.defaultAcls.userPermissions);t.currBucketPermissions.awsAccountPermissions=_.cloneDeep(t.defaultAcls.awsAccountPermissions);t.currBucketPermissions.systemPermissions=_.cloneDeep(t.defaultAcls.systemPermissions)}var z=new m(q.BUCKET_PERMISSIONS.CREATE_BUCKET_PERMISSIONS);i.getBucketGrantees(t.copySettingsSourceBucket.Name,z).then(function(A){r("getBucketGrantees",true,z,"");t.getSourceBucketPermissions.grantees=A;i.getBucketACP(t.copySettingsSourceBucket.Name,z).then(function(B){r("getBucketAcls",true,z,"");var D=_.get(B,"Owner");var C=_.get(B,"AccessControlList.Grant",[]);t.getSourceBucketPermissions.aclGrants=Array.isArray(C)?C:[C];if(!_.isEmpty(t.currBucketPermissions)){g.populateAclsFields(t.currBucketPermissions,t.getSourceBucketPermissions.grantees,D,t.getSourceBucketPermissions.aclGrants)}})["catch"](function(B){r("getBucketAcls",false,z,B);t.getSourceBucketPermissions.aclGrants.isError=true;t.getSourceBucketPermissions.aclGrants.errorMessage=B})})["catch"](function(A){r("getBucketGrantees",false,z,A);t.getSourceBucketPermissions.grantees.isError=true;t.getSourceBucketPermissions.grantees.errorMessage=x.handleErrors(A)})}function r(A,C,z,B){C===true?b.log(A,1,z,{bucketName:t.copySettingsSourceBucket.Name}):b.log(A,0,z,{bucketName:t.copySettingsSourceBucket.Name,error:B})}t.deselectBucket=function(){if(!t.editable){t.copySettingsSourceBucket=undefined;t.getSourceBucketProperties={tagging:{tags:[]},logging:{selectedValue:q.BUCKET_PROPERTIES.DISABLE},versioning:{selectedValue:q.BUCKET_PROPERTIES.DISABLE},eventSelectors:{trailNames:[],access:{read:false,write:false},targetTrail:"",enabled:false,trailRegionMapping:{}}};t.getSourceBucketPermissions.aclGrants={};t.getSourceBucketPermissions.grantees={};t.currBucketPermissions.publicPermissions=_.cloneDeep(t.defaultAcls.publicPermissions);t.currBucketPermissions.userPermissions=_.cloneDeep(t.defaultAcls.userPermissions);t.currBucketPermissions.awsAccountPermissions=_.cloneDeep(t.defaultAcls.awsAccountPermissions)}};t.toggleBucket=function(z,A){A.isExpanded=!A.isExpanded;z.stopPropagation();if(A.isExpanded){b.log("getPropertiesForBucketSelector",1,t.operation,{bucketName:A.Name});A.propertyCount=0;i.getBucketGranteeCounts(A.Name).then(function(B){A.permissionCount=B;A.granteeCount=A.permissionCount.READ+A.permissionCount.WRITE+A.permissionCount.READ_ACP+A.permissionCount.WRITE_ACP});i.isLoggingEnabled(A.Name).then(function(B){if(B){A.loggingStatus=u.instant("bucketproperty.enabled");A.propertyCount++}else{A.loggingStatus=u.instant("bucketproperty.disabled")}});i.getVersioningStatus(A.Name).then(function(B){if(B==="Enabled"){A.versioningStatus=u.instant("bucketproperty.enabled");A.propertyCount++}else{if(B==="Suspended"){A.versioningStatus=u.instant("bucketproperty.suspended")}else{A.versioningStatus=u.instant("bucketproperty.disabled")}}});i.getTagCount(A.Name).then(function(B){A.tagCount=B})}};function j(){i.getBucketLocation(n).then(function(z){e=d.twoWayMapping[z]})["finally"](function(){h(t.operation)})}function h(z){var A=arguments.length<=1||arguments[1]===undefined?true:arguments[1];t.bucketsLoaded=false;b.log("LoadBucketsReceived",1,z);t.isLoadingBuckets=true;if(t.bucketReplication){t.bucketReplication.isLoading=t.isLoadingBuckets}v.listAllMyBuckets(z,A).then(function(C){b.log("listAllMyBuckets",1,z);var B=C.response.ListAllMyBucketsResult.Buckets.Bucket;if(B&&B.length>0){(function(){var D=B.length;B.forEach(function(E){i.getBucketLocation(E.Name).then(function(F){E.Location=d.twoWayMapping[F]})["finally"](function(){D--;if(D<=0){if(t.sameRegion&&e){var F=_.filter(B,function(H){return H.Location===e});t.bucketList=F;if(t.selectedReport&&t.selectedReport.bucket){var G=_.findIndex(B,function(H){return H.Name===t.selectedReport.bucket})===-1;t.account.outside=G?"true":"false";if(G){t.tmpValues.bucket=t.selectedReport.bucket;t.tmpValues.regionError=""}}}else{if(t.bucketReplication&&t.bucketReplication.sourceBucket){t.bucketReplication.bucketListCurrAccount.length=0;B.forEach(function(H){t.bucketReplication.bucketListCurrAccount.push(H)});t.bucketList=_.filter(B,function(H){return H.Name!==t.bucketReplication.sourceBucket&&H.Location!==t.bucketReplication.sourceRegion});if(t.bucketReplication.destinationBucket&&!t.bucketReplication.destinationBucket.createNewDestBucket&&!_.isEmpty(t.bucketReplication.destinationBucket.name)){t.bucketReplication.isCrossAccount=_.findIndex(B,function(H){return H.Name===t.bucketReplication.destinationBucket.name})===-1;t.account.outside=t.bucketReplication.isCrossAccount?"true":"false";if(t.bucketReplication.isCrossAccount){t.tmpValues.bucket=t.bucketReplication.destinationBucket.name;t.tmpValues.regionError=""}}}else{t.bucketList=B}}t.isLoadingBuckets=false;if(t.bucketReplication){t.bucketReplication.isLoading=t.isLoadingBuckets}}})})})()}else{t.bucketList=[]}})["catch"](function(B){b.log("listAllMyBuckets",0,z,{error:B});t.bucketList=[];t.isLoadingBuckets=false;if(t.bucketReplication){t.bucketReplication.isLoading=t.isLoadingBuckets}t.bucketsLoaded=true})}function a(){t.bucketsLoaded=false;t.outside=false;if(t.chooseAccounts&&t.selectedReport){t.tmpValues.bucket=t.selectedReport.bucket;t.tmpValues.accountId=t.selectedReport.accountId;t.tmpValues.regionError=""}if(t.chooseAccounts&&t.bucketReplication){t.tmpValues.bucket=t.bucketReplication.destinationBucket.name;t.tmpValues.accountId=t.bucketReplication.destinationBucket.accountId;t.tmpValues.regionError="";t.account.outside=t.bucketReplication.isCrossAccount?"true":"false"}if(!t.bucketList&&t.editable){t.operation=new m("SelectBucket");var A={};var z=q.BUCKET_PROPERTIES;var B=q.BUCKET_PERMISSIONS;A.createBucketProperties={getResponse:{tagging:{tags:[]},logging:{selectedValue:z.DISABLE},versioning:{selectedValue:z.DISABLE},eventSelectors:{trailNames:[],access:{read:false,write:false},targetTrail:"",enabled:false,trailRegionMapping:{}}}};A.sourceBucketPermissions={grantees:{},aclGrants:{}};A.currPermissions=_.cloneDeep(B.INITIALIZE_ACLS);A.createBucketValues={firstLoad:true,copySettingsSourceBucket:null};A.operation=new m("CreateBucket","CreateBucketRequestReceived");A.defaultAcls=_.cloneDeep(B.INITIALIZE_ACLS);t.copySettingsSourceBucket={};if(t.selectedReport&&t.selectedReport.bucket){t.copySettingsSourceBucket.Name=t.selectedReport.bucket}if(t.bucketReplication&&t.bucketReplication.destinationBucket){t.copySettingsSourceBucket.Name=t.bucketReplication.destinationBucket.createNewDestBucket?u.instant("bucketselector.createnew"):t.bucketReplication.destinationBucket.name}t.getSourceBucketProperties=A.createBucketProperties.getResponse;t.getSourceBucketPermissions=A.sourceBucketPermissions;t.currBucketPermissions=A.createBucketValues.copySettingsSourceBucket;t.defaultAcls=A.defaultAcls;j()}else{t.bucketsLoaded=true}}a()}]);"use strict";(function(){angular.module("s3").directive("operationManager",[function(){return{restrict:"AE",scope:{selectedTab:"="},templateUrl:"/s3/partials/progressbar.html",controller:"ProgressbarController"}}]);angular.module("s3").controller("ProgressbarController",["$filter","$scope","$translate","OperationDispatcherService","$window","SCLogService","S3Constants",function(f,a,e,h,g,d,c){a.isExpanded=false;a.thresholdPercentage=c.OPERATION.THRESHOLD_PERCENTAGE;a.isActiveUploadOperation=function(i){return i.name===c.OPERATION_NAME.UPLOAD&&i.state===c.OPERATION_STATE.ACTIVE};a.$watch(function(i){return i.isExpanded&&i.showingOperations===i.allOperations.ongoingOperations&&i.totalOngoingOperations.length>0},function(i){a.isExpanded=i});a.modalOpen={flag:false};a.detailOperation=null;a.allOperations={ongoingOperations:a.totalOngoingOperations,completedOperations:a.completedOperations,incompleteOperations:a.incompleteOperations};a.$watch(function(i){i.allOperations.ongoingOperations=i.totalOngoingOperations;i.allOperations.completedOperations=i.completedOperations;i.allOperations.incompleteOperations=i.incompleteOperations;return i.allOperations},function(i){a.allOperations=i});a.showingOperations=a.allOperations.ongoingOperations;a.totalOperationCount=Object.keys(h.getAllOperations()).length;a.$watch(function(){return Object.keys(h.getAllOperations()).length},function(i){a.totalOperationCount=i});a.incompleteOperations=[];a.$watch(function(i){i.incompleteOperations.length=0;h.getOperationsWithState(c.OPERATION_STATE.ERROR,i.incompleteOperations);var j=[];h.getOperationsWithState(c.OPERATION_STATE.CANCEL,j);j.forEach(function(k){i.incompleteOperations.push(k)});return i.incompleteOperations},function(i){a.incompleteOperations=i});a.completedOperations=[];a.$watch(function(i){i.completedOperations.length=0;h.getOperationsWithState(c.OPERATION_STATE.COMPLETED,i.completedOperations);return i.completedOperations},function(i){a.completedOperations=i});a.waitingOperations=h.getWaitingOperations();a.ongoingOperations=h.getOngoingOperations();a.totalOngoingOperations=[];var b=0;a.$watch(function(j){b=j.totalOngoingOperations.length;if(j.totalOngoingOperations.length===Object.keys(j.ongoingOperations).length+j.waitingOperations.length){j.totalOngoingOperations.length=0}else{j.totalOngoingOperations=[]}for(var k in j.ongoingOperations){j.totalOngoingOperations.push(j.ongoingOperations[k])}j.waitingOperations.forEach(function(i){j.totalOngoingOperations.push(i)});return j.totalOngoingOperations},function(i){if(b<i.length){a.expandOrCollapseOperations(a.totalOngoingOperations,true,"ongoingOperations")}else{if(b!==0&&i.length===0){a.operationState.ongoingOperations=false}}a.totalOngoingOperations=i});a.expandOrCollapseOperations=function(l,k,j){var i=a.showingOperations!==l;a.operationState={ongoingOperations:false,completedOperations:false,incompleteOperations:false};a.operationState[j]=!a.isExpanded&&k;a.showingOperations=l;if(a.showingOperations.length===0){a.isExpanded=false;return}a.isExpanded=i&&a.showingOperations.length>0||!a.isExpanded};a.openModal=function(i){a.modalOpen.flag=true;a.detailOperation=i;a.detailCancelButtonText=i.state===c.OPERATION_STATE.ACTIVE?e.instant("operation.detail.cancel"):e.instant("operation.detail.close")};a.cancelOperation=function(i){if(i.state===c.OPERATION_STATE.ACTIVE){if(g.confirm(e.instant("operation.warning.cancel"))){d.log(c.PROGRESS_BAR.USER_CONFIRM_CANCEL_FROM_PROGRESS_BAR,1,i);h.cancelOperation(i)}}else{h.cancelOperation(i)}if(i===a.detailOperation){a.modalOpen.flag=false;a.detailOperation=null}};a.cancelFromDetailView=function(i){if(i.state===c.OPERATION_STATE.ACTIVE){if(g.confirm(e.instant("operation.warning.cancel"))){d.log(c.PROGRESS_BAR.USER_CONFIRM_CANCEL_FROM_DETAIL_MODAL,1,i);h.cancelOperation(i);a.modalOpen.flag=false}}else{a.modalOpen.flag=false}};a.closeDetailView=function(){a.modalOpen.flag=false;a.detailOperation=null};a.getIconForOperation=function(i){var l="cog",n="files-o",k="key",j="trash-o",m="upload";switch(i){case c.OPERATION_NAME.MAKE_PUBLIC:case c.OPERATION_NAME.CHANGE_STORAGE_CLASS:case c.OPERATION_NAME.CHANGE_METADATA:case c.OPERATION_NAME.INITIATE_RESTORE:return l;case c.OPERATION_NAME.CHANGE_SSE:return k;case c.OPERATION_NAME.DELETE_OBJECTS:case c.OPERATION_NAME.RESTORE_OBJECTS:case c.OPERATION_NAME.DELETE_BUCKET:case c.OPERATION_NAME.EMPTY_BUCKET:return j;case c.OPERATION_NAME.UPLOAD:return m;case c.OPERATION_NAME.COPY:case c.OPERATION_NAME.CUT:case c.OPERATION_NAME.ADD_OBJECT_TAG:case c.OPERATION_NAME.RENAME:return n}}}])})();"use strict";(function(){angular.module("s3").directive("detailProgress",[function(){return{restrict:"AE",templateUrl:"/s3/partials/detailprogress.html",scope:{isOpen:"=",cancelButtonText:"=",targetOperation:"=",closeCallback:"=?",cancelOperationFunction:"=?"},controller:"detailProgressController"}}]);angular.module("s3").controller("detailProgressController",["$scope","UtilService","S3Constants",function(b,a,c){b.deleteBucketOperationName=c.OPERATION_NAME.DELETE_BUCKET;b.UPLOAD_OPERATION=c.OPERATION_NAME.UPLOAD;b.isActiveUploadOperation=function(){return _.get(b.targetOperation,"name")===b.UPLOAD_OPERATION&&b.targetOperation.state===c.OPERATION_STATE.ACTIVE};b.shouldShowByteText=function(){return _.get(b.targetOperation,"name")===b.UPLOAD_OPERATION&&!b.targetOperation.parameters.isDeleteBucketSuccessful};b.getFileIconClass=function(d){return a.getIconClassFromFilename(d)}}])})();"use strict";(function(){angular.module("s3").directive("bucketVersioning",[function(){return{restrict:"E",scope:{cardOpen:"=",versioning:"=",forCreateBucketModal:"=?",id:"@?"},templateUrl:"/s3/partials/bucketversioning.html",controller:"BucketVersioningController"}}]);angular.module("s3").controller("BucketVersioningController",["$scope","$timeout","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService",a]);function a(p,d,b,e,f,k,l,i,o,n){p.docLink=e.getDocUrl(i.LEARN_MORE_LINKS.VERSIONING);p.versioningError=false;p.versioningStates={enable:"enable",disable:"disable"};var c="enable",j="disable";var h=new k("BucketVersioning","getVersioning");function g(){var s=document.getElementById(i.BUCKET_PROPERTIES.VERSIONING.CREATE_BUCKET_CARD);s.scrollIntoView()}p.cardSummaryObj=_.cloneDeep(i.CARD_SUMMARY_INIT);p.cardSummaryObj.inactiveSummary.text=b.instant("bucketproperty.disabled");p.cardSummaryObj.activeSummary.text=b.instant("bucketproperty.enabled");function r(){p.cardSummaryObj.isActive=p.versioning.selectedValue===p.versioningStates.enable}p.getBucketVersioning=function(){p.cardSummaryObj.isLoading=true;var s=l.getCurrentBucket();f.getBucketVersioning(s,h).then(function(t){p.versioningError=false;if(t==="Enabled"){p.versioning.selectedValue=angular.copy(p.versioningStates.enable)}else{p.versioning.selectedValue=angular.copy(p.versioningStates.disable)}p.cachedVersioning=angular.copy(p.versioning);r()})["catch"](function(t){p.versioningError=true;p.versioningErrorMessage=t;p.cachedVersioning=angular.copy(p.versioning)})["finally"](function(){p.cardSummaryObj.isLoading=false})};function q(s){if(p.versioning.selectedValue===c&&p.cachedVersioning.selectedValue===j){p.versioningWarningMsg=s?b.instant("bucketversioning.enablewarning"):null}else{if(p.versioning.selectedValue===j&&p.cachedVersioning.selectedValue===c){p.versioningWarningMsg=s?b.instant("bucketversioning.disablewarning"):null}else{p.versioningWarningMsg=null}}}p.updateWarningMsg=function(){m()};function m(){var s=new k(i.LIFECYCLE.BUCKET_LIFECYCLE);s.step=i.LIFECYCLE.GET_BUCKET_LIFECYCLE;f.getBucketLifecycle(l.getCurrentBucket(),s).then(function(){q(true)})["catch"](function(){q(false)})}if(p.forCreateBucketModal){p.$watch("cardOpen",function(t,s){if(t){d(g,1)}});if(!_.isEmpty(p.versioning)&&p.versioning.errorMessage){p.versioningError=true;p.versioningErrorMessage=p.versioning.errorMessage}p.cachedVersioning=angular.copy(p.versioning);r()}else{p.scrollCardId="#"+p.id;p.getBucketVersioning()}p.cancelBucketVersioning=function(s){n.analyticsTrackClick(i.ANALYTICS.CANCEL_VERSIONING,i.ANALYTICS.DETAILS);s.stopPropagation();p.versioning=angular.copy(p.cachedVersioning);p.versioningError=false;p.versioningErrorMessage="";p.cardOpen=false;p.versioningWarningMsg=null};p.saveBucketVersioning=function(t){n.analyticsTrackClick(i.ANALYTICS.SAVE_VERSIONING,i.ANALYTICS.DETAILS);t.stopPropagation();p.versioningError=false;p.versioningErrorMessage="";var v;var s=null;if(!p.forCreateBucketModal){var u=l.getCurrentBucket();if(p.versioning.selectedValue===p.versioningStates.enable){v=f.enableBucketVersioning;s=new k("enableBucketVersioning")}else{v=f.disableBucketVersioning;s=new k("disableBucketVersioning")}v(u,s).then(function(){p.cachedVersioning.selectedValue=angular.copy(p.versioning.selectedValue);p.cardOpen=false;p.versioningWarningMsg=null;r()})["catch"](function(w){p.versioningError=true;p.versioningErrorMessage=w})}else{p.cachedVersioning=angular.copy(p.versioning);p.cardOpen=false;r()}}}})();"use strict";(function(){angular.module("s3").directive("bucketTagging",[function(){return{restrict:"E",scope:{cardOpen:"=",bucketTags:"=",forCreateBucketModal:"=?",id:"@?"},templateUrl:"/s3/partials/buckettagging.html",controller:"BucketTaggingController"}}]);angular.module("s3").controller("BucketTaggingController",["$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService","XMLParser",a]);function a(p,d,b,c,e,f,j,l,m,i,o,n,k){p.docLink=e.getDocUrl(i.LEARN_MORE_LINKS.TAGGING);p.tagError=false;p.tagErrorMessage="";p.cachedBucketTags={tags:[]};p.tagCount=0;p.cardSummaryObj=_.cloneDeep(i.CARD_SUMMARY_INIT);function q(){p.cardSummaryObj.isActive=p.tagCount>0;if(p.tagCount>0){p.cardSummaryObj.activeSummary.text=p.tagCount+b.instant("bucketproperties.tagging.summarylable")}else{p.cardSummaryObj.inactiveSummary.text=p.tagCount+b.instant("bucketproperties.tagging.summarylable")}}p.cancelBucketTagging=function(r){n.analyticsTrackClick(i.ANALYTICS.CANCEL_TAGGING,i.ANALYTICS.DETAILS);r.stopPropagation();p.bucketTags.tags=angular.copy(p.cachedBucketTags.tags);p.tagError=false;p.tagErrorMessage="";p.cardOpen=false};p.removeTag=function(r){p.bucketTags.tags.splice(r,1)};p.addTag=function(){p.bucketTags.tags.push({Key:"",Value:""})};var h=new l("BucketTagging","getTagging");function g(){var r=document.getElementById(i.BUCKET_PROPERTIES.TAGGING.CREATE_BUCKET_CARD);r.scrollIntoView()}p.getBucketTags=function(){p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);p.cardSummaryObj.isLoading=true;o.log("getBucketTaggingReceived",1,h,{bucketName:m.getCurrentBucket()});c.getBucketProperty(h,m.getCurrentBucket(),"tagging").then(function(t){var r=t.response;o.logRequestComplete("getBucketTagging",h);p.tagError=false;if(r){var s=k.convertXmlStringToJson(r);if(s.Tagging){j.populateTagsFields(s,p.bucketTags.tags);p.tagCount=s.Tagging.TagSet.Tag.length||1}}p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);q()})["catch"](function(r){var s=n.handleErrors(r);if(r!==i.BUCKET_PROPERTIES.TAGGING.TAG_SET_NOT_EXIST_MESSAGE){o.log("getBucketTagging",0,h,{bucketName:m.getCurrentBucket(),error:r});p.tagError=true;p.tagErrorMessage=s}else{o.logRequestComplete("getBucketTagging",h)}p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);q()})["finally"](function(){p.cardSummaryObj.isLoading=false})};if(!p.forCreateBucketModal){p.scrollCardId="#"+p.id;p.getBucketTags()}else{p.$watch("cardOpen",function(s,r){if(s){d(g,1)}});if(!_.isEmpty(p.bucketTags.tags)&&p.bucketTags.errorMessage){p.tagError=true;p.tagErrorMessage=p.bucketTags.errorMessage}p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);p.tagCount=p.bucketTags&&p.bucketTags.tags.length?p.bucketTags.tags.length:0;q()}p.saveBucketTagging=function(t){n.analyticsTrackClick(i.ANALYTICS.SAVE_TAGGING,i.ANALYTICS.DETAILS);t.stopPropagation();p.tagError=false;p.tagErrorMessage="";if(!p.forCreateBucketModal){var u=m.getCurrentBucket();var s=p.bucketTags.tags;var v=undefined;var r=null;if(s.length>0){v=f.putBucketTagging;r=new l("putBucketTagging")}else{v=f.deleteBucketTagging;r=new l("deleteBucketTagging")}v(u,s,r).then(function(){p.tagCount=p.bucketTags.tags.length;p.cardOpen=false;p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);q()})["catch"](function(w){p.tagError=true;p.tagErrorMessage=w})}else{p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);p.tagCount=p.bucketTags.tags.length;p.cardOpen=false;q()}}}})();"use strict";(function(){angular.module("s3").directive("bucketLogging",[function(){return{restrict:"E",scope:{cardOpen:"=",logging:"=",forCreateBucketModal:"=?",bucketList:"=?",createBucketValues:"=?",id:"@?"},templateUrl:"/s3/partials/bucketlogging.html",controller:"BucketLoggingController"}}]);angular.module("s3").controller("BucketLoggingController",["$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService",a]);function a(n,r,o,p,b,j,g,l,d,m,c,s){n.saving=false;n.docLink=b.getDocUrl(m.LEARN_MORE_LINKS.LOGGING);n.cachedLogging={};n.logging.targetBucketOptions=[];n.loggingError=false;n.resetLoggingValue=true;n.loggingErrorMessage="";n.loggingState={enable:"enable",disable:"disable"};n.cancelBucketLogging=function(t){s.analyticsTrackClick(m.ANALYTICS.CANCEL_LOGGING,m.ANALYTICS.DETAILS);t.stopPropagation();n.logging=angular.copy(n.cachedLogging);n.cardOpen=false;n.loggingError=false;n.loggingErrorMessage="";f()};n.cardSummaryObj=_.cloneDeep(m.CARD_SUMMARY_INIT);n.cardSummaryObj.activeSummary.text=o.instant("bucketproperty.enabled");n.cardSummaryObj.inactiveSummary.text=o.instant("bucketproperty.disabled");f();function f(){n.cardSummaryObj.isActive=n.logging.selectedValue===n.loggingState.enable}function q(t){n.loggingError=true;n.loggingErrorMessage=t}function e(u,t){u.push({Grantee:{Type:m.BUCKET_PROPERTIES.GROUP_GANTEE_TYPE,DisplayName:"",EmailAddress:"",ID:"",URI:m.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:t})}function h(){var t=document.getElementById(m.BUCKET_PROPERTIES.LOGGING.CREATE_BUCKET_CARD);t.scrollIntoView()}function i(w,t,u){var v=arguments.length<=3||arguments[3]===undefined?null:arguments[3];if(_.isEmpty(v)){j.getBucketLocation(u).then(function(x){w.forEach(function(y){j.getBucketLocation(y.Name).then(function(z){if(x===z){t.push({value:y.Name,text:y.Name});n.cachedLogging.targetBucketOptions=_.cloneDeep(t)}})})})}else{t.push({value:n.createBucketValues.name,text:n.createBucketValues.name});n.cachedLogging.targetBucketOptions=_.cloneDeep(t);w.forEach(function(x){j.getBucketLocation(x.Name).then(function(y){if(v&&v.value===y){t.push({value:x.Name,text:x.Name});if(x.Name===n.logging.targetBucket&&n.resetLoggingValue){n.resetLoggingValue=false}n.cachedLogging.targetBucketOptions=_.cloneDeep(t)}})});if(n.createBucketValues.name===n.logging.targetBucket&&n.resetLoggingValue){n.resetLoggingValue=false}}}n.getBucketLogging=function(){var t=new l("BucketLogging","getLogging");var u=d.getCurrentBucket();n.cardSummaryObj.isLoading=true;c.log("getBucketLoggingReceived",1,t,{bucketName:u});t.step="listAllMyBuckets";p.listAllMyBuckets(t).then(function(x){var v=x.response;c.log("ListAllMyBuckets",1,t,{bucketName:u});var w=v.ListAllMyBucketsResult.Buckets.Bucket;i(w,n.logging.targetBucketOptions,u)})["catch"](function(v){c.log("ListAllMyBuckets",0,t,{bucketName:u,error:v});n.loggingError=true;n.loggingErrorMessage=s.handleErrors(v)});t.step="getBucketLogging";p.getBucketProperty(t,u,"logging").then(function(w){var v=w.response;n.loggingError=false;c.logRequestComplete("getBucketLogging",t);if(v){g.populateLoggingFields(v,n.logging);n.cachedLogging=angular.copy(n.logging);f()}})["catch"](function(v){c.log("getBucketLogging",0,t,{bucketName:u,error:v});n.loggingError=true;n.loggingErrorMessage=s.handleErrors(v);n.cachedLogging=angular.copy(n.logging)})["finally"](function(){n.cardSummaryObj.isLoading=false})};if(n.forCreateBucketModal){n.$watch("cardOpen",function(u,t){if(u){r(h,1)}});i(n.bucketList,n.logging.targetBucketOptions,n.createBucketValues.name,n.createBucketValues.region);n.$watch("resetLoggingValue",function(t){if(t){n.logging.selectedValue=m.BUCKET_PROPERTIES.DISABLE;n.cachedLogging.selectedValue=angular.copy(n.logging.selectedValue);f()}});if(!_.isEmpty(n.logging)&&n.logging.errorMessage){n.loggingError=true;n.loggingErrorMessage=n.logging.errorMessage}n.cachedLogging=angular.copy(n.logging)}else{n.scrollCardId="#"+n.id;n.getBucketLogging()}function k(v,x,w,t,u){u.step=m.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING;j.enableBucketLogging(v,x,w,t,u).then(function(){n.cachedLogging=_.cloneDeep(n.logging);f();n.cardOpen=false;n.saving=false})["catch"](function(y){q(y);n.saving=false})}n.saveBucketLogging=function(u){s.analyticsTrackClick(m.ANALYTICS.SAVE_LOGGING,m.ANALYTICS.DETAILS);u.stopPropagation();n.loggingError=false;n.loggingErrorMessage="";if(!n.forCreateBucketModal){var w;var v;var t;(function(){n.saving=true;var x=d.getCurrentBucket();w=n.logging.targetBucket;v=n.logging.targetPrefix;t=n.logging.targetGrants;if(!Array.isArray(t)){var y=t;t=[y]}if(n.logging.selectedValue===n.loggingState.enable){(function(){var z=new l(m.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING);var A=false;z.step=m.BUCKET_PROPERTIES.GET_BUCKET_ACL;j.getBucketACL(w,z).then(function(B){var C=s.transformObjectToArray(B);if(_.findIndex(B,{Grantee:{URI:m.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:m.ACL_PERMISSIONS.WRITE})===-1){e(C,m.ACL_PERMISSIONS.WRITE);A=true}if(_.findIndex(B,{Grantee:{URI:m.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:m.ACL_PERMISSIONS.READ_ACP})===-1){e(C,m.ACL_PERMISSIONS.READ_ACP);A=true}if(A){z.step=m.BUCKET_PROPERTIES.PUT_BUCKET_ACL;j.putBucketACL(w,C,z).then(function(){k(x,w,v,t,z)})["catch"](function(D){q(D);n.saving=false})}else{k(x,w,v,t,z)}})["catch"](function(B){q(B);n.saving=false})})()}else{j.disableBucketLogging(x,new l("disableBucketLogging")).then(function(z){n.cachedLogging=_.cloneDeep(n.logging);f();n.cardOpen=false})["catch"](function(z){q(z)})["finally"](function(){n.saving=false})}})()}else{if(!n.logging.targetGrants){n.logging.targetGrants=[]}n.cachedLogging=angular.copy(n.logging);n.cardOpen=false;f()}}}})();"use strict";(function(){angular.module("s3").directive("bucketWebsite",[function(){return{restrict:"E",scope:{cardOpen:"=",website:"=",forCreateBucketModal:"=?",region:"=?",createBucketName:"=?",id:"@?"},templateUrl:"/s3/partials/bucketwebsite.html",controller:"BucketWebsiteController"}}]);angular.module("s3").controller("BucketWebsiteController",["$filter","$scope","$timeout","$translate","$window","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService","XMLParser",a]);function a(m,o,r,p,l,q,b,h,e,k,d,n,c,s,t){o.docLinks={configure:b.getDocUrl(n.LEARN_MORE_LINKS.WEBSITE.configure),redirect:b.getDocUrl(n.LEARN_MORE_LINKS.WEBSITE.redirect),hosting:b.getDocUrl(n.LEARN_MORE_LINKS.WEBSITE.hosting)};o.websiteErrorMessage="";o.websiteError=false;o.bucketEndpoint="";o.websitePlaceholder=n.BUCKET_PROPERTIES.WEBSITE.INDEX_FILE;o.websiteStates={disable:"disable",useBucket:"useBucket",redirectRequest:"redirectRequest"};function g(){var u=document.getElementById(n.BUCKET_PROPERTIES.WEBSITE.CREATE_BUCKET_CARD);u.scrollIntoView()}o.cardSummaryObj=_.cloneDeep(n.CARD_SUMMARY_INIT);o.cardSummaryObj.inactiveSummary.text=p.instant("bucketproperty.disabled");function i(){o.cardSummaryObj.isActive=o.website.selectedValue!==o.websiteStates.disable;o.cardSummaryObj.activeSummary.text=o.website.selectedValue!==o.websiteStates.disable?o.website.websiteEnabledOption:""}o.cancelBucketWebsite=function(u){s.analyticsTrackClick(n.ANALYTICS.CANCEL_WEBSITE,n.ANALYTICS.DETAILS);u.stopPropagation();o.website=angular.copy(o.cachedWebsite);o.cardOpen=false;o.websiteError=false;o.websiteErrorMessage=""};o.shouldDisableSaveButton=function(){if(o.website.selectedValue===o.websiteStates.useBucket){return _.isEmpty(o.website.indexDocument)}else{if(o.website.selectedValue===o.websiteStates.redirectRequest){return _.isEmpty(o.website.targetDomain)}}return false};o.getBucketWebsite=function(){var v=d.getCurrentBucket();var u=new k("BucketWebsite","getWebsite");o.cardSummaryObj.isLoading=true;c.log("getBucketWebsiteReceived",1,u,{bucketName:v});q.getBucketProperty(u,v,"website").then(function(x){var w=x.response;c.logRequestComplete("getBucketWebsite",u);o.websiteError=false;e.populateWebsiteFields(w,o.website);o.cachedWebsite=angular.copy(o.website);i()})["catch"](function(x){var w=s.handleErrors(x);if(x!==n.BUCKET_PROPERTIES.WEBSITE.NO_WEBSITE_CONFIGURATION_MESSAGE){c.log("getBucketWebsite",0,u,{bucketName:v,error:x});o.websiteError=true;o.websiteErrorMessage=w}else{c.logRequestComplete("getBucketWebsite",u)}o.cachedWebsite=angular.copy(o.website)})["finally"](function(){o.cardSummaryObj.isLoading=false})};if(o.forCreateBucketModal){o.$watch("cardOpen",function(v,u){r(g,1)});if(!_.isEmpty(o.website)&&o.website.errorMessage){o.websiteError=true;o.websiteErrorMessage=o.website.errorMessage}var j=o.createBucketName;var f=n.BUCKET_PROPERTIES.WEBSITE.REGION_TO_WEBSITE_ENDPOINT_MAP[o.region];o.bucketEndpoint="http://"+j+"."+f;o.cachedWebsite=angular.copy(o.website)}else{(function(){o.scrollCardId="#"+o.id;var u=d.getCurrentBucket();h.getBucketLocation(u).then(function(w){var v=n.BUCKET_PROPERTIES.WEBSITE.REGION_TO_WEBSITE_ENDPOINT_MAP[w];o.bucketEndpoint="http://"+u+"."+v})["catch"](function(v){o.websiteError=true;o.websiteErrorMessage=v});o.getBucketWebsite()})()}o.openBucketEndpoint=function(){l.open(o.bucketEndpoint,"_blank")};o.saveBucketWebsite=function(w){s.analyticsTrackClick(n.ANALYTICS.SAVE_WEBSITE,n.ANALYTICS.DETAILS);w.stopPropagation();o.websiteError=false;o.websiteErrorMessage="";if(!o.forCreateBucketModal){var x=d.getCurrentBucket();if(o.website.selectedValue===o.websiteStates.useBucket){var z=!_.isEmpty(o.website.indexDocument)?s.encodeXml(o.website.indexDocument):"";var v=!_.isEmpty(o.website.errorDocument)?s.encodeXml(o.website.errorDocument):"";var B=!_.isEmpty(o.website.routingXML)?o.website.routingXML:"";var u=new k(n.BUCKET_PROPERTIES.WEBSITE.CONFIGURE_BUCKET_WEBSITE);h.configureBucketWebsite(x,z,v,B,u).then(function(){o.website.websiteEnabledOption=p.instant("bucketproperties.website.footer.buckethosting");o.website.websiteEnabledContent=angular.copy(o.website.indexDocument);o.cardOpen=false;o.website.targetDomain="";o.website.redirectRequestProtocol="";o.cachedWebsite=angular.copy(o.website);i()})["catch"](function(C){o.websiteError=true;o.websiteErrorMessage=C})}else{if(o.website.selectedValue===o.websiteStates.redirectRequest){var y=!_.isEmpty(o.website.targetDomain)?s.encodeXml(o.website.targetDomain):"";var A=!_.isEmpty(o.website.redirectRequestProtocol)?o.website.redirectRequestProtocol:"";var u=new k(n.BUCKET_PROPERTIES.WEBSITE.REDIRECT_BUCKET_WEBSITE_REQUESTS);h.redirectBucketWebsiteRequests(x,y,A,u).then(function(){o.website.websiteEnabledOption=p.instant("bucketproperties.website.footer.redirectallrequests");o.website.websiteEnabledContent=angular.copy(o.website.targetDomain);o.cardOpen=false;o.website.indexDocument="";o.website.errorDocument="";o.website.routingXML="";o.cachedWebsite=angular.copy(o.website);i()})["catch"](function(C){o.websiteError=true;o.websiteErrorMessage=C})}else{var u=new k("deleteBucketWebsite");h.deleteBucketWebsite(x,u).then(function(){o.cardOpen=false;e.clearAllWebsiteFields(o.website);o.cachedWebsite=angular.copy(o.website);i()})["catch"](function(C){o.websiteError=true;o.websiteErrorMessage=C})}}}else{o.cachedWebsite=angular.copy(o.website);o.cardOpen=false;i()}}}})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("defaultEncryption",[function(){return{restrict:"E",scope:{cardOpen:"=",defaultEncryption:"=?",forCreateBucketModal:"=?",bucketName:"=?",region:"=?",id:"@?"},templateUrl:"/s3/partials/defaultencryption.html",controller:"DefaultEncryptionController"}}]);angular.module("s3").controller("DefaultEncryptionController",["$location","$q","$scope","$translate","$window","APIProxyService","AwsUrlsService","ConsoleOperation","FAC","PathService","S3Constants","SCLogService","UtilService","XMLParser",a]);function a(h,s,o,q,k,r,b,j,i,d,n,c,t,u){var p;if(!o.defaultEncryption){o.defaultEncryption={customKMSARN:"",encryption:n.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.NONE,kmsId:null}}var l=angular.copy(o.defaultEncryption);o.cardSummaryObj=_.cloneDeep(n.CARD_SUMMARY_INIT);o.cardSummaryObj.inactiveSummary.text=q.instant("bucketproperty.disabled");o.shouldDisableSave=true;o.encryptionConstants=n.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION;o.docLink=b.getDocUrl(n.LEARN_MORE_LINKS.DEFAULT_ENCRYPTION);o.encryptionOptions=(p={},_defineProperty(p,o.encryptionConstants.NONE,{value:q.instant("sse.none")}),_defineProperty(p,o.encryptionConstants.AES256,{apiValue:o.encryptionConstants.API_PARAMS.AES256,value:o.encryptionConstants.AES256,description:q.instant("bucketproperties.defaultencryption.aes256description")}),_defineProperty(p,o.encryptionConstants.AWSKMS,{apiValue:o.encryptionConstants.API_PARAMS.AWSKMS,value:o.encryptionConstants.AWSKMS,description:q.instant("bucketproperties.defaultencryption.kmsdescription")}),p);if(!i.isFeatureEnabled(n.FAC.KMS)){delete o.encryptionOptions[o.encryptionConstants.AWSKMS]}o.goToBucketPermissionsTab=function(){k.scrollTo(0,0);h.path("/"+n.PATH_SEGMENTS.BUCKETS+"/"+d.getCurrentBucket()).search("tab","permissions")};o.cancelDefaultEncryption=function(v){v.stopPropagation();o.defaultEncryption=angular.copy(l);e();o.cardOpen=false};o.saveDefaultEncryption=function(v){var z=undefined,w=o.forCreateBucketModal?o.bucketName:d.getCurrentBucket(),x=undefined,y=undefined;v.stopPropagation();if(o.shouldDisableSave()){return}if(!o.forCreateBucketModal){if(o.defaultEncryption.encryption===o.encryptionConstants.NONE){z=new j(n.OPERATION_NAME.DELETE_DEFAULT_ENCRYPTION);r.deleteBucketProperty(z,w,"defaultEncryption").then(function(A){c.log("DeleteDefaultEncryption",1,z);g()},function(B){var A=t.handleErrors(B);c.log("DeleteDefaultEncryption",0,z,{error:A});o.sseError=A})}else{z=new j(n.OPERATION_NAME.PUT_DEFAULT_ENCRYPTION);x={ServerSideEncryptionConfiguration:{Rule:{ApplyServerSideEncryptionByDefault:{SSEAlgorithm:o.encryptionOptions[o.defaultEncryption.encryption].apiValue}}}};if(o.defaultEncryption.encryption===o.encryptionConstants.AWSKMS){if(o.defaultEncryption.kmsId.value===n.OBJECT_SSE.CUSTOM_ARN){x.ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.KMSMasterKeyID=o.defaultEncryption.customKMSARN}else{x.ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.KMSMasterKeyID=o.defaultEncryption.kmsId.value}}y=u.jsonToXml(x);r.putBucketProperty(z,w,"defaultEncryption",y).then(function(A){c.log("PutDefaultEncryption",1,z);g()},function(B){var A=t.handleErrors(B);c.log("PutDefaultEncryption",0,z,{error:A});o.sseError=A})}}else{g()}};function g(){if(o.defaultEncryption.encryption!==o.encryptionConstants.AWSKMS){o.defaultEncryption.kmsId=null;o.defaultEncryption.customKMSARN=""}e();l=angular.copy(o.defaultEncryption);o.cardOpen=false}o.shouldShowBucketPolicyWarning=function(){return !o.forCreateBucketModal&&o.defaultEncryption.encryption!==o.encryptionConstants.NONE};o.shouldDisableSave=function(){if(o.defaultEncryption.encryption===o.encryptionConstants.AWSKMS){if(!o.defaultEncryption.kmsId){return true}else{if(o.defaultEncryption.kmsId.value===n.OBJECT_SSE.CUSTOM_ARN){return o.defaultEncryption.customKMSARN===l.customKMSARN}else{if(!l.kmsId){return false}else{return o.defaultEncryption.kmsId.value===l.kmsId.value}}}}else{return o.defaultEncryption.encryption===l.encryption||!_.isEmpty(o.sseError)}};function e(){o.cardSummaryObj.isActive=o.defaultEncryption.encryption!==n.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.NONE;o.cardSummaryObj.activeSummary.text=o.defaultEncryption.encryption!==n.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION.NONE?o.defaultEncryption.encryption:"";o.sseError=""}function m(){o.kmsKeys=[];var y=new j(n.OPERATION_NAME.GET_KMS_DEFAULT_ENCRYPTION),x={region:o.region},w=s.defer(),v=o.forCreateBucketModal?o.bucketName:d.getCurrentBucket();r.getKmsKeys(y,v,x).then(function(A){var z=A.response.Keys;c.log("GetKMSKeys",1,y);angular.forEach(z,function(B,C){o.kmsKeys.push({value:B.KeyArn,text:t.getKmsKeyAlias(B)})});o.kmsKeys.push({value:n.OBJECT_SSE.CUSTOM_ARN,text:q.instant("objectproperties.kms.customarn")});w.resolve()})["catch"](function(z){o.KMSServiceError=t.handleErrors(z);o.sseError=t.handleErrors(z);c.log("GetKMSKeys",0,y,z);w.reject(z)});return w.promise}function f(v){switch(v){case o.encryptionConstants.API_PARAMS.AES256:return o.encryptionConstants.AES256;case o.encryptionConstants.API_PARAMS.AWSKMS:return o.encryptionConstants.AWSKMS}}if(o.forCreateBucketModal){o.$watch("cardOpen",function(w,v){if(w){t.scrollTo(n.BUCKET_PROPERTIES.TAGGING.CREATE_BUCKET_CARD)}})}else{o.scrollCardId="#"+o.id}o.cardSummaryObj.isLoading=true;m().then(function(){o.defaultEncryption.kmsId=t.getKMSAliasForArn(o.defaultEncryption.kmsId,o.kmsKeys);if(!o.forCreateBucketModal){(function(){var w=new j(n.OPERATION_NAME.GET_DEFAULT_ENCRYPTION),v=o.forCreateBucketModal?o.bucketName:d.getCurrentBucket();r.getBucketProperty(w,v,"defaultEncryption").then(function(z){var y=u.convertXmlStringToJson(z.response);c.log("GetDefaultEncryption",1,w);o.defaultEncryption.encryption=f(_.get(y,"ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.SSEAlgorithm"));if(o.defaultEncryption.encryption===o.encryptionConstants.AWSKMS){var x=_.get(y,"ServerSideEncryptionConfiguration.Rule.ApplyServerSideEncryptionByDefault.KMSMasterKeyID");o.defaultEncryption.kmsId=t.getKMSKeyObjFromArn(x,o.kmsKeys);if(!o.defaultEncryption.kmsId){o.defaultEncryption.customKMSARN=x}}e();l=angular.copy(o.defaultEncryption);o.cardSummaryObj.isLoading=false},function(y){if(y!==o.encryptionConstants.NOT_FOUND_ERROR){var x=t.handleErrors(y);c.log("GetDefaultEncryption",0,w,{error:x});o.sseError=x}else{c.log("GetDefaultEncryption",1,w)}o.cardSummaryObj.isLoading=false})})()}else{e();o.cardSummaryObj.isLoading=false}})["catch"](function(v){o.sseError=t.handleErrors(v);o.cardSummaryObj.isLoading=false})}})();"use strict";(function(){angular.module("s3").directive("card",function(){return{restrict:"E",scope:{isOpen:"=",cardId:"=?",disableExpand:"=?",cardSummaryObj:"=?"},transclude:{header:"cardHeader",content:"cardContent",footer:"cardFooter"},templateUrl:"/s3/partials/card.html",controller:"CardController"}});angular.module("s3").controller("CardController",["$scope","$timeout","$translate","S3Constants","UtilService",a]);function a(c,e,f,d,b){c.openCard=function(){if(!c.disableExpand&&!c.cardSummaryObj.isLoading){c.isOpen=true}b.analyticsTrackClick(d.ANALYTICS.CARD_OPEN,d.ANALYTICS.DETAILS)};c.cardloadingMsg=f.instant("loading");if(c.cardId){c.$watch("isOpen",function(h,g){if(g!==h){e(function(){b.scrollCardToViewSmoothly(c.cardId)},1)}})}}})();"use strict";(function(){angular.module("s3").service("Md5GenerationService",function(){this.getContentMd5=function(a){return require("crypto").createHash("md5").update(a).digest("base64")}})})();"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};(function(){angular.module("s3").directive("bucketpermissions",[function(){return{restrict:"E",scope:{access:"=",analyzeAccess:"&"},templateUrl:"/s3/partials/bucketpermissions.html",controller:"BucketPermissionsController"}}]);angular.module("s3").controller("BucketPermissionsController",["$filter","$scope","$translate","AnalyzeAccessUtilService","AwsUrlsService","BucketPropertiesService","BulkOperationService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService","PermissionsUtilService",function(i,n,a,j,c,d,o,g,h,f,m,l,k){n.permissionTypes=[{text:a.instant("permissions.types.acl"),value:"acl"},{text:a.instant("permissions.types.policy"),value:"policy"},{text:a.instant("permissions.types.cors"),value:"cors"}];n.S3Constants=f;n.policyGenLink=f.BUCKET_PERMISSIONS.POLICY_GEN[l.getCloudSystem()];n.policyDocLink=c.getDocUrl(f.LEARN_MORE_LINKS.PERMISSIONS.POLICY);n.corsDocLink=c.getDocUrl(f.LEARN_MORE_LINKS.PERMISSIONS.CORS);n.permissions={};n.permissions.selectedItem=n.permissionTypes[0];n.bucket=h.getCurrentBucket();n.bucketARN=l.getBucketARN(n.bucket);n.gettingPolicy=true;n.gettingCors=true;n.corsChanged=false;n.policyChanged=false;n.accessStatus="";var e=new g("BucketPermissions","getPermissions");m.log("GetBucketPermissions",1,e,{bucketName:n.bucket});d.getBucketGrantees(n.bucket,e).then(function(p){n.permissionObj={};d.getBucketACP(n.bucket,e).then(function(r){var q=_.get(r,"AccessControlList.Grant");n.permissionObj.aclGrants=q?l.transformObjectToArray(q):[];var s=_.get(r,"Owner");n.permissionObj.owner=s;n.permissionObj.grantees=k.updateGrantees(p,s)})["catch"](function(q){n.error=q})})["catch"](function(p){n.error=p});d.getBucketPolicy(n.bucket,e,false).then(function(p){n.policy=b(p)})["catch"](function(p){n.error=p})["finally"](function(){n.gettingPolicy=false});d.getBucketCORS(n.bucket,e).then(function(p){if(p){n.cors=l.formatXml(p)}else{n.cors=f.BUCKET_PERMISSIONS.SAMPLE_CORS_POLICY}})["catch"](function(p){n.error=p})["finally"](function(){n.gettingCors=false});n.showView=function(p){switch(p){case f.BUCKET_PERMISSION_TYPE.CORS:n.permissions.selectedItem={text:a.instant("permissions.types.cors"),value:f.BUCKET_PERMISSION_TYPE.CORS};return;case f.BUCKET_PERMISSION_TYPE.ACL:n.permissions.selectedItem={text:a.instant("permissions.types.acl"),value:f.BUCKET_PERMISSION_TYPE.ACL};n.policyAfterAnalysis=undefined;return;case f.BUCKET_PERMISSION_TYPE.POLICY:n.permissions.selectedItem={text:a.instant("permissions.types.policy"),value:f.BUCKET_PERMISSION_TYPE.POLICY};return}};n.putAcl=function(p){return d.putBucketACL(n.bucket,p,new g("putBucketACL"))};n.save=function(){if(n.isDeleting){return}n.error=undefined;n.isSaving=true;if(n.permissions.selectedItem.value==="cors"){(function(){var p=l.formatXml(n.corsEditorSession.getDocument().getValue());n.corsEditorSession.getDocument().setValue(p);d.putBucketCORS(n.bucket,p.trim(),new g("putBucketCORS")).then(function(){n.corsChanged=false;n.cors=p})["catch"](function(q){n.error=q})["finally"](function(){n.isSaving=false})})()}else{if(n.permissions.selectedItem.value==="policy"){(function(){var p=n.policyEditorSession.getDocument().getValue();d.putBucketPolicy(n.bucket,p.trim(),new g("putBucketPolicy")).then(function(){n.policyChanged=false;n.policy=b(JSON.parse(p));n.policyEditorSession.getDocument().setValue(n.policy);n.analyzeAccess({cacheAllowed:false}).then(function(){n.policyAfterAnalysis=true})["finally"](function(q){n.isSaving=false})})["catch"](function(q){n.error=q;n.isSaving=false})})()}}};n.deletePermission=function(){if(n.isSaving){return}n.error=undefined;n.isDeleting=true;if(n.permissions.selectedItem.value==="cors"){d.deleteBucketCORS(n.bucket,new g("deleteBucketCORS")).then(function(){n.corsEditorSession.getDocument().setValue("");n.cors=undefined;n.corsChanged=false})["catch"](function(p){n.error=p})["finally"](function(){n.isDeleting=false})}else{if(n.permissions.selectedItem.value==="policy"){d.deleteBucketPolicy(n.bucket,new g("deleteBucketPolicy")).then(function(){n.policyEditorSession.getDocument().setValue("");n.policy=undefined;n.policyChanged=false;n.analyzeAccess({cacheAllowed:false}).then(function(){n.policyAfterAnalysis=true})["finally"](function(p){n.isDeleting=false})})["catch"](function(p){n.error=p;n.isDeleting=false})}}};n.cancel=function(){if(n.isSaving||n.isDeleting){return}n.error=undefined;if(n.permissions.selectedItem.value==="cors"){if(n.cors){n.corsEditorSession.getDocument().setValue(l.formatXml(n.cors))}else{n.corsEditorSession.getDocument().setValue("")}n.corsChanged=false}else{if(n.permissions.selectedItem.value==="policy"){if(n.policy){n.policyEditorSession.getDocument().setValue(n.policy)}else{n.policyEditorSession.getDocument().setValue("")}n.policyChanged=false}}};n.clearError=function(){n.error=undefined};n.policyEditorLoaded=function(p){n.policyEditorSession=p.getSession();if(n.policy){if(_typeof(n.policy)==="object"){n.policy=b(n.policy)}n.policyEditorSession.getDocument().setValue(n.policy)}n.policyChanged=false};n.policyEditorChanged=function(p){n.policyChanged=true};n.corsEditorLoaded=function(p){n.corsEditorSession=p.getSession();if(n.cors){n.corsEditorSession.getDocument().setValue(l.formatXml(n.cors))}n.corsChanged=false};n.corsEditorChanged=function(p){n.corsChanged=true};n.disableSave=function(){if(n.isDeleting){return true}if(n.permissions.selectedItem.value==="policy"){return n.policyEditorSession&&n.policyEditorSession.getDocument().getValue()===""||!n.policyChanged}return n.corsEditorSession&&n.corsEditorSession.getDocument().getValue()===""||!n.corsChanged};function b(p){return JSON.stringify(p,null,"    ")}}])})();"use strict";(function(){angular.module("s3").directive("dropdown",function(){return{restrict:"E",controller:"DropdownController",scope:{items:"=",selectedItem:"=",filter:"=",placeholder:"@",disabled:"=?",enableInput:"=?",inputField:"=?",dropdownDisabled:"=?"},templateUrl:"/s3/partials/dropdown.html"}});angular.module("s3").controller("DropdownController",["$filter","$scope","S3Constants","$translate","$window","UtilService",function(e,b,c,d,f,a){b.filterColumn="text";b.tableFiltering={filter:{}};b.getDisplayWidth=function(){return parseInt($("#current-displayed-table").width()/10)*10*0.9};angular.element(f).on("resize",function(){$(".truncate-dropdown").css({width:b.getDisplayWidth()})});if(!b.placeholder){b.selectedItem=b.items[0]}b.tableFiltering.filter[b.filterColumn]=b.defaultFilterValue;b.updateInput=function(g){b.selectedItem=g;g.error=null};b.filterBlur=function(){if(!b.tableFiltering.filter[b.filterColumn]){b.tableFiltering.showClear=false}};b.clearFilter=function(){b.tableFiltering.filter[b.filterColumn]="";b.tableFiltering.showClear=false};b.filterKeyDown=function(g){if(g&&g.keyCode===c.KEY_CODES.ESC){$(".input-field").blur();b.clearFilter()}};b.$watch(function(){return b.tableFiltering.filter[b.filterColumn]},function(h,g){if(g!==h){b.totalItems=e("filter")(b.items,b.tableFiltering.filter).length}});b.toggleDropDown=function(g){if(!g){b.isOpen=!b.isOpen;if(b.isOpen&&!b.dropdownDisabled){a.scrollTo("current-displayed-table")}}};b.closeDropDown=function(){b.isOpen=false};b.selectItem=function(g){b.selectedItem=_.cloneDeep(g);if(b.enableInput&&b.inputField){b.inputField.text=g.text||g;b.inputField.error=null}if(b.selectedItem.displayTextField){b.selectedItem.inputValue=b.selectedItem.value}b.closeDropDown()};b.toggleBucket=function(g,h){h.isExpanded=!h.isExpanded;g.stopPropagation()}}])})();"use strict";(function(){angular.module("s3").directive("versionsDropdown",function(){return{restrict:"E",controller:"VersionsDropdownController",scope:{selectedTab:"=?",bucket:"=",error:"=",getMetadata:"&?",setUpMetadata:"&?",key:"=",obj:"=",showVersionsDropdown:"=",objectsPage:"=?",updateObjMetadata:"&?",updateObjAcl:"&?",refresh:"&?",objectPropertiesPanel:"=?",tabs:"=?",versions:"=?",versionsDropdownSelectedObject:"=?"},templateUrl:"/s3/partials/versionsdropdown.html"}});angular.module("s3").controller("VersionsDropdownController",["$filter","$scope","$window","$location","$translate","CachingService","ConsoleOperation","DeleteService","ObjectPropertiesService","S3Constants","S3CWSAPIService","SCLogService","UtilService",function(j,n,c,h,b,a,i,d,g,f,l,m,k){function e(){var o="ListVersionsCompleted",p=new i(f.OPERATION_NAME.LIST_VERSIONS);g.listVersions(n.bucket,n.key,p).then(function(q){n.versions=q;n.obj.versionId=q&&q[0]&&q[0].VersionId;m.log(o,1,p,{objectKey:n.key,versions:q})})["catch"](function(q){n.error=q;p.error=q;p.errorMessage=b.instant("versionsdropdown.errorMessage");m.log(o,0,p,q)})}n.dateFormat=f.DATE_FORMAT;n.closeDropdown=function(){n.showVersionsDropdown.show=false};n.deleteVersion=function(r,p){r.stopPropagation();if(!p||!p.Key){return}if(p.deleteDisabled){return}var o="DeleteVersion",q=new i(o);d.deleteKeysAndVersions(q,[{Key:p.Key,VersionId:p.VersionId}],{}).then(function s(v){var w=p.IsLatest==="true";var t=n.versions.length,u=Object.keys(v.result).length;n.versions=_.filter(n.versions,function(y){var x=v.result[y.Key+":"+y.VersionId],z=x?x.status:"";return z!==f.OPERATION_PER_KEY_STATUS.DONE});if(u!==1){m.log(q.name+"MoreThanOne",1,q,v.result)}else{if(n.versions.length!==t-u){m.log(q.name+"AlreadyDeleted",1,q,v.result)}}a.setCurrentVersions(p.Key,n.versions);if(n.objectsPage&&(_.isEmpty(n.versions)||w)){n.refresh();n.objectPropertiesPanel.show=false}})["catch"](function(t){n.error=t})};n.downloadVersion=function(r,o){r.stopPropagation();if(o.downloadDisabled){return}var q={"Content-Disposition":"attachment"};var p=new i("objectDownload","objDLPresignFetchStart");l.fetchPresignedUrl(n.bucket,o.Key,"GET",q,{versionId:o.VersionId},null,null,p).then(function(s){c.location.href=s.data.presignedUrl;m.log("fetchPresignedUrl",1,p,{bucket:n.bucket,key:o.Key})})["catch"](function(s){m.log("fetchPresignedUrl",0,p,s);n.error=s})};n.switchVersion=function(q,o){var p=new i(f.OPERATION_NAME.SWITCH_VERSION);q.stopPropagation();m.log(f.OPERATION_NAME.SWITCH_VERSION,1,p,{version:o});if(o.ETag&&!n.objectsPage){n.getMetadata({operation:p,versionId:o.VersionId})}if(!n.objectsPage){h.search(f.VERSION_ID_PARAM,o.VersionId)}n.obj.VersionId=o.VersionId;n.obj.ETag=k.extractFromQuotes(o.ETag);n.obj.IsLatest=o.IsLatest;if(_.isArray(n.tabs)&&_.size(n.tabs)>1){n.tabs[f.TABS.OBJECT_DETAILS.PERMISSIONS]["disabled"]=o.IsLatest!=="true"}n.obj.Key=o.Key;if(n.obj.Key.lastIndexOf("/")!==-1){n.obj.Key=n.obj.Key.substring(n.obj.Key.lastIndexOf("/")+1)}n.obj.LastModified=o.LastModified;n.obj.Owner=o.Owner;n.obj.Size=o.Size;n.obj.StorageClass=f.STORAGE_CLASSES[o.StorageClass];n.obj.versionLabel=o.IsLatest==="true"?b.instant("versionsdropdown.label.latestVersion"):j("date")(o.LastModified,n.dateFormat);n.showVersionsDropdown.show=false;if(n.selectedTab){n.selectedTab="overview"}if(!_.isEmpty(n.obj.ETag)){a.setCurrentObject(n.obj)}n.versionsDropdownSelectedObject=_.cloneDeep(o);if(n.objectsPage){var r=angular.copy(n.obj);n.setUpMetadata({obj:r});n.updateObjAcl({obj:r});n.updateObjMetadata({obj:r})}};if(_.isEmpty(n.versions)){e()}}])})();"use strict";(function(){angular.module("s3").directive("editor",[function(a,c){return{restrict:"AE",scope:{code:"=",mode:"=",readonly:"=",onLoad:"&"},templateUrl:"/s3/partials/editor.html",link:{pre:function d(f,g,e){a.fullscreen=false;f.theme="dawn";var h=function h(j,i){f.editor.setTheme("ace/theme/"+j)};f.toggleFullscreen=function(i){a.fullscreen=!a.fullscreen;if(i){f.$apply()}c(function(){f.editor.resize()})};f.themes=["cobalt","dawn","eclipse","monokai","solarized_dark"].map(function(i){return{value:i,text:window.messages.ide.theme[i]}});f.modals={settings:{open:false}};f.saveSettings=function(){f.theme=f.modals.settings.theme;h(f.theme,true);f.modals.settings.open=false};f.aceLoaded=function(i){f.editor=i;i.$blockScrolling=Infinity;i.resize(true);c(function(){h(f.theme)});f.onLoad({editor:f.editor})}},post:function b(e){e.$watch("mode",function(){if(!e.mode){return}e.editor.session.setMode("ace/mode/"+e.mode)});e.$watch("readonly",function(){e.editor.setReadOnly(e.readonly)})}}}}])})();"use strict";(function(){angular.module("s3").service("OperationDispatcherService",["PathService","$interval","ConsoleOperation","S3Constants","SCLogService","APIProxyService",function(j,h,i,g,l,d){var m=20;var e=5;var b={};var f={};var a=[];this.addOperation=function(n){for(var o in f){l.log("HaveConflictingOperation",this.isConflict(f[o],n)?1:0,n,{},Date())}b[n.id]=n;if(!n.finishCallBack){n.finishCallBack=this.operationDoneCallBack}n.errorCallBack=this.operationErrorCallBack;if(k(n)){f[n.id]=n;n.state=g.OPERATION_STATE.ACTIVE;l.log(g.OPERATION_MANAGER_LOGGING.STARTED,1,n);n.start()}else{n.state=g.OPERATION_STATE.WAITING;l.log(g.OPERATION_MANAGER_LOGGING.ENQUEUED,1,n);a.push(n)}l.log(g.OPERATION_MANAGER_LOGGING.ADDED,1,n)};this.getOngoingOperations=function(){return f};this.getWaitingOperations=function(){return a};this.getOperationById=function(n){return b[n]};this.getAllOperations=function(){return b};this.getOperationsWithState=function(o,n){for(var p in b){if(b[p].state===o){n.push(b[p])}}};var k=function k(n){if(Object.keys(f).length<m){if(n.initialBucket){var s={};d.getBucketLocation(n,n.initialBucket,s);var r=s.region;var q=0;for(var o in f){var p={};d.getBucketLocation(n,f[o].initialBucket,p);if(p.region===r){q+=1}}return q<e}return true}return false};this.operationDoneCallBack=function(n){if(b[n].state===g.OPERATION_STATE.COMPLETED){return}b[n].state=g.OPERATION_STATE.COMPLETED;b[n].defer.resolve(b[n].errorDetails);l.log(g.OPERATION_MANAGER_LOGGING.COMPLETED,1,b[n]);delete f[n];c()};this.operationErrorCallBack=function(n){b[n].state=g.OPERATION_STATE.ERROR;b[n].defer.reject(b[n].errorDetails);l.log(g.OPERATION_MANAGER_LOGGING.ERROR,1,b[n]);delete f[n];c()};this.cancelOperation=function(n){if(n.id in f){delete f[n.id];c();n.cancel();n.state=g.OPERATION_STATE.CANCEL}else{if(n.state===g.OPERATION_STATE.WAITING){n.cancel();for(var o=0;o<a.length;o++){if(a[o]===n){a.splice(o,1);break}}}delete b[n.id]}l.log(g.OPERATION_MANAGER_LOGGING.CANCELED,1,n)};var c=function c(){for(var o=0;o<a.length;o++){if(k(a[o])){var n=a[o];n.state=g.OPERATION_STATE.ACTIVE;l.log(g.OPERATION_MANAGER_LOGGING.DEQUEUED,1,n);f[n.id]=n;a.splice(o,1);n.start();l.log(g.OPERATION_MANAGER_LOGGING.STARTED,1,n);break}}};this.isConflict=function(o,n){if(o.initialBucket!==undefined&&n.initialBucket!==undefined&&o.initialBucket===n.initialBucket){if(o.initialPath.length>n.initialPath.length){return o.initialPath.lastIndexOf(n.initialPath)>=0}else{return n.initialPath.lastIndexOf(o.initialPath)>=0}}return false};this.setMaximumOngoingOperation=function(n){m=n};this.setMaximumOngoingOperationsPerRegion=function(n){e=n}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").service("BulkOperationService",["$translate","ConsoleOperation","SCLogService","S3Service","Md5GenerationService","PathService","S3Constants","ObjectListingService","OperationDispatcherService","ListVerificationService","APIProxyService","$q","DeleteService","CopyService","OperationUtilService","$filter","$routeParams","UtilService",function(z,g,h,q,I,D,K,n,x,s,F,d,A,y,k,E,J,v){var c,H,t;var u=(c={},_defineProperty(c,K.OPERATION_NAME.DELETE_OBJECTS,A.deleteKeysAndVersions),_defineProperty(c,K.OPERATION_NAME.RESTORE_OBJECTS,A.deleteKeysAndVersions),_defineProperty(c,K.OPERATION_NAME.EMPTY_BUCKET,A.deleteKeysAndVersions),_defineProperty(c,K.OPERATION_NAME.DELETE_BUCKET,A.deleteKeysAndVersions),_defineProperty(c,K.OPERATION_NAME.MAKE_PUBLIC,k.defaultCWSBulkOperationCaller),_defineProperty(c,K.OPERATION_NAME.COPY,y.copyObjects),_defineProperty(c,K.OPERATION_NAME.CUT,y.copyObjects),_defineProperty(c,K.OPERATION_NAME.RENAME,y.copyObjects),_defineProperty(c,K.OPERATION_NAME.CHANGE_SSE,k.defaultCWSBulkOperationCaller),_defineProperty(c,K.OPERATION_NAME.CHANGE_STORAGE_CLASS,k.defaultCWSBulkOperationCaller),_defineProperty(c,K.OPERATION_NAME.CHANGE_METADATA,k.defaultCWSBulkOperationCaller),_defineProperty(c,K.OPERATION_NAME.INITIATE_RESTORE,k.defaultCWSBulkOperationCaller),_defineProperty(c,K.OPERATION_NAME.ADD_OBJECT_TAG,k.defaultCWSBulkOperationCaller),c);var e=(H={},_defineProperty(H,K.OPERATION_NAME.DELETE_OBJECTS,z.instant("operationname.deleteobjects")),_defineProperty(H,K.OPERATION_NAME.RESTORE_OBJECTS,z.instant("operationname.undodelete")),_defineProperty(H,K.OPERATION_NAME.EMPTY_BUCKET,z.instant("operationname.emptybucket")),_defineProperty(H,K.OPERATION_NAME.DELETE_BUCKET,z.instant("operationname.deletebucket")),_defineProperty(H,K.OPERATION_NAME.MAKE_PUBLIC,z.instant("operationname.makepublic")),_defineProperty(H,K.OPERATION_NAME.COPY,z.instant("operationname.copy")),_defineProperty(H,K.OPERATION_NAME.CUT,z.instant("operationname.cut")),_defineProperty(H,K.OPERATION_NAME.RENAME,z.instant("operationname.rename")),_defineProperty(H,K.OPERATION_NAME.CHANGE_SSE,z.instant("operationname.changesse")),_defineProperty(H,K.OPERATION_NAME.CHANGE_STORAGE_CLASS,z.instant("operationname.changestorageclass")),_defineProperty(H,K.OPERATION_NAME.CHANGE_METADATA,z.instant("operationname.changemetadata")),_defineProperty(H,K.OPERATION_NAME.INITIATE_RESTORE,z.instant("operationname.initiaterestore")),_defineProperty(H,K.OPERATION_NAME.ADD_OBJECT_TAG,z.instant("operationname.addtags")),H);var C=(t={},_defineProperty(t,K.OPERATION_NAME.DELETE_OBJECTS,w),_defineProperty(t,K.OPERATION_NAME.RESTORE_OBJECTS,w),_defineProperty(t,K.OPERATION_NAME.EMPTY_BUCKET,w),_defineProperty(t,K.OPERATION_NAME.DELETE_BUCKET,w),_defineProperty(t,K.OPERATION_NAME.MAKE_PUBLIC,w),_defineProperty(t,K.OPERATION_NAME.COPY,p),_defineProperty(t,K.OPERATION_NAME.CUT,p),_defineProperty(t,K.OPERATION_NAME.RENAME,p),_defineProperty(t,K.OPERATION_NAME.CHANGE_SSE,p),_defineProperty(t,K.OPERATION_NAME.CHANGE_STORAGE_CLASS,p),_defineProperty(t,K.OPERATION_NAME.CHANGE_METADATA,p),_defineProperty(t,K.OPERATION_NAME.INITIATE_RESTORE,w),_defineProperty(t,K.OPERATION_NAME.ADD_OBJECT_TAG,w),t);var f={createBulkOperation:l,listAndOperateObjectsRecursively:i,updateUIWithSuccessResponse:a,populateErrorDetails:L,completeOperation:G,updateUIWithError:o,getOperationAPIMap:r,getOperationCompleteCallBack:B,shouldListVersion:m,updateProgress:j,updateOperationProgressBasedOnFileCount:w,updateOperationProgressBasedOnSize:p};return f;function l(N,R,M,P,Q){if(R.length===0&&M.length===0){throw"No keys or folders were passed in for "+N+" operation"}var O=new g(N);O.displayName=e[O.name];O.selectedKeys=angular.copy(R);O.selectedKeys.forEach(function(S){S.Key=S.Path?S.Path+S.Key:O.initialPath+S.Key});O.selectedFolders=angular.copy(M);if(!b(O)){O.selectedFolders.forEach(function(S){S.Prefix=O.initialPath+S.Prefix+K.DELIMITER});if(O.selectedFolders.length>0){O.originFolders=angular.copy(M)}}O.totalObjectCount=P;O.totalOperatedObjectCount=0;O.start=function(){var V=O.additionalInfo?O.additionalInfo:Q;var S=function S(X){f.updateUIWithSuccessResponse(X)};var W=function W(X){f.updateUIWithError(X)};var T=function T(X){f.updateProgress(X)};if(O.selectedKeys.length>0){for(var U=0;U<R.length/V.numberOfKeysPerBulkOperation;U++){u[N](O,O.selectedKeys.slice(U*V.numberOfKeysPerBulkOperation,(U+1)*V.numberOfKeysPerBulkOperation),V).then(S,W,T)}}if(O.selectedFolders.length>0){f.listAndOperateObjectsRecursively(O,null,V)}};O.cancel=function(){O.state=K.OPERATION_STATE.CANCEL};O.finishCallBack=f.getOperationCompleteCallBack(O);h.log(N.replace(/\s/g,"")+"OperationCreated",1,O);return O}function i(M,O,N){if(!O&&M.state===K.OPERATION_STATE.ACTIVE||O.truncated&&M.state===K.OPERATION_STATE.ACTIVE){n.getBatchOfItems(M,O?O.marker:null,N.numberOfKeysPerBulkOperation,false,m(M,N),O?O.versionIdMarker:null,M.selectedFolders,null).then(function(P){h.log(M.name.replace(/\s/g,"")+"FolderListing",1,M,P);if(P.keys.length>0){u[M.name](M,P.keys,N).then(function(Q){f.updateUIWithSuccessResponse(Q);f.listAndOperateObjectsRecursively(M,P,N)},function(Q){f.updateUIWithError(Q)},function(Q){f.updateProgress(Q)})}else{f.completeOperation(M)}})["catch"](function(P){h.log(M.name.replace(/\s/g,"")+"FolderListing",0,M,P);f.updateUIWithError({operation:M,result:P})})}else{if(M.state===K.OPERATION_STATE.CANCEL){return}else{f.completeOperation(M)}}}function j(P){var N=P.operation;var M=P.result;if(P.updateType===K.OPERATION_PROGRESS_UPDATE_TYPE.SINGLE_PART_RESULTS){N.totalOperatedObjectCount+=Object.keys(M).length;C[N.name](P);f.populateErrorDetails(N,M)}else{if(P.updateType===K.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_RESULT||P.updateType===K.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_COMPLETE){N.successPercentage+=M/N.totalSizeInBytes*100;N.progressPercentage=N.successPercentage+N.errorPercentage;if(P.updateType===K.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_COMPLETE){N.succeedKeyCount+=1;N.totalOperatedObjectCount+=1}}else{if(P.updateType===K.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_ERROR){N.errorPercentage+=M/N.totalSizeInBytes*100;N.progressPercentage=N.successPercentage+N.errorPercentage;N.failedKeyCount+=1;N.totalOperatedObjectCount+=1;var O={};O[P.keys[0]]={status:K.OPERATION_PER_KEY_STATUS.ERROR,errorMessage:P.error};f.populateErrorDetails(N,O)}}}if(P.isLastOne){P.notifyDefer.resolve(P)}if(N.totalOperatedObjectCount===N.totalObjectCount&&N.selectedFolders.length===0){f.completeOperation(N)}}function a(O){if(O.updateType!==K.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_ALL_COMPLETE){var N=O.operation;var M=O.result;N.totalOperatedObjectCount+=Object.keys(M).length;if(b(N)){N.totalObjectCount=N.totalOperatedObjectCount}C[N.name](O);f.populateErrorDetails(N,M);if(N.totalOperatedObjectCount===N.totalObjectCount&&N.selectedFolders.length===0){f.completeOperation(N)}}}function p(O){var N=O.operation;var Q=O.keys;var M=O.result;var R=0;var P=0;if(N.totalSizeInBytes===0){f.updateOperationProgressBasedOnFileCount(O);return}Object.keys(M).forEach(function(S){if(M[S].status===K.OPERATION_PER_KEY_STATUS.DONE){N.succeedKeyCount+=1;Q.forEach(function(T){if(T.Key===S){R+=T.Size}})}else{N.failedKeyCount+=1;Q.forEach(function(T){if(T.Key===S){P+=T.Size}})}});N.defer.notify();N.successPercentage+=R/N.totalSizeInBytes*100;N.errorPercentage+=P/N.totalSizeInBytes*100;N.progressPercentage=N.successPercentage+N.errorPercentage}function w(O){var N=O.operation;var M=O.result;Object.keys(M).forEach(function(P){if(M[P].status===K.OPERATION_PER_KEY_STATUS.DONE){N.succeedKeyCount+=1}else{N.failedKeyCount+=1}});N.defer.notify();N.progressPercentage=N.totalOperatedObjectCount/N.totalObjectCount*100;N.successPercentage=N.succeedKeyCount/N.totalObjectCount*100;N.errorPercentage=N.failedKeyCount/N.totalObjectCount*100}function G(M){if(M.state===K.OPERATION_STATE.COMPLETED){return}if(b(M)){M.totalObjectCount=M.totalOperatedObjectCount;if(M.totalObjectCount===0){M.errorPercentage=0}else{M.errorPercentage=M.failedKeyCount/M.totalObjectCount*100}M.errorTypes.forEach(function(N){N.errorPercentage=Number(N.errorCount/M.totalObjectCount*100).toFixed(2)})}M.successPercentage=Number(100-M.errorPercentage).toFixed(2);M.progressPercentage=100;h.log(M.name.replace(/\s/g,"")+"Success",1,M);if(M.errorPercentage===0){M.parameters.operationSuccessful=true}else{if(M.successPercentage===0){M.parameters.operationUnsuccessful=true}else{M.parameters.operationPartiallySuccessful=true}}if(M.name===K.OPERATION_NAME.DELETE_BUCKET){M.successPercentage/=2;M.errorPercentage/=2;if(M.errorPercentage!==0&&M.name===K.OPERATION_NAME.DELETE_BUCKET){M.errorPercentage+=50}M.errorTypes.forEach(function(N){N.errorPercentage=Number(N.errorCount/M.totalObjectCount*100).toFixed(2);N.errorPercentage/=2})}if(M.errorPercentage!==0){M.errorCallBack(M.id)}else{M.finishCallBack(M.id)}}function o(M){var N=M.operation;N.defer.notify();h.log(N.name.replace(/\s/g,"")+"Success",0,N,M);N.errorPercentage=100-N.progressPercentage;if(N.name===K.OPERATION_NAME.DELETE_BUCKET){N.errorPercentage=N.errorPercentage/2;N.errorPercentage+=50}N.errorCallBack(N.id)}function B(M){if(M.name===K.OPERATION_NAME.DELETE_BUCKET){return function(){F.deleteBucket(M).then(function(){M.parameters.isDeleteBucketSuccessful=true;M.successPercentage+=50;h.log("DeleteBucketRequest",1,M);x.operationDoneCallBack(M.id)})["catch"](function(N){M.errorPercentage+=50;M.parameters.isDeleteBucketSuccessful=false;h.log("DeleteBucketRequest",0,M,N);M.errorMessage=v.handleErrors(N);x.operationErrorCallBack(M.id)})}}else{return M.finishCallBack}}function L(M,N){Object.keys(N).forEach(function(O){if(N[O].status!==K.OPERATION_PER_KEY_STATUS.DONE){(function(){var P=N[O].errorMessage;var Q=_.filter(M.errorTypes,function(R){return R.errorMessage===P});if(Q.length===0){M.errorTypes.push({errorMessage:P,errorCount:1,errorPercentage:Number(1/M.totalObjectCount*100).toFixed(2)})}else{Q[0].errorCount+=1;Q[0].errorPercentage=Number(Q[0].errorCount/M.totalObjectCount*100).toFixed(2)}if(M.errorDetails[P]){if(M.errorDetails[P].length<K.BULK_OPERATION_KEY_COUNT_PER_ERROR_TYPE){M.errorDetails[P].push(O)}}else{M.errorDetails[P]=[O]}})()}})}function m(M,O){var N=v.convertStringToBoolean(J[K.SHOW_VERSION_PARAM]);if(N){return true}else{if(M.name===K.OPERATION_NAME.EMPTY_BUCKET||M.name===K.OPERATION_NAME.DELETE_BUCKET){return O.versioning==="Enabled"||O.versioning==="Suspended"}else{return false}}}function b(M){return M.name===K.OPERATION_NAME.EMPTY_BUCKET||M.name===K.OPERATION_NAME.DELETE_BUCKET}function r(){return u}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").service("OperationUtilService",["$q","ConsoleOperation","FAC","MultipartCopyService","SCLogService","S3Service","S3Constants","S3CWSAPIService","APIProxyService","UtilService",function(u,l,j,B,c,x,n,d,s,y){var z;var i="BulkOpKeyCountMatch";var e="BulkOpKeyCountMismatch";var g="ObjectCount";var w="RequestFailed";var f="GetBucketLocationError";var p=[n.OPERATION_NAME.CHANGE_METADATA,n.OPERATION_NAME.CHANGE_SSE,n.OPERATION_NAME.CHANGE_STORAGE_CLASS];var m=(z={},_defineProperty(z,n.OPERATION_NAME.MAKE_PUBLIC,n.CWS_OPERATION_NAME.MAKE_PUBLIC),_defineProperty(z,n.OPERATION_NAME.CHANGE_SSE,n.CWS_OPERATION_NAME.CHANGE_SSE),_defineProperty(z,n.OPERATION_NAME.CHANGE_STORAGE_CLASS,n.CWS_OPERATION_NAME.CHANGE_STORAGE_CLASS),_defineProperty(z,n.OPERATION_NAME.CHANGE_METADATA,n.CWS_OPERATION_NAME.CHANGE_METADATA),_defineProperty(z,n.OPERATION_NAME.INITIATE_RESTORE,n.CWS_OPERATION_NAME.INITIATE_RESTORE),_defineProperty(z,n.OPERATION_NAME.ADD_OBJECT_TAG,n.CWS_OPERATION_NAME.ADD_OBJECT_TAG),z);var A={handleCWSSuccessResponse:o,handleCWSErrorResponse:k,handleGetBucketLocationError:h,initializeBulkOperationResult:a,defaultCWSBulkOperationCaller:v,generateParameterForSpecificOperation:b,verifyKeysMatching:q,getAllSinglePartCopyResult:t,verifyInput:r};return A;function a(C,D){return{operation:C,keys:D,result:{},error:null,updateType:""}}function b(C,F,E,G){var H={};H.bucket=C.initialBucket;H.region=G;var D=[n.OPERATION_NAME.ADD_OBJECT_TAG,n.OPERATION_NAME.MAKE_PUBLIC,n.OPERATION_NAME.INITIATE_RESTORE];if(D.indexOf(C.name)>-1){H.keyVersionIds=y.getKeyVersionIds(F)}else{H.keys=_.pluck(F,"Key")}if(C.name===n.OPERATION_NAME.CHANGE_STORAGE_CLASS){H.storageClass=E.targetStorageClass}else{if(C.name===n.OPERATION_NAME.CHANGE_SSE){H.sseAlgo=E.sseAlgo;if(E.sseKmsKeyId){H.sseKmsKeyId=E.sseKmsKeyId}}else{if(C.name===n.OPERATION_NAME.CHANGE_METADATA){H.metadataMap=E.addAndChangeMetadata;H.deleteMetadata=E.deleteMetadata}else{if(C.name===n.OPERATION_NAME.INITIATE_RESTORE){H.expirationDays=E.expirationDays;if(E.tier){H.tier=E.tier}}else{if(C.name===n.OPERATION_NAME.ADD_OBJECT_TAG){H.tags=E.tags;H.disableFetchTag=E.disableFetchTag}}}}}if(p.indexOf(C.name)>=0&&j.isFeatureEnabled(n.FAC.NEW_MULTIPART_COPY+"-"+G)){H.isNewMultipartCopy=true}return H}function v(C,H,F){var G={};var E=u.defer();var D=A.initializeBulkOperationResult(C,H);if(!A.verifyInput(C,H)){throw"The call has invalid input."}s.getBucketLocation(C,C.initialBucket,G).then(function(){var J=A.generateParameterForSpecificOperation(C,H,F,G.region);var I=m[C.name];if(!I){throw C.name+" is not supported"}d.makeS3ConsoleOperationRequest(J,I,{},C).then(function(K){if(B.isMultipartCopyNeeded(C,K)){var L=A.getAllSinglePartCopyResult(C,K,H);if(L.error){E.reject(L);return}E.notify(L);B.startMultipartCopyForFiles(C,C.initialBucket,J.region,J.region,H,_.pluck(H,"Key"),K,false,E)}else{A.handleCWSSuccessResponse(C,H,K,D,E)}})["catch"](function(K){A.handleCWSErrorResponse(C,K,D,E)})})["catch"](function(I){A.handleGetBucketLocationError(C,I,D,E)});return E.promise}function t(E,D,G){var C=A.initializeBulkOperationResult(E);C.updateType=n.OPERATION_PROGRESS_UPDATE_TYPE.SINGLE_PART_RESULTS;C.keys=G;var F=_.pluck(G,"Key");D.data.statusPerKey.forEach(function(H){if(!B.isMultipartCopyObject(H)){if(F.lastIndexOf(H.key)>=0){C.result[H.key]=H.result}else{c.log(i,0,{operation:E,originalKeys:G,response:D});C.error=e}}});return C}function h(D,E,C,F){c.log(f,1,D,E);C.error=E;F.reject(C)}function k(D,E,C,F){c.log((D.name+w).replace(/ /g,""),1,D,E);C.error=E;F.reject(C)}function o(E,G,D,C,H){var F=false;if(d.wasOperationSuccessful(D)){D.data.statusPerKey.forEach(function(I){if(I.versionId){F=true;C.result[I.key+I.versionId]=I.result}else{C.result[I.key]=I.result}});if(!A.verifyKeysMatching(G,C.result,F)){c.log(i,0,{operation:E,keys:G,response:D});C.error=e;H.reject(C)}else{c.log(i,1,E);c.log((E.name+g).replace(/ /g,""),Object.keys(G).length,E,C.result);H.resolve(C)}}}function r(C,E){if(isNaN(C.totalSizeInBytes)||C.totalSizeInBytes<0){return false}for(var D in E){if(isNaN(E[D].Size)||E[D].Size<0){return false}}return true}function q(H,F){var E=arguments.length<=2||arguments[2]===undefined?false:arguments[2];var G={};var D=!E?_.pluck(H,"Key"):_.map(H,function(I){return I.Key+I.VersionId});D.forEach(function(I){G[I]=false});var C=Object.keys(F);if(H.length!==C.length){return false}C.forEach(function(I){if(G[I]===false){G[I]=true}else{return false}});D.forEach(function(I){if(!G[I]){return false}});return true}}])})();"use strict";(function(){angular.module("s3").service("DeleteService",["$q","ConsoleOperation","ListVerificationService","Md5GenerationService","ObjectListingService","PathService","S3Constants","SCLogService","APIProxyService","S3Service","UtilService",function(p,j,v,i,g,b,l,a,o,r,t){var e="GetBucketLocationError";var h="DeleteCountMatch";var c="DeleteCountMismatch";var m="DeleteRequestGenerated";var d="DeleteObjectCount";var u={createDeleteMultipleObjectsXml:q,deleteKeysAndVersions:s,generateDeleteRequest:f,getKeyAndVersionIdSetFromResponse:n,compareRequestAndResponse:k};return u;function q(y){var w="<Delete>";for(var x in y){w+="<Object>";w+="<Key>"+t.encodeXml(y[x].Key)+"</Key>";if(y[x].VersionId){w+="<VersionId>"+t.encodeXml(y[x].VersionId)+"</VersionId>"}w+="</Object>"}w+="</Delete>";return w}function s(z,B,A){var w=u.createDeleteMultipleObjectsXml(B);var C=u.generateDeleteRequest(z,w,A.mfaString);var x=p.defer();var y={operation:z,error:null,result:null};o.getBucketLocation(z,z.initialBucket,C).then(function(D){o.makeProxyRequest(r.deleteObjects,D,l.PROXY_API_NAMES.S3.DELETE,z).then(function(F){if(F.response.DeleteResult){var E=u.getKeyAndVersionIdSetFromResponse(F.response.DeleteResult,z);if(!u.compareRequestAndResponse(B,E)){a.log(h,0,z,{original:B,result:E});y.error=c;x.reject(y)}else{a.log(h,1,z,{original:B,result:E});y.result=E;x.resolve(y)}}else{if(F.response.Error){y.error=F.response.Error;x.reject(y)}}})["catch"](function(E){y.error=E;x.reject(y)})})["catch"](function(D){a.log(e,1,z,D);y.error=D;x.reject(y)});return x.promise}function f(w,x,z){var y={content:x,path:w.initialBucket};y.headers={};y.headers[l.HEADERS.CONTENT_TYPE]=l.HEADERS.CONTENT_TYPE_JSON;y.headers[l.HEADERS.X_AMZ_DATE]=new Date().toUTCString();y.headers[l.HEADERS.CONTENT_MD5]=i.getContentMd5(x);if(z){y.headers[l.HEADERS.X_AMZ_MFA]=z}a.log(m,1,w,y);return y}function n(y,x){var w={};if(y.Deleted){if(y.Deleted.length>1){a.log(d,y.Deleted.length,x);y.Deleted.forEach(function(z){if(z.VersionId){w[z.Key+":"+z.VersionId]={status:l.OPERATION_PER_KEY_STATUS.DONE}}else{w[z.Key]={status:l.OPERATION_PER_KEY_STATUS.DONE}}})}else{a.log(d,1,x);if(y.Deleted.VersionId){w[y.Deleted.Key+":"+y.Deleted.VersionId]={status:l.OPERATION_PER_KEY_STATUS.DONE}}else{w[y.Deleted.Key]={status:l.OPERATION_PER_KEY_STATUS.DONE}}}}if(y.Error){if(y.Error.length>1){y.Error.forEach(function(z){if(z.VersionId){w[z.Key+":"+z.VersionId]={status:l.OPERATION_PER_KEY_STATUS.ERROR,errorCode:z.Code,errorMessage:z.Message}}else{w[z.Key]={status:l.OPERATION_PER_KEY_STATUS.ERROR,errorCode:z.Code,errorMessage:z.Message}}})}else{if(y.Error.VersionId){w[y.Error.Key+":"+y.Error.VersionId]={status:l.OPERATION_PER_KEY_STATUS.ERROR,errorCode:y.Error.Code,errorMessage:y.Error.Message}}else{w[y.Error.Key]={status:l.OPERATION_PER_KEY_STATUS.ERROR,errorCode:y.Error.Code,errorMessage:y.Error.Message}}}}return w}function k(z,x){var w={};z.forEach(function(A){if(A.VersionId){w[A.Key+":"+A.VersionId]=false}else{w[A.Key]=false}});var y=Object.keys(x);if(Object.keys(w).length!==y.length){return false}y.forEach(function(A){if(w[A]===undefined||w[A]===true){return false}w[A]=true});Object.keys(w).forEach(function(A){if(!w[A]){return false}});return true}}])})();"use strict";(function(){angular.module("s3").service("CopyService",["ConsoleOperation","FAC","MultipartCopyService","OperationDispatcherService","OperationUtilService","PathService","SCLogService","S3Service","S3Constants","S3CWSAPIService","APIProxyService","$q",function(m,j,v,e,k,c,b,t,o,d,p,s){var r="PasteObjects";var q="RenameObject";var a=null;var u={copyObjects:l,setClipboardOperation:n,isOperationInClipboard:f,startClipboardOperation:i,generateCopyRequestPayload:g,getClipboardOperation:h};return u;function n(w){if(a!==null){a.state=o.OPERATION_STATE.CANCEL}a=w}function f(){return a===null}function i(){var x=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var w=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(a===null){throw"There is no operation in the clipboard."}a.dstBucket=c.getCurrentBucket();a.dstPrefix=c.getCurrentAbsoluteFolderPath();if(a.dstPrefix===undefined){a.dstPrefix=""}if(x){a.dstName=w&&w.name;b.log(q,1,a,{dstName:a.dstName})}else{b.log(r,1,a,{dstBucket:a.dstBucket,dstPrefix:a.dstPrefix})}e.addOperation(a);a=null}function g(x,y,w,C,B){var A={bucket:x.initialBucket,prefix:x.initialPath,dstBucket:x.dstBucket,keys:_.pluck(y,"Key"),dstKeys:[],region:B};var z=undefined;if(C){(function(){var D=y[0].Key;y.forEach(function(F){var E=F.Key;z=E.replace(D,x.dstName);A.dstKeys.push(A.prefix?A.prefix+z:z)})})()}else{y.forEach(function(E){var D=E.Key;A.dstKeys.push(D.replace(E.Path||x.initialPath,x.dstPrefix))})}A.cutOperation=(w||C)===true;if(j.isFeatureEnabled(o.FAC.NEW_MULTIPART_COPY+"-"+B)){A.isNewMultipartCopy=true}return A}function l(x,C,E){var A=E.isCut;var B=E.isRename;var z=s.defer();var y=k.initializeBulkOperationResult(x,C);var D={};var w=undefined;p.getBucketLocation(x,x.initialBucket,D).then(function(){w=u.generateCopyRequestPayload(x,C,A,B,D.region);D={};p.getBucketLocation(x,x.dstBucket,D).then(function(F){w.dstBucketRegion=F.region;d.makeS3ConsoleOperationRequest(w,o.CWS_OPERATION_NAME.COPY,{},x).then(function(G){if(v.isMultipartCopyNeeded(x,G)){var H=k.getAllSinglePartCopyResult(x,G,C);if(H.error){z.reject(H);return}z.notify(H);v.startMultipartCopyForFiles(x,x.dstBucket,w.dstBucketRegion,w.region,C,w.dstKeys,G,!!(A||B),z)}else{k.handleCWSSuccessResponse(x,C,G,y,z)}})["catch"](function(G){k.handleCWSErrorResponse(x,G,y,z)})})["catch"](function(F){k.handleGetBucketLocationError(x,F,y,z)})})["catch"](function(F){k.handleGetBucketLocationError(x,F,y,z)});return z.promise}function h(){return a}}])})();"use strict";(function(){angular.module("s3").service("UploadOperationService",["$q","$window","$translate","ConsoleOperation","humanReadableBytesFilter","SCLogService","APIProxyService","PromiseQueue","S3Constants","UploadService",function(C,r,w,q,D,e,x,o,v,u){var f="DragAndDropComplete",c="OperationCreated",y="StartExplorerTraversal",d="CancelUploadOperation",g="EmptyFolder",l="Start",F="Started",j="StartedBeforeSetup",n="Complete",i="UserError";var H={createUploadOperation:B,setupUploadOperation:s,uploadFile:k,uploadSuccess:h,uploadError:b,uploadNotify:G,selectFile:m,setFlagValues:E,updateErrorPercentage:p};return H;function B(){var I=new q(v.OPERATION_NAME.UPLOAD);I.displayName=w.instant("operationname.upload");I.explorers=[];e.log(I.name+c,1,I);I.start=function(){if((!I.selectedObjects||I.selectedObjects.length===0)&&(!I.selectedFolders||I.selectedFolders.length===0)){e.log(I.name+j,1,I);throw"Setup up the upload operation before start"}e.log(I.name+F,1,I);for(var K in I.selectedFolders){if(I.selectedFolders[K].objsCount===0){A(I.selectedFolders[K],I)}}var L=new o(1);for(var J in I.selectedObjects){L.add(k,{file:I.selectedObjects[J],operation:I,isDragAndDrop:false})}if(I.explorers&&I.explorers.length>0){t(0,I)}};I.cancel=function(){I.state=v.OPERATION_STATE.CANCEL;e.log(d,1,I);for(var J in I.selectedObjects){u.cancelUpload(I.selectedObjects[J].id,I)}};return I}function t(J,I){var K=I.explorers[J];J++;e.log(I.name+y,1,I,{explorerId:K.explorerId,selectedItems:K.getSelectedItems()});z(K,I).then(function(){var L=I.succeedKeyCount+I.failedKeyCount;if(J<I.explorers.length){t(J,I)}else{e.log(I.name+f,1,I,{expectedTotalObjsCount:I.totalObjectCount,numberOfFileUploadsAttempted:L,numberOfExplorersUploaded:I.explorers.length})}},function(L){e.log(I.name+f,0,I,L);I.cancel()})}function z(L,K,M){var J=M||C.defer(),I=[];if(K.state===v.OPERATION_STATE.CANCEL){p(K);J.reject("Operation was cancelled");return}L.getNext().then(function(Q){if(!Q){J.resolve();return}var O=Q.fileList,N=Q.emptyFolderToBeUploaded;if(N){I.push(A(N,K,true))}for(var P in O){I.push(k({file:O[P],operation:K,isDragAndDrop:true}))}if(I.length>0){C.all(I).then(function(){z(L,K,J)},function(){I[I.length-1].then(function(){z(L,K,J)},function(){z(L,K,J)})})}else{z(L,K,J)}},function(N){J.reject(N)});return J.promise}function A(K,J,I){var L=x.putObject(J,J.initialBucket,J.initialPath+K.fullPath,K.Prefix);L.then(function(M){e.log(J.name+g,1,J,{fullPath:J.initialPath+K.fullPath,isDragAndDrop:I,name:K.Prefix});M.operation=J;h(M)},function(M){e.log(J.name+g,0,J,M);M.operation=J;b(M)});return L}function k(L){var J=L.file;var M=L.operation;var O=L.isDragAndDrop;var K=J.file,Q=J.fullPath?M.initialPath+J.fullPath:M.initialPath,N=M.initialBucket,R=J.id,S=M.options;K.initialLastModified=K.lastModified||"";var I=u.upload(K,Q,N,R,M,S);e.log(l+M.name,1,M,{fullPath:M.initialPath+K.fullPath,isDragAndDrop:O,fileName:K.Key});M.files[L.file.Key]=L.file.Size;if(M.state===v.OPERATION_STATE.CANCEL){var P={operation:M,name:L.file.Key,errorMessage:w.instant("upload.cancelled")};b(P);return C.reject()}else{I.then(h,b,G);return I}}function s(L,J,K,I,N,O){var M=arguments.length<=6||arguments[6]===undefined?true:arguments[6];L.selectedFolders=J;L.selectedObjects=K;L.totalObjectCount=I.files;L.totalBytes=I.size;L.totalUploadedBytes=0;L.options=N;L.uploadUiCallBack=O;L.currentUploadSpeed=0;L.lastNotifyTime=null;L.lastMarkBytes=0;L.files={};L.shouldPerformETagVerification=M}function m(J,I){return u.fileSelected(J,I)}function E(I){if(I.errorPercentage===0){I.parameters.operationSuccessful=true}else{if(I.successPercentage===0){I.parameters.operationUnsuccessful=true}else{I.parameters.operationPartiallySuccessful=true}}}function p(I){if(I.successPercentage+I.errorPercentage!==100){I.errorPercentage=100-I.successPercentage}}function h(I){var J=I.operation;delete I.operation;e.log(J.name+n,1,J,I);J.succeedKeyCount+=1;J.totalOperatedObjectCount+=1;J.totalUploadedBytes+=J.files[I.name];J.successPercentage=J.succeedKeyCount/J.totalObjectCount*100;J.uploadUiCallBack();E(J);if(J.succeedKeyCount+J.failedKeyCount===J.totalObjectCount){J.progressPercentage=100;delete J.fileInProgress;if(J.succeedKeyCount===J.totalObjectCount){J.successPercentage=100}p(J);if(J.errorPercentage!==0){J.errorCallBack(J.id)}else{J.finishCallBack(J.id)}}}function b(I){var J=I.operation;delete I.operation;var K=I.errorMessage;var L=_.filter(J.errorTypes,function(N){return N.errorMessage===K});if(L.length===0){J.errorTypes.push({errorMessage:K,errorCount:1,errorPercentage:Number(J.files[I.name]/J.totalBytes*100).toFixed(2)})}else{L[0].errorCount+=1;L[0].errorPercentage=Number(J.files[I.name]/J.totalBytes*100).toFixed(2)}var M=Number(a(I));e.log(J.name+n,M,J,I);if(M===1){e.log(J.name+i,1,J,I.errorMessage)}if(J.errorDetails[K]){J.errorDetails[K].push(I.name)}else{J.errorDetails[K]=[I.name]}J.failedKeyCount+=1;J.totalOperatedObjectCount+=1;J.successPercentage=J.succeedKeyCount/J.totalObjectCount*100;J.errorPercentage=J.failedKeyCount/J.totalObjectCount*100;J.progressPercentage=J.totalOperatedObjectCount/J.totalObjectCount*100;J.uploadUiCallBack();E(J);if(J.succeedKeyCount+J.failedKeyCount===J.totalObjectCount){if(J.failedKeyCount===J.totalObjectCount){J.errorPercentage=100}p(J);if(J.errorPercentage!==0){J.errorCallBack(J.id)}else{J.finishCallBack(J.id)}}}function G(K){var I=K.operation;if(K.totalBytes&&K.uploadedByte){var L=I.totalUploadedBytes;L+=K.uploadedByte;I.progressPercentage=I.succeedKeyCount/I.totalObjectCount*100+K.uploadedByte/K.totalBytes/I.totalObjectCount*100;I.successPercentage=I.progressPercentage;I.fileInProgress=K.fileName;var J=r.Date.now();if(I.lastNotifyTime&&J!==I.lastNotifyTime){I.currentUploadSpeed=D((L-I.lastMarkBytes)/((J-I.lastNotifyTime)/1000))}I.lastMarkBytes=L;I.lastNotifyTime=J}delete K.operation;e.log("UploadProgress",1,I,K)}function a(I){return v.UPLOAD.USER_ERROR_MESSAGES.indexOf(I.errorMessage)!==-1||I.isCancelled===true}}])})();"use strict";(function(){angular.module("s3").service("MultipartCopyService",["$q","$translate","ConsoleOperation","PathService","SCLogService","S3Constants","S3CWSAPIService","UtilService",function(t,r,o,d,c,p,e,u){var q="MultipartCopyCompleted";var k="multipartCopyId:";var l="MultipartCopyPartCompleted";var f=[p.OPERATION_NAME.COPY,p.OPERATION_NAME.CUT,p.OPERATION_NAME.RENAME,p.OPERATION_NAME.CHANGE_METADATA,p.OPERATION_NAME.CHANGE_STORAGE_CLASS,p.OPERATION_NAME.CHANGE_SSE];var w={completeMultipartCopy:g,doMultipartCopy:h,getEtagsFromResponse:b,recursivelyMultipartCopy:a,startMultipartCopyForFiles:i,isMultipartCopyNeeded:m,isMultipartCopyObject:v,initializeNotifyResult:s,notifyProgress:j,notifyError:n};return w;function m(y,x){if(f.lastIndexOf(y.name)<0){return false}else{for(var z in x.data.statusPerKey){if(x.data.statusPerKey[z].result.additionalInfoWhenSuccess&&x.data.statusPerKey[z].result.additionalInfoWhenSuccess.lastIndexOf(k)!==-1){return true}}}return false}function v(x){return x.result.additionalInfoWhenSuccess&&x.result.additionalInfoWhenSuccess.lastIndexOf(k)!==-1}function i(A,I,C,D,H,E,B,F,y){var x={};var z=false;B.data.statusPerKey.forEach(function(K){if(K.result.additionalInfoWhenSuccess&&K.result.additionalInfoWhenSuccess.lastIndexOf(k)!==-1){for(var M in H){if(H[M].Key===K.key){var O=K.result.additionalInfoWhenSuccess.split(k)[1];x[O]={key:H[M]};x[O].dstKey=E[M];x[O].dstBucket=I;x[O].dstBucketRegion=C;x[O].srcBucketRegion=D;x[O].isCut=F;x[O].objectSizeInByte=H[M].Size;x[O].partCount=Math.ceil(H[M].Size/p.MULTIPART_COPY.PART_SIZE);var L=Object.keys(x[O]);for(var N in L){if(x[O][L[N]]===undefined){c.log(q,0,A,x[O]);var J=w.initializeNotifyResult(A,[x[O].key]);J.updateType=p.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_ERROR;J.error=r.instant("operation.errormessage.multipartcopyfailed");y.notify(J);z=true}}break}}}});if(!z){var G=Object.keys(x);w.recursivelyMultipartCopy(A,G,x,0,0,B,y)}}function h(x,y,z,A){var B={bucket:x.initialBucket,multipartCopyId:y,key:z.key.Key,dstBucket:z.dstBucket,dstKey:z.dstKey,objectSizeInByte:z.objectSizeInByte,dstBucketRegion:z.dstBucketRegion,region:z.dstBucketRegion,startPartNumber:A*p.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API+1,endPartNumber:Math.min((A+1)*p.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API,z.partCount)};return e.makeS3ConsoleOperationRequest(B,p.CWS_OPERATION_NAME.MULTIPART_COPY,{},x)}function b(x){var A=[];var y="";var z=null;x.data.statusPerKey.forEach(function(B){if(B.result.status===p.OPERATION_PER_KEY_STATUS.DONE){A.push({partNumber:Number(B.key),eTag:B.result.additionalInfoWhenSuccess})}else{if(B.result.status===p.OPERATION_PER_KEY_STATUS.ERROR){y=B.result.errorMessage;z=B.result.errorCode}}});if(!y){return A}else{return{errorMessage:y,errorCode:z}}}function g(x,y,z){var A={bucket:x.initialBucket,etags:z.partEtags,copyId:y,dstKey:z.dstKey,srcKey:z.key.Key,objectSize:z.objectSizeInByte,dstBucket:z.dstBucket,srcRegion:z.srcBucketRegion,region:z.dstBucketRegion,isCut:z.isCut};return e.makeS3ConsoleOperationRequest(A,p.CWS_OPERATION_NAME.COMPLETE_MULTIPART_COPY,{},x)}function s(x,y,z){return{operation:x,keys:y,result:{},error:null,updateType:"",notifyDefer:z,isLastOne:false}}function n(y,C,D,x,B,z){var F=w.initializeNotifyResult(y,[C.key.Key],z?x:null);F.error=B;F.updateType=p.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_ERROR;F.isLastOne=z;var E=D*p.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API+1;var A=C.partCount;F.result=(A-E)*p.MULTIPART_COPY.PART_SIZE+Math.min(p.MULTIPART_COPY.PART_SIZE,C.objectSizeInByte-(A-1)*p.MULTIPART_COPY.PART_SIZE);x.notify(F)}function j(z,C,D,x,y,A){var F=w.initializeNotifyResult(z,[C.key.Key],A?x:null);if(y){F.updateType=p.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_COMPLETE}else{F.updateType=p.OPERATION_PROGRESS_UPDATE_TYPE.MULTIPART_COPY_RESULT}F.isLastOne=A;var E=D*p.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API+1;var B=Math.min((D+1)*p.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API,C.partCount);F.result=(B-E)*p.MULTIPART_COPY.PART_SIZE+Math.min(p.MULTIPART_COPY.PART_SIZE,C.objectSizeInByte-(B-1)*p.MULTIPART_COPY.PART_SIZE);x.notify(F)}function a(C,D,B,x,E,F,z){if(x===D.length||C.state===p.OPERATION_STATE.CANCEL){return}var y=B[D[x]];var A=x+1===D.length;w.doMultipartCopy(C,D[x],y,E).then(function(G){var H=b(G);if(H.errorMessage){c.log(l,0,C,{params:y,error:H.errorMessage});c.log(q,0,C);w.notifyError(C,y,E,z,H.errorMessage,A);w.recursivelyMultipartCopy(C,D,B,x+1,0,F,z)}else{c.log(l,1,C,y);if(y.partEtags){y.partEtags=y.partEtags.concat(H)}else{y.partEtags=H}if(y.partEtags.length===y.partCount){w.completeMultipartCopy(C,D[x],y).then(function(){c.log(q,1,C);w.notifyProgress(C,y,E,z,true,A)})["catch"](function(I){c.log(q,0,C);w.notifyError(C,y,E,z,I,A)});w.recursivelyMultipartCopy(C,D,B,x+1,0,F,z)}else{w.notifyProgress(C,y,E,z,false,false);w.recursivelyMultipartCopy(C,D,B,x,E+1,F,z)}}})["catch"](function(G){c.log(l,0,C,{params:y,error:G});c.log(q,0,C);w.notifyError(C,y,E,z,G,A);w.recursivelyMultipartCopy(C,D,B,x+1,0,F,z)})}}])})();"use strict";(function(){angular.module("s3").controller("ObjectDetailsController",["$filter","$location","$q","$routeParams","$scope","$timeout","$translate","APIProxyService","AWSC","BulkOperationService","CachingService","ConsoleOperation","DownloadService","PathService","PermissionsUtilService","OperationDispatcherService","S3Constants","SCLogService","UtilService",a]);function a(q,k,w,g,t,y,u,v,s,p,h,o,m,c,i,e,r,b,z){t.tabs=[{label:u.instant("details.tab.overview"),id:"overview"},{label:u.instant("details.tab.properties"),id:"properties"},{label:u.instant("details.tab.permissions"),id:"permissions"}];t.dateFormat=r.DATE_FORMAT;t.objectDetailError="";t.bucket=c.getCurrentBucket();t.key=c.getCurrentObject();if(t.key.lastIndexOf(r.DELIMITER)===t.key.length-1){k.path(""+r.DELIMITER+r.PATH_SEGMENTS.HOME)}t.obj=h.getCurrentObject();t.versionsDropdownSelectedObject={obj:_.cloneDeep(h.getCurrentObject())};if(t.versionsDropdownSelectedObject.obj){t.versionsDropdownSelectedObject.obj.Key=c.relativeToAbsoluteObjectPath(t.versionsDropdownSelectedObject.obj.Key)}t.options={};t.versionLabel=u.instant("versionsdropdown.label.latestVersion");t.selectedTab=k.search().tab||"overview";t.showReplication=false;t.showRestoration=false;t.showExpiry=false;t.showVersionsDropdown={show:false};t.showSuccessMessage=false;t.showVersionId=false;t.permissionObj={};t.versionId=g[r.VERSION_ID_PARAM];t.showVersions=z.convertStringToBoolean(g[r.SHOW_VERSION_PARAM]);s.Clog.setPageId(r.CLOG_OBJECT_DETAILS_PAGE_ID);t.copyFinished={flag:false};t.listVersions=function(A){A.stopPropagation();if(t.showVersionsDropdown.show){t.showVersionsDropdown.show=false}else{if(t.selectedTab!==r.TABS.OBJECT_LIST.PERMISSIONS){t.showVersionsDropdown.show=true;z.analyticsTrackClick(r.ANALYTICS.LATEST_VERSION,r.ANALYTICS.DETAILS)}}};t.closeDownloadAsPanel=function(){t.downloadAsPanel=false};t.openDownloadAsPanel=function(){t.downloadAsPanel=true;z.analyticsTrackClick(r.ANALYTICS.DOWNLOAD_AS,r.ANALYTICS.DETAILS);t.downloadAsPanelGenerating=true;t.downloadPanelError=false;t.downloadPanel={};m.generatePresignedUrlForCurrentObject(t.versionsDropdownSelectedObject.obj,false).then(function A(C){t.downloadAsPanelGenerating=false;t.downloadPanel.url=C.data.presignedUrl},function B(C){t.downloadAsPanelGenerating=false;t.downloadPanelError=true})};t.downloadSelectedObject=function(){var A=c.getCurrentAbsoluteFolderPath();if(t.versionsDropdownSelectedObject.obj.Key.lastIndexOf(A)===-1){t.versionsDropdownSelectedObject.obj.Key=A+t.versionsDropdownSelectedObject.obj.Key}m.downloadCurrentSelection(t.versionsDropdownSelectedObject.obj,false)};t.openSelectedObject=function(){var C=t.versionsDropdownSelectedObject.obj.VersionId?t.versionsDropdownSelectedObject.obj.VersionId:null;var A=c.getCurrentAbsoluteFolderPath();var B=undefined;if(t.versionsDropdownSelectedObject.obj.Key.lastIndexOf(A)===-1){B=A+t.versionsDropdownSelectedObject.obj.Key}else{B=t.versionsDropdownSelectedObject.obj.Key}m.openInBrowser(B,t.versionsDropdownSelectedObject.obj.Size,C,false)};t.makePublic=function(){t.isMakingPublic=true;var A=p.createBulkOperation(r.OPERATION_NAME.MAKE_PUBLIC,[t.obj],[],1,{numberOfKeysPerBulkOperation:1});A.totalSizeInBytes=t.obj.Size;e.addOperation(A);b.log("MakePublicRequestReceived",1,A);A.defer.promise.then(function(B){var C=Object.keys(B);if(C.length>0){t.objectDetailError=z.handleErrors(C[0]);b.log("MakePublicRequestComplete",0,A)}else{t.cachedValue=angular.copy(t.obj);t.cardOpen=false;t.showSuccessMessage=true;t.successMessageString=u.instant("objectdetails.successmessage");y(function(){return t.showSuccessMessage=false},r.SUCCESS_MESSAGE_TIMEOUT);b.log("MakePublicRequestComplete",1,A);n(A)}})["catch"](function(B){A.error=B;b.log("MakePublicRequestComplete",0,A);t.objectDetailError=z.handleErrors(B,true)})["finally"](function(){t.isMakingPublic=false})};t.permissionObj.grantees={};t.putAcl=function(A){var B=new o("putObjectAcl");var C=t.key;b.log("putObjectACLReceived",1,B,{bucketName:t.bucket,key:C});var D="";return v.getObjectAcl(B,t.bucket,C).then(function(F){var E=F.response.AccessControlPolicy;D+='<AccessControlPolicy xmlns="http://s3.amazonaws.com/doc/2006-03-01/"><Owner><ID>'+E.Owner.ID+"</ID>";D+="<DisplayName>"+z.encodeXml(E.Owner.DisplayName)+"</DisplayName></Owner><AccessControlList>";A.forEach(function(G){G.Grantee.Type=G.Grantee.URI?"Group":G.Grantee.EmailAddress?"AmazonCustomerByEmail":"CanonicalUser";D+='<Grant><Grantee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="'+G.Grantee.Type+'">';D+=G.Grantee.ID?"<ID>"+G.Grantee.ID+"</ID>":"";D+=G.Grantee.DisplayName?"<DisplayName>"+z.encodeXml(G.Grantee.DisplayName)+"</DisplayName>":"";D+=G.Grantee.EmailAddress?"<EmailAddress>"+G.Grantee.EmailAddress+"</EmailAddress>":"";D+=G.Grantee.URI?"<URI>"+G.Grantee.URI+"</URI>":"";D+="</Grantee>";D+="<Permission>"+G.Permission+"</Permission></Grant>"});D+="</AccessControlList></AccessControlPolicy>";return v.putObjectAcl(B,t.bucket,C,D).then(function(H){var G=H.response;b.logRequestComplete("putObjectAcl",B);if(G.Error&&(G.Error.Code||G.Error.Message)){t.objectDetailError=z.handleErrors(G);return w.reject(z.handleErrors(G))}return G})["catch"](function(G){b.log("putObjectAcl",0,B,{bucketName:t.bucket,key:C,error:G});t.objectDetailError=z.handleErrors(G);return w.reject(z.handleErrors(G))})})["catch"](function(E){t.objectDetailError=z.handleErrors(E);return w.reject(z.handleErrors(E))})};t.getStorageClassTranslation=function(){if(t.obj&&t.obj.StorageClass){return z.getStorageClassTranslations()[t.obj.StorageClass.toUpperCase()]}return""};t.getEncryptionTranslation=function(){if(t.obj){if(t.obj.statusCodes){var A=t.obj.statusCodes[r.OPERATION_NAME.GET_OBJECT_METADATA];if(A){return A}}return z.getEncryptionTranslations()[t.obj.Encryption]}return""};t.getMetadata=function(C,D){t.obj.statusCodes={};var A=c.getCurrentObject();var B=new o(r.OPERATION_NAME.GET_METADATA);b.log("GetObjectMetadataReceived",1,B);v.getObjectMetadata(C,t.bucket,A,D).then(function(F){b.log(r.OPERATION_NAME.GET_OBJECT_METADATA,C,1,{bucketName:t.bucket,key:A});var H=F.headers();t.obj.Encryption=r.OBJECT_SSE.NONE;if(H){if(H[r.HEADERS.EXPIRES.toLowerCase()]){if(!t.obj.UserDefinedMetadata){t.obj.UserDefinedMetadata={}}t.obj.UserDefinedMetadata[r.HEADERS.EXPIRES]=H[r.HEADERS.EXPIRES.toLowerCase()]}if(H[r.HEADERS.X_AMZ_REPLICATION_STATUS]){t.showReplication=true;t.obj.ReplicationStatus=F.headers()[r.HEADERS.X_AMZ_REPLICATION_STATUS]}if(H[r.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]){t.obj.Encryption=H[r.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]}if(H[r.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]){t.obj.KmsID=H[r.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID];t.options.kmsId=H[r.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]}if(H[r.HEADERS.X_AMZ_RESTORE]){t.restorationExpiry=undefined;var E=H[r.HEADERS.X_AMZ_RESTORE];if(E){var G=z.extractFromQuotes(E);if(G==="true"){t.withinRestoreExpiry=false;t.showRestoration=true}else{if(G==="false"){t.showRestoration=false;t.restorationExpiry=q("date")(new Date(z.extractFromQuotes(E,1)),t.dateFormat);t.withinRestoreExpiry=!_.isEmpty(t.restorationExpiry)}}}}if(H[r.HEADERS.X_AMZ_EXPIRATION]){t.showExpiry=true;var I=H[r.HEADERS.X_AMZ_EXPIRATION];t.obj.ExpirationDate=q("date")(new Date(z.extractFromQuotes(I,0)),t.dateFormat);t.obj.ExpirationRule=z.extractFromQuotes(I,1)}}x(C)})["catch"](function(E){t.obj.Encryption=z.getErrorMessage(E);b.log(r.OPERATION_NAME.GET_OBJECT_METADATA,C,0,{bucketName:t.bucket,key:A});t.objectDetailError=z.handleErrors(E);t.obj.statusCodes[r.OPERATION_NAME.GET_OBJECT_METADATA]=z.getErrorMessage(E)});v.getBucketLocation(C,t.bucket,{}).then(function(E){t.obj.Link=t.obj.ETag?c.getObjectLink(A,E.region,D):""});t.showVersionId=D&&D!=="null"};t.actionButtonsDisabled=function(){if(t.obj){return t.obj.StorageClass===r.STORAGE_CLASSES.GLACIER&&!t.withinRestoreExpiry||_.isEmpty(t.obj.ETag)}return true};t.makePublicButtonsDisabled=function(){if(t.obj){return false}return true};t.copyPathToClipboard=function(){z.copyPathToClipboard(t.obj.Key,t.copyFinished)};function n(A){v.getObjectAcl(A,t.bucket,c.getCurrentObject()).then(function(F){var B=F.response.AccessControlPolicy;b.log("getObjectACL",1,A,{bucketName:t.bucket,key:c.getCurrentObject()});var C=_.get(B,"AccessControlList.Grant");var D=_.get(B,"Owner");t.permissionObj.owner=D;var E={};if(C){if(Array.isArray(C)){C.forEach(function(G){i.updateGranteesHelperFunction(G,E)})}else{i.updateGranteesHelperFunction(C,E)}t.permissionObj.grantees=i.updateGrantees(E,D);t.permissionObj.aclGrants=C?Array.isArray(C)?C:[C]:[]}})["catch"](function(B){b.log("getObjectACL",0,A,{bucketName:t.bucket,key:c.getCurrentObject()});t.objectDetailError=z.handleErrors(B)})}function x(A){t.restoreWarning=null;t.warning=null;if(t.obj.StorageClass===r.STORAGE_CLASSES.GLACIER&&!t.withinRestoreExpiry){t.warning=u.instant("objectdetail.glacierwarning")}else{if(t.withinRestoreExpiry){t.restoreWarning=u.instant("objectdetail.restorewarning");n(A)}else{n(A)}}}function l(A){if(t.obj.VersionId){t.versionsDropdownSelectedObject.obj=_.cloneDeep(t.obj)}if(!t.obj.IsLatest||t.obj.IsLatest==="true"){t.obj.versionLabel=u.instant("versionsdropdown.label.latestVersion")}else{t.tabs[r.TABS.OBJECT_DETAILS.PERMISSIONS]["disabled"]=true}t.showVersionId=t.obj.VersionId&&t.obj.VersionId!=="null";t.obj.ETag=t.obj.ETag?t.obj.ETag.replace(/[\\"]+/g,""):"";if(t.obj.Key.lastIndexOf("/")!==-1){t.obj.Key=t.obj.Key.substring(t.obj.Key.lastIndexOf("/")+1)}t.getMetadata(A,t.obj.VersionId)}function j(A){var B={bucket:t.bucket,prefix:t.key,maxKeys:1,cacheAllowed:true};v.listObjects(A,B).then(function(C){t.obj=_.get(C,"response.ListBucketResult.Contents[0]");t.obj.versionLabel=u.instant("versionsdropdown.label.latestVersion");t.versionsDropdownSelectedObject.obj=_.cloneDeep(t.obj);s.Timer.customerReady();b.log(r.OPERATION_NAME.GET_OBJECT_DETAILS,1,A,B);if(t.obj){t.obj.ETag=t.obj&&t.obj.ETag.replace(/[\\"]+/g,"");if(t.obj.Key.lastIndexOf("/")!==-1){t.obj.Key=t.obj.Key.substring(t.obj.Key.lastIndexOf("/")+1)}t.obj.versionLabel=u.instant("versionsdropdown.label.latestVersion");t.getMetadata(A)}})["catch"](function(C){s.Timer.customerReady();t.objectDetailError=z.handleErrors(C);b.log(r.OPERATION_NAME.GET_OBJECT_DETAILS,0,A,C)})}function f(A){var B={bucket:t.bucket,prefix:t.key,cacheAllowed:true};v.listVersions(A,B).then(function(F){var E=F.response.ListVersionsResult;if(E.Version){E.Version=z.transformObjectToArray(E.Version)}if(E.DeleteMarker){E.DeleteMarker=z.transformObjectToArray(E.DeleteMarker)}var C=E.Version;var D=E.DeleteMarker;if(C&&C.length>0){angular.forEach(C,function(G){if(G.VersionId===t.versionId){t.obj=G}})}if(!t.obj&&D&&D.length>0){angular.forEach(D,function(G){if(G.VersionId===t.versionId){t.obj=G}})}if(t.obj){s.Timer.customerReady();b.log(r.OPERATION_NAME.GET_OBJECT_DETAILS,1,A,B);l(A)}})["catch"](function(C){s.Timer.customerReady();t.objectDetailError=z.handleErrors(C);b.log(r.OPERATION_NAME.GET_OBJECT_DETAILS,0,A,C)})}function d(){var A=new o(r.OPERATION_NAME.GET_OBJECT_DETAILS);b.setEndpoint();if(!t.obj||t.showVersions&&!t.obj.hasOwnProperty("VersionId")){if(t.versionId){f(A)}else{j(A)}}else{b.log("GetObjectDetailsCacheHit",1,A,{bucket:t.bucket,key:t.obj.Key});l(A)}}t.setTabParam=function(A){k.search("tab",A)};d()}})();"use strict";(function(){angular.module("s3").service("KeySelectionService",["PathService","UtilService","$location","$rootScope",function(e,b,h,a){function f(k){for(var j=0;j<k.length;j++){k[j].selected=false}}function d(i,j){if(i){f(i)}if(j){f(j)}}function g(j,k){if(k.length!==1){return false}var i=k[0];return decodeURIComponent(j)===e.getAbsolutePathToObjectWithBucket(i.Key)}function c(i){var j={sizeDataMissing:false,totalObjs:i.objects.length,totalSize:0,totalFolders:i.folders.length};angular.forEach(i.objects,function(k){if(k.Size){j.totalSize+=Number(k.Size)}else{j.sizeDataMissing=true}});return j}return{isCurrentlySelectedObject:g,setSelectedFlagAsFalse:d,countCurrLevelFiles:c}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("acl",[function(){return{restrict:"E",scope:{permissionObj:"=",putAcl:"=",error:"=",bucket:"=?",isBucketPermission:"=",shouldDisable:"=?",access:"=",analyzeAccess:"&"},templateUrl:"/s3/partials/acl.html",controller:"AclController"}}]);angular.module("s3").controller("AclController",["$scope","$timeout","$translate","APIProxyService","BucketPropertiesService","ConsoleOperation","PathService","PermissionsUtilService","S3Constants","SCLogService","UtilService",a]);function a(m,t,n,o,g,i,c,f,k,b,v){var s;m.granteeList={};m.radioSelect={displayName:null};m.granteeList.inputItem="";m.granteeList.inputError="";m.predefinedGroups=[{value:"AllUsers",text:n.instant("permissions.acl.everyone"),Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AllUsers"},{value:"AuthenticatedUsers",text:n.instant("permissions.acl.any"),Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AuthenticatedUsers"},{value:"LogDelivery",text:n.instant("permissions.acl.log"),Type:"Group",URI:"http://acs.amazonaws.com/groups/s3/LogDelivery"}];m.granteeListPlaceholder=n.instant("permissions.granteelist.placeholder");m.isAddGranteeRowDisplayed=false;m.resource={type:m.isBucketPermission===true?"bucket":"object"};m.readHeader=n.instant(m.resource.type+".acl.read");m.readTooltip=n.instant(m.resource.type+".acl.readtooltip");m.writeHeader=n.instant(m.resource.type+".acl.write");m.writeTooltip=n.instant(m.resource.type+".acl.writetooltip");m.readACPHeader=n.instant(m.resource.type+".acl.readacp");m.readACPTooltip=n.instant(m.resource.type+".acl.readacptooltip");m.writeACPHeader=n.instant(m.resource.type+".acl.writeacp");m.writeACPTooltip=n.instant(m.resource.type+".acl.writeacptooltip");m.showAddGranteeRow=function(){m.isAddGranteeRowDisplayed=true;v.analyticsTrackClick(k.ANALYTICS.ADD_GRANTEE,k.ANALYTICS.DETAILS);m.selectedGrantee=undefined;m.onPanelClose();t(function(){angular.element(".grantee-list input").focus()})};var q=[m.predefinedGroups[0].text,m.predefinedGroups[1].text,m.predefinedGroups[2].text];m.addNewGranteeToACL=function(w){m.addingGrantee=true;var x=_.cloneDeep(m.permissionObj.aclGrants);w.inputItem=w.inputItem.trim();if(q.indexOf(w)===-1){if(v.validateEmail(w.inputItem)){w={EmailAddress:w.inputItem,grantPermissions:w.grantPermissions}}else{w={ID:w.inputItem,grantPermissions:w.grantPermissions}}}f.addNewPermissions(w.grantPermissions,w,x);m.putAcl(x).then(function(){m.granteeList.inputItem=null;m.granteeList.inputError=null;h(m.isBucketPermission===true)})["catch"](function(y){m.granteeList.inputError=y;m.addingGrantee=false})};m.getPublicPermissionDisplayName=function(w){if(k.PUBLIC_PERMISSIONS_LIST.indexOf(w)>-1){return e[w]}return w};var e=(s={},_defineProperty(s,k.PUBLIC_PERMISSIONS_LIST[0],_.find(k.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions,{detail:{value:k.PUBLIC_PERMISSIONS_LIST[0]}}).detail.text),_defineProperty(s,k.PUBLIC_PERMISSIONS_LIST[1],_.find(k.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions,{detail:{value:k.PUBLIC_PERMISSIONS_LIST[1]}}).detail.text),s);var p=_defineProperty({},k.SYSTEM_PERMISSIONS_LIST[0],n.instant("permissions.acl.log"));m.getSystemPermissionDisplayName=function(w){if(k.SYSTEM_PERMISSIONS_LIST.indexOf(w)>-1){return p[w]}return w};function l(w){g.getBucketGrantees(m.bucket,w).then(function(x){b.log("GetBucketPermissions",1,w,{bucketName:m.bucket});g.getBucketACP(m.bucket,w).then(function(z){b.log("getBucketACPs",1,w,{bucketName:m.bucket});var y=_.get(z,"AccessControlList.Grant");m.permissionObj.aclGrants=[];if(y){m.permissionObj.aclGrants=v.transformObjectToArray(y)}var A=_.get(z,"Owner");m.permissionObj.owner=A;m.permissionObj.grantees=f.updateGrantees(x,A)})["catch"](function(y){b.log("getBucketACPs",0,w,{bucketName:m.bucket});m.aclError=y})})["catch"](function(x){b.log("GetBucketPermissions",0,w,{bucketName:m.bucket});m.aclError=x})["finally"](function(){r()})}function u(w){o.getObjectAcl(w,m.bucket,c.getCurrentObject()).then(function(B){var x=B.response.AccessControlPolicy;b.log("getObjectACL",1,w,{bucketName:m.bucket,key:c.getCurrentObject()});var y=_.get(x,"AccessControlList.Grant");var z=_.get(x,"Owner");m.permissionObj.owner=z;var A={};m.permissionObj.aclGrants=y?v.transformObjectToArray(y):[];if(y){if(y.forEach){y.forEach(function(C){f.updateGranteesHelperFunction(C,A)})}else{f.updateGranteesHelperFunction(y,A)}}m.permissionObj.grantees=f.updateGrantees(A,z)})["catch"](function(x){b.log("getObjectACL",0,w,{bucketName:m.bucket,key:c.getCurrentObject()});m.aclError=v.handleErrors(x)})["finally"](function(){r()})}function h(x){if(x){var w=new i("BucketPermissions","getPermissions");l(w)}else{var w=new i("ObjectPermissions","getPermissions");u(w)}}m.updateGrantee=function(x){m.updatingGrantee=true;m.granteeList.inputError=null;var y=_.cloneDeep(m.permissionObj.aclGrants);var w=undefined,A=undefined;if(x.granteeDetails.DisplayName||x.granteeDetails.ID){if(m.permissionObj.owner.ID===x.granteeDetails.ID){A=k.GRANTEE_GROUP.OWNER}else{A=k.GRANTEE_GROUP.ACCOUNTS}w=x.granteeDetails.DisplayName||x.granteeDetails.ID}else{if(x.granteeDetails.URI){w=x.granteeDetails.URI.split("/")[5];if(_.indexOf(k.SYSTEM_PERMISSIONS_LIST,w)>-1){A=k.GRANTEE_GROUP.SYSTEM}else{A=k.GRANTEE_GROUP.GROUP}}}var z={allPermissionsRevoked:true,fullControlAdded:false};f.aclsUpdate(y,m.permissionObj.grantees[A],x.permissions,x.granteeDetails,w,z);m.putAcl(y).then(function(){if(!_.isEmpty(m.permissionObj)){m.permissionObj.aclGrants=y}if(z.allPermissionsRevoked===true){if(A===k.GRANTEE_GROUP.ACCOUNTS){delete m.permissionObj.grantees.accounts[w]}else{m.permissionObj.grantees[A][w]=_.clone(x.permissions)}}else{m.permissionObj.grantees[A][w]=_.clone(x.permissions)}m.savedBucketAcl=true;m.analyzeAccess({cacheAllowed:false}).then(function(){m.aclAfterAnalysis=true})["finally"](function(){j()})})["catch"](function(B){m.granteeList.inputError=B;j()})};function j(){m.updatingGrantee=false;m.panelCancel()}m.onPanelClose=function(){m.panelHide=true;m.radioSelect.displayName=null};m.panelCancel=function(){m.onPanelClose();m.selectedGrantee=undefined};m.getPublicPermissionsWarning=function(){var w=k.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions[1].detail.value;var y=k.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions[0].detail.value;var z=_.get(m,"selectedGrantee.displayedValue");if(z===w||z===y){var A=_.find(m.permissionObj.grantees.group[z],function(B){return B===true})!==undefined;if(A){return{body:n.instant(m.resource.type+".warningbody.granted."+z),header:n.instant(m.resource.type+".warningheader.granted."+z),isVisible:true}}var x=_.find(m.selectedGrantee.permissions,function(B){return B===true})!==undefined;if(x){return{body:n.instant(m.resource.type+".warningbody.granting."+z),header:n.instant(m.resource.type+".warningheader.granting."+z),isVisible:true}}}else{return{isVisible:false}}};m.hasGrant=function(w){return w.READ||w.READ_ACP||w.WRITE||w.WRITE_ACP};m.selectGrantee=function(x,w){m.isAddGranteeRowDisplayed=false;m.radioSelect.displayName=x;m.selectedGrantee={displayedValue:x,granteeDetails:d(x)};m.selectedGrantee.permissions=_.clone(w);m.panelOpen=true;m.panelHide=false};m.resetInputError=function(){if(!_.isEmpty(m.granteeList.inputError)){m.granteeList.inputError=null}};m.deleteAccountGrantee=function(){if(!m.disableDeleteButton()){m.selectedGrantee.permissions={READ:false,WRITE:false,READ_ACP:false,WRITE_ACP:false};m.updateGrantee(m.selectedGrantee)}};m.disableDeleteButton=function(){return m.shouldDisable||!(m.radioSelect&&!_.isEmpty(m.radioSelect.displayName)&&k.PUBLIC_PERMISSIONS_LIST.indexOf(m.radioSelect.displayName)===-1&&m.radioSelect.displayName!==k.LOG_DELIVERY_VALUE&&m.selectedGrantee&&m.selectedGrantee.displayedValue===m.radioSelect.displayName)};function d(y){for(var x in m.permissionObj.aclGrants){var w=m.permissionObj.aclGrants[x];if(w.Grantee.DisplayName===y||w.Grantee.ID===y||w.Grantee.URI&&w.Grantee.URI.split("/")[5]===y){return w.Grantee}}if(_.indexOf(k.SYSTEM_PERMISSIONS_LIST,y)>-1){return _.find(k.BUCKET_PERMISSIONS.INITIALIZE_ACLS.systemPermissions,{detail:{value:y}}).detail}var z=_.find(k.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions,{detail:{value:y}});if(!_.isEmpty(z)){return z.detail}if(m.permissionObj.owner.ID===y||m.permissionObj.owner.DisplayName===y){return m.permissionObj.owner}}function r(){m.isAddGranteeRowDisplayed=false;m.granteeList.inputItem=null;m.granteeList.inputError=null;m.addingGrantee=false;m.granteeList.grantPermissions=null}m.save=function(){m.granteeList.inputError=null;m.addNewGranteeToACL(m.granteeList)};m.cancel=function(){m.granteeList.inputError=null;r()}}})();"use strict";(function(){angular.module("s3").service("UtilService",["$anchorScroll","$cookies","$document","$location","$q","$translate","$timeout","$window","AWSC","EZCRCService","FAC","Region","S3Constants","ReplicationConstants","PathService","CLOUD_SYSTEMS","AwsUrlsService",a]);function a(i,s,z,k,w,u,y,n,r,j,l,e,q,A,d,h,c){var o="aws-userInfo";var p="aws-creds";var x="s3console_crr_iam_template";var f="s3.amazonaws.com";var t=$("body");var b=300;this.createQueue=function(I){var C=[],G=0;if(Array.isArray(I)){C=I}function H(){if(G===C.length){return undefined}var J=C[G];G++;if(G>=(C.length-1)/2){C=C.slice(G);G=0}return J}function D(J){C.push(J)}function F(){return C.length-G}function E(){return C[G]}return{dequeue:H,enqueue:D,getLength:F,peek:E}};this.escapePath=function(G){var F=G.split(q.DELIMITER);var H=[];for(var E=0;E<F.length;E++){var D=encodeURIComponent(F[E]);var C=D.replace(/\*/g,"%2A").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/!/g,"%21").replace(/'/g,"%27");H.push(C)}return H.join("/")};this.extractTopicName=function(C){return C.substring(C.lastIndexOf(":")+1)};this.extractQueueName=function(C){return C.substring(C.lastIndexOf("/")+1)};this.getIconClassFromFilename=function(C){if(C){var D=C.substr(C.lastIndexOf(".")+1);if(q.FILE_EXTENSIONS_ICON_MAP.hasOwnProperty(D)){return q.FILE_EXTENSIONS_ICON_MAP[D]}}return q.FILE_EXTENSIONS_ICON_MAP["default"]};this.getStorageClassTranslations=function(){return{STANDARD:u.instant("uploadmodal.label.standard"),"STANDARD-IA":u.instant("versionsdropdown.label.standard_ia"),STANDARD_IA:u.instant("versionsdropdown.label.standard_ia"),REDUCED_REDUNDANCY:u.instant("uploadmodal.label.reduced_redundancy"),GLACIER:u.instant("versionsdropdown.label.glacier")}};this.getEncryptionTranslations=function(){return{NONE:u.instant("sse.none"),AES256:u.instant("sse.aes256"),"aws:kms":u.instant("sse.aws.kms")}};this.transformListOfOptionsToDropdown=function(C){return _.map(C,function(D){return{text:D,value:D,disabled:false}})};this.getKmsKeyAlias=function(C){if(_.isArray(C.AliasList)&&C.AliasList.length>0){var E=C.AliasList[0].Alias;var D=E.split(q.OBJECT_SSE.KMS.ALIAS);if(D.length===2){return D[1]}}return C.KeyArn};this.getKMSAliasForArn=g;function g(F,E){var C=undefined,G=undefined;if(_.isArray(E)&&F&&typeof F==="string"){var D=F.split(q.OBJECT_SSE.KMS.KEY);if(D.length===2){C=D[1]}G=_.filter(E,function(H){return H.value===C&&H.text});if(G.length===1){return G[0].text}}return F}this.getKMSKeyObjFromArn=function(E,D){var F=undefined,C=g(E,D);angular.forEach(D,function(G){if(G.value===C){F=G}});return F};this.getStorageClassOptions=function(D){var E=this;var C=[];angular.forEach(D,function(F){var G=E.getStorageClassTranslations()[F];if(!G){G=F}C.push({value:F,text:G})});if(C.length>0){return C}return null};this.transformObjectToArray=function(C){return[].concat(C)};this.parseFunctionArn=function(E){var G={};var F=this.getLambdaARNPrefix();var D=E.substring(E.indexOf(F)+F.length+1);var C=D.split(":");G.region=C[0];G.accountNum=C[1];G.functionName=C[3];return G};this.getFACRegions=function(D,C){if(_.isEmpty(C)){_.forEach(D,function(E){if(q.FALLBACK_REGION_LIST[v()].indexOf(E.value)>-1){if(l.isFeatureEnabled(""+q.FAC.PROD_STACK+E.value)){C.push(E)}}})}};function v(){var C=e.DOMAINS.PUBLIC.NAME;var D=k.host();_.each(e.DOMAINS,function(F,E){if(_.contains(D,F.SUFFIX)||_.contains(D,F.GAMMA)){C=F.NAME}});return C}this.getCloudSystem=v;this.getUserAccountId=function(){try{return JSON.parse(s.get(o)).arn.match(/[0-9]{12}/)[0]}catch(C){return null}};this.getUserNameARN=function(){try{return JSON.parse(s.get(o)).arn}catch(C){return null}};this.getCookie=function(C){var D="; "+document.cookie,E=D.split("; "+C+"=");if(E.length===2){return E.pop().split(";").shift()}return undefined};this.analyticsTrackClick=function(E,D){var C=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];C.s_fid=this.getCookie("s_fid");C["session-id"]=this.getCookie("session-id");r.Analytics.trackClick({id:E,context:D,metaData:C})};this.analyticsTrackView=function(E,D){var C=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];C.s_fid=this.getCookie("s_fid");C["session-id"]=this.getCookie("session-id");r.Analytics.trackView({id:E,context:D,metaData:C})};this.createOrUpdateRoleForReplication=function(E,H,K,G,F){var I=this.getUserAccountId();var J=w.defer();if(I===null){J.reject();return J.promise}var D=this.getIamARNPrefix();var C=""+D+I+":";if(G){return j.createPolicyForServiceRole(E,H,f,F.name,F.versionNum,C+"policy/service-role/"+H,K,this.getDefaultRegion()).then(function(){J.resolve();return J.promise})["catch"](function(L){var M=_.get(L,"response.Error.Code");if(M===A.ERROR_CODE.ENTITY_EXIST||M===A.ERROR_CODE.ACCESS_DENIED||M===A.ERROR_CODE.LIMIT_EXCEED){J.resolve()}else{J.reject(L)}return J.promise})}else{return j.zeroClickRoleCreation(E,H,f,F.name,F.versionNum,C+"policy/service-role/"+H,K,this.getDefaultRegion()).then(function(L){J.resolve(C+"role/service-role/"+L.request.params.RoleName);return J.promise})["catch"](function(L){J.reject(L);return J.promise})}};this.createOrUpdateRoleForReplication_v1=function(F,H,D,J,G){var I=this.getUserAccountId();var K=w.defer();if(I===null){K.reject();return K.promise}var L={accountId:I,srcbucket:D,dstbucket:J};var E=this.getIamARNPrefix();var C=""+E+I+":";if(G){return j.createPolicyForServiceRole(F,H,f,x,2,C+"policy/service-role/"+H,L,this.getDefaultRegion()).then(function(){K.resolve();return K.promise})["catch"](function(M){var N=_.get(M,"response.Error.Code");if(N===q.REPLICATION.ERROR_CODE.ENTITY_EXIST||N===q.REPLICATION.ERROR_CODE.ACCESS_DENIED||N===q.REPLICATION.ERROR_CODE.LIMIT_EXCEED){K.resolve()}else{K.reject(M)}return K.promise})}else{return j.zeroClickRoleCreation(F,H,f,x,2,C+"policy/service-role/"+H,L,this.getDefaultRegion()).then(function(M){K.resolve(C+"role/service-role/"+M.request.params.RoleName);return K.promise})["catch"](function(M){K.reject(M);return K.promise})}};this.convertToArray=function(C){if(!Array.isArray(C)){var D=C;C=[];C.push(D)}return C};this.convertStringToBoolean=function(C){if(C==="true"){return true}else{if(C==="false"){return false}else{return undefined}}};this.isNumeric=function(C){return !isNaN(parseFloat(C))&&isFinite(C)};this.encodeXml=function(C){if(!C){return C}return C.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};this.scrollCardToView=function(D){var C=document.getElementById(D);C.scrollIntoView()};this.scrollCardToViewSmoothly=function(C){$("html, body").animate({scrollTop:_.isEmpty(C)?0:$(C).offset().top},b)};this.scrollTo=function(C){y(i,10,false,C)};var B=function B(D,C){if(_.isEmpty(D)){if(C.status&&Object.keys(q.STATUS_CODE_MAP).indexOf(C.status.toString())>-1){return q.STATUS_CODE_MAP[C.status.toString()]}else{return u.instant("utilities.unknown.error")}}else{if(D==="null"||D==="undefined"){return u.instant("utilities.unknown.error")}}return D};this.getErrorMessage=function(C){if(C){if(_.isString(C)){if(C==="Access Denied"||C==="AccessDenied"){return u.instant("resource.access.denied")}return C}else{if(C.data&&C.data.requestStatus&&C.data.requestStatus==="error"){if(C.data.errorCode.indexOf(q.HTTP_STATUS_CODES.ACCESS_DENIED.toString())>-1){return u.instant("resource.access.denied")}return C.data.errorCode.toString()}else{if(C.status){if(C.status===q.HTTP_STATUS_CODES.ACCESS_DENIED){return u.instant("resource.access.denied")}}}}}return undefined};this.handleErrors=function(E){var D=arguments.length<=1||arguments[1]===undefined?false:arguments[1];if(D&&_.isObject(E)){if(_.get(E,"data.statusPerKey[0].result.errorCode")==="AccessDenied"){E.data.statusPerKey[0].result.errorMessageLocalized=u.instant("resource.access.denied");return E.data.statusPerKey[0].result}return Object.keys(E)[0]}if(_.get(E,"response.code","")==="CSRFException"){var C=k.absUrl().split("/s3/");var F=undefined;if(C&&C.length>0){F=C[0]+"/s3/home?region="+this.getDefaultRegion()}return{link:F,text:u.instant("crsferror")}}if(!_.isEmpty(E)){if(_.isString(E)){if(E.toLowerCase()==="access denied"||E.toLowerCase()==="accessdenied"){return u.instant("resource.access.denied")}return E}if(_.isString(E.response)){return B(E.response,E)}if(E.response&&E.response.Error&&_.isString(E.response.Error.Message)){return B(E.response.Error.Message,E)}if(E.response&&_.isString(E.response.Message)){return B(E.response.Message,E)}if(E.Error&&E.Error.Message&&_.isString(E.Error.Message)){return B(E.Error.Message,E)}if(E.response&&E.response.message&&_.isString(E.response.message)){return B(E.response.message,E)}if(E.data&&E.data.requestStatus==="error"){if(E.data.errorCode&&E.data.errorCode.indexOf(q.HTTP_STATUS_CODES.ACCESS_DENIED.toString())>-1){return u.instant("resource.access.denied")}}if(_.isObject(E)&&_.keys(E).length>0){if(_.keys(E)[0].indexOf("Forbidden")>-1){return u.instant("resource.access.denied")}if(_.keys(E)[0].indexOf("Key")>-1){return _.keys(E)[0]}}}if(Array.isArray(E)&&E[0]===q.SESSION_TIMEOUT_MESSAGE){return this.handleSessionTimeout()}return u.instant("utilities.unknown.error")};this.isValidBucketName=function(E){var C=arguments.length<=1||arguments[1]===undefined?[]:arguments[1];if(!E){C.push(u.instant("createbucketmodal.validation.invalid.error"));return false}var G="\0";var I="";for(var D=0;D<E.length;D++){var F=E.charAt(D);var H="";if(/[A-Z]/.test(F)){var J=u.instant("createbucketmodal.validation.uppercase.error");if(C.indexOf(J)===-1){C.push(J)}}if(F==="."){if(G==="\0"){H=u.instant("createbucketmodal.validation.start.error")}if(G==="."){H=u.instant("createbucketmodal.validation.periods.error")}if(G==="-"){H=u.instant("createbucketmodal.validation.dashperiod.error")}}else{if(F==="-"){if(G==="\0"){H=u.instant("createbucketmodal.validation.start.error")}if(G==="."){H=u.instant("createbucketmodal.validation.dashperiod.error")}}else{if(!/[a-z0-9]/.test(F)&&I.indexOf(F)===-1){if(!/[A-Z]/.test(F)){I+=F}if(G==="\0"){H=u.instant("createbucketmodal.validation.start.error")}}}}if(H&&C.indexOf(H)===-1){C.push(H)}G=F}if(G==="."||G==="-"){C.push(u.instant("createbucketmodal.validation.end.error"))}if(I.length>0){C.push(u.instant("createbucketmodal.validation.badchars.error")+" '"+I+"'")}if(E.length<3||E.length>63){C.push(u.instant("createbucketmodal.validation.length.error"))}if(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(E)){C.push(u.instant("createbucketmodal.validation.ipaddress.error"))}return C.length===0};this.bodyFreezeScroll=function(C,E){var G=undefined;if(C){G=t.width();t.addClass("noscroll");var D=t.innerWidth()-G;t.css("paddingRight",D);if(E){$(".storage-console-config-panel").css("marginRight",D)}}else{G=t.innerWidth();var F=G-t.innerWidth();t.css("paddingRight",F);if(E){$(".storage-console-config-panel").css("marginRight",F)}t.removeClass("noscroll")}};this.isIE=function(){var C=n.navigator.userAgent;return C.indexOf("Trident/")!==-1||C.indexOf("MSIE ")!==-1||C.indexOf("Edge/")!==-1};this.getRegionOrder=function(){var F=this.getDefaultRegion();try{F=e.getCurrentRegion()}catch(E){}var G=this.getCloudSystem();var C=_.cloneDeep(q.FALLBACK_REGION_LIST_FOR_LAMB_AND_HEADBUCKET[G]);if(G===e.DOMAINS.PUBLIC.NAME){var D=_.indexOf(C,F);if(D<0){(function(){var H=F.substr(0,2);var I=_.findIndex(C,function(J){return _.startsWith(J,H)});if(I<0){C.pop()}else{C.splice(I,1)}C.unshift(F)})()}else{C.splice(D,1);C.unshift(F)}}return C};this.validateEmail=function(C){var D=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return D.test(C)};this.reduceObjectArrayToObject=function(C){var D={};C.forEach(function(F){var E=Object.keys(F);D[F[E[0]]]=F[E[1]]});return D};this.extractFromQuotes=function(E){var D=arguments.length<=1||arguments[1]===undefined?0:arguments[1];var C=E;if(/"/.test(E)){C=E.match(/"(.*?)"/ig);C=C[D].substring(1,C[D].length-1)}return C};this.formatWithUnits=function(C){if(C<1024){return C+" B"}else{if(C<1024*1024){return Math.round(C/1024)+" KB"}else{if(C<1024*1024*1024){return(C/1024/1024).toFixed(1)+" MB"}else{if(C<1024*1024*1024*1024){return(C/1024/1024/1024).toFixed(2)+" GB"}else{if(C<1024*1024*1024*1024*1024){return(C/1024/1024/1024/1024).toFixed(2)+" TB"}else{return(C/1024/1024/1024/1024/1024).toFixed(2)+" PB"}}}}}};this.copyToClipboard=function(E){if(n.clipboardData&&n.clipboardData.setData){return n.clipboardData.setData("Text",E)}else{if(z[0].queryCommandSupported&&z[0].queryCommandSupported("copy")){var C=z[0].createElement("textarea");C.textContent=E;z[0].body.appendChild(C);C.select();try{return z[0].execCommand("copy")}catch(D){return false}finally{z[0].body.removeChild(C)}}}};this.getBucketARN=function(C){var D=this.getARNPrefix(q.AWS_SERVICE.S3);return""+D+C};this.getBucketARNPrefix=function(){return this.getARNPrefix(q.AWS_SERVICE.S3)};this.getLambdaARNPrefix=function(){return this.getARNPrefix(q.AWS_SERVICE.LAMBDA)};this.getIamARNPrefix=function(){return this.getARNPrefix(q.AWS_SERVICE.IAM)};this.getSqsARNPrefix=function(){return this.getARNPrefix(q.AWS_SERVICE.SQS)};this.getSnsARNPrefix=function(){return this.getARNPrefix(q.AWS_SERVICE.SNS)};this.getKmsARNPrefix=function(){return this.getARNPrefix(q.AWS_SERVICE.KMS)};this.getARNPrefix=function(C){var F=this.getCloudSystem();if(F===q.REGION_DOMAIN["ISO-B"]){F=q.REGION_DOMAIN.ISOB}var E=e.DOMAINS[F].ARN;var D=q.ARN_SERVICE[C];return""+E+D};this.getPartition=function(){var C=this.getCloudSystem();if(C){return e.DOMAINS[C].ARN.split("arn:")[1]}return""};this.formatXml=function(C){var E="";var D=/(>)(<)(\/*)/g;C=C.replace(D,"$1\r\n$2$3");var F=0;C.split("\r\n").forEach(function(I){var G=0;if(I.match(/.+<\/\w[^>]*>$/)){G=0}else{if(I.match(/^<\/\w/)){if(F!==0){F-=1}}else{if(I.match(/^<\w[^>]*[^\/]>.*$/)){G=1}else{G=0}}}var J="";for(var H=0;H<F;H++){J+="  "}E+=J+I+"\r\n";F+=G});return E};this.checkValue=function(F,E){var D=this;var C=false;if(F){(function(){var G=D.transformObjectToArray(E);var H=D.transformObjectToArray(F);C=H.some(function(I){return G.some(function(J){return J===I})})})()}return C};this.copyPathToClipboard=function(D,E){var C=d.relativeToAbsoluteObjectPath(D);this.copyToClipboard(C);E.flag=true;y(function(){E.flag=false},1000)};this.validateBucketName=function(D,F,E){var C=[];if(this.isValidBucketName(D,C)){if(m(D,E)){F.length=0;F.push(u.instant("createbucketmodal.bucketname.exists.error"))}else{F.length=0}}else{F.length=0;C.forEach(function(G){F.push(G)})}};function m(C,D){return D.some(function(E){return E.Name===C})}this.handleSessionTimeout=function(){var C=false;if(!this.isIE()||this.isIE()&&this.getCookie(p)){C=n.confirm(u.instant("sessionauth.expired"))}if(C){n.location.reload()}else{return w.reject(q.SESSION_TIMEOUT_MESSAGE)}};this.getPricingUrl=function(){var C={};C[h.BJS]="https://console.amazonaws.cn/billing/content?document=pricingplan#glacier";return c.getMarketingUrl("glacier/pricing",C)};this.getDataRetrievalUrl=function(){return c.getMarketingUrl("glacier/faqs/#dataretrievals")};this.getDefaultRegion=function(){return q.DEFAULT_REGION[this.getCloudSystem()]};this.getAWSCMezzRegion=function(){if(z[0]&&z[0].head&&z[0].head.querySelector('[id="awsc-mezz-region"]')){return z[0].head.querySelector('[id="awsc-mezz-region"]').content}};this.CRRFACHandle=function(){var C=l.isFeatureEnabled(q.FAC.CRR);var E=l.isFeatureEnabled(q.FAC.CRR_V2);var D={v1:C&&!E,v2:E};return D};this.getKeyVersionIds=function(C){return _.map(C,function(D){return{key:D.Key,version:D.VersionId||null}})};this.getContentType=function(C){var E=C.type;var D=C.name.split(".").pop().toLowerCase();var F=q.CONTENT_TYPE_VAL_FROM_EXT[D];if(F){E=F}return E};this.getTrailName=function(C){var D=C.split(":trail/");if(D.length===2){return D[1]}return C};this.getTrailRegionFromARN=function(C){var E=undefined;var D=C.split(":cloudtrail:");if(D.length>0){E=D[1].split(":")[0]}if(_.isEmpty(E)){E=this.getDefaultRegion()}return E};this.extractRegionFromKmsArn=function(D){var C=D.split(this.getKmsARNPrefix())[1];if(C){return C.split(":")[0]}return""};this.extractKeyIDFromKmsArn=function(C){if(C){return C.split("/")[1]}return""};this.getKmsKeysFromIamPolicy=function(C){var D=[];if(C.length>0){_.forEach(C,function(E){D=D.concat(E.Resource)})}return _.unique(D)}}})();"use strict";(function(){angular.module("s3").service("ManagementUtilService",["S3Constants","UtilService",a]);function a(c,b){return{getAnalyticsSharedDataFilePath:d,getInventorySharedDataFilePath:e};function d(h,l,j){var k=b.getUserAccountId();if(!k){return null}var g=c.S3_SHARED_DATA.OBJECT_TEMPLATE.replace("<account-id>",k).replace("<bucket-name>",h).replace("<config-id>",l),i=c.S3_SHARED_DATA.STATUS_TEMPLATE.replace("<account-id>",k).replace("<bucket-name>",h).replace("<config-id>",l),f=c.S3_SHARED_DATA.ANALYTICS_BUCKET_TEMPLATE.replace("<region>",j);return{data:g,status:i,bucket:f,fullDataPath:f+"/"+g}}function e(g,k,i){var j=b.getUserAccountId();if(!j){return null}var h=c.S3_SHARED_DATA.STATUS_TEMPLATE.replace("<account-id>",j).replace("<bucket-name>",g).replace("<config-id>",k),f=c.S3_SHARED_DATA.INVENTORY_BUCKET_TEMPLATE.replace("<region>",i);return{bucket:f,status:h}}}})();"use strict";(function(){angular.module("s3").service("ManagementDataProcessor",["$q","APIProxyService","BucketPropertiesService","ConsoleOperation","ManagementUtilService","S3Constants","SCLogService","UtilService",a]);function a(y,u,j,r,v,s,b,z){var n=0;var e=3;var w=4;var q=5;var o=6;var k=7;var i=8;var A=9;var f=10;var t=11;var d=12;var m=",";var h="ALL";var B={retrieveAnalyticsData:c,retrieveInventoryStatus:l};return B;function c(D,F,E){var C=y.defer();j.getBucketLocation(D).then(function(J){var G=new r(s.OPERATION_NAME.ANALYTICS_GET_DATA),I=v.getAnalyticsSharedDataFilePath(D,F,J);if(!I){C.reject(s.ANALYTICS.ERROR.USER_INFO_MISSING);return}var H=I.bucket;var K=E===s.S3_SHARED_DATA.DATA?I.data:I.status;u.getObject(G,H,K).then(function(L){switch(E){case s.S3_SHARED_DATA.DATA:b.log("getAnalyticsData",1,G);break;case s.S3_SHARED_DATA.STATUS:b.log("getAnalyticsStatus",1,G)}C.resolve(g(L,E))})["catch"](function(L){switch(E){case s.S3_SHARED_DATA.DATA:b.log("getAnalyticsData",0,G);break;case s.S3_SHARED_DATA.STATUS:b.log("getAnalyticsStatus",0,G)}C.reject(L)})});return C.promise}function l(H,E){var D=new r(s.OPERATION_NAME.INVENTORY_GET_STATUS),C=y.defer(),I=[];var G=undefined,F=0;if(E.length<1){C.reject()}else{j.getBucketLocation(H).then(function(J){G=v.getInventorySharedDataFilePath(H,E[0].name,J);if(!G){C.reject(s.INVENTORY.GET_STATUS_ERROR)}else{_.each(E,function(K){G=v.getInventorySharedDataFilePath(H,K.name,J);u.getObject(D,G.bucket,G.status).then(function(M){b.log("getInventoryStatus",1,D);var L=g(M,s.S3_SHARED_DATA.STATUS);I.push({name:K.name,lastExportDate:L[0],status:L[4],errorCode:L[5]});if(I.length===E.length-F){C.resolve(I)}})["catch"](function(L){b.log("getInventoryStatus",0,D);F++})})}})}return C.promise}function p(F){var D=1024*1024;var E={objectCount:isNaN(parseFloat(F[q]))?0:parseFloat(F[q]),dataUploaded:isNaN(parseFloat(F[o]))?0:parseFloat(F[o])*D,storage:isNaN(parseFloat(F[k]))?0:parseFloat(F[k])*D,dataRetrieved:isNaN(parseFloat(F[i]))?0:parseFloat(F[i])*D,getRequestCount:isNaN(parseFloat(F[A]))?0:parseFloat(F[A]),CRR:isNaN(parseFloat(F[f]))?0:parseFloat(F[f]),objectAge:F[w],storageClass:F[e]};if(F[w]===h){E.recommendedAgeTransition=F[d];if(E.recommendedAgeTransition&&E.recommendedAgeTransition!=="-1"){var C=parseInt(E.recommendedAgeTransition);if(C>=0&&C<=14){E.recommendation="15";E.recommendedAgeTransition="15"}else{E.recommendation=C.toString()}}E.ageTransition=F[t];if(E.storage===0){E.percentage=0}else{E.percentage=E.dataRetrieved/E.storage*100}}E.timestamp=new Date(F[n]).getTime();return E}function x(E){var F={};var H={};var G={};var I=[];var D=0;angular.forEach(E,function(N,L){var P=N.split(m);if(N){var K=P[n].trim();var J=F[K];if(!(K in F)){F[K]=D;I.push({date:K,stats:[],timestamp:new Date(K).getTime()});J=D;D+=1}var O=p(P);var M=P[e].toUpperCase();if(!H[M]){H[M]=M}I[J].stats.push(O);if(P[w]===h){if(!G[M]){G[M]=[]}G[M].push({date:K,row:O,timestamp:O.timestamp,percentage:O.percentage})}}});I.sort(function(K,J){return K.timestamp-J.timestamp});angular.forEach(G,function(K,J){K.sort(function(M,L){return M.timestamp-L.timestamp})});var C={all:G,rows:I,classes:H};return C}function g(E,D){var C=E.split("\n");if(C.length===0||C.length===1&&_.isEmpty(C[0])){return null}C.shift();switch(D){case s.S3_SHARED_DATA.DATA:return x(C);case s.S3_SHARED_DATA.STATUS:return C[0].split(m)}}}})();"use strict";(function(){angular.module("s3").directive("stickyNav",function(){function b(d,e){if(d[0].firstElementChild){$(d[0].firstElementChild).css({position:"fixed",top:e})}}function a(d,e){if(d[0].firstElementChild){$(d[0].firstElementChild).css({position:"absolute",top:e})}}return{restrict:"A",link:function c(h,f,e){var k=e.stickyNav,i=parseInt(e.stickyNavPaddingTop,10),d=e.isSidePanel,j=e.panelNavToggle,g=e.panelNavRemove;$(window).on("scroll",function(){if($(window).scrollTop()>=i){d?b(f,j):f.addClass(k)}else{d?a(f,g):f.removeClass(k)}})}}})})();"use strict";(function(){angular.module("s3").directive("breadcrumbs",[function(){return{restrict:"E",templateUrl:"/s3/partials/breadcrumbs.html",scope:{},controller:"BreadcrumbsController"}}]);angular.module("s3").controller("BreadcrumbsController",["$routeParams","$scope","PathService","Region","S3Constants",a]);function a(f,b,d,e,c){b.currentRegion=e.getCurrentRegion();b.objects=d.getFolderList();b.objects.forEach(function(g){if(g.path){g.path="buckets"+g.path+"?region="+b.currentRegion+"&tab=overview";if(f[c.SHOW_DELETED_PARAM]){g.path=g.path+"&"+c.SHOW_DELETED_PARAM+"="+f[c.SHOW_DELETED_PARAM]}if(f[c.SHOW_VERSION_PARAM]){g.path=g.path+"&"+c.SHOW_VERSION_PARAM+"="+f[c.SHOW_VERSION_PARAM]}}});b.condenseBreadcrumbs=false;if(b.objects.map(function(g){return g.name}).join("").length>$("body").width()/10){b.condenseBreadcrumbs=true}}})();"use strict";(function(){angular.module("s3").directive("search",function(){return{restrict:"E",templateUrl:"/s3/partials/search.html",scope:{fetchOnePagePrefix:"&?",fetchOnePageTag:"&?",filters:"=?",markers:"=?",versionsKeyMarkers:"=?",versionsIdMarkers:"=?",showVersions:"=?",noBackendCalls:"=?",enforceSelection:"&?",searchError:"=?",showTag:"=?",tagContinuationTokens:"=?",tagSearchSelected:"=?",tagQueryDeferred:"=?",empty:"=?",isLambPage:"&?"},controller:"SearchController"}});angular.module("s3").controller("SearchController",["$filter","$location","$routeParams","$scope","$translate","FAC","focusOn","PathService","S3Constants",function(j,i,m,n,a,l,p,k,f){var o=new RegExp(/[^+ \- = . _ : /A-Za-z0-9 ]/g),e=new RegExp(/[^+ \- = . _ : , /A-Za-z0-9 ]/g),h=new RegExp(/,[^ ](?!\1)|,$/g);n.objectTaggingEnabled=(n.noBackendCalls||_.isUndefined(k.getCurrentAbsoluteFolderPath()))&&l.isFeatureEnabled(f.FAC.OBJECT_TAGGING);if(!n.noBackendCalls&&!l.isFeatureEnabled(f.FAC.TAG_QUERY)){n.objectTaggingEnabled=false}n.inputDropdownText=n.objectTaggingEnabled?a.instant("tagsearch.dropdowntext"):a.instant("prefixsearch.dropdowntext");n.getInputPlaceholder=function(){if(n.isLambPage){return a.instant("bucketselector.inputfield.placeholder")}if(n.empty){return a.instant("prefixtagsearch.optional.placeholder")}if(n.noBackendCalls){return a.instant("prefixtagsearch.placeholder")}if(!n.objectTaggingEnabled){return a.instant("prefixsearch.placeholder")}else{if(n.filters&&n.filters.tagFilters.length>0){return a.instant("tagsearch.addfilter")}else{return a.instant("tagsearch.placeholder")}}};n.clearFilterInput=function(){n.filters.input=""};n.highlightRow=function(q){n.tagSearchSelected=q};n.filterKeyUp=function(q){if(n.isLambPage){if(n.filters.input!==""){b()}else{if(q&&q.keyCode!==f.KEY_CODES.ESC){n.openDropdown()}}}};n.filterKeyDown=function(q){if(n.filters.input===""){n.dropdownOpen=true}if(n.enforceSelection&&q&&q.keyCode===f.KEY_CODES.BACKSPACE&&n.filters.input.length===1){n.enforceSelection()}if(q&&q.keyCode===f.KEY_CODES.ESC){n.clearFilterInput();c();n.prefixSearch()}if(q&&q.keyCode===f.KEY_CODES.ENTER){if(!n.isLambPage){if(_.isEmpty(n.filters.input)&&n.noBackendCalls){return}if(n.showTag){n.tagSearch(true);b()}else{if(n.tagSearchSelected){n.selectTag()}else{n.prefixSearch();b();if(n.noBackendCalls){n.filters.input=""}}}}else{b()}}if(n.objectTaggingEnabled&&q&&q.keyCode===f.KEY_CODES.DOWN){q.preventDefault();n.tagSearchSelected=true}if(n.objectTaggingEnabled&&q&&q.keyCode===f.KEY_CODES.UP){q.preventDefault();n.tagSearchSelected=false}};n.shouldShowTag=function(){if(!n.filters||!n.filters.input||!n.objectTaggingEnabled){return false}var q=n.filters.input;if(q.search(/.+ \| /g)>-1){n.showTag=true;return true}else{n.showTag=false;return false}};n.selectTag=function(){n.searchError="";n.showTag=true;n.filters.input=n.filters.input+" | ";p("prefixSearchInput")};n.openDropdown=function(){if(n.filters.input===""){n.dropdownOpen=true}};function b(){n.dropdownOpen=false;n.tagSearchSelected=false}n.clickedOutside=function(){if(n.enforceSelection&&n.filters&&!_.isEmpty(n.filters.input)){n.enforceSelection();p("prefixSearchInput")}else{b()}};n.isSearchEmpty=function(){if(n.filters&&_.isEmpty(n.filters.input)){n.searchError="";n.tagSearchSelected=false;n.showTag=false;return true}else{return false}};n.removePrefixFilter=function(q){n.filters.input="";for(var r=0;r<n.filters.prefixFilters.length;r++){if(q===n.filters.prefixFilters[r]){n.filters.prefixFilters.splice(r,1)}}n.prefixSearch()};n.removeTagFilter=function(q){if(n.tagQueryDeferred){n.tagQueryDeferred.reject()}for(var r=0;r<n.filters.tagFilters.length;r++){if(q===n.filters.tagFilters[r]){n.filters.tagFilters.splice(r,1)}}if(n.filters.tagFilters.length>0){n.tagSearch(false)}else{if(!n.noBackendCalls){n.fetchOnePagePrefix({prefix:""})}}};n.removeAccessFilter=function(q){if(n.filters.accessFilters.length===1){n.filters.accessFilters=[]}else{_.remove(n.filters.accessFilters,function(r){return r===q})}};n.accessSearch=function(r){var q=a.instant("accesssearch.publicread"),s=a.instant("accesssearch.publicwrite");n.searchError="";if(!r){if(n.filters.accessFilters.indexOf(q)===-1){n.filters.accessFilters.push(q)}if(n.filters.accessFilters.indexOf(s)===-1){n.filters.accessFilters.push(s)}}else{if(r==="read"){n.filters.accessFilters=[q]}else{n.filters.accessFilters=[s]}}n.dropdownOpen=false};n.prefixSearch=function(){n.searchError="";var r=n.filters.input.indexOf("/");if(n.noBackendCalls&&r===0){n.bucketName=m[f.PATH_SEGMENTS.BUCKET_NAME];n.prefixInfo=n.filters.input}else{n.bucketName="";n.prefixInfo=""}if(!n.noBackendCalls&&r!==-1){n.searchError=a.instant("prefixsearch.validation.error")}else{var q=n.filters.input;if(!n.noBackendCalls){n.filters.tagFilters.length=0}if(q!==""){n.filters.prefixFilters.length=0;n.filters.prefixFilters.push(q);if(n.noBackendCalls){n.filters.input=""}b()}else{n.filters.prefixFilters=[]}if(!n.noBackendCalls){if(n.tagQueryDeferred){n.tagQueryDeferred.reject()}n.markers=[];if(_.isEmpty(q)){i.search("prefixSearch",null)}else{i.search("prefixSearch",q)}i.search(f.CURRENT_MARKER,null);i.search(f.CURRENT_VERSIONS_KEY_MARKER,null);i.search(f.CURRENT_VERSIONS_ID_MARKER,null)}if(n.enforceSelection){n.enforceSelection()}}};n.tagSearch=function(q){n.tagContinuationTokens=[];n.searchError="";if(q){(function(){var s=n.filters.input,u=s.split(" | "),t=u[0],w=u[1],v=w.split(",");if(t.length>f.ENTITY_MAX_LENGTH.TAG_KEY){n.searchError=a.instant("tagKey.length.error")}else{if(!d(v)){n.searchError=a.instant("tagVal.length.error")}else{if(t.search(o)>-1){n.searchError=a.instant("tagKey.validation.error")}else{if(w.search(e)>-1||w.search(h)>-1){n.searchError=a.instant("tagVal.validation.error")}else{if(g(t,v)){n.searchError=a.instant("tagsearch.duplicate.error")}else{var r=true;n.filters.input="";if(!n.noBackendCalls){angular.forEach(n.filters.tagFilters,function(x){if(x.tagKey===t){x.tagVal+=", "+w;r=false}})}if(r){n.filters.tagFilters=n.filters.tagFilters.concat({tagKey:t,tagVal:w})}}}}}}})()}n.tagSearchSelected=false;n.showTag=false;if(!n.noBackendCalls){if(n.tagQueryDeferred){n.tagQueryDeferred.reject()}n.filters.prefixFilters.length=0;n.fetchOnePageTag()}if(n.enforceSelection){n.enforceSelection()}};function d(r){var q=true;angular.forEach(r,function(s){if(s.length>f.ENTITY_MAX_LENGTH.TAG_VALUE){q=false}});return q}function g(q,r){var s=false;angular.forEach(n.filters.tagFilters,function(t){if(t.tagKey===q){angular.forEach(r,function(u){if(t.tagVal.indexOf(u)>-1){s=true}})}});return s}function c(){n.searchError="";n.tagSearchSelected=false;n.showTag=false;n.tagContinuationTokens=[];n.dropdownOpen=false;if(n.filters){n.filters.input="";n.filters.tagFilters=[];n.filters.accessFilters=[]}else{n.filters={input:"",prefixFilters:[],tagFilters:[],accessFilters:[]}}}if(!n.noBackendCalls){c()}}])})();"use strict";(function(){angular.module("s3").directive("filedrop",["S3Constants","SCLogService",function(a,b){return{restrict:"A",link:function c(f,e,d){function g(k){for(var j in k){if(k[j].kind==="file"){return true}}return false}function h(){e.off("drop");e.off("dragdrop");e.off("dragover")}e.on("drop",function(i){i.stopPropagation();i.preventDefault();if(!i.originalEvent.dataTransfer||!g(i.originalEvent.dataTransfer.items)){return}f.$apply(function(){f.$emit("fileDropEvent",i.originalEvent.dataTransfer.items)})});e.on("dragdrop",function(i){i.stopPropagation();i.preventDefault()});e.on("dragover",function(i){i.stopPropagation();i.preventDefault()});f.$on("$destroy",h)}}}])})();"use strict";(function(){angular.module("s3").service("BucketPropertiesUtilService",["BucketPropertiesService","S3Constants","$filter","$q","$translate","UtilService","XMLParser",function(g,n,m,s,o,v,w){function j(x,z){if(x.BucketLoggingStatus&&x.BucketLoggingStatus.LoggingEnabled){var y=x.BucketLoggingStatus.LoggingEnabled;z.selectedValue=n.BUCKET_PROPERTIES.ENABLE;z.targetPrefix=_.isEmpty(y.TargetPrefix)?"":y.TargetPrefix;z.targetBucket=y.TargetBucket;if(y.TargetGrants){z.targetGrants=y.TargetGrants.Grant}else{z.targetGrants=[]}}else{z.selectedValue=n.BUCKET_PROPERTIES.DISABLE;z.targetPrefix="";z.targetBucket="";z.targetGrants=[]}}function t(B){var A="<RoutingRule>";if(B.Condition){A+="<Condition>";if(B.Condition.KeyPrefixEquals){if(_.isEmpty(B.Condition.KeyPrefixEquals)){A+="<KeyPrefixEquals/>"}else{var z=v.encodeXml(B.Condition.KeyPrefixEquals);A+="<KeyPrefixEquals>"+z+"</KeyPrefixEquals>"}}if(B.Condition.HttpErrorCodeReturnedEquals){if(_.isEmpty(B.Condition.HttpErrorCodeReturnedEquals)){A+="<HttpErrorCodeReturnedEquals/>"}else{var E=v.encodeXml(B.Condition.HttpErrorCodeReturnedEquals);A+="<HttpErrorCodeReturnedEquals>"+E+"</HttpErrorCodeReturnedEquals>"}}A+="</Condition>"}if(B.Redirect){A+="<Redirect>";if(B.Redirect.Protocol){var F=v.encodeXml(B.Redirect.Protocol);A+="<Protocol>"+F+"</Protocol>"}if(B.Redirect.HostName){var y=v.encodeXml(B.Redirect.HostName);A+="<HostName>"+y+"</HostName>"}if(B.Redirect.ReplaceKeyPrefixWith){if(_.isEmpty(B.Redirect.ReplaceKeyPrefixWith)){A+="<ReplaceKeyPrefixWith/>"}else{var C=v.encodeXml(B.Redirect.ReplaceKeyPrefixWith);A+="<ReplaceKeyPrefixWith>"+C+"</ReplaceKeyPrefixWith>"}}if(B.Redirect.ReplaceKeyWith){if(_.isEmpty(B.Redirect.ReplaceKeyWith)){A+="<ReplaceKeyWith/>"}else{var D=v.encodeXml(B.Redirect.ReplaceKeyWith);A+="<ReplaceKeyWith>"+D+"</ReplaceKeyWith>"}}if(B.Redirect.HttpRedirectCode){var x=v.encodeXml(B.Redirect.HttpRedirectCode);A+="<HttpRedirectCode>"+x+"</HttpRedirectCode>"}A+="</Redirect>"}A+="</RoutingRule>";A=A;return A}function r(x,B){if(x&&x.WebsiteConfiguration){var y=x.WebsiteConfiguration;if(y.RedirectAllRequestsTo){B.selectedValue=n.BUCKET_PROPERTIES.WEBSITE.REDIRECT_REQUEST;B.targetDomain=angular.copy(y.RedirectAllRequestsTo.HostName);B.redirectRequestProtocol=_.isEmpty(y.RedirectAllRequestsTo.Protocol)?"":y.RedirectAllRequestsTo.Protocol;B.websiteEnabledOption=o.instant("bucketproperties.website.footer.redirectallrequests");B.websiteEnabledContent=angular.copy(B.targetDomain);B.indexDocument="";B.errorDocument="";B.routingXML=""}else{if(y.IndexDocument){B.selectedValue=n.BUCKET_PROPERTIES.WEBSITE.USE_BUCKET;B.indexDocument=angular.copy(y.IndexDocument.Suffix);B.websiteEnabledOption=o.instant("bucketproperties.website.footer.buckethosting");B.websiteEnabledContent=angular.copy(B.indexDocument);if(y.ErrorDocument){B.errorDocument=angular.copy(y.ErrorDocument.Key)}if(y.RoutingRules){var E="<RoutingRules>";var D=v.transformObjectToArray(y.RoutingRules.RoutingRule);if(D.length){for(var A=0,C=D.length;A<C;A++){var z=D[A];E+=t(z)}}E+="</RoutingRules>";B.routingXML=v.formatXml(angular.copy(E));B.routingXMLToggle=true}else{B.routingXML=""}B.targetDomain="";B.redirectRequestProtocol=""}}}else{B.selectedValue=n.BUCKET_PROPERTIES.DISABLE;u(B)}}function c(x,z){if(x.Tagging.TagSet.Tag.length){for(var y=0;y<x.Tagging.TagSet.Tag.length;y++){z.push({Key:x.Tagging.TagSet.Tag[y].Key,Value:_.isEmpty(x.Tagging.TagSet.Tag[y].Value)?"":x.Tagging.TagSet.Tag[y].Value})}}else{z.push({Key:x.Tagging.TagSet.Tag.Key,Value:_.isEmpty(x.Tagging.TagSet.Tag.Value)?"":x.Tagging.TagSet.Tag.Value})}}function u(x){x.websiteEnabledOption="";x.websiteEnabledContent="";x.indexDocument="";x.errorDocument="";x.routingXML="";x.targetDomain="";x.redirectRequestProtocol=""}function f(x){var A=[{name:n.EVENTS.TOPIC,value:n.EVENTS.TOPICCONFIG,display:n.EVENTS.SNS,dropdown:"SNS topics"},{name:n.EVENTS.QUEUE,value:n.EVENTS.QUEUECONFIG,display:n.EVENTS.SQS,dropdown:"SQS queues"},{name:n.EVENTS.CLOUDFN,value:n.EVENTS.CLOUDCONFIG,display:n.EVENTS.LAMBDA,dropdown:"Lambda functions"}];var y={};var z=x.NotificationConfiguration;A.forEach(function(C){var B=[];var D=z[C.value];if(D){D=v.convertToArray(D);D.forEach(function(E){B.push(l(E,C))})}y[C.name]=B});return y}function l(y,A){var B={};B.id=y.Id;if(y.Filter&&y.Filter.S3Key&&y.Filter.S3Key.FilterRule){var x=v.convertToArray(y.Filter.S3Key.FilterRule);x.forEach(function(C){if(C.Name===n.EVENTS.PREFIX&&C.Value&&!_.isEmpty(C.Value)&&C.Value!==""){B.prefix=C.Value}if(C.Name===n.EVENTS.SUFFIX&&C.Value&&!_.isEmpty(C.Value)&&C.Value!==""){B.suffix=C.Value}})}B.arn=y[A.name];B.events=[];var z=v.convertToArray(y.Event);z.forEach(function(C){B.events.push(C)});B.type=A.display;return B}function q(D,z,C){var y=D.length;if(y===1){for(var B=0;B<z[0].length;B++){z[0][B].disabled=false}}else{if(y===2){for(var B=0;B<y;B++){for(var A=0;A<z[B].length;A++){z[B][A].disabled=false}}if(!_.isEmpty(D[0].action)){var E=C[D[0].action];for(var B=0;B<=E;B++){z[1][B].disabled=true}}if(!_.isEmpty(D[1].action)){var x=C[D[1].action];for(var B=x;B<z[0].length;B++){z[0][B].disabled=true}}}else{if(y===z.length){for(var B=0;B<y;B++){for(var A=0;A<y;A++){z[B][A].disabled=B!==A?true:false}}}}}}function a(x,z){if(z.length===n.LIFECYCLE.TOTAL_OPTIONS){return true}else{for(var y=0;y<z.length;y++){if(z[y].action===x){return true}}return false}}function b(y){if(y){var x=y.lastIndexOf(":");return y.substring(x+1)}return y}function p(A,B,x,E,C){x.rulesArray=[];var z=w.convertXmlStringToJson(A);if(z.ReplicationConfiguration&&z.ReplicationConfiguration.Rule){var D=z.ReplicationConfiguration.Rule;if(Array.isArray(D)){x.isEnabled=n.REPLICATION.DISABLED;x.destinationBucket=k(D[0].Destination.Bucket);x.replicationType="prefix";D.forEach(function(F){x.isEnabled=x.isEnabled===n.REPLICATION.ENABLED||F.Status===n.REPLICATION.ENABLED?n.REPLICATION.ENABLED:n.REPLICATION.DISABLED;e(F,x.rulesArray)})}else{x.isEnabled=D.Status;x.destinationBucket=k(D.Destination.Bucket);if(B===D.ID){x.replicationType="bucket";x.storageClass=D.Destination.StorageClass&&!_.isEmpty(D.Destination.StorageClass)?D.Destination.StorageClass:n.STORAGE_CLASSES.DEFAULT}else{x.replicationType="prefix";e(D,x.rulesArray)}}x.role=z.ReplicationConfiguration.Role;return g.getBucketLocation(x.destinationBucket).then(function(F){if(!C){x.resetDestinationBucket=true}x.destinationRegion=!_.isEmpty(E)?_.find(E,{value:F}):F})}else{x.role="";x.destinationBucket="";x.destinationRegion="";x.storageClass="";x.rulesArray=[];x.replicationType="";x.isEnabled=n.REPLICATION.DISABLED;x.response="";var y=s.defer();return y.promise}}function d(y,x){if(x.replicationType==="bucket"){x.rules=[{id:y,prefix:"",status:x.isEnabled}];if(x.storageClass!=="default"){x.rules[0].storageClass=x.storageClass}}else{x.rules=[];x.rulesArray.forEach(function(A){if(!A.markedForDelete){var z=_.clone(A);if(z.storageClass==="default"){delete z.storageClass}if(x.isEnabled===n.REPLICATION.DISABLED){z.status=n.REPLICATION.DISABLED}x.rules.push(z)}})}}function k(x){return x.substring(x.lastIndexOf(":")+1)}function e(x,y){y.push({id:x.ID,prefix:x.Prefix,status:x.Status,storageClass:x.Destination.StorageClass&&!_.isEmpty(x.Destination.StorageClass)?x.Destination.StorageClass:n.STORAGE_CLASSES.DEFAULT,markedForDelete:false})}function i(y,A,x){var z=_.get(y,"response.trailList");if(!_.isEmpty(z)){_.each(z,function(B){var D=v.getTrailName(B.TrailARN);A.push({value:D,text:D});var C=v.getTrailRegionFromARN(B.TrailARN);x[D]=C})}}function h(B,F,A,C){var D="";if(A.read&&A.write){D=n.BUCKET_PROPERTIES.OBJECT_LOGGING.ALL}else{if(A.read){D=n.BUCKET_PROPERTIES.OBJECT_LOGGING.READ_ONLY}else{if(A.write){D=n.BUCKET_PROPERTIES.OBJECT_LOGGING.WRITE_ONLY}}}var z=_.cloneDeep(B);var E=_.findIndex(z,{ReadWriteType:D});var y=undefined;var x=v.getBucketARN(C)+"/";if(E>-1){y=z[E].DataResources;if(!_.isEmpty(y)){y[0].Values.push(x)}else{y.push({Values:[x],Type:"AWS::S3::Object"})}}else{y={IncludeManagementEvents:false,DataResources:[{Values:[x],Type:"AWS::S3::Object"}],ReadWriteType:D};z.push(y)}return{EventSelectors:z,TrailName:F}}return{clearAllWebsiteFields:u,populateLoggingFields:j,populateWebsiteFields:r,populateTagsFields:c,generateRoutingRuleXML:t,generateEventSelectorsConfig:h,parseBucketNotificationConfig:f,updateLifecycleDropdown:q,isTransitionDisabled:a,stripBucketARN:b,populateReplicationObj:p,handleRules:d,populateTrailNames:i}}])})();"use strict";(function(){angular.module("s3").directive("actionDropdown",[function(){return{restrict:"E",scope:{text:"@",items:"=",bucketname:"=",isSingleObjectOnlySelected:"=",getSelectedFolders:"=",getSelectedObjects:"=",showDeleted:"=?",tagFilterLength:"=",disableTakeAction:"=?",showVersions:"="},template:'<awsui-button-dropdown ng-click="takeAction()" item-click="triggerItem(event)" items="items" text="{{text}}"></awsui-button-dropdown>',controller:"ActionDropdownController"}}]);angular.module("s3").controller("ActionDropdownController",["$scope","CopyService","FAC","S3Constants",a]);function a(p,d,j,f){var o=["getinfo","download","rename","initiaterestore","dropdowndelete","cut","copy","changestorageclass","changeencryption","changemetadata","makeobjectpublic","open"],h=["download","rename","initiaterestore"],k=["getinfo","initiaterestore","dropdowndelete"],e=["getinfo","dropdowndelete","open"],q=["download","rename","initiaterestore"],g=["undodelete"],c=["getinfo","download","dropdowndelete","makeobjectpublic","open"],n=["getinfo","download","dropdowndelete","makeobjectpublic","changestorageclass","changeencryption","changemetadata","open"],i=["makeobjectpublic","open"],b=["open","getinfo","download","initiaterestore"],l=["getinfo","open","dropdowndelete"];if(j.isFeatureEnabled(f.FAC.OBJECT_TAGGING)){o.push("addobjecttags");h.push("addobjecttags");i.push("addobjecttags");n.push("addobjecttags");c.push("addobjecttags");q.push("addobjecttags")}function m(E){var I=function I(K,J){_.forEach(K,function(L){E[L].disabled=J})};var u=p.getSelectedObjects(),H=p.getSelectedFolders(),t=_.filter(u,{StorageClass:f.STORAGE_CLASSES.GLACIER}),C=p.showVersions?_.filter(u,function(J){return J.ETag===undefined}):[],F=H.length>0,y=_.isEmpty(u)&&_.isEmpty(H),D=d.getClipboardOperation()!==null,s=p.isSingleObjectOnlySelected(),x=H.length>=1,G=H.length===1&&u.length===0,v=H.length===0&&_.every(u,{StorageClass:f.STORAGE_CLASSES.GLACIER}),z=p.showVersions&&_.some(u,function(J){return J.ETag===undefined}),A=_.any(u,{StorageClass:f.STORAGE_CLASSES.GLACIER}),w=p.showVersions&&_.every(u,function(J){return J.IsLatest==="true"}),B=s&&u[0].withinRestoreExpiry===true,r=H.length===0&&t.length+C.length===u.length;E.paste.disabled=!D;if(y){I(o,true)}else{if(p.showDeleted){I(o,true);I(g,true);if(!x){I(g,false)}}else{if(p.showVersions&&s&&!z){if(v){I($(o).not(k),true);I(k,false)}else{if(w){I(o,false);I($(o).not(n),true)}else{I(o,true);I(c,false)}}}else{if(p.showVersions&&F){I(o,true);I(l,false)}else{if(p.showVersions&&z){I(o,true);I(e,false);if(r){I(["open"],true)}}else{if(p.showVersions&&!s&&!z){I(o,true);I(e,false);I(i,false);if(v){I(o,true);I(k,false)}else{I(o,true);I(e,false);I(i,false)}}else{if(v){if(B){I($(o).not(b),true);I(b,false)}else{I($(o).not(k),true);I(k,false)}}else{if(!s&&!G){if(F&&!A){I(q,true);I($(o).not(q),false)}else{if(A&&!v){I(o,true);I(e,false)}}}else{if(x){I(h,true);I($(o).not(h),false)}else{if(p.tagFilterLength>0){I($(o).not(["initiaterestore","rename"]),false);I(["initiaterestore","rename"],true)}else{I($(o).not(["initiaterestore"]),false);I(["initiaterestore"],true)}}}}}}}}}}}p.takeAction=function(){if(p.items&&p.items[0].items&&!p.disableTakeAction){var r={open:p.items[0].items[0],getinfo:p.items[0].items[1],download:p.items[0].items[2],rename:p.items[1].items[0],dropdowndelete:p.items[1].items[1],undodelete:p.items[1].items[2],showdeleteobjs:p.items[1].items[3],cut:p.items[2].items[0],copy:p.items[2].items[1],paste:p.items[2].items[2],changestorageclass:p.items[3].items[0],initiaterestore:p.items[3].items[1],changeencryption:p.items[3].items[2],changemetadata:p.items[3].items[3],makeobjectpublic:p.items[3].items[4]};if(j.isFeatureEnabled(f.FAC.OBJECT_TAGGING)){r.addobjecttags=p.items[3].items[5]}m(r)}};p.triggerItem=function(t){var u=t.originalEvent.detail.id;function r(v){if(v.id===u){return v}if(v.items){return v.items.filter(r)[0]}}var s=p.items.map(r).filter(function(v){return v})[0];s.action()}}})();"use strict";(function(){angular.module("s3").service("CountService",["ConsoleOperation","KeySelectionService","PathService","S3Constants","SCLogService","S3CWSAPIService","UtilService","$q","$routeParams",function(i,j,c,k,b,d,q,n,f){var l="generateCountInvoked";var g="generateCountBucket";var m="generateCountRequest";var r="CountCompleted";var p="VersionsCountCompleted";var s={generateCountForOperation:e,generateCountForFullPathFoldersWithContinuationTokens:o,generateCountForFullPathFoldersWithVersionTokens:h,countAllFiles:a};return s;function e(w){var t=n.defer();w.countResultEachFolder={};var y=Math.ceil(w.selectedFolders.length/k.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API);var A=0;var z=q.convertStringToBoolean(f[k.SHOW_VERSION_PARAM]);function B(C){if(z){s.generateCountForFullPathFoldersWithVersionTokens(w,C,[],[]).then(function(E){A+=1;if(A===y){b.log(p,1,E);t.resolve(E)}else{var D=[];var G=E.selectedFolders.length<=(A+1)*k.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API?E.selectedFolders.length:(A+1)*k.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API;for(var F=A*k.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API;F<G;F++){D.push(E.selectedFolders[F].Prefix)}B(D)}})["catch"](function(D){t.reject(D);b.log(p,0,w)})}else{s.generateCountForFullPathFoldersWithContinuationTokens(w,C,[]).then(function(E){A+=1;if(A===y){b.log(r,1,E);t.resolve(E)}else{var D=[];var G=E.selectedFolders.length<=(A+1)*k.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API?E.selectedFolders.length:(A+1)*k.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API;for(var F=A*k.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API;F<G;F++){D.push(E.selectedFolders[F].Prefix)}B(D)}})["catch"](function(D){t.reject(D);b.log(r,0,w)})}}var u=[];var v=w.selectedFolders.length<=k.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API?w.selectedFolders.length:k.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API;for(var x=0;x<v;x++){u.push(w.selectedFolders[x].Prefix)}B(u);return t.promise}function o(t,w,x){var v=t.initialBucket;var y=t.initialPath;var u={};u.bucket=v;u.path=y;u.selectedFolders=w;b.log(l,1,t,u);if(w.length===0){b.log(g,1,t,u);w=[""]}return d.generateCount(v,w,x,t).then(function(z){if(z&&z.data&&z.data.statusPerKey){b.logRequestComplete(m,t);var B=[];var A=[];_.each(z.data.statusPerKey,function(D){if(D.result&&D.result.additionalInfoWhenSuccess){var C=D.result.additionalInfoWhenSuccess;if(t.countResultEachFolder[D.key]){t.countResultEachFolder[D.key].count+=C.count;t.countResultEachFolder[D.key].totalSize+=C.totalSize}else{t.countResultEachFolder[D.key]=C}t.keyCount+=C.count;t.totalSizeInBytes+=C.totalSize;if(C.continuationToken){B.push(C.continuationToken);A.push(D.key)}}});if(B.length>0){return n.resolve(o(t,A,B))}return n.resolve(t)}return n.reject(z)})["catch"](function(z){b.log(m,0,t,{bucketName:v,path:y,error:z});t.keyCount=-1;return n.reject(z)})}function h(u,y,t,v){var x=u.initialBucket;var z=u.initialPath;var w={};w.bucket=x;w.path=z;w.selectedFolders=y;b.log(l,1,u,w);if(y.length===0){b.log(g,1,u,w);y=[""]}return d.generateVersionsCount(x,y,t,v,u).then(function(B){if(B&&B.data&&B.data.statusPerKey){b.logRequestComplete(m,u);var D=[];var A=[];var C=[];_.each(B.data.statusPerKey,function(F){if(F.result&&F.result.additionalInfoWhenSuccess){var E=F.result.additionalInfoWhenSuccess;if(u.countResultEachFolder[F.key]){u.countResultEachFolder[F.key].count+=E.count;u.countResultEachFolder[F.key].totalSize+=E.totalSize}else{u.countResultEachFolder[F.key]=E}u.keyCount+=E.count;u.totalSizeInBytes+=E.totalSize;if(E.keyMarkers&&E.nextVersionIdMarkers){D.push(E.keyMarkers);A.push(E.versionIdMarkers);C.push(F.key)}}});if(t.length>0&&v.length>0){return n.resolve(h(u,D,A))}return n.resolve(u)}return n.reject(B)})["catch"](function(A){b.log(m,0,u,{bucketName:x,path:z,error:A});u.keyCount=-1;return n.reject(A)})}function a(x,t,u,w){w.flag=true;var v=j.countCurrLevelFiles(x);t.sizeDataMissing=v.sizeDataMissing;t.folders=v.totalFolders;t.currLevelObjs=v.totalObjs;t.objects=v.totalObjs;t.size=v.totalSize;u.totalSizeInBytes=v.totalSize;t.flag=true;if(x.folders&&!_.isEmpty(x.folders)){s.generateCountForOperation(u).then(function(){b.log("generateCountForOperation",1,u);t.objects+=u.keyCount;t.size=u.totalSizeInBytes;angular.forEach(u.countResultEachFolder,function(z,y){t.countResultEachFolder[y]=z})})["catch"](function(y){t.error=y;b.log("generateCountForOperation",0,u,{errorMessage:y})})["finally"](function(){w.flag=false})}else{w.flag=false}}}])})();"use strict";(function(){angular.module("s3").service("DownloadService",["ConsoleOperation","KeySelectionService","PathService","S3CWSAPIService","SCLogService","$q","$window",function(l,q,d,e,c,t,m){var h="objectDownload";var a="objDLPresignFetchStart";var i="fetchPresignedUrl";var n="DownloadSize";var f="Content-Disposition";var o="attachment";var r="inline";var g="GET";function s(B,v,D,x,w,A){var C={};C[f]=A?r:o;var z=w===null?{}:{versionId:w};return e.fetchPresignedUrl(v,B,g,C,z,null,null,x).then(function u(E){c.log(n,D,x);c.log(i,1,x,{key:B,bucket:v});return t.resolve(E)},function y(F){var E={};E.error=F;E.key=B;E.bucket=v;c.log(i,0,x,E);return t.reject(E)})}function b(z,y,x){var w=d.getCurrentBucket();var v=new l(h,a);return s(z,w,y,v,x).then(function u(A){m.location.href=A.data.presignedUrl;return t.resolve(A)})}function p(v){var x=arguments.length<=1||arguments[1]===undefined?true:arguments[1];if(v&&v.Key){var w=v.VersionId?v.VersionId:null;var y=_.cloneDeep(v.Key);if(x){y=d.relativeToAbsoluteObjectPath(y)}return b(y,v.Size,w)}var u=t.defer();u.reject(v);return u.promise}function j(w){var z=arguments.length<=1||arguments[1]===undefined?true:arguments[1];var y=d.getCurrentBucket();var v=new l(h,a);if(w&&w.Key){var x=w.VersionId?w.VersionId:null;var A=_.cloneDeep(w.Key);if(z){A=d.relativeToAbsoluteObjectPath(A)}return s(A,y,w.Size,v,x)}var u=t.defer();u.reject(w);return u.promise}function k(z,y){var x=arguments.length<=2||arguments[2]===undefined?null:arguments[2];var A=arguments.length<=3||arguments[3]===undefined?true:arguments[3];var w=d.getCurrentBucket();var v=new l(h,a);var B=_.cloneDeep(z);if(A){B=d.relativeToAbsoluteObjectPath(B)}s(B,w,y,v,x,true).then(function u(C){m.open(C.data.presignedUrl,"_blank")})}return{downloadCurrentSelection:p,generatePresignedUrlForCurrentObject:j,openInBrowser:k}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("addEventsForm",function(){return{restrict:"E",scope:{isOpen:"=",selectedEvent:"=",updateEvents:"=",eventTypes:"=",currentConfig:"=",resourceTypes:"=",forCreateBucketModal:"=?",modalInfo:"=?",cardState:"=",currentEvents:"="},templateUrl:"/s3/partials/addeventsform.html",controller:"AddEventController"}});angular.module("s3").controller("AddEventController",["$filter","$scope","$translate","BucketPropertiesService","ConsoleOperation","LambdaService","PathService","APIProxyService","S3Constants","SCLogService","SNSService","SQSService","UtilService","XMLParser",function(l,n,o,h,i,q,d,p,m,c,v,s,t,u){var a;var j=(a={},_defineProperty(a,m.EVENTS.SNS,m.EVENTS.TOPIC),_defineProperty(a,m.EVENTS.SQS,m.EVENTS.QUEUE),_defineProperty(a,m.EVENTS.LAMBDA,m.EVENTS.CLOUDFN),a);var g={SNS:"sns",SQS:"sqs",LAMBDA:"lambda"};var b=function b(){n.showCustomArn=false;n.eventResources=[];n.eventsChecked={};n.eventTypes.forEach(function(x){n.eventsChecked[x.complexName]=false});n.resourceTypesDropdown=[];n.resourceTypes.forEach(function(x){n.resourceTypesDropdown.push({text:x.dropdown,value:x.display})});n.selectValue={value:""};n.bucket=d.getCurrentBucket();n.currentEventType=n.eventTypes[0];n.S3Constants=m;n.selectedEvent.events.forEach(function(x){n.eventsChecked[x]=true});n.cachedSelectedEvents=_.cloneDeep(n.selectedEvent);n.updateEventResources()};var r=function r(y){if(_.isEmpty(y.arn)&&n.selectValue&&!_.isEmpty(n.selectValue.value)&&n.selectValue.value.indexOf(n.selectedEvent.type.toLowerCase())>-1){y.arn=n.selectValue.value}if(_.isEmpty(y.arn)){return}var x=_.find(n.eventResources,function(z){return z.text===y.arn.substring(y.arn.lastIndexOf(":")+1)});if(x===undefined){n.selectValue.value=m.EVENTS.CUSTOM;n.showCustomArn=true}else{n.selectValue.value=x.value}};n.updateEventResources=function(){n.eventResources=[];if(n.forCreateBucketModal){return k(n.modalInfo.region)}else{return h.getBucketLocation(n.bucket).then(function(x){return k(x)})["catch"](function(x){n.cardState.errorMessage=x.response;n.cardState.showError=true})}};n.getCustomArnLabel=function(){var x=undefined;switch(n.selectedEvent.type){case m.EVENTS.SNS:x=o.instant("events.label.customsnsarn");n.customarn_placeholder=t.getARNPrefix(m.AWS_SERVICE.SNS)+m.EVENTS.CUSTOM_PLACEHOLDER.SNS;break;case m.EVENTS.SQS:x=o.instant("events.label.customsqsarn");n.customarn_placeholder=t.getARNPrefix(m.AWS_SERVICE.SQS)+m.EVENTS.CUSTOM_PLACEHOLDER.SQS;break;case m.EVENTS.LAMBDA:x=o.instant("events.label.customlambdaarn");n.customarn_placeholder=t.getARNPrefix(m.AWS_SERVICE.LAMBDA)+m.EVENTS.CUSTOM_PLACEHOLDER.LAMBDA;break}return x};function f(){if(n.cachedSelectedEvents&&n.cachedSelectedEvents.type&&n.selectedEvent.type!==n.cachedSelectedEvents.type){var x=_.findIndex(n.currentEvents[j[n.cachedSelectedEvents.type]],function(y){return y.id===n.cachedSelectedEvents.id});n.currentEvents[j[n.cachedSelectedEvents.type]].splice(x,1);n.currentEvents[j[n.selectedEvent.type]].push(n.selectedEvent);n.cachedSelectedEvents=_.cloneDeep(n.selectedEvent)}}function w(x){return n.selectedEvent.arn&&n.selectedEvent.arn.indexOf(x)===-1}function k(y){var x=new i("updateResource");n.updateCurrentEventType(n.selectedEvent.type);n.isLoadingResources=true;if(n.selectedEvent.type===m.EVENTS.SNS){return p.makeProxyRequest(v.listTopics,{region:y},m.PROXY_API_NAMES.SNS.LIST_TOPICS,x).then(function(z){var A=z.response.ListTopicsResponse.ListTopicsResult.Topics;if(A){A.forEach(function(B){n.eventResources.push({value:B.TopicArn,text:t.extractTopicName(B.TopicArn)})})}n.eventResources.push({value:m.EVENTS.CUSTOM,text:o.instant("events.option.customsnsarn")});n.isLoadingResources=false;if(w(g.SNS)){n.selectedEvent.arn=null}r(n.selectedEvent)})["catch"](function(z){n.cardState.listTopicError=t.handleErrors(z)})["finally"](function(){f()})}else{if(n.selectedEvent.type===m.EVENTS.SQS){return p.makeProxyRequest(s.listQueues,{region:y},m.PROXY_API_NAMES.SQS.LIST_QUEUES,x).then(function(A){var z=A.response.ListQueuesResponse.ListQueuesResult.queueUrls;if(z){z.forEach(function(B){n.eventResources.push({value:e(B),text:t.extractQueueName(B)})})}n.eventResources.push({value:m.EVENTS.CUSTOM,text:o.instant("events.option.customsqsarn")});n.isLoadingResources=false;if(w(g.SQS)){n.selectedEvent.arn=null}r(n.selectedEvent)})["catch"](function(z){n.cardState.listTopicError=t.handleErrors(z)})["finally"](function(){f()})}else{if(n.selectedEvent.type===m.EVENTS.LAMBDA){return p.makeProxyRequest(q.listFunctions,{region:y,params:{MaxItems:m.API_MAX_ITEMS.LAMBDA_LIST_FUNCTIONS}},m.PROXY_API_NAMES.LAMBDA.LIST_FUNCTIONS,x).then(function(A){var z=A.response.Functions;if(z){z.forEach(function(B){n.eventResources.push({value:B.FunctionArn,text:B.FunctionName})})}n.eventResources.push({value:m.EVENTS.CUSTOM,text:o.instant("events.option.customlambdaarn")});n.isLoadingResources=false;if(w(g.LAMBDA)){n.selectedEvent.arn=null}r(n.selectedEvent)})["catch"](function(z){n.cardState.listTopicError=t.handleErrors(z)})["finally"](function(){f()})}}}}function e(y){var B=t.getARNPrefix(m.AWS_SERVICE.SQS);var A=y.substring(y.indexOf(".")+1);var z=A.substring(0,A.indexOf("."));var x=A.substring(A.indexOf("/")).replaceAll("/",":");return B+z+x}n.updateCurrentEventType=function(x){switch(x){case m.EVENTS.SNS:n.currentEventType=n.eventTypes[0];break;case m.EVENTS.SQS:n.currentEventType=n.eventTypes[1];break;case m.EVENTS.LAMBDA:n.currentEventType=n.eventTypes[2];break}};n.selectChanged=function(){if(n.selectValue.value!==m.EVENTS.CUSTOM){n.selectedEvent.arn=n.selectValue.value}};n.handleCheckboxes=function(){n.selectedEvent.events=_.filter(_.keys(n.eventsChecked),function(x){return n.eventsChecked[x]})};b()}])})();"use strict";(function(){angular.module("s3").directive("events",[function(){return{restrict:"E",scope:{cardOpen:"=",forCreateBucketModal:"=?",createBucketObj:"=?",modalInfo:"=?",id:"@?"},templateUrl:"/s3/partials/events.html",controller:"EventsController"}}]);angular.module("s3").controller("EventsController",["$q","$scope","$timeout","$translate","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","FAC","LambdaService","PathService","Region","S3Constants","SCLogService","UtilService","XMLParser",a]);function a(y,u,z,w,d,m,i,o,n,x,f,g,r,e,A,B){var v,q,p,k;var j="provided already exists. Please provide a new statement id, or remove the existing statement";function h(){u.cardSummaryObj.isActive=u.eventsTable.length>0;if(u.cardSummaryObj.isActive>0){u.cardSummaryObj.activeSummary.text=u.eventsTable.length+w.instant("bucketproperties.events.activenotifications")}else{u.cardSummaryObj.inactiveSummary.text=u.eventsTable.length+w.instant("bucketproperties.events.activenotifications")}}function c(){u.cardState={errorMessage:"",headerTitle:w.instant("event.table.newevent"),isAdding:true,isSaving:false,radioValue:"",selectedEventObj:null,selectedEventTable:null,showError:false};u.cachedEventsSettings=null;u.eventTypes=[{simpleName:w.instant("events.eventTypes.objectlost"),complexName:r.BUCKET_EVENTS.RRS_OBJECT_LOST},{simpleName:w.instant("events.eventTypes.put"),complexName:r.BUCKET_EVENTS.PUT},{simpleName:w.instant("events.eventTypes.post"),complexName:r.BUCKET_EVENTS.POST},{simpleName:w.instant("events.eventTypes.copy"),complexName:r.BUCKET_EVENTS.COPY},{simpleName:w.instant("events.eventTypes.completeMultipartUpload"),complexName:r.BUCKET_EVENTS.COMPLETE_MULTIPART_UPLOAD},{simpleName:w.instant("events.eventTypes.delete"),complexName:r.BUCKET_EVENTS.DELETE},{simpleName:w.instant("events.eventTypes.deleteMarker"),complexName:r.BUCKET_EVENTS.DELETE_MARKER_CREATED},{simpleName:w.instant("events.eventTypes.objectCreate"),complexName:r.BUCKET_EVENTS.CREATE_OBJECT_ALL},{simpleName:w.instant("events.eventTypes.objectDelete"),complexName:r.BUCKET_EVENTS.DELETE_OBJECT_ALL}];if(!n.isFeatureEnabled(r.FAC.S3_RRS)){u.eventTypes=_.reject(u.eventTypes,function(E){return E.complexName===r.BUCKET_EVENTS.RRS_OBJECT_LOST})}u.eventsMap={};u.eventTypes.forEach(function(E){u.eventsMap[E.simpleName]=E.complexName;u.eventsMap[E.complexName]=E.simpleName});u.scrollCardId="#"+u.id;u.cardSummaryObj=_.cloneDeep(r.CARD_SUMMARY_INIT);v=new o("BucketNotification","getBucketNotification");q=new o("BucketNotification","putBucketNotification");p=f.getCurrentBucket();u.eventsTable=[];k=g.getCurrentRegion();var D={name:r.EVENTS.CLOUDFN,value:r.EVENTS.CLOUDCONFIG,display:r.EVENTS.LAMBDA,dropdown:w.instant("events.label.lambdafunction")};u.resourceTypes=[{name:r.EVENTS.TOPIC,value:r.EVENTS.TOPICCONFIG,display:r.EVENTS.SNS,dropdown:w.instant("events.label.snstopic")},{name:r.EVENTS.QUEUE,value:r.EVENTS.QUEUECONFIG,display:r.EVENTS.SQS,dropdown:w.instant("events.label.sqsqueue")},D];if(u.forCreateBucketModal){k=u.modalInfo.region;if(!u.isFeatureEnabled("s3-la-"+k)){u.resourceTypes.pop()}}else{m.getBucketLocation(p).then(function(E){k=E;if(!u.isFeatureEnabled("s3-la-"+k)){u.resourceTypes.pop()}})}if(u.forCreateBucketModal){u.$watch("cardOpen",function(F,E){z(function(){A.scrollCardToView(r.BUCKET_PROPERTIES.EVENTS.CREATE_BUCKET_CARD)},1)})}if(u.forCreateBucketModal){if(u.modalInfo.copySettingsSourceBucket){var C=B.convertXmlStringToJson(u.createBucketObj.response);u.currentEvents=i.parseBucketNotificationConfig(C);u.createBucketObj.currentEvents=u.currentEvents}else{if(u.createBucketObj.currentEvents){u.currentEvents=u.createBucketObj.currentEvents}else{u.currentEvents={Topic:[],Queue:[],CloudFunction:[]}}}u.updateTable()}else{u.cardSummaryObj.isLoading=true;u.updateEvents().then(function(){u.updateTable();h();u.cardSummaryObj.isLoading=false})}}u.updateEvents=function(){return m.getBucketNotification(p,v).then(function(E){var D=E.response;var C=B.convertXmlStringToJson(D);u.currentEvents=i.parseBucketNotificationConfig(C);u.cachedEventsSettings=_.cloneDeep(u.currentEvents)})["catch"](function(C){l(C)})};u.updateTable=function(){u.eventsTable=[];if(!u.currentEvents){return}u.resourceTypes.forEach(function(C){u.currentEvents[C.name].forEach(function(E){var D={id:E.id,type:E.type};D.events=_.map(E.events,function(F){return u.eventsMap[F]}).toString();D.filter=s(E.prefix,E.suffix);D.isEditing=false;u.eventsTable.push(D)})});u.cardState.isAdding=false};function s(C,D){if(C&&D){return C+", "+D}else{if(C){return C}else{if(D){return D}else{return""}}}}function t(C){return _.find(u.resourceTypes,function(D){return D.display===C.type})}u.selectEvent=function(D){u.closeAddEvents();var E=D;u.cardState.selectedEventTable=_.find(u.eventsTable,function(F){return F.id===E.id});var C=t(E);u.cardState.selectedEventObj=_.find(u.currentEvents[C.name],function(F){return F.id===E.id});u.cardState.radioValue=u.cardState.selectedEventTable.id};u.addEvent=function(){u.cardState.selectedEventObj={id:"",type:null,prefix:"",suffix:"",arn:"",events:[]};u.cardState.selectedEventTable={id:"",type:r.EVENTS.SNS,filter:"",events:[],isEditing:true};u.cardState.isAdding=true;u.cardState.radioValue="";u.cardState.headerTitle=w.instant("events.table.newevent");u.eventsTable.unshift(u.cardState.selectedEventTable)};u.closeCard=function(C){C.stopPropagation();u.cardOpen=false};u.closeAddEvents=function(){if(u.cardState.isAdding){var C=_.findIndex(u.eventsTable,function(D){return D===u.cardState.selectedEventTable});u.eventsTable.splice(C,1);u.cardState.isAdding=false}else{if(u.cardState.selectedEventTable&&u.cardState.selectedEventTable.isEditing){u.cardState.selectedEventTable.isEditing=false;u.updateTable()}}u.cardState.selectedEventTable=null;u.cardState.selectedEventObj=null;u.cardState.radioValue=""};u.deletePressed=function(){var D=t(u.cardState.selectedEventObj);var C=_.findIndex(u.currentEvents[D.name],function(E){return E.id===u.cardState.selectedEventObj.id});u.currentEvents[D.name].splice(C,1);u.cardState.selectedEventTable=null;u.cardState.selectedEventObj=null;u.cardState.radioValue="";u.updateTable()};u.editPressed=function(){u.cardState.headerTitle=u.cardState.selectedEventTable.id;u.cardState.selectedEventTable.isEditing=true;u.cardState.isAdding=false};u.cancelPressed=function(C){A.analyticsTrackClick(r.ANALYTICS.CANCEL_EVENTS,r.ANALYTICS.DETAILS);c();u.closeCard(C)};u.savePressed=function(D){A.analyticsTrackClick(r.ANALYTICS.SAVE_EVENTS,r.ANALYTICS.DETAILS);u.cardState.isSaving=true;if(u.cardState.selectedEventObj){var E=t(u.cardState.selectedEventObj);var C=_.findIndex(u.currentEvents[E.name],function(F){return F.id===u.cardState.selectedEventObj.id});if(C===-1){u.currentEvents[E.name].push(u.cardState.selectedEventObj)}else{u.currentEvents[E.name][C]=u.cardState.selectedEventObj}}if(u.forCreateBucketModal){u.createBucketObj.response=m.parseBucketNotificationObject(u.currentEvents);u.createBucketObj.currentEvents=u.currentEvents;if(u.cardState.selectedEventObj){u.cardState.selectedEventTable.isEditing=false;u.cardState.selectedEventTable=null;u.cardState.selectedEventObj=null;u.cardState.radioValue=""}u.closeCard(D);u.cardState.isSaving=false}else{(function(){var F=[];u.currentEvents.CloudFunction.forEach(function(H){if(_.isEmpty(u.cachedEventsSettings)||_.findIndex(u.cachedEventsSettings.CloudFunction,{id:H.id})===-1){var G=A.parseFunctionArn(H.arn);var J=A.getUserAccountId();if(J===null){e.log("LambdaAddPermission",0,q,{bucket:p,lambda:H.arn});l(w.instant("events.addpermissions.error"));return}var I={Action:"lambda:InvokeFunction",Principal:"s3.amazonaws.com",SourceAccount:J,SourceArn:A.getBucketARN(p),StatementId:(J+"_event_permissions_for_"+H.id+"_from_"+p+"_for_"+G.functionName).substring(0,100)};F.push(x.addPermission({region:k,path:"/2015-03-31/functions/"+G.functionName+"/policy",content:JSON.stringify(I)}).then(function(){e.log("LambdaAddPermission",1,q,{bucket:p,lambda:H.arn})})["catch"](function(K){e.log("LambdaAddPermission",0,q,{bucket:p,lambda:H.arn});l(K)}))}});y.all(F).then(function(){b(D)})})()}};function b(C){m.putBucketNotification(p,q,u.currentEvents).then(function(){u.closeCard(C);if(u.cardState.selectedEventObj){u.cardState.selectedEventTable.isEditing=false}u.cardState.selectedEventTable=null;u.cardState.selectedEventObj=null;u.cardState.radioValue="";u.cardState.isSaving=false;u.cardState.showError=false;u.cardState.isAdding=false;u.updateEvents().then(function(){u.updateTable();h()})})["catch"](function(D){l(D)})}function l(C){var D=A.handleErrors(C);if(D.indexOf(j)>-1){return}u.cardState.showError=true;u.cardState.errorMessage=D;u.cardState.isSaving=false}u.isFeatureEnabled=function(C){return n.isFeatureEnabled(C)};u.docLink=d.getDocUrl(r.LEARN_MORE_LINKS.EVENTS);c()}})();"use strict";(function(){angular.module("s3").directive("modalPermissions",[function(){return{restrict:"E",scope:{publicPermissions:"=",userPermissions:"=",isAddingAccount:"=",awsAccountPermissions:"=",systemPermissions:"=?",showSystemPermissions:"@?",owner:"=",modalType:"="},templateUrl:"/s3/partials/modalpermissions.html",controller:"ModalPermissionsController"}}]);angular.module("s3").controller("ModalPermissionsController",["$filter","$scope","$translate","S3Constants",function(d,a,c,b){a.manageUserTitles=[{txt:c.instant("modal.manageusertitles.userid"),info:c.instant("modal.userid.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objects"),info:c.instant("modal.objects.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objectspermissions"),info:c.instant("modal.objectspermissions.tooltip"),pos:"left"}];a.manageAWSAccountTitles=[{txt:c.instant("modal.manageusertitles.accounts"),info:c.instant("modal.awsaccounts.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objects"),info:c.instant("modal.objects.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objectspermissions"),info:c.instant("modal.objectspermissions.tooltip"),pos:"left"}];a.publicpermissionsecTitles=[{txt:c.instant("modal.publicpermissionsectitles.group"),info:c.instant("modal.group.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objects"),info:c.instant("modal.objects.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objectspermissions"),info:c.instant("modal.objectspermissions.tooltip"),pos:"left"}];a.systempermissionsecTitles=[{txt:c.instant("modal.publicpermissionsectitles.group"),info:c.instant("modal.group.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objects"),info:c.instant("modal.objects.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objectspermissions"),info:c.instant("modal.objectspermissions.tooltip"),pos:"left"}];a.addOwnerPermissions=function(){if(a.userPermissions[0].revokeAll){a.userPermissions[0].revokeAll=false}};a.makePublicOptions=[{text:c.instant(a.modalType+".permission.disablepublic"),value:false},{text:c.instant(a.modalType+".permission.enablepublic"),value:true}];a.logDeliveryOptions=[{text:c.instant(a.modalType+".permission.disablelogdelivery"),value:false},{text:c.instant(a.modalType+".permission.enablelogdelivery"),value:true}];a.selectedItems={logDelivery:a.logDeliveryOptions[0],makePublic:a.makePublicOptions[0]};a.makePublicWarningHeader=c.instant(a.modalType+".acl.makepublic.warning.header");a.makePublicWarningBody=c.instant(a.modalType+".acl.makepublic.warning.body");a.$watchCollection("selectedItems",function(e){a.publicPermissions[1].permissions.READ=_.get(e.makePublic,"value");if(a.systemPermissions){a.systemPermissions[0].permissions.READ=_.get(e.logDelivery,"value")}});a.MODAL_TYPES=b.MODAL_TYPE}])})();"use strict";(function(){angular.module("s3").directive("permissionsSubModal",function(){return{restrict:"E",scope:{isPublic:"=",isAwsAccount:"=?",aclModalTitles:"=",isAddingAccount:"=",permissions:"="},templateUrl:"/s3/partials/permissionsSubModal.html",controller:"PermissionSubModalController"}});angular.module("s3").controller("PermissionSubModalController",["$scope","$timeout","UtilService",function(b,d,a){function e(){return{detail:null,permissions:{READ:false,READ_ACP:false,WRITE:false,WRITE_ACP:false},revokeAll:false}}function c(){b.newAwsAccount.detail=null;b.newAwsAccount.permissions.READ=false;b.newAwsAccount.permissions.READ_ACP=false;b.newAwsAccount.permissions.WRITE=false;b.newAwsAccount.permissions.WRITE_ACP=false;b.newAwsAccount.revokeAll=false}b.deleteUserAcl=function(f){b.permissions[f].revokeAll=true;angular.forEach(b.permissions[f].permissions,function(h,g){b.permissions[f].permissions[g]=false})};b.addAwsAccountPermission=function(){b.isAddingAccount.flag=true;b.newAwsAccount=e();d(function(){angular.element(".newawsaccount-permission-textbox input").focus()})};b.deleteAwsAccountAcl=function(g){var f=_.findIndex(b.permissions,{detail:g});b.permissions.splice(f,1)};b.saveAwsAccountPermission=function(){if(_.isEmpty(b.permissions)){b.permissions=[]}if(a.validateEmail(b.newAwsAccount.detail.ID)){b.newAwsAccount.detail.EmailAddress=b.newAwsAccount.detail.ID;b.newAwsAccount.detail.ID=null}b.permissions.push(_.cloneDeep(b.newAwsAccount));c();b.isAddingAccount.flag=false;b.isAddingAccount.warningMsg=null};b.clearAwsAccountPermission=function(){c();b.isAddingAccount.flag=false;b.isAddingAccount.warningMsg=null}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").service("PermissionsUtilService",["S3Constants",function(i){function b(o,n,q,p){_.forEach(n,function(u,t){if(i.PUBLIC_PERMISSIONS_LIST.indexOf(t)>-1){var s=_.findIndex(o.publicPermissions,{detail:{value:t}});if(s>-1){o.publicPermissions[s].permissions=_.clone(u)}}else{if(i.SYSTEM_PERMISSIONS_LIST.indexOf(t)>-1){o.systemPermissions[0].permissions=_.clone(u)}else{if(q.ID===t||q.DisplayName===t){o.userPermissions[0].permissions=_.clone(u)}else{var r=_.find(p,function(v){return v.Grantee.ID===t||v.Grantee.DisplayName===t});if(!_.isEmpty(r)){o.awsAccountPermissions.push({detail:_.cloneDeep(r.Grantee),permissions:_.clone(u)})}}}}})}function e(n,p){var o=_.cloneDeep(n.aclGrants);o=!_.isEmpty(o)&&!Array.isArray(o)?[o]:_.isEmpty(o)?[]:o;o=!_.isEmpty(o)?m(o,n,p):a(p);return o}function a(p){var o=[],n=[];n=n.concat(p.userPermissions,p.publicPermissions);n=n.concat(p.systemPermissions);n=n.concat(p.awsAccountPermissions);angular.forEach(n,function(q){k(q.permissions,q.detail,o)});return o}function l(o,n,p){p.forEach(function(q,r){if((q.Grantee.URI&&q.Grantee.URI.indexOf(o)!==-1||q.Grantee.DisplayName&&q.Grantee.DisplayName===o||q.Grantee.ID&&q.Grantee.ID===o)&&q.Permission===n){p.splice(r,1)}});return p}function g(p,s,q,o,n,r){if(_.values(q).indexOf(false)>-1&&_.values(s[n]).indexOf(false)===-1&&_.findIndex(p,{Permission:i.ACL_PERMISSIONS.FULL_CONTROL})>-1){l(n,i.ACL_PERMISSIONS.FULL_CONTROL,p);angular.forEach(q,function(u,t){if(u===true){h(o,t,p)}})}else{if(_.values(q).indexOf(false)===-1&&_.values(s[n]).indexOf(false)>-1){h(o,i.ACL_PERMISSIONS.FULL_CONTROL,p);angular.forEach(i.ACL_PERMISSIONS,function(u,t){if(t!==i.ACL_PERMISSIONS.FULL_CONTROL){l(n,u,p)}});r.fullControlAdded=true;r.allPermissionsRevoked=false}}if(!r.fullControlAdded){_.keys(q).forEach(function(t){if(q[t]!==s[n][t]){if(q[t]===false||q[t]===undefined&&s[n][t]===true){l(n,t,p)}else{if(q[t]===true){h(o,t,p);r.allPermissionsRevoked=false}}}else{if(s[n][t]===true){r.allPermissionsRevoked=false}}})}}function k(p,o,n){if(p&&Object.keys(p).length===4&&_.values(p).indexOf(false)===-1){h(o,i.ACL_PERMISSIONS.FULL_CONTROL,n)}else{if(p){h(o,p,n)}}}function m(o,n,q){var p={AllUsers:_.find(q.publicPermissions,{detail:{value:"AllUsers"}}),AuthenticatedUsers:_.find(q.publicPermissions,{detail:{value:"AuthenticatedUsers"}}),LogDelivery:_.find(q.systemPermissions,{detail:{value:"LogDelivery"}})};angular.forEach(q.userPermissions.concat(q.awsAccountPermissions),function(r){var s=r.detail.DisplayName||r.detail.EmailAddress||r.detail.ID;if(s){p[s]=r}});angular.forEach(p,function(s,r){if(!n.grantees[r]){k(s.permissions,s.detail,o)}else{if(!_.isEqual(s.permissions,n.grantees[r])){var t={allPermissionsRevoked:true,fullControlAdded:false};g(o,n.grantees,s.permissions,s.detail,r,t)}}});return o}function h(n,p,o){if(!Array.isArray(o)){var q=o;o=_.isEmpty(q)?[]:[q]}var r={Type:n.Type,DisplayName:n.DisplayName,EmailAddress:n.EmailAddress,ID:n.ID,URI:n.URI};if(_.isString(p)){o.push({Grantee:r,Permission:p})}else{if(p){_.forEach(p,function(t,s){if(t){o.push({Grantee:r,Permission:s})}})}}return o}function f(n){return n.Grantee.DisplayName?n.Grantee.DisplayName:n.Grantee.URI?n.Grantee.URI.split("/").pop():n.Grantee.ID}function c(n,o){var p=f(n);if(p){if(!o[p]){o[p]={READ:false,WRITE:false,READ_ACP:false,WRITE_ACP:false}}if(n.Permission==="FULL_CONTROL"){o[p]={READ:true,WRITE:true,READ_ACP:true,WRITE_ACP:true}}else{o[p][n.Permission]=true}}}function j(o,n){_.forEach(o,function(p){if(_.isEmpty(n[p])){n[p]={READ:false,WRITE:false,WRITE_ACP:false,READ_ACP:false}}})}function d(n,p){var r;var o=p.DisplayName||p.ID;var q=(r={},_defineProperty(r,i.GRANTEE_GROUP.GROUP,{}),_defineProperty(r,i.GRANTEE_GROUP.ACCOUNTS,{}),_defineProperty(r,i.GRANTEE_GROUP.SYSTEM,{}),_defineProperty(r,i.GRANTEE_GROUP.OWNER,{}),r);_.forEach(n,function(t,s){if(i.PUBLIC_PERMISSIONS_LIST.indexOf(s)>-1){q.group[s]=t}else{if(i.SYSTEM_PERMISSIONS_LIST.indexOf(s)>-1){q.system[s]=t}else{if(s===p.DisplayName||s===p.ID){q.owner[s]=t;o=s}else{q.accounts[s]=t}}}});j(i.PUBLIC_PERMISSIONS_LIST,q.group);j(i.SYSTEM_PERMISSIONS_LIST,q.system);if(Object.keys(q.owner).length===0){q.owner[o]={READ:false,WRITE:false,WRITE_ACP:false,READ_ACP:false}}return q}return{populateAclsFields:b,updateAcl:e,aclsUpdate:g,addNewPermissions:k,updateGranteesHelperFunction:c,updateGrantees:d,extractGranteeKey:f}}])})();"use strict";(function(){angular.module("s3").directive("objectProperties",[function(){return{restrict:"E",scope:{obj:"=",options:"="},templateUrl:"/s3/partials/object-details/objectproperties.html"}}])})();"use strict";(function(){angular.module("s3").directive("objectStorageClass",[function(){return{restrict:"E",scope:{obj:"=",id:"@?"},templateUrl:"/s3/partials/object-details/objectstorageclass.html",controller:"ObjectStorageClassController"}}]);angular.module("s3").controller("ObjectStorageClassController",["$scope","AwsUrlsService","BulkOperationService","OperationDispatcherService","S3Constants","SCLogService","UtilService",a]);function a(d,h,c,i,f,g,b){d.docLink=h.getDocUrl(f.LEARN_MORE_LINKS.STORAGE_CLASS);d.cachedValue=angular.copy(d.obj);d.cancel=function(j){b.analyticsTrackClick(f.ANALYTICS.CANCEL_OBJECT_STORAGE_CLASS,f.ANALYTICS.DETAILS);j.stopPropagation();d.storageClassError="";d.cardOpen=false;d.obj.StorageClass=d.cachedValue.StorageClass};d.getStorageClassTranslation=function(){return b.getStorageClassTranslations()[d.obj.StorageClass]};d.scrollCardId="#"+d.id;d.cardSummaryObj=_.cloneDeep(f.CARD_SUMMARY_INIT);e();function e(){var j=d.getStorageClassTranslation();d.cardSummaryObj.isActive=d.obj.StorageClass!==f.STORAGE_CLASSES.GLACIER;if(d.cardSummaryObj.isActive){d.cardSummaryObj.activeSummary.text=j}else{d.cardSummaryObj.inactiveSummary.text=j}}d.save=function(k){b.analyticsTrackClick(f.ANALYTICS.SAVE_OBJECT_STORAGE_CLASS,f.ANALYTICS.DETAILS);k.stopPropagation();d.storageClassError="";d.isSaving=true;var m=[d.obj];var l={targetStorageClass:d.obj.StorageClass,numberOfKeysPerBulkOperation:1};var j=c.createBulkOperation(f.OPERATION_NAME.CHANGE_STORAGE_CLASS,m,[],1,l);j.totalSizeInBytes=m[0].Size;i.addOperation(j);g.log("ChangeStorageClassReceived",1,j);j.defer.promise.then(function(n){var o=Object.keys(n);if(o.length>0){d.storageClassError=o[0];g.log("ChangeStorageClassComplete",0,j)}else{d.cachedValue.StorageClass=d.obj.StorageClass;d.cardOpen=false;g.log("ChangeStorageClassComplete",1,j)}})["catch"](function(n){g.log("ChangeStorageClassComplete",0,j);d.storageClassError=n})["finally"](function(){d.isSaving=false;e()})}}})();"use strict";(function(){angular.module("s3").directive("objectEncryption",[function(){return{restrict:"E",scope:{obj:"=",options:"=",id:"@?"},templateUrl:"/s3/partials/object-details/objectsse.html",controller:"ObjectSSEController"}}]);angular.module("s3").controller("ObjectSSEController",["$q","$scope","$translate","AwsUrlsService","APIProxyService","BulkOperationService","ConsoleOperation","OperationDispatcherService","PathService","S3Constants","SCLogService","UtilService",a]);function a(h,m,b,d,c,p,i,n,j,f,l,k){m.S3Constants=f;m.docLink=d.getDocUrl(f.LEARN_MORE_LINKS.ENCRYPTION);m.scrollCardId="#"+m.id;m.aws_kms=f.OBJECT_SSE.KMS_ENCRYPTION;m.custom_arn=f.OBJECT_SSE.CUSTOM_ARN;m.cachedValue=angular.copy(m.obj);m.model={};m.model.selectedOption=_.isEmpty(m.obj.Encryption)?undefined:m.obj.Encryption;m.cancel=function(q){k.analyticsTrackClick(f.ANALYTICS.CANCEL_OBJECT_SSE,f.ANALYTICS.DETAILS);q.stopPropagation();m.sseError="";m.cardOpen=false;e()};function e(){m.obj.Encryption=m.cachedValue.Encryption;m.model.selectedOption=m.obj.Encryption;if(m.model.selectedOption===f.OBJECT_SSE.KMS_ENCRYPTION){m.options.kmsId=m.cachedValue.KmsID}else{m.options.kmsId=undefined}o()}var g=function g(){var s=new i("GetKMSKeysForObjectSSE");var r={};var q=h.defer();if(!m.cardSummaryObj){m.cardSummaryObj=_.cloneDeep(f.CARD_SUMMARY_INIT)}m.kmsKeys=[];m.cardSummaryObj.isLoading=true;c.getKmsKeys(s,j.getCurrentBucket(),r).then(function(u){var t=u.response.Keys;l.log("GetKMSKeys",1,s);angular.forEach(t,function(v,w){m.kmsKeys.push({value:v.KeyId,text:k.getKmsKeyAlias(v)})});m.kmsKeys.push({value:f.OBJECT_SSE.CUSTOM_ARN,text:b.instant("objectproperties.kms.customarn")});q.resolve()})["catch"](function(t){m.KMSServiceError=k.handleErrors(t);m.sseError=k.handleErrors(t);l.log("GetKMSKeys",0,s,t);q.reject(t)})["finally"](function(){m.cardSummaryObj.isLoading=false});return q.promise};m.updateKMSKey=function(q){if(q===f.OBJECT_SSE.KMS_ENCRYPTION){g()}else{if(!_.isEmpty(m.sseError)&&m.sseError===m.KMSServiceError){m.sseError=null}m.KMSServiceError=null}};m.save=function(r){k.analyticsTrackClick(f.ANALYTICS.SAVE_OBJECT_SSE,f.ANALYTICS.DETAILS);r.stopPropagation();if(m.isSaving||m.disableSave()){return}m.sseError="";m.isSaving=true;var t=[m.obj],u=undefined;if(m.model.selectedOption===f.OBJECT_SSE.KMS_ENCRYPTION){if(m.options.kmsId.value===f.OBJECT_SSE.CUSTOM_ARN){u=m.options.kmsARN}else{u=m.options.kmsId.value}}var s={sseAlgo:m.model.selectedOption,numberOfKeysPerBulkOperation:1,sseKmsKeyId:u};var q=p.createBulkOperation(f.OPERATION_NAME.CHANGE_SSE,t,[],1,s);q.totalSizeInBytes=t[0].Size;n.addOperation(q);l.log("ChangeSSERequestReceived",1,q);q.defer.promise.then(function(v){var w=Object.keys(v);if(w.length>0){m.sseError=w[0];l.log("ChangeSSERequestComplete",0,q)}else{m.cachedValue.Encryption=m.model.selectedOption;m.obj.Encryption=m.model.selectedOption;m.cardOpen=false;if(m.model.selectedOption===f.OBJECT_SSE.KMS_ENCRYPTION){if(m.options.kmsId.value===f.OBJECT_SSE.CUSTOM_ARN){m.options.kmsId.value=u;m.obj.KmsID=m.options.kmsARN}else{m.obj.KmsID=m.options.kmsId.text}m.cachedValue.KmsID=u}l.log("ChangeSSERequestComplete",1,q);if(m.model.selectedOption!==f.OBJECT_SSE.KMS_ENCRYPTION){m.obj.KmsID=undefined}o()}})["catch"](function(v){l.log("ChangeSSERequestComplete",0,q);m.sseError=k.handleErrors(v)})["finally"](function(){m.isSaving=false})};m.disableSave=function(){if(m.model.selectedOption===m.cachedValue.Encryption&&m.model.selectedOption!==f.OBJECT_SSE.KMS_ENCRYPTION){return true}if(m.model.selectedOption===f.OBJECT_SSE.KMS_ENCRYPTION&&(!m.options.kmsId||m.options.kmsId.value===m.custom_arn&&!m.options.kmsARN)){return true}if(m.model.selectedOption===f.OBJECT_SSE.KMS_ENCRYPTION&&m.cachedValue.KmsID&&(m.cachedValue.KmsID.indexOf(m.options.kmsId.value)>-1||m.options.kmsId===m.cachedValue.KmsID||m.options.kmsId.value===m.custom_arn&&m.options.kmsARN===m.cachedValue.KmsID)){return true}return false};if(m.model.selectedOption===f.OBJECT_SSE.KMS_ENCRYPTION){g().then(function(){m.options.kmsId=k.getKMSAliasForArn(m.options.kmsId,m.kmsKeys)})}m.cardSummaryObj=_.cloneDeep(f.CARD_SUMMARY_INIT);o();function o(){var q=m.model.selectedOption===b.instant("resource.access.denied");m.cardSummaryObj.isActive=!q&&m.model.selectedOption!==f.OBJECT_SSE.NONE;m.cardSummaryObj.inactiveSummary.text=q?b.instant("resource.access.denied"):k.getEncryptionTranslations()[m.model.selectedOption];m.cardSummaryObj.activeSummary.text=q?b.instant("resource.access.denied"):k.getEncryptionTranslations()[m.model.selectedOption]}}})();"use strict";(function(){angular.module("s3").directive("objectMetadata",[function(){return{restrict:"E",scope:{obj:"=",id:"@?"},templateUrl:"/s3/partials/object-details/objectmetadata.html",controller:"ObjectMetadataController"}}]);angular.module("s3").controller("ObjectMetadataController",["$routeParams","$scope","$translate","AwsUrlsService","BulkOperationService","ConsoleOperation","ObjectPropertiesService","OperationDispatcherService","PathService","S3Constants","S3CWSAPIService","SCLogService","UtilService",a]);function a(i,q,r,b,n,m,k,g,d,p,e,c,t){q.scrollCardId="#"+q.id;q.docLink=b.getDocUrl(p.LEARN_MORE_LINKS.METADATA);q.newMetadataList=[];q.revokeAll=false;q.validationError={text:null};q.selectedRow={scopeIndex:null};q.cardSummaryObj=_.cloneDeep(p.CARD_SUMMARY_INIT);q.obj.UserDefinedMetadata={};q.addMetadata=function(v){q.newMetadataList.splice(0,0,{metadataKey:null,metadataValue:null});j("newMetadataList:0");v.scopeIndex="newMetadataList:0"};q.getMetadata=function(){var y=d.getCurrentBucket();var x=d.getCurrentObject();var w=i[p.VERSION_ID_PARAM];q.cardSummaryObj.isLoading=true;var v=new m(p.OPERATION_NAME.GET_METADATA);e.getMetadata(y,x,w,v).then(function(z){c.log("getObjectMetadataCWS",v,1,{bucket:y,key:x});var B=_.get(z,"data.metadata");if(B){q.obj.Metadata=B;var A=_.pick(q.obj.Metadata,function(D,C){return p.USER_DEFINED_METADATA.indexOf(C)>-1||C.indexOf(p.USER_DEFINED_METADATA_PREFIX)===0});q.obj.UserDefinedMetadata=_.merge(A,q.obj.UserDefinedMetadata);q.cachedValue=_.cloneDeep(q.obj)}})["catch"](function(z){c.log("getObjectMetadataCWS",v,0,{bucket:y,key:x});q.objectPropertiesError=t.handleErrors(z)})["finally"](function(){q.cardSummaryObj.isLoading=false;f()})};q.getMetadata();q.predefinedMetadata=k.getPredefinedMetadata();q.getObjectMetadataCount=function(){if(!q.obj||!q.obj.UserDefinedMetadata){return 0}q.userDefinedMetadata=o();q.cachedConvertedValue=_.cloneDeep(q.userDefinedMetadata);return Object.keys(q.obj.UserDefinedMetadata).length};q.$watch("userDefinedMetadata",function(x,v){u(x,v,"userDefinedMetadata");q.validationError.text="";if(q.userDefinedMetadata){var w=k.checkDuplicatedKey(q.userDefinedMetadata.concat(q.newMetadataList));if(!_.isEmpty(w)){q.validationError.text=w}}},true);q.$watch("newMetadataList",function(x,v){u(x,v,"newMetadataList");q.validationError.text="";if(q.newMetadataList){var w=k.checkDuplicatedKey(q.newMetadataList.concat(q.userDefinedMetadata));if(!_.isEmpty(w)){q.validationError.text=w}}},true);q.getIndex=function(v){return _.findIndex(q.userDefinedMetadata,function(w){return _.isEqual(w,v)})};q.isDeleteAndEditDisabled=function(v){return v===undefined||q.revokeAll||v.scopeIndex===null||q.obj&&q.obj.StorageClass==="GLACIER"||v.scopeIndex&&v.scopeIndex.indexOf("newMetadataList")>-1};q.removeNewMetadata=function(x,y,z){y.stopPropagation();if(z&&z.scopeIndex){var A=z.scopeIndex.split(":"),w=A[0],v=parseInt(A[1]);if(w==="newMetadataList"&&v===x){z.scopeIndex=null}if(w==="newMetadataList"&&x<v){v-=1;z.scopeIndex=w+":"+v}}q.newMetadataList.splice(x,1)};q.switchSelectedRow=function(v){j(v.scopeIndex,false)};q.editMetadata=function(v){j(v.scopeIndex,true)};q.deleteMetadata=function(v){var w=v.scopeIndex.split(":");if(w[0]==="userDefinedMetadata"){q.userDefinedMetadata.splice(w[1],1)}v.scopeIndex=null;if(_.isEmpty(q.userDefinedMetadata)){q.revokeAll=true}};function f(){var w=q.getObjectMetadataCount();q.cardSummaryObj.isActive=w>0;if(w>0){q.cardSummaryObj.activeSummary.text=w+r.instant("objectdetail.metadata.keyvalue")}if(w===0){q.cardSummaryObj.inactiveSummary.text=w+r.instant("objectdetail.metadata.keyvalue")}if(q.obj.statusCodes){var v=q.obj.statusCodes[p.OPERATION_NAME.GET_OBJECT_METADATA];if(v){q.cardSummaryObj.inactiveSummary.text=v;q.cardSummaryObj.activeSummary.text=v}}}q.cachedConvertedValue=_.cloneDeep(q.userDefinedMetadata);q.cachedValue=_.cloneDeep(q.obj);q.cancel=function(v){t.analyticsTrackClick(p.ANALYTICS.CANCEL_OBJECT_METADATA,p.ANALYTICS.DETAILS);v.stopPropagation();s();f()};q.save=function(y){y.stopPropagation();if(q.obj&&(q.obj.StorageClass==="GLACIER"||q.obj.IsLatest&&q.obj.IsLatest!=="true")||q.validationError.text){return}t.analyticsTrackClick(p.ANALYTICS.SAVE_OBJECT_METADATA,p.ANALYTICS.DETAILS);q.isSaving=true;q.metadataError="";q.validationError.text="";var v=q.userDefinedMetadata?q.userDefinedMetadata.concat(q.newMetadataList):q.newMetadataList;if(_.isEmpty(v)){return}if(!k.isValid(v,q.validationError)){q.isSaving=false;return}var x=k.getMetadataMap(v);if(_.isEqual(x,q.obj.UserDefinedMetadata)){q.isSaving=false;s();return}var A=[q.obj];var z=k.getMetadataRequestParams(q.obj.UserDefinedMetadata,x,1);var w=n.createBulkOperation(p.OPERATION_NAME.CHANGE_METADATA,A,[],1,z);w.totalSizeInBytes=A[0].Size;g.addOperation(w);c.log("ChangeMetadataRequestReceived",1,w);w.defer.promise.then(function(B){var C=Object.keys(B);if(C.length>0){q.metadataError=C[0];c.log("ChangeMetadataRequestComplete",0,w)}else{h(x,v);c.log("ChangeMetadataRequestComplete",1,w)}f()})["catch"](function(B){c.log("ChangeMetadataRequestComplete",0,w);q.metadataError=B})["finally"](function(){q.isSaving=false})};function o(){var v=[];_.forEach(q.obj.UserDefinedMetadata,function(y,x){var w=_.find(q.predefinedMetadata,{value:x})||{value:x,text:x};v.push({metadataKey:w,metadataValue:{text:y}})});return v}function u(z,y,x){if(!_.isEqual(z,y)&&q.selectedRow.scopeIndex){var A=q.selectedRow.scopeIndex.split(":"),w=A[0],v=A[1];if(w===x&&y[v]&&z[v]&&y[v].metadataKey&&z[v].metadataKey&&y[v].metadataKey.value!==z[v].metadataKey.value||w===x&&z[v].metadataKey===undefined){q[x][v].metadataValue=null}else{if(w===x&&z[v]&&y[v]&&z[v].metadataValue&&y[v].metadataValue&&!_.isEqual(z[v].metadataValue,y[v].metadataValue)&&z[v].metadataValue.text!==y[v].metadataValue.text){q[x][v].metadataValue.inputError=null}else{if(w===x&&z[v]&&y[v]&&z[v].metadataKey&&y[v].metadataKey&&!z[v].metadataKey.hasOwnProperty("inputValue")&&z[v].metadataKey.text&&y[v].metadataKey.text&&!_.isEqual(z[v].metadataKey,y[v].metadataKey)&&z[v].metadataKey.text!==y[v].metadataKey.text){q[x][v].metadataKey.error=null}else{if(w===x&&z[v]&&y[v]&&z[v].metadataKey&&y[v].metadataKey&&z[v].metadataKey.hasOwnProperty("inputValue")&&!_.isEqual(z[v].metadataKey,y[v].metadataKey)&&z[v].metadataKey.inputValue!==y[v].metadataKey.inputValue){q[x][v].metadataKey.error=null}}}}}}function j(w,y){var z=w.split(":"),v=z[0],x=parseInt(z[1]);if(v==="newMetadataList"){_.forEach(q.newMetadataList,function(B,A){B.isEditing=A===x});_.forEach(q.userDefinedMetadata,function(A){A.isEditing=false})}else{if(v==="userDefinedMetadata"){_.forEach(q.userDefinedMetadata,function(B,A){B.isEditing=A!==x?false:y});_.forEach(q.newMetadataList,function(A){A.isEditing=false})}}}function l(){_.forEach(q.newMetadataList,function(v){v.isEditing=false});_.forEach(q.userDefinedMetadata,function(v){v.isEditing=false})}function h(w,v){q.obj.UserDefinedMetadata=w;q.userDefinedMetadata=v;q.newMetadataList=[];q.cachedConvertedValue=_.cloneDeep(q.userDefinedMetadata);q.cachedValue.UserDefinedMetadata=_.cloneDeep(q.obj.UserDefinedMetadata);q.cachedValue.Metadata=_.cloneDeep(q.obj.Metadata);q.selectedRow={scopeIndex:null};l();q.cardOpen=false}function s(){q.metadataError="";q.validationError.text="";q.newMetadataList=[];q.userDefinedMetadata=_.cloneDeep(q.cachedConvertedValue);q.obj.UserDefinedMetadata=_.cloneDeep(q.cachedValue.UserDefinedMetadata);q.obj.Metadata=_.cloneDeep(q.cachedValue.Metadata);q.selectedRow={scopeIndex:null};l();q.cardOpen=false}}})();"use strict";(function(){angular.module("s3").directive("objectTag",[function(){return{restrict:"E",scope:{obj:"=",id:"@?"},templateUrl:"/s3/partials/object-details/objecttag.html",controller:"ObjectTagController"}}]);angular.module("s3").controller("ObjectTagController",["$scope","$translate","APIProxyService","AwsUrlsService","ConsoleOperation","ObjectPropertiesService","PathService","S3Constants","SCLogService","UtilService","XMLParser",a]);function a(m,n,o,b,j,i,d,k,c,r,s){var h="getObjectTags";var q="getObjectVersionTags";var f="putObjectTags";var l="putObjectVersionTags";var p="getObjectTagsReceived";var g="putObjectTagsReceived";m.docLink=b.getDocUrl(k.LEARN_MORE_LINKS.OBJECT_TAGGING);m.scrollCardId="#"+m.id;m.tagError=false;m.tagErrorMessage="";m.cachedObjectTags={tags:[]};m.tagCount=0;m.maxAllowedTags=k.TAGGING.MAX_ALLOWED_TAGS;m.cardSummaryObj=_.cloneDeep(k.CARD_SUMMARY_INIT);m.cardSummaryObj.isActive=m.tagCount>0;m.cardSummaryObj.activeSummary.text=m.tagCount+n.instant("objectproperties.tags.keyvalue");m.cardSummaryObj.inactiveSummary.text="0"+n.instant("objectproperties.tags.keyvalue");m.cancelObjectTagging=function(t){r.analyticsTrackClick(k.ANALYTICS.CANCEL_OBJECT_TAGS,k.ANALYTICS.DETAILS);t.stopPropagation();m.obj.Tagging=angular.copy(m.cachedObjectTags.tags);m.tagError=false;m.tagErrorMessage="";m.cardOpen=false};m.removeTag=function(t){m.obj.Tagging.splice(t,1)};m.addTag=function(){if(!m.obj.Tagging){m.obj.Tagging=[]}if(m.obj.Tagging.length<k.TAGGING.MAX_ALLOWED_TAGS){m.obj.Tagging.push({Key:"",Value:""})}};m.$watch("obj.VersionId",function(u,t){if(u!==t){m.getObjectTags()}});m.isAnyKeyEmpty=function(){return !_.isEmpty(m.obj.Tagging)&&_.some(m.obj.Tagging,function(t){return _.isEmpty(t.Key)})};function e(){m.cardSummaryObj.isActive=m.tagCount>0;if(m.cardSummaryObj.isActive){m.cardSummaryObj.activeSummary.text=m.tagCount+n.instant("objectproperties.tags.keyvalue")}}m.getObjectTags=function(){var t=new j(k.OPERATION_NAME.GET_OBJECT_TAGGING);var w=d.getCurrentObject();var v=d.getCurrentBucket();c.log(p,1,t,{objectName:w});m.obj.Tagging=[];var u=m.obj.VersionId;m.cardSummaryObj.isLoading=true;o.getObjectTag(t,v,w,u).then(function(A){var x=A.response;if(!u){c.log(h,1,t,{objectName:w})}else{c.log(q,1,t,{objectName:w,versionId:u})}m.tagError=false;if(x){var y=s.convertXmlStringToJson(x);if(y.Tagging.TagSet.Tag){var z=[].concat(y.Tagging.TagSet.Tag);angular.forEach(z,function(B){if(_.isEmpty(B.Value)){B.Value=""}B.errorMessage=""});m.obj.Tagging=z;m.tagCount=z.length||0}else{m.tagCount=0}}m.cachedObjectTags.tags=angular.copy(m.obj.Tagging);e()})["catch"](function(x){if(x){if(x.status===k.HTTP_STATUS_CODES.NOT_FOUND){if(x.response.Error.Code===k.TAGGING.ERROR_CODES.NO_SUCH_TAG_SET){if(!u){c.log(h,0,t,{objectName:w,error:x})}else{c.log(q,0,t,{objectName:w,versionId:u,error:x})}m.tagCount=0;m.obj.Tagging=[]}}}m.cachedObjectTags.tags=angular.copy(m.obj.Tagging)})["finally"](function(){m.cardSummaryObj.isLoading=false})};m.getObjectTags();m.saveObjectTagging=function(v){r.analyticsTrackClick(k.ANALYTICS.SAVE_OBJECT_TAGS,k.ANALYTICS.DETAILS);v.stopPropagation();m.tagError=false;m.tagErrorMessage="";var u=m.obj.Tagging;var t=new j(k.OPERATION_NAME.PUT_OBJECT_TAGGING);var x=d.getCurrentObject();var w=m.obj.VersionId;c.log(g,1,t,{objectName:x});if(u){angular.forEach(u,function(y){if(_.isEmpty(y.Key)){y.errorMessage=n.instant("objectproperties.tags.emptykeyname");m.tagError=true}else{y.errorMessage=""}})}if(!m.tagError){i.putObjectTagging(x,w,u,t).then(function(A){if(!w){c.log(f,1,t,{objectName:x})}else{c.log(l,1,t,{objectName:x,versionId:w})}var z=s.convertXmlStringToJson(A.request.contentString);var y;if(!_.isEmpty(z.Tagging.TagSet.Tag)){y=[].concat(z.Tagging.TagSet.Tag);angular.forEach(y,function(B){if(_.isEmpty(B.Value)){B.Value=""}})}m.obj.Tagging=_.isEmpty(y)?[]:[].concat(y);m.tagCount=m.obj.Tagging.length;m.cachedObjectTags.tags=angular.copy(m.obj.Tagging);m.cardOpen=false;e()})["catch"](function(y){if(!w){c.log(f,0,t,{objectName:x,error:y})}else{c.log(f,0,t,{objectName:x,error:y,versionId:w})}m.tagError=true;if(y){m.tagErrorMessage=r.handleErrors(y)}else{m.tagErrorMessage=n.instant("objectproperties.tags.genericerror")}})}}}})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("dialogModal",function(){return{restrict:"E",templateUrl:"/s3/partials/dialogmodal.html",scope:{isOpen:"=",closeCallback:"&?",headerTitle:"=",hasWarningMsg:"=?",countInfo:"=?",pasteInfo:"=?",sourceDstInfo:"=?"},transclude:{header:"?dialogModalHeader",content:"dialogModalContent",footer:"dialogModalFooter"},controller:"DialogModalController"}});angular.module("s3").controller("DialogModalController",["$scope","PathService","$filter","$translate","UtilService",function(d,e,g,f,c){var b;var a=(b={},_defineProperty(b,f.instant("confirmationmodal.delete.title"),"dialog-delete-image"),_defineProperty(b,f.instant("confirmationmodal.storageclass.title"),"dialog-storage-image"),_defineProperty(b,f.instant("confirmationmodal.public.title"),"dialog-public-image"),_defineProperty(b,f.instant("confirmationmodal.deletebucket.title"),"dialog-delete-image"),_defineProperty(b,f.instant("confirmationmodal.emptybucket.title"),"dialog-delete-image"),_defineProperty(b,f.instant("confirmationmodal.initiaterestore.title"),"dialog-public-image"),_defineProperty(b,f.instant("crr.warningmsg.title.notenabled"),"crr-watermark-image"),_defineProperty(b,f.instant("crr.warningmsg.title.accessdenied"),"crr-watermark-image"),_defineProperty(b,f.instant("crr.confirmationmodal.enablerule"),"crr-watermark-image"),_defineProperty(b,f.instant("crr.confirmationmodal.disablerule"),"crr-watermark-image"),_defineProperty(b,f.instant("crr.confirmationmodal.enableallrules"),"crr-watermark-image"),_defineProperty(b,f.instant("crr.confirmationmodal.disableallrules"),"crr-watermark-image"),_defineProperty(b,f.instant("crr.confirmationmodal.deleteallrules"),"crr-watermark-image"),_defineProperty(b,f.instant("crr.confirmationmodal.deleteruletitle"),"crr-watermark-image"),_defineProperty(b,f.instant("crr.receiveobjectmodal.title"),"crr-watermark-image"),b);d.getClass=function(){return a[d.headerTitle]};d.closeModal=function(){d.isOpen.flag=false;d.closeCallback();c.bodyFreezeScroll(d.isOpen&&d.isOpen.flag)};d.dstFolderPath=e.getCurrentAbsoluteFolderPath()||e.getCurrentBucket()}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("confirmationDialogModal",function(){return{restrict:"E",scope:{isOpen:"=",operation:"=?",countInfo:"=?",objectMetadata:"=?"},templateUrl:"/s3/partials/confirmationdialogmodal.html",controller:"ConfirmationDialogModalController"}});angular.module("s3").controller("ConfirmationDialogModalController",["$scope","$filter","$translate","$routeParams","BulkOperationService","OperationDispatcherService","S3Constants","CopyService","KeySelectionService","CountService","ObjectPropertiesService","UtilService","SCLogService",function(r,o,s,h,m,e,q,k,p,f,i,t,b){var l;var d="ttlObj";var j="ttlSize";r.showVersions=t.convertStringToBoolean(h[q.SHOW_VERSION_PARAM]);var n={STANDARD:s.instant("replication.storageclasses.standard"),STANDARD_IA:s.instant("replication.storageclasses.standardia")};var c=(l={},_defineProperty(l,q.OPERATION_NAME.DELETE_OBJECTS,{headTitle:s.instant("confirmationmodal.delete.title"),buttonName:s.instant("confirmationmodal.delete.buttonname"),warningInfo:{flag:true,text:r.showVersions?"confirmationmodal.permanentdelete.warningtext":"confirmationmodal.delete.warningtext"}}),_defineProperty(l,q.OPERATION_NAME.RESTORE_OBJECTS,{headTitle:s.instant("confirmationmodal.undodelete.text"),buttonName:s.instant("confirmationmodal.undodelete.text"),warningInfo:{flag:true,text:"confirmationmodal.undodelete.warningtext"}}),_defineProperty(l,q.OPERATION_NAME.MAKE_PUBLIC,{headTitle:s.instant("confirmationmodal.public.title"),buttonName:s.instant("confirmationmodal.public.buttonname"),warningInfo:{flag:true,text:"object.warningbody.granting.AllUsers"}}),_defineProperty(l,q.OPERATION_NAME.CHANGE_STORAGE_CLASS,{headTitle:s.instant("confirmationmodal.storageclass.title"),buttonName:s.instant("confirmationmodal.storageclass.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.paste.warningtext",val:r.operation.panelSettingValues?n[r.operation.panelSettingValues.setting]:""}}),_defineProperty(l,q.OPERATION_NAME.CHANGE_SSE,{headTitle:s.instant("confirmationmodal.sse.title"),buttonName:s.instant("confirmationmodal.sse.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.sse.warningtext"}}),_defineProperty(l,q.OPERATION_NAME.CHANGE_METADATA,{headTitle:s.instant("confirmationmodal.metadata.title"),buttonName:s.instant("confirmationmodal.metadata.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.metadata.warningtext"}}),_defineProperty(l,q.OPERATION_NAME.CUT,{headTitle:s.instant("confirmationmodal.cutpaste.title"),buttonName:s.instant("confirmationmodal.paste.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.paste.warningtext"}}),_defineProperty(l,q.OPERATION_NAME.COPY,{headTitle:s.instant("confirmationmodal.copypaste.title"),buttonName:s.instant("confirmationmodal.paste.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.paste.warningtext"}}),_defineProperty(l,q.OPERATION_NAME.INITIATE_RESTORE,{headTitle:s.instant("confirmationmodal.initiaterestore.title"),buttonName:s.instant("confirmationmodal.initiaterestore.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.initialrestore.warningtext"}}),_defineProperty(l,q.OPERATION_NAME.ADD_OBJECT_TAG,{headTitle:s.instant("confirmationmodal.addtags.title"),buttonName:s.instant("confirmationmodal.addtags.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.addtags.warningtext",val:r.operation.panelSettingValues&&r.operation.panelSettingValues.values?r.operation.panelSettingValues.values.length:0}}),_defineProperty(l,q.OPERATION_NAME.GET_INFO,{headTitle:s.instant("confirmationmodal.getinfo.title"),buttonName:s.instant("confirmationmodal.getinfo.buttonname"),warningInfo:{flag:false}}),l);var a={flag:true,folders:0,objects:0,size:0,currLevelObjs:0,countResultEachFolder:{}};r.closeIconShow=false;r.selected={selectedItems:{currFolderPathPrefix:r.operation.initialPath,folders:r.operation.selectedFolders,objects:r.operation.selectedKeys}};if(!r.countInfo||!r.countInfo.countFinish){r.countInfo=_.cloneDeep(a);r.isCounting={flag:false};r.$watch(function(){return r.countInfo},function(v,u){if(v!==u){angular.forEach(r.selected.selectedItems.folders,function(w){var x=r.countInfo.countResultEachFolder&&r.countInfo.countResultEachFolder[w.Prefix];if(x){w.objsCount=r.countInfo.countResultEachFolder[w.Prefix].count;w.folderSize=r.countInfo.countResultEachFolder[w.Prefix].totalSize}})}},true);f.countAllFiles(r.selected.selectedItems,r.countInfo,r.operation,r.isCounting)}else{angular.forEach(r.selected.selectedItems.folders,function(u){var v=r.countInfo.countResultEachFolder&&r.countInfo.countResultEachFolder[u.Prefix];if(v){u.objsCount=r.countInfo.countResultEachFolder[u.Prefix].count;u.folderSize=r.countInfo.countResultEachFolder[u.Prefix].totalSize}})}r.modalInfo=c[r.operation.name];var g=r.operation.name===q.OPERATION_NAME.CUT||r.operation.name===q.OPERATION_NAME.COPY;r.sourceDstInfo={flag:g,source:r.operation.initialPath||r.operation.initialBucket};r.closeConfirmationModal=function(){r.isOpen.flag=false;r.isOpen.dialogOpen.flag=false;r.isOpen.sidePanelOpen=false;r.selected={selectedItems:{currFolderPathPrefix:"",folders:[],objects:[]}};r.countInfo=_.cloneDeep(a);r.countInfo.flag=false;r.modalInfo={headTitle:"",buttonName:"",warningInfo:{flag:false,text:""}};r.operation=null;r.panelSettingValues=null};r.operationFunc=function(){if(r.operation.name===q.OPERATION_NAME.CHANGE_STORAGE_CLASS){r.operation.additionalInfo={targetStorageClass:r.operation.panelSettingValues.setting,numberOfKeysPerBulkOperation:q.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}}else{if(r.operation.name===q.OPERATION_NAME.CHANGE_METADATA){var u=i.getMetadataMap(r.operation.panelSettingValues.values);if(_.isEqual(u,r.objectMetadata)){r.closeConfirmationModal();return}r.operation.additionalInfo=i.getMetadataRequestParams(r.objectMetadata,u,q.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API)}else{if(r.operation.name===q.OPERATION_NAME.CHANGE_SSE){r.operation.additionalInfo={sseAlgo:r.operation.panelSettingValues.setting,numberOfKeysPerBulkOperation:q.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API};if(r.operation.additionalInfo.sseAlgo===q.OBJECT_SSE.KMS_ENCRYPTION){if(r.operation.panelSettingValues.kmsOption.kmsId.value===q.OBJECT_SSE.CUSTOM_ARN){r.operation.additionalInfo.sseKmsKeyId=r.operation.panelSettingValues.kmsOption.kmsARN}else{r.operation.additionalInfo.sseKmsKeyId=r.operation.panelSettingValues.kmsOption.kmsId.value}}}else{if(r.operation.name===q.OPERATION_NAME.INITIATE_RESTORE){r.operation.additionalInfo={expirationDays:r.operation.panelSettingValues.setting,numberOfKeysPerBulkOperation:q.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}}else{if(r.operation.name===q.OPERATION_NAME.ADD_OBJECT_TAG){r.operation.additionalInfo={tags:t.reduceObjectArrayToObject(r.operation.panelSettingValues.values),disableFetchTag:r.operation.panelSettingValues.disableFetchTag||false,numberOfKeysPerBulkOperation:q.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}}else{if(r.operation.name===q.OPERATION_NAME.GET_INFO){r.closeConfirmationModal();return}}}}}}r.operation.totalObjectCount=r.countInfo.objects;b.log(r.operation.name.replace(/\s/g,"")+d,r.operation.totalObjectCount,r.operation);b.log(r.operation.name.replace(/\s/g,"")+j,r.countInfo.size,r.operation);g?k.startClipboardOperation():e.addOperation(r.operation);r.closeConfirmationModal()};r.save=function(u){u.stopPropagation();r.isOpen.dialogOpen.flag=true;r.isOpen.sidePanelOpen=false};r.cancel=function(u){u.stopPropagation();r.closeConfirmationModal()}}])})();"use strict";(function(){angular.module("s3").directive("fileListInModal",function(){return{restrict:"E",scope:{removeItemFromUpload:"&?",closeIconShow:"=?",forUploads:"=",selected:"="},templateUrl:"/s3/partials/fileslistinmodal.html",controller:"FileListInModalController"}});angular.module("s3").controller("FileListInModalController",["$scope","$filter","UtilService",function(b,c,a){b.$watchCollection("selected",function(){b.selectedItems=b.selected.selectedItems});b.closeIconFunc=function(d){if(b.forUploads&&b.removeItemFromUpload){b.removeItemFromUpload({item:d})}};b.getFileIconClass=function(d){return a.getIconClassFromFilename(d.Key)};b.haveSelectedItems=function(){return b.selectedItems&&b.selectedItems.folders&&!_.isEmpty(b.selectedItems.folders)||b.selectedItems&&b.selectedItems.objects&&!_.isEmpty(b.selectedItems.objects)}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("bucketLifecycle",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/bucketlifecycle.html",controller:"BucketLifecycleController"}}]);angular.module("s3").controller("BucketLifecycleController",["$scope","$translate","BucketPropertiesService","BucketPropertiesUtilService","CachingService","ConsoleOperation","FAC","PathService","S3Constants","UtilService",a]);function a(s,t,k,e,i,q,m,c,r,y){var A;s.moreOptions=[{id:r.LIFECYCLE.CONFIRMATION_MODAL.ENABLE_POLICY,text:t.instant("bucketlifecycle.more.enablelifecycle"),action:function u(){s.showConfirmationModal(r.LIFECYCLE.CONFIRMATION_MODAL.ENABLE_POLICY)},disabled:true},{id:r.LIFECYCLE.CONFIRMATION_MODAL.DISABLE_POLICY,text:t.instant("bucketlifecycle.more.disablelifecycle"),action:function u(){s.showConfirmationModal(r.LIFECYCLE.CONFIRMATION_MODAL.DISABLE_POLICY)},disabled:true}];s.showConfirmationModal=function(B){if(s.lifecycle.ruleToBeEdited){s.lifecycle.selectedRule=s.lifecycle.ruleToBeEdited;s.lifecycle.selectedRuleIndex=s.lifecycle.editRuleIndex;s.warningMessage=s.warningList[B];s.actionType=B;s.headerTitle=s.confirmationModalHeadersList[B];o();s.isConfirmationModalOpen.flag=true}};s.warningList={enablePolicy:t.instant("lifecycleconfirmationmodal.warning.enablemessage"),disablePolicy:t.instant("lifecycleconfirmationmodal.warning.disablemessage"),deletePolicy:t.instant("lifecycleconfirmationmodal.warning.deletemessage")};s.confirmationModalHeadersList={enablePolicy:t.instant("bucketlifecycle.more.enablelifecycle"),disablePolicy:t.instant("bucketlifecycle.more.disablelifecycle"),deletePolicy:t.instant("bucketlifecycle.more.deletelifecycle")};s.isConfirmationModalOpen={flag:false};s.isLifecycleModalOpen={flag:false};s.isRefreshing=true;s.lifecycleError="";s.showLifecycleModalForEdit=function(){if(s.lifecycle.ruleToBeEdited){s.lifecycle.selectedRule=v(s.lifecycle.ruleToBeEdited);s.lifecycle.selectedRule.showCurrent=!_.isEmpty(s.lifecycle.selectedRule.currentRuleActions);s.lifecycle.selectedRule.showPrevious=!_.isEmpty(s.lifecycle.selectedRule.noncurrentRuleActions);s.lifecycle.selectedRule.indexVal=s.lifecycle.editRuleIndex;s.isLifecycleModalOpen.flag=true;o();s.forEdit=true}};function o(){y.analyticsTrackClick(r.ANALYTICS.LIFECYCLE_RULES_MODAL,r.ANALYTICS.DETAILS)}s.showLifecycleModalForCreate=function(){y.analyticsTrackClick(r.ANALYTICS.START_LIFECYCLE,r.ANALYTICS.LIFECYCLE_S3);y.analyticsTrackView(r.ANALYTICS.NAME_SCOPE_LIFECYCLE,r.ANALYTICS.LIFECYCLE_S3);p();s.forEdit=false;s.lifecycle.selectedRule={};s.lifecycle.selectedRule.ID="";s.lifecycle.selectedRule.Status=r.LIFECYCLE.ENABLED;s.lifecycle.selectedRule.Prefix="";s.lifecycle.selectedRule.applied=r.LIFECYCLE.WHOLE_BUCKET;s.lifecycle.selectedRule.tags=[];s.lifecycle.selectedRule.currentRuleActions=[];s.lifecycle.selectedRule.noncurrentRuleActions=[];s.lifecycle.selectedRule.summary={currentTransitionsList:["","",""],noncurrentTransitionsList:["","",""],rldm:false,amu:"",ID:"",prefix:""};s.lifecycle.selectedRule.amu={enabled:false,days:""};s.lifecycle.selectedRule.expiration={enabled:false,days:""};s.lifecycle.selectedRule.permanentlyDelete={enabled:false,days:""};s.lifecycle.selectedRule.showRldm=true;s.lifecycle.selectedRule.rldmValue=false;s.lifecycle.selectedRule.containsRldmAsFalse=false;s.lifecycle.selectedRule.removeExpire=false;s.lifecycle.selectedRule.expiration={enabled:false,days:""};s.lifecycle.selectedRule.showCurrent=false;s.lifecycle.selectedRule.showPrevious=false;s.lifecycle.selectedRule.currentRuleOptions=z(n);s.lifecycle.selectedRule.noncurrentRuleOptions=z(n);s.lifecycle.selectedRule.isAddCurrentTransitionDisabled=false;s.lifecycle.selectedRule.isAddPrevTransitionDisabled=false;s.lifecycle.selectedRule.isNextButtonDisabled=true;s.lifecycle.selectedRule.showStep3CurrentVersion=false;s.lifecycle.selectedRule.showStep3PreviousVersion=false;s.lifecycle.selectedRule.filterUsed=s.filterUsed;s.lifecycle.selectedRule.filters={input:"",prefixFilters:[],tagFilters:[]};s.lifecycle.selectedRule.prefixUsed=false;o();s.isLifecycleModalOpen.flag=true};function p(){if(s.lifecycleConfiguration&&s.lifecycleConfiguration.Rules){for(var B=0;B<s.lifecycleConfiguration.Rules.length;B++){s.lifecycle.listViewRules[B].selected=false}}}function h(C,B){s.moreOptions[0].disabled=C;s.moreOptions[1].disabled=B}function n(){var C=[{text:t.instant("lifecyclemodal.sia"),value:r.LIFECYCLE.SIA,disabled:false}];var B={text:t.instant("lifecyclemodal.glacier"),value:r.LIFECYCLE.GLACIER,disabled:false};if(s.glacierEnabled){C.push(B)}return C}function z(C){var D=[];for(var B=0;B<r.LIFECYCLE.TOTAL_OPTIONS;B++){D.push(C())}return D}function x(D,C){if(D.NoncurrentVersionTransition){var E=y.transformObjectToArray(D.NoncurrentVersionTransition);for(var B=0;B<E.length;B++){if(E[B].NoncurrentDays){C.noncurrentRuleActions.push({action:r.LIFECYCLE.RULE_ACTIONS_MAP[E[B].StorageClass],value:E[B].NoncurrentDays})}}}}function l(C,B){if(C.NoncurrentVersionExpiration){if(C.NoncurrentVersionExpiration.NoncurrentDays){B.permanentlyDelete={enabled:true,days:C.NoncurrentVersionExpiration.NoncurrentDays};B.showStep3PreviousVersion=true}}}function b(D,C){if(D.Transition){var E=y.transformObjectToArray(D.Transition);for(var B=0;B<E.length;B++){if(E[B].Days){C.currentRuleActions.push({action:r.LIFECYCLE.RULE_ACTIONS_MAP[E[B].StorageClass],value:E[B].Days})}}}}function d(C,B){if(C.Expiration){if(C.Expiration.Days){B.expiration={enabled:true,days:C.Expiration.Days};B.removeExpire=false;B.showRldm=false;B.showStep3CurrentVersion=true}else{if(C.Expiration.ExpiredObjectDeleteMarker){if(C.Expiration.ExpiredObjectDeleteMarker===r.LIFECYCLE.TRUE){B.removeExpire=true}else{B.containsRldmAsFalse=true}}}}}function w(C,B){B.amu={enabled:false,days:""};if(C.AbortIncompleteMultipartUpload){B.amu.enabled=true;B.amu.days=C.AbortIncompleteMultipartUpload.DaysAfterInitiation}}function v(F){var E=_.cloneDeep(F);var D={};D.ID=E.ID;D.Status=E.Status;D.tagSet=[];D.Prefix="";D.prefixUsed=true;D.filters={input:"",prefixFilters:[],tagFilters:[]};if(E.Prefix){D.filterUsed=false;D.Prefix=E.Prefix;D.filters.prefixFilters.push(D.Prefix)}else{if(E.Filter){D.filterUsed=true;if(E.Filter.Prefix){D.Prefix=E.Filter.Prefix;D.filters.prefixFilters.push(D.Prefix)}else{if(E.Filter.And&&E.Filter.And.Prefix){D.Prefix=E.Filter.And.Prefix;D.filters.prefixFilters.push(D.Prefix)}else{D.prefixUsed=false}}}}if(E.Filter){var B=[];if(!_.isEmpty(E.Filter.Tag)){B=y.transformObjectToArray(E.Filter.Tag)}else{if(E.Filter.And&&!_.isEmpty(E.Filter.And.Tag)){B=y.transformObjectToArray(E.Filter.And.Tag)}}for(var C=0;C<B.length;C++){D.filters.tagFilters.push({tagKey:B[C].Key,tagVal:B[C].Value})}}D.applied=!_.isEmpty(D.Prefix)?r.LIFECYCLE.PREFIX:r.LIFECYCLE.WHOLE_BUCKET;D.currentRuleActions=[];D.noncurrentRuleActions=[];D.expiration={enabled:false,days:""};D.permanentlyDelete={enabled:false,days:""};D.removeExpire=false;D.showCurrent=false;D.showPrevious=false;D.showRldm=true;b(E,D);d(E,D);x(E,D);l(E,D);w(E,D);D.currentRuleOptions=z(n);D.noncurrentRuleOptions=z(n);D.isAddCurrentTransitionDisabled=e.isTransitionDisabled(r.LIFECYCLE.GLACIER,D.currentRuleActions);e.updateLifecycleDropdown(D.currentRuleActions,D.currentRuleOptions,r.LIFECYCLE.CURRENT_RULE_OPTIONS_MAP);D.isAddPrevTransitionDisabled=e.isTransitionDisabled(r.LIFECYCLE.GLACIER,D.noncurrentRuleActions);e.updateLifecycleDropdown(D.noncurrentRuleActions,D.noncurrentRuleOptions,r.LIFECYCLE.NONCURRENT_RULE_OPTIONS_MAP);D.summary={currentTransitionsList:["","",""],noncurrentTransitionsList:["","",""],rldm:false,amu:"",ID:"",prefix:""};D.isNextButtonDisabled=false;return D}s.isEdit=true;s.isDelete=true;s.selectRule=function(C,B){s.lifecycle.selectedRule={};s.lifecycle.ruleToBeEdited=angular.copy(s.lifecycleConfiguration.Rules[B]);s.lifecycle.editRuleIndex=B;p();C.selected=true;if(!C.containsDate){s.isEdit=false}s.isDelete=false;if(C.Status===r.LIFECYCLE.ENABLED){h(true,false)}else{h(false,true)}};s.lifecycle={listViewRules:[],ruleToBeEdited:{}};s.lifecycleConfiguration={Rules:[]};s.bucketName=c.getCurrentBucket();var j=(A={},_defineProperty(A,r.LIFECYCLE.LIST_VIEW.STANDARD_IA,t.instant("lifecycle.listview.standia")),_defineProperty(A,r.LIFECYCLE.LIST_VIEW.GLACIER,t.instant("lifecycle.listview.glacier")),_defineProperty(A,r.LIFECYCLE.LIST_VIEW.PREFIX,t.instant("lifecycle.listview.prefix")),_defineProperty(A,r.LIFECYCLE.LIST_VIEW.WHOLE,t.instant("lifecycle.listview.whole")),_defineProperty(A,r.LIFECYCLE.EXPIRE,t.instant("lifecycle.expire")),A);function f(){s.lifecycle.listViewRules=[];s.filterUsed=false;var C=function C(E){var H={};var G=angular.copy(s.lifecycleConfiguration.Rules[E]);H.ID=G.ID;if(typeof G.Prefix!=="undefined"){H.Prefix=G.Prefix!==""?j[r.LIFECYCLE.LIST_VIEW.PREFIX]+" : "+G.Prefix:j[r.LIFECYCLE.LIST_VIEW.WHOLE]}else{if(G.Filter){s.filterUsed=true;if(G.Filter.Prefix){H.Prefix=j[r.LIFECYCLE.LIST_VIEW.PREFIX]+" : "+G.Filter.Prefix}else{if(G.Filter.And&&G.Filter.And.Prefix){H.Prefix=j[r.LIFECYCLE.LIST_VIEW.PREFIX]+" : "+G.Filter.And.Prefix}else{H.Prefix=t.instant("lifecycle.listview.whole")}}if(H.Prefix.length>r.LIFECYCLE.LIST_VIEW_MAX_LENGTH){H.Prefix=H.Prefix.substring(0,22);H.Prefix=H.Prefix+"... "}var L=[];if(G.Filter.Tag){L=y.transformObjectToArray(G.Filter.Tag)}else{if(G.Filter.And&&!_.isEmpty(G.Filter.And.Tag)){L=y.transformObjectToArray(G.Filter.And.Tag)}}if(!_.isEmpty(L)){(function(){var M=r.LIFECYCLE.TAGS;var O=r.LIFECYCLE.KEY_STRING;var P=r.LIFECYCLE.VALUE_STRING;var N=", "+M+" : ";angular.forEach(L,function(Q){N=N+" [ "+O+": "+Q.Key+" , "+P+" : "+Q.Value+" ]"});if(N.length>r.LIFECYCLE.LIST_VIEW_MAX_LENGTH){N=N.substring(0,22);N=N+"..."}H.Prefix=H.Prefix+" "+N})()}}}H.Status=G.Status;var F=[];if(G.Transition){var J=y.transformObjectToArray(G.Transition);for(var D=0;D<J.length;D++){if(J[D].Days){F.push(j[r.LIFECYCLE.LIST_VIEW[J[D].StorageClass]])}else{if(J[D].Date){F.push(j[r.LIFECYCLE.LIST_VIEW[J[D].StorageClass]]+" ("+t.instant("bucketlifecycle.date")+(" "+J[D].Date+")"));H.containsDate=true}}}}if(G.Expiration){if(G.Expiration.Days){F.push(j[r.LIFECYCLE.EXPIRE])}else{if(G.Expiration.Date){F.push(j[r.LIFECYCLE.EXPIRE]+" ("+t.instant("bucketlifecycle.date")+(" "+G.Expiration.Date+")"));H.containsDate=true}}}H.transitionsList="";for(var K=0;K<F.length;K++){H.transitionsList=H.transitionsList+" / "+F[K]}if(!_.isEmpty(H.transitionsList)){H.transitionsList=H.transitionsList.substring(3)}else{H.transitionsList="-"}F=[];H.prevActions="";if(G.NoncurrentVersionTransition){var I=y.transformObjectToArray(G.NoncurrentVersionTransition);angular.forEach(I,function(M){if(M.NoncurrentDays){F.push(j[r.LIFECYCLE.LIST_VIEW[M.StorageClass]])}})}if(G.NoncurrentVersionExpiration){F.push(r.LIFECYCLE.LIST_VIEW[r.LIFECYCLE.PERMANENTLY_DELETE])}angular.forEach(F,function(M){H.prevActions=H.prevActions+" / "+M});if(!_.isEmpty(H.prevActions)){H.prevActions=H.prevActions.substring(3)}else{H.prevActions="-"}if(H.transitionsList==="-"&&H.prevActions==="-"&&G.AbortIncompleteMultipartUpload){H.transitionsList=t.instant("lifecyclemodal.step3.imucleanup")}s.lifecycle.listViewRules.push(H)};for(var B=0;B<s.lifecycleConfiguration.Rules.length;B++){C(B)}}s.operation=new q(r.LIFECYCLE.BUCKET_LIFECYCLE);s.glacierEnabled=true;function g(){k.getBucketLocation(s.bucketName).then(function(B){if(!m.isFeatureEnabled("s3-gl-"+B)){s.glacierEnabled=false}})}s.initialize=function(){var B=new X2JS({stripWhitespaces:false});s.lifecycle.initialXML="";s.lifecycleConfiguration.Rules=[];s.isRefreshing=true;s.operation.step=r.LIFECYCLE.GET_BUCKET_LIFECYCLE;k.getBucketLifecycle(s.bucketName,s.operation).then(function(D){i.evictBucketProperty(s.bucketName,r.LIFECYCLE.NAME);var C=B.xml_str2json(D);if(C&&C.LifecycleConfiguration&&C.LifecycleConfiguration.Rule){s.lifecycleConfiguration.Rules=y.transformObjectToArray(C.LifecycleConfiguration.Rule);s.showEmptyScreen=s.lifecycleConfiguration.Rules.length===0;s.lifecycle.initialXML=D;f()}})["catch"](function(C){if(C!==r.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE){s.lifecycleError=C}else{s.showEmptyScreen=true}})["finally"](function(){s.isRefreshing=false})};s.initialize();g()}})();"use strict";(function(){angular.module("s3").directive("lifecycleModal",[function(){return{restrict:"E",scope:{isOpen:"=",selectedRule:"=",initialResponse:"=",initialize:"=",isEditing:"=",initialXml:"=",operation:"=",disableEdit:"=",disableDelete:"=",ruleToBeEdited:"=",moreOptions:"="},templateUrl:"/s3/partials/lifecyclemodal.html",controller:"LifecycleModalController"}}]);angular.module("s3").controller("LifecycleModalController",["$scope","$timeout","$translate","BucketPropertiesService","BucketPropertiesUtilService","FAC","PathService","S3Constants","SCLogService","UtilService",a]);function a(t,z,u,o,g,p,f,s,e,A){t.STEP={NAME_AND_SCOPE:{name:"NAME_AND_SCOPE",value:u.instant("lifecyclemodal.label.nameandscope")},TRANSITION:{name:"TRANSITION",value:u.instant("lifecyclemodal.transitions")},EXPIRATION:{name:"EXPIRATION",value:u.instant("lifecyclemodal.expiration")},REVIEW:{name:"REVIEW",value:u.instant("lifecyclemodal.label.review")}};t.transitionNumber=[u.instant("bucketlifecycle.firsttransition"),u.instant("bucketlifecycle.secondtransition"),u.instant("bucketlifecycle.thirdtransition")];t.$watch("selectedRule",function(E,D){if(!t.selectedRule){return}if(t.state.name===t.STEP.NAME_AND_SCOPE.name&&t.selectedRule.ID.length===1){t.updateNextButtonDisabled()}if(t.selectedRule.filters&&t.selectedRule.filters.tagFilters.length>0){if(t.selectedRule.amu.enabled&&t.selectedRule.amu.days||t.selectedRule.removeExpire){t.clearLDMAMUWarning=true;t.selectedRule.amu.enabled=false;t.selectedRule.amu.days="";t.selectedRule.removeExpire=false}t.showV2FormatWarning=!t.selectedRule.filterUsed&&!_.isEmpty(t.initialResponse)}else{t.showV2FormatWarning=false;t.clearLDMAMUWarning=false}},true);if(!t.selectedRule||_.isEmpty(t.selectedRule.ID)){z(function(){angular.element("#rule-name input").focus()})}t.isAddPrevTransitionDisabled=false;t.isAddCurrentTransitionDisabled=false;t.showOverlappingPrefixWarning=false;function c(){t.selectedRule.isAddCurrentTransitionDisabled=g.isTransitionDisabled(s.LIFECYCLE.GLACIER,t.selectedRule.currentRuleActions);g.updateLifecycleDropdown(t.selectedRule.currentRuleActions,t.selectedRule.currentRuleOptions,s.LIFECYCLE.CURRENT_RULE_OPTIONS_MAP)}function B(){t.selectedRule.isAddPrevTransitionDisabled=g.isTransitionDisabled(s.LIFECYCLE.GLACIER,t.selectedRule.noncurrentRuleActions);g.updateLifecycleDropdown(t.selectedRule.noncurrentRuleActions,t.selectedRule.noncurrentRuleOptions,s.LIFECYCLE.NONCURRENT_RULE_OPTIONS_MAP)}function n(E,D){if(E.action===s.LIFECYCLE.SIA){E.value=s.LIFECYCLE.RECOMMENDED_DAYS.SIA}else{if(E.action===s.LIFECYCLE.GLACIER){E.value=s.LIFECYCLE.RECOMMENDED_DAYS.GLACIER;if(D.length>1){E.value=(parseInt(D[D.length-2].value)+s.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.SIA).toString()}}}}function y(E,D){E.days=s.LIFECYCLE.RECOMMENDED_DAYS.EXPIRATION;if(D.length>0){E.days=(parseInt(D[D.length-1].value)+parseInt(E.days)).toString()}}t.selectNoncurrentRuleAction=function(E,D){if(D===t.selectedRule.noncurrentRuleActions.length-1){t.hasPrevError=false}t.notANumberErrorNoncurrent.SIA=false;t.notANumberErrorNoncurrent.Glacier=false;t.minimumDaysNoncurrent.SIA=false;t.minimumDaysNoncurrent.Glacier=false;B();if(t.selectedRule.noncurrentRuleActions[D].value===""){n(t.selectedRule.noncurrentRuleActions[D],t.selectedRule.noncurrentRuleActions)}t.validateDays(D,s.LIFECYCLE.NONCURRENT);t.updateNextButtonDisabled()};t.selectCurrentRuleAction=function(E,D){if(D===t.selectedRule.currentRuleActions.length-1){t.hasCurrentError=false}t.notANumberErrorCurrent.SIA=false;t.notANumberErrorCurrent.Glacier=false;t.minimumDaysCurrent.SIA=false;t.minimumDaysCurrent.Glacier=false;c();if(t.selectedRule.currentRuleActions[D].value===""){n(t.selectedRule.currentRuleActions[D],t.selectedRule.currentRuleActions)}t.validateDays(D,s.LIFECYCLE.CURRENT);t.updateNextButtonDisabled()};t.addCurrentRuleAction=function(){if(t.selectedRule.isAddCurrentTransitionDisabled){return}t.selectedRule.currentRuleActions.push({action:"",value:""});c();t.selectedRule.isAddCurrentTransitionDisabled=true;t.updateNextButtonDisabled()};t.removeCurrentRuleAction=function(D){if(t.selectedRule.currentRuleActions.length-1===D){t.hasCurrentError=false}var E=t.selectedRule.currentRuleActions[D].action;t.notANumberErrorCurrent[E]=false;t.minimumDaysCurrent[E]=false;t.highlightTextBoxErrorCurrent[D]=false;t.selectedRule.currentRuleActions.splice(D,1);c();q(t.selectedRule.currentRuleActions,s.LIFECYCLE.CURRENT);t.updateNextButtonDisabled();if(t.selectedRule.expiration.enabled){t.validateCurrentExpiration()}};t.addNoncurrentRuleAction=function(){if(t.selectedRule.isAddPrevTransitionDisabled){return}t.selectedRule.noncurrentRuleActions.push({action:"",value:""});B();t.selectedRule.isAddPrevTransitionDisabled=true;t.updateNextButtonDisabled()};t.removeNoncurrentRuleAction=function(E){if(t.selectedRule.noncurrentRuleActions.length-1===E){t.hasPrevError=false}var D=t.selectedRule.noncurrentRuleActions[E].action;t.notANumberErrorNoncurrent[D]=false;t.minimumDaysNoncurrent[D]=false;t.highlightTextBoxErrorNonCurrent[E]=false;t.selectedRule.noncurrentRuleActions.splice(E,1);B();q(t.selectedRule.noncurrentRuleActions,s.LIFECYCLE.NONCURRENT);t.updateNextButtonDisabled();if(t.selectedRule.permanentlyDelete.enabled){t.validateNoncurrentExpiration()}};t.state=t.STEP.NAME_AND_SCOPE;t.headerTitle=u.instant("lifecyclemodal.header.title");t.generateSummary=function(){if(t.state===t.STEP.NAME_AND_SCOPE){if(!_.isEmpty(t.selectedRule.filters.input)){t.updateNextButtonDisabled();return}A.analyticsTrackClick(s.ANALYTICS.NAME_SCOPE_LIFECYCLE,s.ANALYTICS.LIFECYCLE_S3);A.analyticsTrackView(s.ANALYTICS.TRANSITION_LIFECYCLE,s.ANALYTICS.LIFECYCLE_S3);t.selectedRule.summary.ruleName=angular.copy(t.selectedRule.ID);if(t.showOldUI){t.selectedRule.summary.prefix=!_.isEmpty(t.selectedRule.Prefix)?angular.copy(t.selectedRule.Prefix):u.instant("lifecyclemodal.step1.wholebucket")}else{var J=t.selectedRule.filters&&!_.isEmpty(t.selectedRule.filters.prefixFilters)?angular.copy(t.selectedRule.filters.prefixFilters[0]):u.instant("lifecyclemodal.step1.wholebucket");var E=s.LIFECYCLE.TAGSET;E=E+" : ";for(var G=0;G<t.selectedRule.filters.tagFilters.length;G++){var I=s.LIFECYCLE.KEY;var P=s.LIFECYCLE.VALUE;var F="[ "+I+" "+t.selectedRule.filters.tagFilters[G].tagKey+" , "+P+" : "+t.selectedRule.filters.tagFilters[G].tagVal+" ]";E=E+" "+F}t.selectedRule.summary.prefix=""+J;if(!_.isEmpty(t.selectedRule.filters.tagFilters)){t.selectedRule.summary.prefix=J+" , "+E}}}else{if(t.state===t.STEP.TRANSITION){t.selectedRule.summary.currentTransitionsList=[];t.selectedRule.summary.noncurrentTransitionsList=[];var D=u.instant("lifecyclemodal.step3.afterdays");var M=u.instant("lifecyclemodal.days");for(var G=0;G<t.selectedRule.currentRuleActions.length;G++){var O=angular.copy(t.selectedRule.currentRuleActions[G].value);var N=s.LIFECYCLE.REVIEW_SECTION_TRANSITIONS[t.selectedRule.currentRuleActions[G].action];var H=N+" "+D+" "+O+" "+M;t.selectedRule.summary.currentTransitionsList.push(H)}for(var G=t.selectedRule.currentRuleActions.length;G<s.LIFECYCLE.TOTAL_OPTIONS;G++){t.selectedRule.summary.currentTransitionsList.push("")}for(var G=0;G<t.selectedRule.noncurrentRuleActions.length;G++){var K=angular.copy(t.selectedRule.noncurrentRuleActions[G].value);var N=s.LIFECYCLE.REVIEW_SECTION_TRANSITIONS[t.selectedRule.noncurrentRuleActions[G].action];var L=N+" "+D+" "+K+" "+M;t.selectedRule.summary.noncurrentTransitionsList.push(L)}for(var G=t.selectedRule.noncurrentRuleActions.length;G<s.LIFECYCLE.TOTAL_OPTIONS;G++){t.selectedRule.summary.noncurrentTransitionsList.push("")}t.selectedRule.summary.currentVersionHeader=_.some(t.selectedRule.summary.currentTransitionsList,function(Q){return Q!==""});t.selectedRule.summary.noncurrentVersionHeader=_.some(t.selectedRule.summary.noncurrentTransitionsList,function(Q){return Q!==""});A.analyticsTrackClick(s.ANALYTICS.TRANSITION_LIFECYCLE,s.ANALYTICS.LIFECYCLE_S3);A.analyticsTrackView(s.ANALYTICS.EXPIRATIONS_LIFECYCLE,s.ANALYTICS.LIFECYCLE_S3)}else{if(t.state===t.STEP.EXPIRATION){t.searchOverlappingPrefixes();if(t.selectedRule.amu&&t.selectedRule.amu.enabled&&t.selectedRule.amu.days!==""){t.selectedRule.summary.amu=angular.copy(t.selectedRule.amu.days)}else{t.selectedRule.summary.amu=""}if(t.selectedRule.removeExpire&&t.selectedRule.expiration&&!t.selectedRule.expiration.enabled){t.selectedRule.summary.rldm=true}else{t.selectedRule.summary.rldm=false}A.analyticsTrackClick(s.ANALYTICS.EXPIRATIONS_LIFECYCLE,s.ANALYTICS.LIFECYCLE_S3);A.analyticsTrackView(s.ANALYTICS.REVIEW_LIFECYCLE,s.ANALYTICS.LIFECYCLE_S3)}}}t.nextState();t.selectedRule.isNextButtonDisabled=true;t.updateNextButtonDisabled()};t.searchOverlappingPrefixes=function(){t.showOverlappingPrefixWarning=false;t.overlappingRule="";for(var E=0;E<t.initialResponse.length;E++){if(t.isEditing&&E===t.selectedRule.indexVal){continue}var F="";var D="";if(t.showOldUI){D=t.selectedRule.Prefix}else{D=!_.isEmpty(t.selectedRule.filters.prefixFilters)?t.selectedRule.filters.prefixFilters[0]:""}var G=t.initialResponse[E];if(G.Prefix){F=G.Prefix}else{if(G.Filter){if(G.Filter.Prefix){F=G.Filter.Prefix}else{if(G.Filter.And&&G.Filter.And.Prefix){F=G.Filter.And.Prefix}}}}if(_.startsWith(D,F)||_.startsWith(F,D)){t.showOverlappingPrefixWarning=true;if(!t.selectedRule.filterUsed){t.showOverlappingNewFormatWarning=true}t.overlappingRule=G.ID;break}}};function v(G,J,H){var F={};F.LifecycleConfiguration={};F.LifecycleConfiguration.Rule=G;delete G._xmlns;var E=t.initialXml;var D=J.json2xml_str(F);var I=t.isEditing?J.json2xml_str(t.initialResponse[t.selectedRule.indexVal]):"";o.putBucketLifecycle(f.getCurrentBucket(),E,D,I,H,t.operation).then(function(){t.lifecycleError=undefined;t.disableEdit=true;t.disableDelete=true;t.ruleToBeEdited=undefined;t.moreOptions[0].disabled=true;t.moreOptions[1].disabled=true;t.initialize();t.closeLifecycleModal()})["catch"](function(K){t.lifecycleError=K})}t.detectStateChange=function(){t.operation.step=s.LIFECYCLE.GET_BUCKET_LIFECYCLE;o.getBucketLifecycle(f.getCurrentBucket(),t.operation).then(function(D){if(D!==t.initialXml){t.showContinue=true;t.stateChangeWarning=u.instant("lifecyclemodal.step3.statechange")}else{t.showContinue=false;t.stateChangeWarning=undefined;t.saveLifecycle()}})["catch"](function(D){if(D===s.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE){if(t.initialXml!==""){t.showContinue=true;t.stateChangeWarning=u.instant("lifecyclemodal.step3.statechange")}else{t.showContinue=false;t.stateChangeWarning=undefined;t.saveLifecycle()}}else{t.lifecycleError=D}})};function b(E,D){return Object.keys(E).some(function(F){return F!==s.LIFECYCLE.PREFIX_PROPERTY&&!_.isEqual(E[F],D[F])})}t.saveLifecycle=function(){var E={};var F=false;A.analyticsTrackClick(s.ANALYTICS.END_LIFECYCLE,s.ANALYTICS.LIFECYCLE_S3,{s_fid:A.getCookie("s_fid"),"session-id":A.getCookie("session-id")});t.operation.step=s.LIFECYCLE.ENABLED_LIFECYCLE_RULE_ACTIONS;var N=angular.copy(t.selectedRule);E.ID=N.ID;if(!t.selectedRule.filterUsed&&_.isEmpty(t.selectedRule.filters.tagFilters)&&!t.showOverlappingPrefixWarning){if(t.showOldUI){E.Prefix=N.applied===s.LIFECYCLE.PREFIX?N.Prefix:""}else{if(!_.isEmpty(t.initialResponse)){E.Prefix=_.isEmpty(N.filters.prefixFilters)?"":N.filters.prefixFilters[0]}else{E.Filter={};E.Filter.Prefix=_.isEmpty(N.filters.prefixFilters)?"":N.filters.prefixFilters[0];F=true}}}else{if(!_.isEmpty(N.filters.tagFilters)){if(N.filters.tagFilters.length===1&&!N.prefixUsed&&(t.showOldUI&&_.isEmpty(N.Prefix)||!t.showOldUI&&_.isEmpty(N.filters.prefixFilters))){E.Filter={};E.Filter.Tag=[];E.Filter.Tag.push({Key:N.filters.tagFilters[0].tagKey,Value:N.filters.tagFilters[0].tagVal})}else{E.Filter={};E.Filter.And={};if(t.showOldUI){E.Filter.And.Prefix=N.applied===s.LIFECYCLE.PREFIX?N.Prefix:""}else{E.Filter.And.Prefix=_.isEmpty(N.filters.prefixFilters)?"":N.filters.prefixFilters[0]}E.Filter.And.Tag=[];for(var G=0;G<N.filters.tagFilters.length;G++){E.Filter.And.Tag.push({Key:N.filters.tagFilters[G].tagKey,Value:N.filters.tagFilters[G].tagVal})}}}else{E.Filter={};if(t.showOldUI){E.Filter.Prefix=N.applied===s.LIFECYCLE.PREFIX?N.Prefix:""}else{E.Filter.Prefix=_.isEmpty(N.filters.prefixFilters)?"":N.filters.prefixFilters[0]}}if(!t.selectedRule.filterUsed){F=true}}E.Status=N.Status;E.Transition=[];for(var G=0;G<N.currentRuleActions.length;G++){if(N.currentRuleActions[G].action===s.LIFECYCLE.SIA){var J={};J.StorageClass=s.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS;J.Days=N.currentRuleActions[G].value;E.Transition.push(J);e.log("LifecycleCurrentSIARule",1,t.operation)}else{if(N.currentRuleActions[G].action===s.LIFECYCLE.GLACIER){var M={};M.StorageClass=s.STORAGE_CLASSES.GLACIER;M.Days=N.currentRuleActions[G].value;E.Transition.push(M);e.log("LifecycleCurrentGlacierRule",1,t.operation)}}}if(E.Transition.length===0){delete E.Transition}E.NoncurrentVersionTransition=[];for(var G=0;G<N.noncurrentRuleActions.length;G++){if(N.noncurrentRuleActions[G].action===s.LIFECYCLE.SIA){var D={};D.StorageClass=s.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS;D.NoncurrentDays=N.noncurrentRuleActions[G].value;E.NoncurrentVersionTransition.push(D);e.log("LifecycleNoncurrentSIARule",1,t.operation)}else{if(N.noncurrentRuleActions[G].action===s.LIFECYCLE.GLACIER){var I={};I.StorageClass=s.STORAGE_CLASSES.GLACIER;I.NoncurrentDays=N.noncurrentRuleActions[G].value;E.NoncurrentVersionTransition.push(I);e.log("LifecycleNoncurrentGlacierRule",1,t.operation)}}}if(E.NoncurrentVersionTransition.length===0){delete E.NoncurrentVersionTransition}if(N.expiration&&N.expiration.enabled&&N.expiration.days!==""){E.Expiration={};E.Expiration.Days=N.expiration.days;e.log("LifecycleExpirationRule",1,t.operation)}if(N.permanentlyDelete&&N.permanentlyDelete.enabled&&N.permanentlyDelete.days!==""){E.NoncurrentVersionExpiration={};E.NoncurrentVersionExpiration.NoncurrentDays=N.permanentlyDelete.days;e.log("LifecycleNoncurrentExpirationRule",1,t.operation)}if(N.removeExpire){if(!(E.Expiration&&E.Expiration.Days)){E.Expiration={};E.Expiration.ExpiredObjectDeleteMarker=s.LIFECYCLE.TRUE;e.log("LifecycleExpiredLDMTrueRule",1,t.operation)}}if(N.amu&&N.amu.enabled&&N.amu.days!==""){E.AbortIncompleteMultipartUpload={};E.AbortIncompleteMultipartUpload.DaysAfterInitiation=N.amu.days;e.log("LifecycleAbortIncompleteUploadRule",1,t.operation)}if(N.containsRldmAsFalse){if(!E.Expiration){E.Expiration={};E.Expiration.ExpiredObjectDeleteMarker=s.LIFECYCLE.FALSE;e.log("LifecycleExpiredLDMFalseRule",1,t.operation)}}var H=angular.copy(t.initialResponse);if(F){for(var G=0;G<H.length;G++){if(typeof H[G].Prefix!=="undefined"){H[G].Filter={};H[G].Filter.Prefix=angular.copy(H[G].Prefix);delete H[G].Prefix}}}var K=new X2JS({stripWhitespaces:false});var L=false;if(t.isEditing){H[N.indexVal]=E;if(!t.selectedRule.filterUsed){for(var G=0;G<t.initialResponse.length;G++){if(G!==N.indexVal){if(b(t.initialResponse[G],H[G])){e.log(s.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,t.operation,{initialRule:t.initialResponse[G],finalRule:H[G]});L=true;break}}}}else{for(var G=0;G<t.initialResponse.length;G++){if(G!==N.indexVal&&!_.isEqual(t.initialResponse[G],H[G])){e.log(s.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,t.operation,{initialRule:t.initialResponse[G],finalRule:H[G]});L=true;break}}}if(!L){e.log("LifecycleRuleVerification",1,t.operation,{initialResponse:t.initialResponse,finalResponse:H});t.operation.step=s.LIFECYCLE.EDIT_BUCKET_LIFECYCLE;v(H,K,E)}else{e.log("LifecycleRuleVerification",0,t.operation,{initialResponse:t.initialResponse,finalResponse:H})}}else{for(var G=0;G<t.initialResponse.length;G++){if(b(t.initialResponse[G],H[G])){e.log(s.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,t.operation,{initialRule:t.initialResponse[G],finalRule:H[G]});L=true;break}}t.operation.step=s.LIFECYCLE.CREATE_BUCKET_LIFECYCLE;H.push(E);if(!L){e.log("LifecycleRuleVerification",1,t.operation,{initialResponse:t.initialResponse,finalResponse:H});v(H,K,E)}else{e.log("LifecycleRuleVerification",0,t.operation,{initialResponse:t.initialResponse,finalResponse:H})}}};function m(){t.notANumberErrorCurrent={};t.notANumberErrorCurrent.SIA=false;t.notANumberErrorCurrent.Glacier=false;t.notANumberErrorCurrent.Expire=false;t.minimumDaysCurrent={};t.minimumDaysCurrent.SIA=false;t.minimumDaysCurrent.Glacier=false;t.minimumDaysCurrent.Expire=false;t.greaterThanCurrentError={};t.greaterThanCurrentError.GlacierGreaterThanSIA=false;t.greaterThanCurrentError.DeleteGreaterThanSIA=false;t.greaterThanCurrentError.DeleteGreaterThanGlacier=false;t.highlightTextBoxErrorCurrent=[false,false,false];t.notANumberErrorNoncurrent={};t.notANumberErrorNoncurrent.SIA=false;t.notANumberErrorNoncurrent.Glacier=false;t.notANumberErrorNoncurrent.PermanentlyDelete=false;t.minimumDaysNoncurrent={};t.minimumDaysNoncurrent.SIA=false;t.minimumDaysNoncurrent.Glacier=false;t.minimumDaysNoncurrent.PermanentlyDelete=false;t.greaterThanNonCurrentError={};t.greaterThanNonCurrentError.GlacierGreaterThanSIA=false;t.greaterThanNonCurrentError.DeleteGreaterThanSIA=false;t.greaterThanNonCurrentError.DeleteGreaterThanGlacier=false;t.highlightTextBoxErrorNonCurrent=[false,false,false];t.currentGlacierGreaterThanSIAValue="";t.expireGreaterThanSIAValue="";t.expireGreaterThanGlacierValue="";t.noncurrentGlacierGreaterThanSIAValue="";t.permanentlyDeleteGreaterThanSIAValue="";t.permanentlyDeleteGreaterThanGlacierValue="";t.tag={error:""};t.tagSearchSelected=false;t.showTag=false;t.markers=[];t.tagContinuationTokens=[];t.higherNumberErrorCurrent={};t.higherNumberErrorCurrent.SIA=false;t.higherNumberErrorCurrent.Glacier=false;t.higherNumberErrorCurrent.Expire=false;t.higherNumberErrorNoncurrent={};t.higherNumberErrorNoncurrent.SIA=false;t.higherNumberErrorNoncurrent.Glacier=false;t.higherNumberErrorNoncurrent.PermanentlyDelete=false}t.showStep2CurrentVersionChange=function(){if(!t.selectedRule.showCurrent){var D=t.selectedRule.currentRuleActions.length;for(var E=0;E<D;E++){t.removeCurrentRuleAction(0)}}if(t.selectedRule.expiration.enabled){t.validateCurrentExpiration()}};t.showStep2PreviousVersionChange=function(){if(!t.selectedRule.showPrevious){var D=t.selectedRule.noncurrentRuleActions.length;for(var E=0;E<D;E++){t.removeNoncurrentRuleAction(0)}}if(t.selectedRule.permanentlyDelete.enabled){t.validateNoncurrentExpiration()}};t.showStep3CurrentVersionChange=function(){if(!t.selectedRule.showStep3CurrentVersion){t.selectedRule.expiration.enabled=false;t.selectedRule.expiration.days="";t.selectedRule.showRldm=true;t.notANumberErrorCurrent[s.LIFECYCLE.EXPIRE]=false;t.minimumDaysCurrent[s.LIFECYCLE.EXPIRE]=false;t.higherNumberErrorCurrent.Expire=false;t.greaterThanCurrentError[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;t.greaterThanCurrentError[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;t.updateNextButtonDisabled()}else{if(!t.selectedRule.expiration.enabled){t.selectedRule.expiration.enabled=true;t.selectedRule.showRldm=false;t.selectedRule.removeExpire=false;z(function(){return $("#expiration-days input").focus()});if(t.selectedRule.expiration.days===""){y(t.selectedRule.expiration,t.selectedRule.currentRuleActions)}t.updateNextButtonDisabled()}}};t.showStep3PreviousVersionChange=function(){if(!t.selectedRule.showStep3PreviousVersion){t.selectedRule.permanentlyDelete.enabled=false;t.selectedRule.permanentlyDelete.days="";t.notANumberErrorNoncurrent[s.LIFECYCLE.PERMANENTLY_DELETE]=false;t.minimumDaysNoncurrent[s.LIFECYCLE.PERMANENTLY_DELETE]=false;t.higherNumberErrorNoncurrent.PermanentlyDelete=false;t.greaterThanNonCurrentError[s.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;t.greaterThanNonCurrentError[s.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;t.updateNextButtonDisabled()}else{if(!t.selectedRule.permanentlyDelete.enabled){t.selectedRule.permanentlyDelete.enabled=true;z(function(){return $("#permanently-delete-days input").focus()});if(t.selectedRule.permanentlyDelete.days===""){y(t.selectedRule.permanentlyDelete,t.selectedRule.noncurrentRuleActions)}t.updateNextButtonDisabled()}}};function l(){t.notANumberAmuError=false;t.minimumDaysAmuError=false;t.higherNumberErrorAmu=false;t.hasCurrentError=false;t.hasPrevError=false}function k(){m();l()}function r(K,I,H,F,D,G){var E=K.length;if(E>=1){if(K[0].action===s.LIFECYCLE.SIA){if(E===2&&K[1].action===s.LIFECYCLE.GLACIER){if(K[1].value-K[0].value<s.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.SIA){H[s.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=true;F[s.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]=true;var J=parseInt(K[0].value)+30;if(G===s.LIFECYCLE.CURRENT){t.currentGlacierGreaterThanSIAValue=J}else{t.noncurrentGlacierGreaterThanSIAValue=J}return}else{if(K[0].value<s.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.SIA){D[s.LIFECYCLE.SIA]=true;F[s.LIFECYCLE.RULE_ACTION_ERRORS.SIA]=true;return}else{H[s.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=false;F[s.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]=false}}}}if(I!==""&&I-K[E-1].value<s.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.Delete){var J=parseInt(K[E-1].value)+1;if(K[E-1].action===s.LIFECYCLE.SIA){H[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=true;F[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true;if(G===s.LIFECYCLE.CURRENT){t.expireGreaterThanSIAValue=J}else{t.permanentlyDeleteGreaterThanSIAValue=J}return}else{if(K[E-1].action===s.LIFECYCLE.GLACIER){H[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=true;F[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true;if(G===s.LIFECYCLE.CURRENT){t.expireGreaterThanGlacierValue=J}else{t.permanentlyDeleteGreaterThanGlacierValue=J}return}}}else{H[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;F[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false}}}t.validateDays=function(G,F){if(F===s.LIFECYCLE.CURRENT){var D=t.selectedRule.currentRuleActions[G].action;t.notANumberErrorCurrent.SIA=false;t.notANumberErrorCurrent.Glacier=false;t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.SIA]=false;t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]=false;t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;t.minimumDaysCurrent.SIA=false;t.minimumDaysCurrent.Glacier=false;t.higherNumberErrorCurrent.SIA=false;t.higherNumberErrorCurrent.Glacier=false;t.greaterThanCurrentError[s.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=false;t.greaterThanCurrentError[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;t.greaterThanCurrentError[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;if(t.selectedRule.currentRuleActions.length>0&&t.selectedRule.currentRuleActions[G].action!==""){if(isNaN(t.selectedRule.currentRuleActions[G].value)||t.selectedRule.currentRuleActions[G].value%1!==0||t.selectedRule.currentRuleActions[G].value.indexOf(s.LIFECYCLE.EXPONENTIAL)!==-1){t.notANumberErrorCurrent[D]=true;t.highlightTextBoxErrorCurrent[G]=true}else{if(t.selectedRule.currentRuleActions[G].value>s.LIFECYCLE.MAX_DAYS_ALLOWED){t.higherNumberErrorCurrent[D]=true;t.highlightTextBoxErrorCurrent[G]=true}else{if(t.selectedRule.currentRuleActions[G].value<s.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[t.selectedRule.currentRuleActions[G].action]){t.minimumDaysCurrent[D]=true;t.highlightTextBoxErrorCurrent[G]=true}else{r(t.selectedRule.currentRuleActions,t.selectedRule.expiration.days,t.greaterThanCurrentError,t.highlightTextBoxErrorCurrent,t.minimumDaysCurrent,s.LIFECYCLE.CURRENT)}}}}t.updateNextButtonDisabled();return w(s.LIFECYCLE.CURRENT)}else{var E=t.selectedRule.noncurrentRuleActions[G].action;t.notANumberErrorNoncurrent.SIA=false;t.notANumberErrorNoncurrent.Glacier=false;t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.SIA]=false;t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]=false;t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;t.minimumDaysNoncurrent.SIA=false;t.minimumDaysNoncurrent.Glacier=false;t.higherNumberErrorNoncurrent.SIA=false;t.higherNumberErrorNoncurrent.Glacier=false;t.greaterThanNonCurrentError[s.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=false;t.greaterThanNonCurrentError[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;t.greaterThanNonCurrentError[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;if(t.selectedRule.noncurrentRuleActions.length>0&&t.selectedRule.noncurrentRuleActions[G].action!==""){if(isNaN(t.selectedRule.noncurrentRuleActions[G].value)||t.selectedRule.noncurrentRuleActions[G].value%1!==0||t.selectedRule.noncurrentRuleActions[G].value.indexOf(s.LIFECYCLE.EXPONENTIAL)!==-1){t.notANumberErrorNoncurrent[E]=true;t.highlightTextBoxErrorNonCurrent[G]=true}else{if(t.selectedRule.noncurrentRuleActions[G].value>s.LIFECYCLE.MAX_DAYS_ALLOWED){t.higherNumberErrorNoncurrent[E]=true;t.highlightTextBoxErrorNonCurrent[G]=true}else{if(t.selectedRule.noncurrentRuleActions[G].value<s.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[t.selectedRule.noncurrentRuleActions[G].action]){t.minimumDaysNoncurrent[E]=true;t.highlightTextBoxErrorNonCurrent[G]=true}else{r(t.selectedRule.noncurrentRuleActions,t.selectedRule.permanentlyDelete.days,t.greaterThanNonCurrentError,t.highlightTextBoxErrorNonCurrent,t.minimumDaysNoncurrent,s.LIFECYCLE.NONCURRENT)}}}}t.updateNextButtonDisabled();return w(s.LIFECYCLE.NONCURRENT)}};t.validateCurrentExpiration=function(){t.notANumberErrorCurrent.Expire=false;t.minimumDaysCurrent.Expire=false;t.greaterThanCurrentError.DeleteGreaterThanSIA=false;t.greaterThanCurrentError.DeleteGreaterThanGlacier=false;t.higherNumberErrorCurrent.Expire=false;t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;if(isNaN(t.selectedRule.expiration.days)||t.selectedRule.expiration.days%1!==0||t.selectedRule.expiration.days.indexOf(s.LIFECYCLE.EXPONENTIAL)!==-1){t.notANumberErrorCurrent.Expire=true;t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{if(t.selectedRule.expiration.days>s.LIFECYCLE.MAX_DAYS_ALLOWED){t.higherNumberErrorCurrent.Expire=true;t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{if(t.selectedRule.expiration.days<s.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[s.LIFECYCLE.EXPIRE]){t.minimumDaysCurrent.Expire=true;t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{r(t.selectedRule.currentRuleActions,t.selectedRule.expiration.days,t.greaterThanCurrentError,t.highlightTextBoxErrorCurrent,t.minimumDaysCurrent,s.LIFECYCLE.CURRENT)}}}t.updateNextButtonDisabled()};t.validateNoncurrentExpiration=function(){t.notANumberErrorNoncurrent.PermanentlyDelete=false;t.minimumDaysNoncurrent.PermanentlyDelete=false;t.greaterThanNonCurrentError.DeleteGreaterThanSIA=false;t.greaterThanNonCurrentError.DeleteGreaterThanGlacier=false;t.higherNumberErrorNoncurrent.PermanentlyDelete=false;t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;if(isNaN(t.selectedRule.permanentlyDelete.days)||t.selectedRule.permanentlyDelete.days%1!==0||t.selectedRule.permanentlyDelete.days.indexOf(s.LIFECYCLE.EXPONENTIAL)!==-1){t.notANumberErrorNoncurrent.PermanentlyDelete=true;t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{if(t.selectedRule.permanentlyDelete.days>s.LIFECYCLE.MAX_DAYS_ALLOWED){t.higherNumberErrorNoncurrent.PermanentlyDelete=true;t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{if(t.selectedRule.permanentlyDelete.days<s.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[s.LIFECYCLE.PERMANENTLY_DELETE]){t.minimumDaysNoncurrent.PermanentlyDelete=true;t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{r(t.selectedRule.noncurrentRuleActions,t.selectedRule.permanentlyDelete.days,t.greaterThanNonCurrentError,t.highlightTextBoxErrorNonCurrent,t.minimumDaysNoncurrent,s.LIFECYCLE.NONCURRENT)}}}t.updateNextButtonDisabled()};function w(D){if(D===s.LIFECYCLE.CURRENT){return t.minimumDaysCurrent.SIA||t.minimumDaysCurrent.Glacier||t.minimumDaysCurrent.Expire||t.higherNumberErrorCurrent.Expire||t.greaterThanCurrentError.GlacierGreaterThanSIA||t.greaterThanCurrentError.DeleteGreaterThanSIA||t.greaterThanCurrentError.DeleteGreaterThanGlacier||_.indexOf(t.highlightTextBoxErrorCurrent,true)!==-1}else{return t.minimumDaysNoncurrent.SIA||t.minimumDaysNoncurrent.Glacier||t.minimumDaysNoncurrent.PermanentlyDelete||t.higherNumberErrorNoncurrent.PermanentlyDelete||t.greaterThanNonCurrentError.GlacierGreaterThanSIA||t.greaterThanNonCurrentError.DeleteGreaterThanSIA||t.greaterThanNonCurrentError.DeleteGreaterThanGlacier||_.indexOf(t.highlightTextBoxErrorNonCurrent,true)!==-1}}function h(){return _.some(t.selectedRule.currentRuleActions,function(D){return D.action===""||D.value===""})}function d(){return _.some(t.selectedRule.noncurrentRuleActions,function(D){return D.action===""||D.value===""})}function x(){return t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.SIA]||t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]||t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.SIA]||t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]}function j(){return t.selectedRule.expiration.enabled&&t.selectedRule.expiration.days===""||t.selectedRule.permanentlyDelete.enabled&&t.selectedRule.permanentlyDelete.days===""||t.selectedRule.amu.enabled&&t.selectedRule.amu.days===""||t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]||t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]||t.amuError}function C(){if(t.state.name===t.STEP.NAME_AND_SCOPE.name){var D=!_.isEmpty(t.selectedRule.filters.input);t.showFinishSelectionWarning=D;t.selectedRule.isNextButtonDisabled=D}else{if(t.state.name===t.STEP.TRANSITION.name){t.selectedRule.isNextButtonDisabled=h()||d()||x()}else{if(t.state.name===t.STEP.EXPIRATION.name){t.selectedRule.isNextButtonDisabled=j()||_.isEmpty(t.selectedRule.currentRuleActions)&&_.isEmpty(t.selectedRule.noncurrentRuleActions)&&!t.selectedRule.expiration.enabled&&!t.selectedRule.amu.enabled&&!t.selectedRule.permanentlyDelete.enabled&&!t.selectedRule.removeExpire}}}}t.updateNextButtonDisabled=function(){t.selectedRule.isNextButtonDisabled=false;z(C)};function q(F,E){for(var D=0;D<F.length;D++){if(t.validateDays(D,E)){break}}}t.validateAmuDays=function(){if(isNaN(t.selectedRule.amu.days)){t.amuError=true;t.notANumberAmuError=true}else{if(t.selectedRule.amu.days<s.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.AMU){t.amuError=true;t.minimumDaysAmuError=true}else{if(t.selectedRule.amu.days>s.LIFECYCLE.MAX_DAYS_ALLOWED){t.amuError=true;t.higherNumberErrorAmu=true}else{t.notANumberAmuError=false;t.minimumDaysAmuError=false;t.higherNumberErrorAmu=false;t.amuError=false}}}t.updateNextButtonDisabled()};t.selectCurrentExpiration=function(){if(t.selectedRule.expiration.enabled){t.selectedRule.removeExpire=false;t.selectedRule.showRldm=false;if(t.selectedRule.expiration.days===""){y(t.selectedRule.expiration,t.selectedRule.currentRuleActions)}}else{t.selectedRule.expiration.days="";t.selectedRule.showRldm=true;t.notANumberErrorCurrent[s.LIFECYCLE.EXPIRE]=false;t.minimumDaysCurrent[s.LIFECYCLE.EXPIRE]=false;t.higherNumberErrorCurrent.Expire=false;t.greaterThanCurrentError[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;t.greaterThanCurrentError[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;t.highlightTextBoxErrorCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false}t.updateNextButtonDisabled()};t.selectNoncurrentExpiration=function(){if(!t.selectedRule.permanentlyDelete.enabled){t.selectedRule.permanentlyDelete.days="";t.notANumberErrorNoncurrent[s.LIFECYCLE.PERMANENTLY_DELETE]=false;t.minimumDaysNoncurrent[s.LIFECYCLE.PERMANENTLY_DELETE]=false;t.higherNumberErrorNoncurrent.PermanentlyDelete=false;t.greaterThanNonCurrentError[s.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;t.greaterThanNonCurrentError[s.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;t.highlightTextBoxErrorNonCurrent[s.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false}else{if(t.selectedRule.permanentlyDelete.days===""){y(t.selectedRule.permanentlyDelete,t.selectedRule.noncurrentRuleActions)}}t.updateNextButtonDisabled()};t.selectAmuAction=function(){if(!t.selectedRule.amu.enabled){t.selectedRule.amu.days="";t.notANumberAmuError=false;t.minimumDaysAmuError=false;t.higherNumberErrorAmu=false}else{if(_.isEmpty(t.selectedRule.amu.days)){t.selectedRule.amu.days=s.LIFECYCLE.AMU_DEFAULT_DAYS}}t.updateNextButtonDisabled()};function i(){t.showOldUI=!p.isFeatureEnabled(s.FAC.OBJECT_TAGGING)}k();i();t.goToPreviousStep=function(){t.lifecycleError=undefined;t.previousState();t.updateNextButtonDisabled()};t.closeLifecycleModal=function(){k();t.isOpen.flag=false;t.state=t.STEP.NAME_AND_SCOPE;t.selectedRule=undefined;t.lifecycleError=undefined;t.showContinue=false;t.showOverlappingPrefixWarning=false;t.showOverlappingNewFormatWarning=false;t.showFinishSelectionWarning=false;t.showV2FormatWarning=false;t.overlappingRule="";t.stateChangeWarning=undefined;t.currentGlacierGreaterThanSIAValue="";t.expireGreaterThanSIAValue="";t.expireGreaterThanGlacierValue="";t.noncurrentGlacierGreaterThanSIAValue="";t.permanentlyDeleteGreaterThanSIAValue="";t.permanentlyDeleteGreaterThanGlacierValue="";t.clearLDMAMUWarning=false}}})();"use strict";(function(){angular.module("s3").directive("lifecycleConfirmationModal",function(){return{restrict:"E",scope:{isOpen:"=",warningMessage:"=",initialResponse:"=",initialize:"=",initialXml:"=",selectedRule:"=",selectedRuleIndex:"=",actionType:"=",headerTitle:"=",listRules:"=",ruleToBeEdited:"=",disableEdit:"=",disableDelete:"=",moreOptions:"=",operation:"="},templateUrl:"/s3/partials/lifecycleconfirmationmodal.html",controller:"LifecycleConfirmationModalController"}});angular.module("s3").controller("LifecycleConfirmationModalController",["$scope","$filter","$translate","BucketPropertiesService","PathService","ConsoleOperation","S3Constants","SCLogService",function(l,i,b,d,j,h,f,k){l.closeConfirmationModal=function(){l.isOpen.flag=false;l.showContinue=false;l.stateChangeWarning=undefined;l.selectedRuleIndex=undefined;l.selectedRule=undefined;l.lifecycleError=undefined};function n(){l.lifecycleError=undefined;l.showContinue=false;l.stateChangeWarning=undefined;l.saveLifecycle()}function c(){l.showContinue=true;l.stateChangeWarning=b.instant("lifecyclemodal.step3.statechange")}l.detectStateChange=function(){l.operation.step=f.LIFECYCLE.GET_BUCKET_LIFECYCLE;d.getBucketLifecycle(j.getCurrentBucket(),l.operation).then(function(o){if(o===l.initialXml){n()}else{c()}})["catch"](function(o){if(o===f.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE){if(l.initialXml===""){n()}else{c()}}else{l.lifecycleError=o}})};function a(){l.lifecycleError=undefined;l.ruleToBeEdited=undefined;l.disableEdit=true;l.disableDelete=true;l.moreOptions[0].disabled=true;l.moreOptions[1].disabled=true;l.initialize();l.closeConfirmationModal()}function e(o){return l.initialResponse.length===1&&_.isEmpty(o)}function m(o){for(var p=0;p<l.initialResponse.length;p++){if(p!==l.selectedRuleIndex&&!_.isEqual(l.initialResponse[p],o[p])){k.log(f.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,l.operation,{initialRule:l.initialResponse[p],finalRule:o[p]});return true}}return false}function g(o){var p=angular.copy(l.initialResponse);p.splice(l.selectedRuleIndex,1);if(_.isEqual(p,o)||e(o)){return false}else{k.log(f.METRIC_NAME.LIFECYCLE_DELETE_MISMATCH,1,l.operation,{selectedRuleIndex:l.selectedRuleIndex,initialConfig:p,finalConfig:o});return true}}l.saveLifecycle=function(){var r=angular.copy(l.initialResponse);var w=angular.copy(l.selectedRule);var u=false;if(l.actionType===f.LIFECYCLE.CONFIRMATION_MODAL.ENABLE_POLICY){l.operation.step=f.LIFECYCLE.ENABLE_LIFECYCLE_POLICY;w.Status=f.LIFECYCLE.ENABLED;r[l.selectedRuleIndex]=w;u=m(r)}else{if(l.actionType===f.LIFECYCLE.CONFIRMATION_MODAL.DISABLE_POLICY){l.operation.step=f.LIFECYCLE.DISABLE_LIFECYCLE_POLICY;w.Status=f.LIFECYCLE.DISABLED;r[l.selectedRuleIndex]=w;u=m(r)}else{if(l.actionType===f.LIFECYCLE.CONFIRMATION_MODAL.DELETE_POLICY){l.operation.step=f.LIFECYCLE.DELETE_LIFECYCLE_POLICY;r.splice(l.selectedRuleIndex,1);u=g(r)}}}if(!u){k.log("LifecycleRuleVerification",1,l.operation,{initialResponse:l.initialResponse,finalResponse:r});var t=new X2JS({stripWhitespaces:false});var v="";var p=t.json2xml_str(l.initialResponse[l.selectedRule.indexVal]);var q=l.actionType===f.LIFECYCLE.CONFIRMATION_MODAL.DELETE_POLICY?"":t.json2xml_str(w);var s=l.initialXml;if(r.length>0){var o={};o.LifecycleConfiguration={};o.LifecycleConfiguration.Rule=r;delete r._xmlns;v=t.json2xml_str(o);d.putBucketLifecycle(j.getCurrentBucket(),s,v,p,q,l.operation).then(function(){a()})["catch"](function(x){l.lifecycleError=x})}else{d.deleteBucketLifecycle(j.getCurrentBucket(),s,v,p,q,l.operation).then(function(){l.listRules=[];l.initialResponse=[];l.ruleToBeEdited=undefined;l.lifecycleError=undefined;l.disableEdit=true;l.disableDelete=true;l.moreOptions[0].disabled=true;l.moreOptions[1].disabled=true;l.initialize();l.closeConfirmationModal()})["catch"](function(x){l.lifecycleError=x})}}else{k.log("LifecycleRuleVerification",0,l.operation,{initialResponse:l.initialResponse,finalResponse:r})}}}])})();"use strict";(function(){angular.module("s3").directive("scroll",["$timeout",function(c){var a=30;function b(e){if(Math.ceil($(window).scrollTop()+$(window).height())+a>=$(document).height()){$(e[0]).addClass("progressbarbottom")}else{$(e[0]).removeClass("progressbarbottom")}}return{restrict:"A",link:function d(g,f,e){g.$watch(function(){return e.totalOperation},function(i,h){if(i!==h){c(b(f),1)}},true);$(window).resize(function(){b(f)});$(window).scroll(function(){b(f)})}}}])})();"use strict";(function(){angular.module("s3").directive("bucketConfirmationModal",function(){return{restrict:"E",scope:{isOpen:"=",warningMessage:"=",headerTitle:"=",operation:"=",isDelete:"=?"},templateUrl:"/s3/partials/bucketconfirmationmodal.html",controller:"BucketConfirmationModalController"}});angular.module("s3").controller("BucketConfirmationModalController",["$scope","$timeout","$filter","BucketPropertiesService","OperationDispatcherService","S3Constants",function(b,e,f,d,g,c){b.confirmationModal={bucketName:undefined};function a(){b.isDelete=false;b.showIncorrectBucketError=false;b.confirmationModal={bucketName:undefined};b.isOpen.flag=false}e(function(){angular.element("#deletebucket-input input").focus()});b.closeConfirmationModal=function(){a()};b.compareBucketNames=function(h){if(h&&h.keyCode===c.KEY_CODES.ENTER){b.showIncorrectBucketError=_.trim(b.confirmationModal.bucketName)!==b.operation.initialBucket?true:false}};b.saveOperation=function(){d.getBucketVersioning(b.operation.initialBucket,b.operation).then(function(h){b.operation.additionalInfo={numberOfKeysPerBulkOperation:c.BULK_OPERATION_KEYS_PER_REQUEST.S3_API,versioning:h};if(_.trim(b.confirmationModal.bucketName)===b.operation.initialBucket){g.addOperation(b.operation);a()}else{b.showIncorrectBucketError=true}})["catch"](function(h){b.errorMessage=h})}}])})();"use strict";(function(){angular.module("s3").directive("emptyState",[function(){return{restrict:"E",scope:{type:"=",openModal:"=",oneIntroImage:"=?"},templateUrl:"/s3/partials/emptystate.html",controller:"EmptyStateController"}}]);angular.module("s3").controller("EmptyStateController",["$scope","AwsUrlsService","S3Constants",function(a,c,b){a.getLearnMoreLink=function(d){return c.getDocUrl(b.LEARN_MORE_LINKS[a.type][d])}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("updateObject",function(){return{restrict:"E",scope:{showOperation:"=",defaultEncryptionEnabled:"=",fetchObjects:"=",currentMarker:"@?",defaultValue:"@?",operation:"=",defaultPlaceholder:"@?",resetSelection:"="},templateUrl:"/s3/partials/updateobject.html",controller:"UpdateObjectController"}});angular.module("s3").controller("UpdateObjectController",["$document","$filter","$q","$scope","$timeout","$translate","APIProxyService","CachingService","ConsoleOperation","CopyService","FACService","PathService","S3Constants","SCLogService","UtilService",a]);function a(v,l,t,n,u,p,r,e,j,h,g,d,m,c,w){var o;n.encryptionConstants=m.BUCKET_PROPERTIES.DEFAULT_ENCRYPTION;n.encryptionOptions=(o={},_defineProperty(o,n.encryptionConstants.NONE,{apiValue:n.encryptionConstants.API_PARAMS.NONE,value:n.encryptionConstants.NONE,text:p.instant("sse.defaultencryption.none")}),_defineProperty(o,n.encryptionConstants.AES256,{apiValue:n.encryptionConstants.API_PARAMS.AES256,value:n.encryptionConstants.AES256,description:p.instant("bucketproperties.defaultencryption.aes256description"),text:n.encryptionConstants.AES256}),_defineProperty(o,n.encryptionConstants.AWSKMS,{apiValue:n.encryptionConstants.API_PARAMS.AWSKMS,value:n.encryptionConstants.AWSKMS,description:p.instant("bucketproperties.defaultencryption.kmsdescription"),text:n.encryptionConstants.AWSKMS}),o);n.showEncryptionModal=false;if(n.operation.name==="CreateFolder"){g.isRegionalFeatureEnabled(m.FAC.DEFAULT_ENCRYPTION).then(function(x){n.showEncryptionModal=x})}n.updateObject={errorMessage:undefined,name:n.defaultValue||""};n.shouldDisableSave=function(){if(n.defaultEncryption.encryption===n.encryptionConstants.AWSKMS){if(!n.defaultEncryption.kmsId){return true}else{if(n.defaultEncryption.kmsId.value===m.OBJECT_SSE.CUSTOM_ARN){return _.get(n.defaultEncryption,"customKMSARN.length")===0||n.updateObject.name.length===0}}}return n.updateObject.name.length===0};n.previousName=n.defaultValue;var q=n.operation.name;n.triggerAction=function(x){x.stopPropagation();switch(q){case"CreateFolder":b();break;case"Rename":i();break}};if(!n.defaultEncryption){n.defaultEncryption={customKMSARN:"",encryption:n.encryptionConstants.NONE,kmsId:null}}u(function(){angular.element(document).find(".new-folder-input input").focus()});n.resetOperationState=function(x,y){e.resetLocationAndMarkers();n.fetchObjects(false,false);if(x){x.stopPropagation()}n.showOperation=false;switch(q){case"CreateFolder":f();break;case"Rename":s();n.resetSelection();break}n.operation=null};n.triggerKeyboardEvt=function(x){if(x&&x.keyCode===m.KEY_CODES.ENTER){n.triggerAction(x)}};function b(){var x=n.operation;var B="createFolder";var A=x.initialBucket;var y=x.initialPath;var z=_.get(n.updateObject,"name");if(z.indexOf(m.DELIMITER)!==-1){n.updateObject.errorMessage=p.instant("createfolder.input.errormessage.includesSlash")}else{if(z===""){f()}else{c.log("checkFolderExists",1,x);r.getObjectMetadata(x,A,""+y+z+"/").then(function(){n.updateObject.errorMessage=p.instant("createfolder.input.errormessage.exists",{name:z})})["catch"](function(C){if(C.status===m.HTTP_STATUS_CODES.NOT_FOUND){var D={};if(n.showEncryptionModal){if(n.defaultEncryption.encryption!==n.encryptionConstants.NONE){D[m.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]=n.encryptionOptions[n.defaultEncryption.encryption].apiValue;if(n.defaultEncryption.encryption===n.encryptionConstants.AWSKMS){D[m.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]=n.defaultEncryption.kmsId.value===n.encryptionConstants.CUSTOM_ARN?n.defaultEncryption.customKMSARN:n.defaultEncryption.kmsId.value}}}else{D[m.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]=m.OBJECT_SSE.AES256}D[m.HEADERS.CONTENT_TYPE]=m.DIRECTORY_CONTENT_TYPE;r.putObject(n.operation,A,y,z,D).then(function(){c.log(B,1,x,{name:z});n.resetOperationState()},function(E){c.log(B,0,x,E);n.updateObject.errorMessage=p.instant("createfolder.input.errormessage.generic",{name:z})})}else{c.log(B,0,x,C);n.updateObject.errorMessage=p.instant("createfolder.input.errormessage.generic",{name:z})}})}}}function f(){n.updateObject.name=n.defaultValue||"";n.updateObject.errorMessage=""}function i(){var x="renameObject";var y=n.operation,A=false,z=n.updateObject.name;if(!_.isEmpty(z)){if(!y.selectedFolders||y.selectedFolders&&y.selectedFolders.length===0){if(z.indexOf(m.DELIMITER)!==-1){n.updateObject.errorMessage=p.instant("renameobject.input.errormessage.includesSlash")}else{h.startClipboardOperation(true,{name:z});y.defer.promise.then(function(){c.log(x,1,y,{name:z,isFolder:A});e.evictBucketObjects(d.getCurrentBucket());n.resetOperationState()},function(){c.log(x,0,y,{name:z,isFolder:A});n.updateObject.errorMessage=p.instant("renameobject.input.errormessage.generic",{name:z})})}}}}function s(){n.updateObject.errorMessage=""}function k(){n.kmsKeys=[];var A=new j("GetKMSKeysForDefaultEncryption"),z={},y=t.defer(),x=!n.forCreateBucketModal?d.getCurrentBucket():"";r.getKmsKeys(A,x,z,n.region).then(function(C){var B=C.response.Keys;c.log("GetKMSKeys",1,A);angular.forEach(B,function(D,E){n.kmsKeys.push({value:D.KeyId,text:w.getKmsKeyAlias(D)})});n.kmsKeys.push({value:m.OBJECT_SSE.CUSTOM_ARN,text:p.instant("objectproperties.kms.customarn")});y.resolve()})["catch"](function(B){n.KMSServiceError=w.handleErrors(B);n.sseError=w.handleErrors(B);c.log("GetKMSKeys",0,A,B);y.reject(B)})}n.updateKMSKey=function(x){if(x===n.encryptionConstants.AWSKMS){k()}else{if(!_.isEmpty(n.sseError)&&n.sseError===n.KMSServiceError){n.sseError=null}n.KMSServiceError=null}}}})();"use strict";(function(){angular.module("s3").directive("storageManagement",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/storagemanagement.html",controller:"StorageManagementController"}}]);angular.module("s3").controller("StorageManagementController",["$scope","S3Constants","UtilService",function(b,c,a){b.S3Constants=c;b.viewId={value:c.MANAGEMENT.VIEWS.LIFECYCLE};var d=[c.MANAGEMENT.VIEWS.ANALYTICS,c.MANAGEMENT.VIEWS.CLOUDWATCH];b.showView=function(f){b.viewId.value=f;var e=$(".storage-management-container"),g="wideview";if(d.indexOf(f)>-1){e.addClass(g)}else{e.removeClass(g)}};b.viewEnabled=function(e){return b.viewId.value===e};b.displayCRRV2=a.CRRFACHandle().v2}])})();"use strict";(function(){angular.module("s3").controller("StorageMetricsController",["$anchorScroll","$routeParams","$scope","$translate","AwsUrlsService","Region","S3Constants","StorageMonitoringService","UtilService",function(l,j,p,q,a,d,o,c,v){p.deepLinks=[];var b=60;var n=60*b;var k={MINUTE:b,QUARTER_HOUR:15*b,HALF_HOUR:30*b,HOUR:60*b,QUARTER_DAY:6*n,HALF_DAY:12*n,DAY:24*n};var u=n*1000;var h={H1:u,H3:3*u,H12:12*u,H24:24*u,D3:3*24*u,W1:7*24*u,W2:7*2*24*u};var r={H1:q.instant("management.metrics.period.minute.one"),H3:q.instant("management.metrics.period.hour.quarter"),H12:q.instant("management.metrics.period.hour.half"),H24:q.instant("management.metrics.period.hour.one"),D3:q.instant("management.metrics.period.day.quarter"),W1:q.instant("management.metrics.period.day.half"),W2:q.instant("management.metrics.period.day.one"),Count:q.instant("management.metrics.unit.count"),Bytes:q.instant("management.metrics.unit.bytes"),Milliseconds:q.instant("management.metrics.unit.milliseconds")};var t={H1:k.MINUTE,H3:k.QUARTER_HOUR,H12:k.HALF_HOUR,H24:k.HOUR,D3:k.QUARTER_DAY,W1:k.HALF_DAY,W2:k.DAY};var m={H1:"1H",H3:"3H",H12:"12H",H24:"1D",D3:"3D",W1:"7D",W2:"14D"};p.statistic=p.statistic?p.statistic:"Average";p.timestamp=p.timestamp?p.timestamp:"Timestamp";function f(w){var x="";angular.forEach(w,function(A){var y=A.Name;var z=A.Value;x+="~'"+y+"~'"+z});return x}function e(w){var x="";angular.forEach(w,function(z,y){x+=z.Name;if(y!==w.length-1){x+=","}});return x}function s(w,B,y){var A=g();var x="#"+A+":graph=~(view~'timeSeries~stacked~false~start~'-P<start>~end~'P0D~region~'<region>~metrics~(~(~'AWS*2fS3~'<metric-name>";var z=a.getConsoleServiceUrl("cloudwatch",w.region,"")+x;var D="))~period~<period>~stat~'<statistic>);namespace=<namespace>;dimensions=";D+=e(w.Dimensions);var E=z+f(w.Dimensions)+D;var C=E.replace(new RegExp("<region>","g"),w.region);C=C.replace("<metric-name>",w.MetricName).replace("<namespace>",w.Namespace).replace("<period>",B).replace("<start>",m[y]).replace("<statistic>",w.statistic);return C}function g(){var w=v.getCloudSystem();var x=w===d.DOMAINS.ISO.NAME||w===d.DOMAINS.GOV.NAME?"metrics":"metricsV2";return x}p.getAllMetricData=function(w){var x=h[w];var y=t[w];p.deepLinks=[];angular.forEach(p.metricList,function(z){p.deepLinks.push(s(z,y,w));c.requestMetricStatistics(z,x,z.statistic,y).then(function(A){z.error="";z.chartId=z.MetricName;z.heading=z.MetricName;z.chartId="s3_"+z.chartId;if(z.statistics&&z.statistics.Datapoints&&z.statistics.Datapoints.length>0){z.heading+=" ("+i(z,w)+")"}angular.forEach(z.Dimensions,function(B){z.chartId+="_"+B.Value.replaceAll(".","_")})})["catch"](function(A){z.error=q.instant("management.metrics.data.error",{name:z.MetricName,message:v.handleErrors(A)})})})};function i(y,z){var w=y.statistics.Datapoints[0];var x="";switch(w.Unit){case o.METRICS.UNIT.COUNT:case o.METRICS.UNIT.BYTES:x+=r[w.Unit]+" / "+r[z];break;case o.METRICS.UNIT.MILLIS:x+=r[o.METRICS.UNIT.MILLIS];break;default:x+=w.Unit.toLowerCase()}return x}p.getChartLabels=function(w){var x=[];angular.forEach(w.Dimensions,function(y){if(y.Name!=="BucketName"){x.push(y.Value)}});return x};p.$watch("zoom",function(x,w){if(x!==w){p.getAllMetricData(x)}});p.$watch("metricList",function(x,w){if(x!==w){p.getAllMetricData(p.zoom)}});p.getAllMetricData(p.zoom)}]);angular.module("s3").directive("metricsMonitoring",[function(){return{scope:{metricList:"=",zoom:"=",statistic:"=?",timestamp:"=?"},templateUrl:"/s3/partials/storagemetrics.html",controller:"StorageMetricsController"}}])})();"use strict";(function(){angular.module("s3").service("StorageMonitoringService",["$q","$routeParams","CloudWatchService","BucketPropertiesService","S3Constants","SCLogService",function(a,f,e,d,b,c){this.requestMetricsList=function(i){var j=f[b.PATH_SEGMENTS.BUCKET_NAME];var h=[];return d.getBucketLocation(j).then(function(k){angular.forEach(i,function(n,m){var o={Namespace:"AWS/S3","Dimensions.member.1.Name":"BucketName","Dimensions.member.1.Value":j,"Dimensions.member.2.Name":n.Name};if(n.Value){o["Dimensions.member.2.Value"]=n.Value}var l=e.listMetrics({region:k,params:o});l.then(function(p){var q=p.response.ListMetricsResponse.ListMetricsResult.Metrics;angular.forEach(q,function(r){r.region=k});c.log("ListMetrics",1);return q})["catch"](function(p){c.log("ListMetrics",0,{err:p});return a.reject(p)});h.push(l)});return a.all(h).then(function(l){var m=[];angular.forEach(l,function(n){var o=n.response.ListMetricsResponse.ListMetricsResult.Metrics;m=m.concat(o)});return m})["catch"](function(l){return a.reject(l)})})};this.requestMetricStatistics=function(k,h,j,o){var i=new Date();var l=new Date(i-h);var n={MetricName:k.MetricName,Namespace:k.Namespace,StartTime:l.toISOString(),EndTime:i.toISOString(),Period:o,"Statistics.member.1":j};var m=g(k.Dimensions);n=_.extend(n,m);return e.getMetricStatistics({region:k.region,params:n}).then(function(p){k.statistics=p.response.GetMetricStatisticsResponse.GetMetricStatisticsResult;k.period=o;k.endTime=i.getTime();k.startTime=l.getTime();c.log("GetMetricStatistics",1);return k})["catch"](function(p){c.log("GetMetricStatistics",0,p);return a.reject(p)})};function g(h){var i={};h.forEach(function(k,j){i["Dimensions.member."+(j+1)+".Name"]=k.Name;i["Dimensions.member."+(j+1)+".Value"]=k.Value});return i}}])})();"use strict";(function(){angular.module("s3").directive("cloudwatchMetrics",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/cloudwatch.html",controller:"CloudwatchMetricsController"}}]);angular.module("s3").controller("CloudwatchMetricsController",["$anchorScroll","$route","$routeParams","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","ConsoleOperation","PathService","S3Constants","SCLogService","StorageMonitoringService","UtilService","XMLParser",function(m,s,k,v,C,x,y,b,t,e,u,d,g,E,F){var j="Prefix",f="Tag";var z=u.MANAGEMENT.ACTION;var B="EntireBucket";var A=new t(u.OPERATION_NAME.METRICS_GET_CONFIG);v.bucketName=k[u.PATH_SEGMENTS.BUCKET_NAME];v.metricsLoading=true;v.metrics={};v.timestamp="Timestamp";v.xScaleBy=1000;v.selectedTimeFrame="W2";v.selectedMetricGroup="";v.selectedMetricType=u.METRICS.TYPE.STORAGE;v.selectedMetricLink="";v.S3Constants=u;v.error="";m.yOffset=100;v.bucketRegion=e.getCurrentBucket();v.validFilter=false;v.filterList=[];v.bucketFilterList=[];v.models={filterName:null,filterValue:null,filterError:null,savingFilter:false,applyingConfig:false,showAddFilter:false,editFilter:false,configLoading:true,toggleMetricsConfig:false,searchText:"",bucketChecked:true,allFilters:false,updatedOn:null,addInfoMessage:false,deleteFilter:false};v.filters={input:"",prefixFilters:[],tagFilters:[]};v.metricTypes={storage:{id:u.METRICS.TYPE.STORAGE,group:x.instant("management.metric.type.storage"),title:x.instant("management.metric.type.title.storage"),disable:true,checked:true,state:true,info:x.instant("management.metrics.cost.free"),dimension:"StorageType",metrics:[{name:"BucketSizeBytes",display:x.instant("management.metric.type.display.storage.size"),selected:true,statistic:"Average"},{name:"NumberOfObjects",display:x.instant("management.metric.type.display.storage.count"),selected:true,statistic:"Average"}]},requests:{id:u.METRICS.TYPE.REQUESTS,group:x.instant("management.metric.type.requests"),title:x.instant("management.metric.type.title.requests"),disable:false,checked:false,state:false,info:x.instant("management.metrics.cost.paid"),dimension:"FilterId",metrics:[{name:"GetRequests",display:"GET",selected:true,statistic:"Sum"},{name:"PutRequests",display:"PUT",selected:true,statistic:"Sum"},{name:"ListRequests",display:"LIST",selected:true,statistic:"Sum"},{name:"AllRequests",display:"ALL",selected:true,statistic:"Sum"},{name:"PostRequests",display:"POST",selected:true,statistic:"Sum"},{name:"DeleteRequests",display:"DELETE",selected:true,statistic:"Sum"},{name:"HeadRequests",display:"HEAD",selected:true,statistic:"Sum"},{name:"4xxErrors",display:x.instant("management.metric.type.display.requests.errors4xx"),selected:true,statistic:"Sum"},{name:"5xxErrors",display:x.instant("management.metric.type.display.requests.errors5xx"),selected:true,statistic:"Sum"}]},data:{id:u.METRICS.TYPE.DATA,group:x.instant("management.metric.type.data"),title:x.instant("management.metric.type.title.data"),disable:false,checked:false,state:false,info:x.instant("management.metrics.cost.paid"),dimension:"FilterId",metrics:[{name:"TotalRequestLatency",display:x.instant("management.metric.type.display.data.total"),selected:true,statistic:"Average"},{name:"FirstByteLatency",display:x.instant("management.metric.type.display.data.first"),selected:true,statistic:"Average"},{name:"BytesDownloaded",display:x.instant("management.metric.type.display.data.uploaded"),selected:true,statistic:"Sum"},{name:"BytesUploaded",display:x.instant("management.metric.type.display.data.downloaded"),selected:true,statistic:"Sum"}]}};v.checkAllPaidMetrics=function(I){angular.forEach(v.metricTypes,function(J){if(I.id!==u.METRICS.TYPE.STORAGE&&J.id!==u.METRICS.TYPE.STORAGE&&I.id!==J.id){J.checked=I.checked}})};v.viewAllFilters=function(){angular.forEach(v.filterList,function(I){I.checked=v.models.allFilters});v.getCloudwatchMetrics()};v.filterKeyDown=function(I){if(I&&I.keyCode===u.KEY_CODES.ESC){$(".input-field").blur();v.models.searchText=""}};function l(){var I={prefixes:[],tags:[]};angular.forEach(v.filters.prefixFilters,function(J){I.prefixes.push({Prefix:J})});angular.forEach(v.filters.tagFilters,function(J){I.tags.push({Tag:{Key:J.tagKey,Value:J.tagVal}})});return I}v.getGroupTitle=function(I){return v.metricTypes[I].group};v.getLearnMoreLink=function(I){return b.getDocUrl(u.LEARN_MORE_LINKS["storage-management"][I])};function D(J){var I=J.Filter;if(I){if(!I.And){if(I.Prefix){v.filters.prefixFilters.push(I.Prefix)}else{if(I.Tag){v.filters.tagFilters.push({tagKey:I.Tag.Key,tagVal:I.Tag.Value})}}}else{angular.forEach(I.And,function(L,K){if(K===j){v.filters.prefixFilters.push(L)}if(K===f){L=[].concat(L);angular.forEach(L,function(M){v.filters.tagFilters.push({tagKey:M.Key,tagVal:M.Value})})}})}}}v.configureMetrics=function(){if(v.models.toggleMetricsConfig){v.cancelMetricsConfig()}else{v.models.toggleMetricsConfig=!v.models.toggleMetricsConfig}};v.addFilter=function(I){if(!v.models.showAddFilter){v.models.filterNameError="";v.models.filterValueError="";if(I){E.analyticsTrackClick(u.ANALYTICS.MANAGEMENT.EDIT_CONFIG,u.ANALYTICS.MANAGEMENT.METRICS.CONTEXT);v.models.filterName=I.Id;v.models.editFilter=true;D(I)}else{E.analyticsTrackClick(u.ANALYTICS.MANAGEMENT.ADD_CONFIG,u.ANALYTICS.MANAGEMENT.METRICS.CONTEXT);v.models.filterName="";v.models.filterValue=""}v.models.showAddFilter=true;if(!v.models.editFilter){C(function(){angular.element("#cloudwatch-filterinput input").focus()})}}};v.validateFilter=function(K){var J=true;if(!K){K=l()}v.models.filterNameError="";v.models.filterValueError="";if(!v.models.filterName){return false}else{v.models.filterName=v.models.filterName.trim()}if(!u.MANAGEMENT.FILTER_NAME_REGEX.test(v.models.filterName)){v.models.filterNameError=x.instant("management.config.filtername.error.format");J=false}if(v.filters.input){v.models.filterValueError=x.instant("management.config.filtervalue.error.format",{text:v.filters.input});J=false}if(!v.models.editFilter){var I=_.filter(v.filterList,function(L){return L.Id===v.models.filterName});if(I.length>0){v.models.filterNameError=x.instant("management.metrics.side.filter.error.dup");J=false}}return J};v.cancelFilter=function(){if(!v.models.editFilter){E.analyticsTrackClick(u.ANALYTICS.MANAGEMENT.CANCEL_CONFIG,u.ANALYTICS.MANAGEMENT.METRICS.CONTEXT)}v.models.showAddFilter=false;v.models.editFilter=false;v.models.filterError=false;h()};v.refresh=function(){v.getCloudwatchMetrics()};v.goToChart=function(I){v.selectedMetricLink=I;m(I)};v.setMetricGroup=function(I){v.selectedMetricGroup=I};v.setTimeRange=function(I){E.analyticsTrackClick(u.ANALYTICS.MANAGEMENT.METRICS.PERIOD[I],u.ANALYTICS.MANAGEMENT.METRICS.CONTEXT);v.selectedTimeFrame=I};v.setSelectedMetricType=function(I){E.analyticsTrackClick(u.ANALYTICS.MANAGEMENT.METRICS.TYPE[I],u.ANALYTICS.MANAGEMENT.METRICS.CONTEXT);v.selectedMetricType=I;v.getCloudwatchMetrics()};v.filterChanged=function(I,J){if(J){J.stopPropagation()}I.checked=!I.checked;if(!I.checked){v.models.allFilters=false}v.getCloudwatchMetrics()};function H(){var I=v.metricTypes[v.selectedMetricType].dimension;var J=[];if(v.selectedMetricType===u.METRICS.TYPE.STORAGE){J.push({Name:I,Value:null})}else{if(v.models.bucketChecked){angular.forEach(v.bucketFilterList,function(K){J.push({Name:I,Value:K.Id})})}angular.forEach(v.filterList,function(K){if(K.checked){J.push({Name:I,Value:K.Id})}})}return J}v.getCloudwatchMetrics=function(){var I=H();v.info="";v.error="";if(I.length>0){g.requestMetricsList(I).then(function(J){v.metrics[v.selectedMetricType]=c(J);if(J.length===0){v.info=x.instant("management.metrics.notavailable",{type:v.metricTypes[v.selectedMetricType].group})}else{v.info="";v.error=""}})["catch"](function(J){v.error=x.instant("management.metrics.error",{message:E.handleErrors(J)})})["finally"](function(){v.metricsLoading=false;v.models.updatedOn=x.instant("management.metrics.updatedon",{time:new Date().toLocaleString()})})}else{if(v.models.bucketChecked&&!v.metricTypes.requests.state){v.info=x.instant("management.metrics.not.enabled")}else{v.info=x.instant("management.metrics.not.selected")}v.metrics[v.selectedMetricType]=c([]);v.metricsLoading=false;v.models.updatedOn=x.instant("management.metrics.updatedon",{time:new Date().toLocaleString()})}};function c(J){var K=[];var L=v.metricTypes[v.selectedMetricType];var I=_.groupBy(J,function(M){return M.MetricName});v.metricsWithStats=[];angular.forEach(L.metrics,function(M){if(I[M.name]){K=K.concat(I[M.name]);v.metricsWithStats.push({display:M.display,ref:I[M.name][0]});angular.forEach(I[M.name],function(N){N.statistic=M.statistic})}});return K}function o(I){v.models[I]=true;h();v.bucketFilterList=[];v.filterList=[];G(I)}function G(I){var J=arguments.length<=1||arguments[1]===undefined?null:arguments[1];var K={};if(J){angular.extend(K,{params:{"continuation-token":J}})}y.getBucketProperty(A,v.bucketName,"metrics",K,false).then(function(Q){var L=Q.response;d.log("getBucketMetrics",1,A);var P=F.convertXmlStringToJson(L);var M=P.ListMetricsConfigurationsResult;var O=M.MetricsConfiguration;var N=[];if(O){N=E.transformObjectToArray(O)}v.bucketFilterList=v.bucketFilterList.concat(_.filter(N,function(R){return R.Id===B}));v.filterList=v.filterList.concat(_.filter(N,function(R){if(R.Id!==B||R.Id===B&&R.Filter){R.checked=v.models.allFilters;return true}return false}));if(M.IsTruncated==="true"){G(I,M.NextContinuationToken)}else{n();v.getCloudwatchMetrics();w(I)}})["catch"](function(L){d.log("getBucketMetrics",0,A);w(I);p(I,L)})}function n(){v.models.editFilter=false;v.metricTypes.requests.checked=v.bucketFilterList.length>0;v.metricTypes.requests.state=v.metricTypes.requests.checked;v.metricTypes.data.checked=v.metricTypes.requests.checked;v.metricTypes.data.state=v.metricTypes.data.checked}function h(){v.models.filterName="";v.filters.input="";v.filters.tagFilters=[];v.filters.prefixFilters=[]}function w(I){v.models[I]=false;if(I===z.SAVING_FILTER||I===z.DELETE_FILTER){v.models.showAddFilter=false;v.models.filterError=""}if(I===z.APPLYING_CONFIG){v.models.toggleMetricsConfig=false}v.filters.input="";v.filters.tagFilters=[];v.filters.prefixFilters=[]}v.deleteFilter=function(){if(!v.models.deleteFilter||!v.models.savingFilter){var I={params:{id:v.models.filterName}};i(I,z.DELETE_FILTER)}};v.applyMetricsConfig=function(){if(v.metricTypes.requests.checked){var K={params:{id:B}};var J={},I=undefined;J.MetricsConfiguration={};J.MetricsConfiguration.Id=B;I=F.jsonToXml(J);r(I,K,z.APPLYING_CONFIG)}else{angular.forEach(v.bucketFilterList,function(L){var M={params:{id:L.Id}};i(M,z.APPLYING_CONFIG)})}};v.cancelMetricsConfig=function(){v.metricTypes.requests.checked=v.metricTypes.requests.state;v.metricTypes.data.checked=v.metricTypes.requests.state;v.models.toggleMetricsConfig=false};v.saveFilter=function(){if(!v.models.savingFilter&&!v.models.deleteFilter){var I=l();v.models.filterError="";if(v.validateFilter(I)){(function(){var L={params:{id:v.models.filterName}};var K={},J=undefined;K.MetricsConfiguration={};K.MetricsConfiguration.Id=v.models.filterName;if(I.tags.length+I.prefixes.length){K.MetricsConfiguration.Filter={};if(I.tags.length>1||I.tags.length+I.prefixes.length>1){K.MetricsConfiguration.Filter.And={};if(I.tags.length>0){K.MetricsConfiguration.Filter.And.Tag=[];angular.forEach(I.tags,function(N){var M=N.Tag;return K.MetricsConfiguration.Filter.And.Tag.push(M)})}if(I.prefixes.length>0){K.MetricsConfiguration.Filter.And.Prefix=[];angular.forEach(I.prefixes,function(N){var M=N.Prefix;return K.MetricsConfiguration.Filter.And.Prefix.push(M)})}}else{if(I.prefixes.length>0){K.MetricsConfiguration.Filter=I.prefixes[0]}if(I.tags.length>0){K.MetricsConfiguration.Filter.Tag=I.tags[0].Tag}}}J=F.jsonToXml(K);r(J,L,z.SAVING_FILTER)})()}}};function r(L,K,I){var J=new t(u.OPERATION_NAME.METRICS_PUT_CONFIG);v.models[I]=true;L=q(L);if(I===z.SAVING_FILTER){v.filterError=""}E.analyticsTrackClick(u.ANALYTICS.MANAGEMENT.SAVE_CONFIG,u.ANALYTICS.MANAGEMENT.METRICS.CONTEXT);y.putBucketProperty(J,v.bucketName,"metrics",L,K).then(function(N){var M=N.response;d.log("putBucketMetrics",1,J);o(I);v.models.addInfoMessage=true})["catch"](function(M){d.log("putBucketMetrics",0,J);p(I,M);v.models[I]=false})}function i(K,I){var J=new t(u.OPERATION_NAME.METRICS_DELETE_CONFIG);if(I===z.SAVING_FILTER||I===z.DELETE_FILTER){v.models.filterError=""}E.analyticsTrackClick(u.ANALYTICS.MANAGEMENT.DELETE_CONFIG,u.ANALYTICS.MANAGEMENT.METRICS.CONTEXT);v.models[I]=true;y.deleteBucketProperty(J,v.bucketName,"metrics",K).then(function(M){var L=M.response;d.log("deleteBucketMetrics",1,J);o(I)})["catch"](function(L){d.log("deleteBucketMetrics",0,J);p(I,L);v.models[I]=false})}function p(I,J){if(I===z.SAVING_FILTER){v.models.filterError=E.handleErrors(J)}else{v.error=E.handleErrors(J)}}function q(I){return I.replace("<MetricsConfiguration>",'<MetricsConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">')}v.cloudwatchLinkClicked=function(){E.analyticsTrackClick(u.ANALYTICS.MANAGEMENT.METRICS.CLOUDWATCH_LINK,u.ANALYTICS.MANAGEMENT.METRICS.CONTEXT)};v.searchClicked=function(){E.analyticsTrackClick(u.ANALYTICS.MANAGEMENT.SEARCH_CONFIG,u.ANALYTICS.MANAGEMENT.METRICS.CONTEXT)};function a(){o(z.CONFIG_LOADING)}a()}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("bucketReports",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/bucketreports.html",controller:"ReportsController"}}]);angular.module("s3").controller("ReportsController",["$filter","$q","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPolicyService","BucketPropertiesUtilService","ConsoleOperation","FAC","InventoryConstants","ManagementDataProcessor","ManagementUtilService","PathService","Region","S3Constants","SCLogService","UtilService","XMLParser",function(G,a,p,C,w,J,z,g,D,f,R,o,h,l,E,s,Q,j,t,H){var O,M;var n=Q.BUCKET_PROPERTIES;var L=Q.ENTRY_STATE;var B=Q.LEARN_MORE_LINKS;p.finishedLoading=false;p.selectingBucket={selected:false};p.exampleEmptyReport=m();p.flags={displayDelayWarning:false};p.customARN=Q.OBJECT_SSE.CUSTOM_ARN;p.awsKMS=Q.OBJECT_SSE.KMS_ENCRYPTION;p.reportFormat=[[o.REPORT_FORMAT.CSV,w.instant("report.csv.info")],[o.REPORT_FORMAT.ORC,w.instant("report.orc.info")]];p.policyStatus={policyMessage:"",policyHeader:"",policyType:"info",policyDefinition:""};p.kmsPolicyStatus={policyMessage:"",policyHeader:"",policyDefinition:""};var F="-";function i(){M=E.getCurrentBucket();O=new f("GetBuckets");p.showAdvancedSettingsDropdown=true;p.rowBeingEdited=null;p.headerTitle=w.instant("report.label.new");p.isAdding=false;p.isSaving=false;p.radioValue={value:0};p.selectedRowIndex=-1;p.selectedRow=null;p.showError=false;p.isEditingRow=false;p.regions=s.regionMapping;p.reportsTable=[];p.lastExports={};if(!p.bucketList){p.bucketList=[]}p.configPattern=new RegExp("^[a-zA-Z0-9-_.]+$");p.freqTypes=[{value:n.REPORTS.FREQUENCY.DAILY,text:w.instant("report.freq.daily")},{value:n.REPORTS.FREQUENCY.WEEKLY,text:w.instant("report.freq.weekly")}];p.versionTypes=[{value:n.REPORTS.VERSIONING.ALL,text:w.instant("report.versions.all")},{value:n.REPORTS.VERSIONING.CURRENT,text:w.instant("report.versions.current")}];p.encryption=[[Q.OBJECT_SSE.AES256,w.instant("sse.aes256")]];if(R.isFeatureEnabled(Q.FAC.NO_ENC)){var U=[Q.OBJECT_SSE.NONE,w.instant("sse.none")];p.encryption.unshift(U)}if(R.isFeatureEnabled(Q.FAC.KMS)){var T=[Q.OBJECT_SSE.KMS_ENCRYPTION,w.instant("sse.aws.kms")];p.encryption.push(T);e()}p.inventoryEncryptionLink=z.getDocUrl(B.INVENTORY_ENCRYPTION);r()}function e(){var T=a.defer();p.kmsKeys=[];var V=new f("GetKMSKeysForInventoryReport");var U={};J.getKmsKeys(V,M,U).then(function(X){var W=X.response.Keys;j.log("GetKMSKeys",1,V);angular.forEach(W,function(Y,Z){p.kmsKeys.push({value:Y.KeyArn,text:t.getKmsKeyAlias(Y)})});p.kmsKeys.push({value:Q.OBJECT_SSE.CUSTOM_ARN,text:w.instant("objectproperties.kms.customarn")});T.resolve()})["catch"](function(W){p.KMSServiceError=t.handleErrors(W);j.log("GetKMSKeys",0,V,W);T.reject()});return T.promise}p.getLearnMoreLink=function(T){return z.getDocUrl(B["storage-management"][T])};p.toggleAdvancedSettingsDropdown=function(){p.showAdvancedSettingsDropdown=!p.showAdvancedSettingsDropdown};function m(){return{name:"",type:n.REPORTS.TYPE.OBJECT,filter:"",bucket:"",format:"",prefix:"",freq:n.REPORTS.FREQUENCY.DAILY,versioning:n.REPORTS.VERSIONING.CURRENT,status:n.REPLICATION.DISABLED,isEditing:true,state:L.CREATE,optional:S(),accountId:null,bucketError:false,nameError:false,encryption:{type:Q.OBJECT_SSE.NONE}}}function K(T){if(!T){return{type:Q.OBJECT_SSE.NONE}}else{if(T[o.SSE_S3]){return{type:Q.OBJECT_SSE.AES256}}else{if(T[o.SSE_KMS]){var U=T[o.SSE_KMS].KeyId;if(U){return{type:Q.OBJECT_SSE.KMS_ENCRYPTION,kmsOption:{kmsId:{text:U}}}}else{return{type:Q.OBJECT_SSE.NONE}}}}}}function A(V){var U=m();U.name=V.Id;U.freq=V.Schedule.Frequency.toUpperCase();U.bucket=D.stripBucketARN(V.Destination.S3BucketDestination.Bucket);U.encryption=K(V.Destination.S3BucketDestination.Encryption);if(V.Filter){U.filter=V.Filter.Prefix}if(V.Destination.S3BucketDestination.Prefix){U.prefix=V.Destination.S3BucketDestination.Prefix}if(V.Destination.S3BucketDestination.Format){U.format=V.Destination.S3BucketDestination.Format}if(V.Destination.S3BucketDestination.AccountId){U.accountId=V.Destination.S3BucketDestination.AccountId}U.isEditing=false;if(V.OptionalFields&&V.OptionalFields.Field){var T=[].concat(V.OptionalFields.Field);T.forEach(function(W){U.optional[W]=true})}if(V.IncludedObjectVersions===n.REPORTS.VERSIONING.CURRENT){U.versioning=V.IncludedObjectVersions}else{U.versioning=n.REPORTS.VERSIONING.ALL}return U}function P(V){var T=V.InventoryConfiguration;if(T){var U=[].concat(T);U.forEach(function(W){p.reportsTable.push(A(W))})}}function r(U){var T=new f("getObjectInventory");j.log("getObjectInventoryReceived",1,T);var V={path:M};if(U){V.params={"continuation-token":U}}J.getObjectInventory(T,M,V).then(function(aa){var X=aa.response;j.logRequestComplete("getObjectInventory",T);if(X){var Z=H.convertXmlStringToJson(X);P(Z.ListInventoryConfigurationsResult);var W=Z.ListInventoryConfigurationsResult.IsTruncated==="true";if(W){var Y=Z.ListInventoryConfigurationsResult.NextContinuationToken;r(Y)}else{if(p.reportsTable.length>0){p.radioValue.value=0;p.selectedRowIndex=0}c(M);p.finishedLoading=true}}})["catch"](function(W){if(W){x(W)}})["finally"](function(){p.finishedLoading=true})}p.validatePrefix=function(){var T=p.rowBeingEdited;p.filterInfo="";p.prefixInfo="";if(T.filter&&T.filter.indexOf(Q.DELIMITER)===0){p.filterInfo=T.filter;p.bucketName=M}if(T.prefix&&T.prefix.indexOf(Q.DELIMITER)===0){p.prefixInfo=T.prefix;p.bucketNamePre=T.bucket}};p.validateName=function(U){var T=_.countBy(p.reportsTable,function(V){return V.name===U.name?"dups":"unique"});U.invalidNameMessage="";if(T.dups>1){U.invalidNameMessage=w.instant("report.name.error.duplicate")}else{if(U.name.length<1||U.name.length>64){U.invalidNameMessage=w.instant("report.name.error.length")}else{if(!p.configPattern.test(U.name)){U.invalidNameMessage=w.instant("report.name.error.characters")}}}if(U.invalidNameMessage){U.nameError=true}else{U.nameError=false}};p.validateForm=function(T){p.validateName(T);if(T.bucket){T.bucketError=false}else{T.bucketError=true}T.hasErrors=T.nameError||T.bucketError;return !T.hasErrors};p.selectRow=function(T){if(p.isEditingRow){p.radioValue.value=p.selectedRowIndex}else{if(p.completeEdit()){p.selectedRowIndex=T;p.radioValue.value=T}}p.flags.displayDelayWarning=false};p.closeAddReport=function(T){y();if(T){if(p.rowBeingEdited.state===L.CREATE){p.rowBeingEdited.state=L.ADDED}}p.isExpanded=false;p.rowBeingEdited=null};p.deletePressed=function(){if(p.radioValue.value.length===0){return}var U=p.reportsTable[p.selectedRowIndex];var T=_.findIndex(p.reportsTable,function(V){return V.name===U.name});if(T!==-1&&q(p.reportsTable[T])){p.reportsTable.splice(T,1);p.radioValue.value="";p.selectedRowIndex=-1}t.analyticsTrackClick(Q.ANALYTICS.MANAGEMENT.DELETE_CONFIG,Q.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT);p.flags.displayDelayWarning=false;p.resetPolicyStatus()};p.cancelPressed=function(T){T.stopPropagation();t.analyticsTrackClick(Q.ANALYTICS.MANAGEMENT.CANCEL_CONFIG,Q.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT);v(p.reportsTable[p.selectedRowIndex]);if(p.isAdding){p.selectedRowIndex--;p.isAdding=false;p.reportsTable.shift()}else{p.reportsTable[p.selectedRowIndex]=p.tempRow;p.tempRow=null}p.radioValue.value=p.selectedRowIndex;p.completeEdit(false);p.isEditingRow=false;p.rowBeingEdited.isEditing=false;p.showAdvancedSettingsDropdown=false;p.closeAddReport(false);p.radioValue.value=p.selectedRowIndex};p.successAddHandler=function(){if(p.isAdding){p.selectedRowIndex=0;p.radioValue.value=p.selectedRowIndex;p.isAdding=false}};p.successSaveHandler=function(){p.isEditingRow=false;p.showAdvancedSettingsDropdown=false};p.reportFormatSelected=function(U,T){U.format=T};p.encryptionSelected=function(U,T){U.encryption.type=T};p.savePressed=function(T){T.stopPropagation();p.isSaving=true;t.analyticsTrackClick(Q.ANALYTICS.MANAGEMENT.SAVE_CONFIG,Q.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT);var V=null;if(p.isAdding){V=p.reportsTable[0]}else{V=p.reportsTable[p.selectedRowIndex]}p.validateForm(V);if(V.hasErrors||V.bucketUnknown){p.isSaving=false;return}var U=false;if(p.isAdding){U=true}p.saveReport(V,U);p.radioValue.value=p.selectedRowIndex};function q(T){var U=new f("deleteObjectInventoryConfig");J.deleteObjectInventoryConfig(U,M,{path:M,params:{id:T.name}}).then(function(V){j.logRequestComplete("deleteObjectInventoryConfig",U);p.isEditingRow=false;p.showAdvancedSettingsDropdown=false})["catch"](function(V){x(V);j.log("deleteObjectInventoryConfig",0,U,{objectName:T,error:V});return false});return true}function u(T){if(T.length===0){return}else{if(T.length===1){return T.charAt(0).toUpperCase()}else{return T.charAt(0).toUpperCase()+T.substr(1).toLowerCase()}}}function d(U){var V=Q.OBJECT_SSE.NONE;switch(U.encryption.type){case Q.OBJECT_SSE.AES256:V=_defineProperty({},o.SSE_S3,"");break;case Q.OBJECT_SSE.KMS_ENCRYPTION:var T=_.get(U,"encryption.kmsOption.kmsId.text");if(_.get(U,"encryption.kmsOption.kmsId.value")===Q.OBJECT_SSE.CUSTOM_ARN){T=_.get(U,"encryption.kmsOption.kmsARN")}V=_defineProperty({},o.SSE_KMS,{KeyId:T});break}return V}function b(U){var T={};T.Format=U.format||n.REPORTS.FORMAT.CSV;if(U.accountId){T.AccountId=U.accountId}T.Bucket=t.getBucketARN(U.bucket);if(U.prefix.length>0){T.Prefix=U.prefix}var V=d(U);if(V!==Q.OBJECT_SSE.NONE){T.Encryption=d(U)}return{S3BucketDestination:T}}function k(U){var T=U.optional;var V=[];if(T.Size){V.push("Size")}if(T.LastModifiedDate){V.push("LastModifiedDate")}if(T.StorageClass){V.push("StorageClass")}if(T.ETag){V.push("ETag")}if(T.ReplicationStatus){V.push("ReplicationStatus")}if(T.IsMultipartUploaded){V.push("IsMultipartUploaded")}if(T.EncryptionStatus){V.push("EncryptionStatus")}return V}function I(U){var T={};T.Id=U.name;T.IsEnabled="true";if(U.filter.length>0){T.Filter={Prefix:U.filter}}T.Destination=b(U);T.Schedule={Frequency:u(U.freq)};T.IncludedObjectVersions=U.versioning;T.OptionalFields={Field:k(U)};return T}function N(T){return'<?xml version="1.0" encoding="UTF-8"?><InventoryConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">'+T+"</InventoryConfiguration>"}p.saveReport=function(T,W){var U=new f("putObjectInventoryConfig");var X=I(T);var V=N(H.jsonToXml(X));j.log("putObjectInventoryConfigReceived",1,U);J.putObjectInventoryConfig(U,M,{path:M,params:{id:T.name},content:V}).then(function(Y){j.logRequestComplete("putObjectInventoryConfig",U);p.isSaving=false;p.rowBeingEdited.isEditing=false;if(!W&&T.name!==p.tempRow.name){q(p.tempRow)}else{p.successAddHandler();p.closeAddReport(true);p.successSaveHandler()}p.flags.displayDelayWarning=true;g.createBucketPolicy(M,T.bucket,p.policyStatus);return true})["catch"](function(Y){j.log("putObjectInventoryConfig",0,U,{objectName:T,error:Y});x(Y);return false});return true};function x(T){p.showError=true;p.errorMessage=t.handleErrors(T);p.isSaving=false}function y(){p.showError=false}p.completeEdit=function(T){var U=p.rowBeingEdited;if(!U){return true}else{v(U);if(U.name!==""&&!U.invalidNameMessage&&U.bucket!==""){return true}else{if(U.state===L.CREATE&&U.name===""&&U.bucket===""&&U.filter===""&&U.prefix===""){return true}else{if(T&&U.state===L.CREATE){return false}if(U.name===""){U.nameError=true}if(U.bucket===""){U.bucketError=true}return false}}}};function v(T){if(T){T.nameError=false;T.bucketError=false}}function S(){return{Size:null,LastModifiedDate:null,StorageClass:null,ETag:null,ReplicationStatus:null,IsMultipartUploaded:null,EncryptionStatus:null}}p.addRow=function(U){U.stopPropagation();if(p.completeEdit()){t.analyticsTrackClick(Q.ANALYTICS.MANAGEMENT.ADD_CONFIG,Q.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT);p.isAdding=true;p.isExpanded=true;var T=m();p.reportsTable.unshift(T);p.rowBeingEdited=T;p.selectedRowIndex++;p.radioValue.value=false;p.isEditingRow=true;p.showAdvancedSettingsDropdown=true;p.prefixInfo="";p.filterInfo="";p.resetPolicyStatus();C(function(){angular.element("#report-name-input input").focus()})}p.flags.displayDelayWarning=false};p.editRow=function(U){U.stopPropagation();p.showAdvancedSettingsDropdown=true;var T=p.selectedRowIndex;var V=p.reportsTable[T];t.analyticsTrackClick(Q.ANALYTICS.MANAGEMENT.EDIT_CONFIG,Q.ANALYTICS.MANAGEMENT.INVENTORY.CONTEXT);if(V){p.tempRow=JSON.parse(JSON.stringify(V))}if(p.completeEdit()){V.isEditing=true;p.rowBeingEdited=p.reportsTable[p.selectedRowIndex];p.isEditingRow=true}p.flags.displayDelayWarning=false;p.radioValue.value=false;p.resetPolicyStatus()};p.getPrefixValue=function(T){if(T.length===0){return F}else{return T}};p.getFrequencyTranslationValue=function(T){switch(T){case n.REPORTS.TYPE.OBJECT:return w.instant("report.type.object");case n.REPORTS.FREQUENCY.DAILY:return w.instant("report.freq.daily");case n.REPORTS.FREQUENCY.WEEKLY:return w.instant("report.freq.weekly")}};function c(T){h.retrieveInventoryStatus(T,p.reportsTable).then(function(U){_.each(U,function(V){if(V.status===Q.S3_SHARED_DATA.FAILED){p.lastExports[V.name]={displayText:w.instant("management.inventory.data.exporterror."+V.errorCode.toLowerCase()),status:V.status,tooltipMessage:w.instant("management.inventory.data.exportstatus."+V.errorCode.toLowerCase(),{date:V.lastExportDate})}}else{if(V.status===Q.S3_SHARED_DATA.SUCCESS){p.lastExports[V.name]={displayText:V.lastExportDate,status:V.status}}}})})}p.getLastExportTooltipMessage=function(T){if(T in p.lastExports){return p.lastExports[T].tooltipMessage}else{return""}};p.getLastExportInfo=function(T){if(T in p.lastExports){return p.lastExports[T].displayText}else{return""}};p.hasLastExportFailed=function(T){if(T in p.lastExports){return p.lastExports[T].status===Q.S3_SHARED_DATA.FAILED}return false};p.getFilterValue=function(T){return T||w.instant("report.filter.bucket")};p.resetDelayWarning=function(){p.flags.displayDelayWarning=false};p.resetPolicyStatus=function(){p.policyStatus={policyMessage:"",policyHeader:"",policyDefinition:"",policyType:"info"};p.kmsPolicyStatus={policyMessage:"",policyHeader:"",policyDefinition:""}};p.shouldDisableSave=function(W){var V=W.encryption.type===Q.OBJECT_SSE.KMS_ENCRYPTION,T=undefined;if(V){T=!_.isEmpty(_.get(W,"encryption.kmsOption.kmsId"));if(_.get(W,"encryption.kmsOption.kmsId.value")===Q.OBJECT_SSE.CUSTOM_ARN){T=!_.isEmpty(_.get(W,"encryption.kmsOption.kmsARN"))}}var U=V?T:true;return W.nameError||!W.bucket||W.bucketError||p.selectingBucket.selected||W.bucketUnknown||!U};p.encryptionStatusClicked=function(T,U){T.stopPropagation();U.encryption.type=Q.OBJECT_SSE.AES256};i()}])})();"use strict";(function(){angular.module("s3").directive("barChartCard",[function(){return{restrict:"E",controller:"BarChartController",scope:{width:"=?",height:"=?",chartTitle:"=",data:"=",labels:"=?",colors:"=?",maxValue:"=?",footer:"=?"},link:function a(b){b.$watch("data",function(c){if(c){b.generateChart()}})},templateUrl:"/s3/partials/barchartcard.html"}}]);angular.module("s3").controller("BarChartController",["$scope","$window","$element","UtilService",function(g,a,h,d){var i=a.d3;g.width=g.width||270;g.height=g.height||205;var c=g.maxValue;var e=0.94;g.generateChart=function(){var p=10;var o,j=25,s=j*g.data.length;f();var l=[];for(var m=0;m<g.data.length;m++){var n=m%g.colors.bars.length;var k=g.colors.bars[n];l.push({id:m,color:k,value:g.data[m]})}if(i.select(h[0].children[0].children[1])){i.select(h[0].children[0].children[1]).select("svg").remove()}o=i.select(h[0].children[0].children[1]).append("svg").attr("class","chart").attr("width",g.width*e).attr("height",s);var r=i.scale.linear().domain([0,c]).range([0,g.width*e]);var q=i.scale.ordinal().domain(l.map(function(t){return t.id})).rangeBands([0,s]);o.selectAll("rect").data(l).enter().append("svg:rect").attr("y",function(t){return q(t.id)}).attr("width",function(t){return r(t.value)}).attr("height",j-p).attr("fill",function(t){return t.color});o.selectAll("text").data(l).enter().append("svg:text").attr("x",function(t){return r(t.value)}).attr("y",function(t){return q(t.id)+q.rangeBand()/2}).attr("dx",3).attr("text-anchor","start").text(function(t){return d.formatWithUnits(t.value)}).attr("fill",function(t){return t.color})};function b(){if(!c){c=i.max(g.data)}if(!g.units){g.units=""}if(!g.colors){if(!g.colors.bars){g.colors.bars=["blue"]}if(!g.colors.row){g.colors.row="green"}}if(!g.row){g.row={};if(!g.row.color){g.row.color="blue"}}c/=0.75}function f(){c=g.maxValue;c/=0.75}b()}])})();"use strict";function _toConsumableArray(a){if(Array.isArray(a)){for(var c=0,b=Array(a.length);c<a.length;c++){b[c]=a[c]}return b}else{return Array.from(a)}}(function(){angular.module("s3").directive("objectFrequencyAnalytics",[function(){return{restrict:"E",scope:{data:"=",storageClass:"="},controller:"ObjectFrequencyAnalyticsController",templateUrl:"/s3/partials/objectfrequencyanalytics.html",link:function a(b){b.$watch("storageClass.value",function(d,c){if(d!==c){b.processData()}})}}}]);angular.module("s3").controller("ObjectFrequencyAnalyticsController",["$scope","$translate","APIProxyService","ConsoleOperation","ManagementDataProcessor","S3Constants","UtilService",function(p,q,r,k,u,o,x){var e=[["0-14","000-014"],["15-29","015-029"],["30-44","030-044"],["45-59","045-059"],["60-74","060-074"],["75-89","075-089"],["90-119","090-119"],["120-149"],["150-179"],["180-364"],["365-729"],["730+"]];var f={};var j=o.ANALYTICS.STORAGE_CLASS.STANDARD;p.objectTypes=[];var t="#7394CB";var d="#9066A7";p.barColors=[t,d];p.frequentColor="green";p.infrequentColor="orange";p.emptyColor="gray";var b=q.instant("storageanalysis.footer.text.frequent");var s=q.instant("storageanalysis.footer.text.infrequent");var h=q.instant("storageanalysis.footer.text.move");var l=q.instant("storageanalysis.footer.text.empty");p.width=310;p.height=210;p.labels=[q.instant("storageanalysis.label.storage"),q.instant("storageanalysis.label.dataRetrieved")];function a(){if(p.data){c();p.titles=[];p.titles.push(q.instant("storageanalysis.title.15"));p.titles.push(q.instant("storageanalysis.title.30"));p.titles.push(q.instant("storageanalysis.title.45"));p.titles.push(q.instant("storageanalysis.title.60"));p.titles.push(q.instant("storageanalysis.title.75"));p.titles.push(q.instant("storageanalysis.title.90"));p.titles.push(q.instant("storageanalysis.title.120"));p.titles.push(q.instant("storageanalysis.title.150"));p.titles.push(q.instant("storageanalysis.title.180"));p.titles.push(q.instant("storageanalysis.title.365"));p.titles.push(q.instant("storageanalysis.title.730"));p.titles.push(q.instant("storageanalysis.title.730plus"));v()}}function v(){if(p.data&&p.data.rows){p.objectTypes=x.getStorageClassOptions(p.data.classes);p.daysAnalyzed=p.data.rows.length;p.processData()}}p.processData=function(){m();n()};function c(){angular.forEach(e,function(z,A){angular.forEach(z,function(B){f[B]=A})})}function y(z){var A=parseInt(z,10);if(isNaN(A)){throw"Passed in date range is not a number"}if(A===-1){return -1}else{if(A<15){return 0}else{if(A<30){return 1}else{if(A<45){return 2}else{if(A<60){return 3}else{if(A<75){return 4}else{if(A<90){return 5}else{if(A<120){return 6}else{if(A<150){return 7}else{if(A<180){return 8}else{if(A<365){return 9}else{if(A<730){return 10}else{return 11}}}}}}}}}}}}}function g(){var A=[];for(var z=0;z<e.length;z++){A.push(0)}return A}function w(B,z,A){angular.forEach(B.stats,function(D){var E=D.storageClass.toUpperCase()===p.storageClass.value;var F=D.objectAge in f;if(E&&F){var C=f[D.objectAge];z[C]+=D[A]}})}function i(A,z){angular.forEach(A,function(C,B){A[B]*=z})}function n(){var z,A;var B=p.data.rows;var D=g();var C=g();angular.forEach(B,function(E){w(E,D,"storage");w(E,C,"dataRetrieved")});i(D,1/B.length);i(C,1/B.length);p.storage=D;p.dataRetrieved=C;p.maxValue=Math.max((z=Math).max.apply(z,_toConsumableArray(p.storage)),(A=Math).max.apply(A,_toConsumableArray(p.dataRetrieved)))}function m(){var C=p.data.all[p.storageClass.value];p.frequencyTypes=[];if(C.length>0){var D=C[C.length-1].row;var A="";if(D.recommendedAgeTransition.length>0){A=y(D.recommendedAgeTransition)}for(var B=0;B<e.length;B++){if(p.storageClass.value!==j){p.frequencyTypes.push({title:"",text:"",color:p.emptyColor});continue}var F=b;var z=p.frequentColor;var E="";if(A===""){F=l;z=p.emptyColor}else{if(B>=A&&A>=0){F=s;E=h;z=p.infrequentColor}}p.frequencyTypes.push({title:F,text:E,color:z})}}}a()}])})();"use strict";(function(){angular.module("s3").directive("analytics",[function(){return{restrict:"E",scope:{viewId:"="},templateUrl:"/s3/partials/analytics.html",controller:"AnalyticsController"}}]);angular.module("s3").controller("AnalyticsController",["$anchorScroll","$route","$routeParams","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPolicyService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","FAC","ManagementDataProcessor","PathService","QuicksightService","S3Constants","SCLogService","StorageMonitoringService","UtilService","XMLParser",a]);function a(I,z,X,o,H,B,S,E,f,L,J,e,Z,h,K,t,Y,j,F,y,P){var s="Prefix",r="Tag";var D=Y.MANAGEMENT.ACTION;var Q=Y.ANALYTICS.STORAGE_CLASS;var A=3600*1000*24;var p=undefined;o.bucketName=K.getCurrentBucket();o.allData={};o.metrics={};o.selectedMetricType=Y.METRICS.TYPE.STORAGE;o.S3Constants=Y;o.selectedFilter=null;o.selectedFilterTmp=null;o.quicksightLink=null;o.validFilter=false;o.filterList=[];o.stdSize=B.instant("storage.size.zero.default");o.stdRet=B.instant("storage.size.zero.default");o.stdiaSize=B.instant("storage.size.zero.default");o.stdiaRet=B.instant("storage.size.zero.default");o.stdDate="";o.stdiaDate="";o.startedOn=O(new Date());o.updatedOn=O(new Date());o.recommendation=null;o.numDays=0;o.selectedStorageClass={value:Q.STANDARD};o.percentageGraphId="percentageGraphId";o.percentageGraphHeading="";o.percentageXMin=new Date().getTime()-A;o.percentageXMax=new Date().getTime();o.percentageGraphXValue="timestamp";o.percentageGraphYValue="percentage";o.storageAreaChartId="storageVsDataTransferId";o.xmin=null;o.xmax=null;o.graphData={area:[],percentage:[]};o.storageOptions=null;o.exportFilterInfo={bucket:{},prefix:""};o.exportFailed=false;o.policyStatus={policyMessage:"",policyHeader:"",policyType:"info",policyDefinition:""};o.models={filterName:null,filterValue:null,filterError:null,savingFilter:false,applyingConfig:false,showAddFilter:false,editFilter:false,configLoading:true,toggleAnalyticsConfig:false,searchText:"",bucketChecked:false,allFilters:false,updatedOn:null,analyzingData:false,dataLoading:true,error:"",deleteFilter:false};o.filters={input:"",prefixFilters:[],tagFilters:[]};o.metricTypes={storage:{id:Y.METRICS.TYPE.STORAGE,group:B.instant("management.analytics.type.analysis"),title:B.instant("management.analytics.type.analysis"),disable:false,checked:false,state:false,recommendation:-1,info:B.instant("management.metrics.cost.paid"),dimension:"StorageType",metrics:[{name:"BucketSizeBytes",display:B.instant("management.metric.type.display.storage.size"),selected:true},{name:"NumberOfObjects",display:B.instant("management.metric.type.display.storage.count"),selected:true}]}};o.filterKeyDown=function(aa){if(aa&&aa.keyCode===Y.KEY_CODES.ESC){$(".input-field").blur();o.models.searchText=""}};function N(){var aa={prefixes:[],tags:[]};angular.forEach(o.filters.prefixFilters,function(ab){aa.prefixes.push({Prefix:ab})});angular.forEach(o.filters.tagFilters,function(ab){aa.tags.push({Tag:{Key:ab.tagKey,Value:ab.tagVal}})});return aa}o.getGroupTitle=function(aa){return o.metricTypes[aa].group};function x(ab){var aa="";if(ab){if(!ab.And){if(ab.Prefix){aa+=ab.Prefix}else{if(ab.Tag){aa+=ab.Tag.Key+" | "+ab.Tag.Value}}}else{angular.forEach(ab.And,function(ad,ac){if(ac===s){aa+=ad+" | "}if(ac===r){ad=[].concat(ad);angular.forEach(ad,function(af,ae){aa+=af.Key+"="+af.Value;if(ae!==ad.length-1){aa+=" | "}})}});aa=aa.replace(/\|$/,"")}}else{aa=" "}return aa}o.addFilter=function(aa){if(!o.models.showAddFilter){c();o.models.filterNameError="";o.models.filterValueError="";if(aa){y.analyticsTrackClick(Y.ANALYTICS.MANAGEMENT.EDIT_CONFIG,Y.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT);o.models.editFilter=true;G(aa);o.selectedFilterTmp=aa;o.selectedFilter=aa}else{y.analyticsTrackClick(Y.ANALYTICS.MANAGEMENT.ADD_CONFIG,Y.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT);o.models.filterName="";o.models.filterValue=""}o.models.showAddFilter=true;o.resetPolicyStatus();if(!o.models.editFilter){H(function(){angular.element("#get-filter-name input").focus()})}}};o.validateFilter=function(){var ab=true;o.models.filterNameError="";o.models.filterValueError="";if(!o.models.filterName){return false}else{o.models.filterName=o.models.filterName.trim()}if(!Y.MANAGEMENT.FILTER_NAME_REGEX.test(o.models.filterName)){o.models.filterNameError=B.instant("management.config.filtername.error.format");ab=false}if(o.filters.input){o.models.filterValueError=B.instant("management.config.filtervalue.error.format",{text:o.filters.input});ab=false}if(!o.models.editFilter){var aa=_.filter(o.filterList,function(ac){return ac.Id===o.models.filterName});if(aa.length>0){o.models.filterNameError=B.instant("management.metrics.side.filter.error.dup");ab=false}}return ab};o.goToLifecycleTab=function(){o.viewId.value=Y.MANAGEMENT.VIEWS.LIFECYCLE};o.cancelFilter=function(){if(!o.models.editFilter){y.analyticsTrackClick(Y.ANALYTICS.MANAGEMENT.CANCEL_CONFIG,Y.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT)}o.models.showAddFilter=false;o.models.editFilter=false;o.models.filterError=false;o.selectedFilterTmp=null};o.filterChanged=function(aa,ab){if(o.selectedFilter===aa){return}if(ab){ab.stopPropagation()}if(aa){u();if(o.selectedFilter){o.selectedFilter.checked=false;o.selectedFilter=aa;o.selectedFilter.checked=true}else{o.selectedFilter=aa;o.selectedFilter.checked=true}M()}};o.getLearnMoreLink=function(aa){return E.getDocUrl(Y.LEARN_MORE_LINKS["storage-management"][aa])};function u(){o.cancelFilter();o.cancelMetricsConfig();o.allData.data={};o.graphData.area=[];o.graphData.percentage=[];o.stdSize=B.instant("storage.size.zero.default");o.stdRet=B.instant("storage.size.zero.default");o.stdiaSize=B.instant("storage.size.zero.default");o.stdiaRet=B.instant("storage.size.zero.default");o.stdDate="";o.stdiaDate="";o.startedOn=O(new Date());o.updatedOn=O(new Date());o.numDays=0;o.recommendation=null;o.selectedStorageClass={value:Q.STANDARD};o.percentageGraphId="percentageGraphId";o.percentageGraphHeading="";o.percentageXMin=new Date().getTime()-A;o.percentageXMax=new Date().getTime();o.percentageGraphXValue="timestamp";o.percentageGraphYValue="percentage";o.storageOptions=null;o.xmax=new Date().getTime();o.xmin=o.xmax-30*A;o.exportFailed=false}o.setSelectedMetricType=function(aa){o.selectedMetricType=aa};function n(aa){o.models[aa]=true;c();o.startedOn=O(new Date());o.updatedOn=O(new Date());o.filterList=[];if(aa===D.DELETE_FILTER){if(o.selectedFilterTmp===o.selectedFilter){o.selectedFilterTmp=null;o.selectedFilter=null}else{o.selectedFilterTmp=null}}return L.getBucketLocation(o.bucketName).then(function(ab){o.bucketRegion=ab;T(aa)})["catch"](function(ab){l(aa);U(aa,ab)})}function T(aa){var ab=arguments.length<=1||arguments[1]===undefined?null:arguments[1];var ac=new e(Y.OPERATION_NAME.ANALYTICS_GET_CONFIG),ad={};if(ab){angular.extend(ad,{params:{"continuation-token":ab}})}S.getBucketProperty(ac,o.bucketName,"analytics",ad,false).then(function(ai){var ae=ai.response;j.log(Y.OPERATION_NAME.ANALYTICS_GET_CONFIG,1,ac);var af=P.convertXmlStringToJson(ae);var ah=af.ListBucketAnalyticsConfigurationsResult;var ag=[];if(ah&&ah.AnalyticsConfiguration){ag=y.transformObjectToArray(ah.AnalyticsConfiguration)}angular.forEach(ag,function(aj){if(o.selectedFilterTmp&&o.selectedFilterTmp.Id===aj.Id){o.selectedFilterTmp=aj;aj.checked=true}else{aj.checked=false}if(o.selectedFilter&&o.selectedFilter.Id===aj.Id){o.selectedFilter=aj;aj.checked=true}aj.filterText=x(aj.Filter)});o.filterList=o.filterList.concat(ag);if(ah.IsTruncated==="true"){T(aa,ah.NextContinuationToken)}else{w();l(aa)}})["catch"](function(ae){j.log(Y.OPERATION_NAME.ANALYTICS_GET_CONFIG,0,ac);l(aa);U(aa,ae)})}function w(){if(!o.selectedFilter&&!o.selectedFilterTmp){if(o.filterList.length>0){o.filterList[0].checked=true;o.selectedFilterTmp=o.filterList[0]}}else{if(o.selectedFilter===o.selectedFilterTmp){o.selectedFilter=null}}o.models.editFilter=false;o.filterChanged(o.selectedFilterTmp)}function G(ac){var aa=o.exportFilterInfo;if(ac.StorageClassAnalysis&&ac.StorageClassAnalysis.DataExport&&ac.StorageClassAnalysis.DataExport.Destination&&ac.StorageClassAnalysis.DataExport.Destination.S3BucketDestination){var ab=ac.StorageClassAnalysis.DataExport.Destination.S3BucketDestination;if(ab.Prefix){aa.prefix=ab.Prefix}if(ab.BucketAccountId){aa.bucket.accountId=ab.BucketAccountId}if(ab.Bucket){aa.bucket.bucket=J.stripBucketARN(ab.Bucket)}}o.models.filterName=ac.Id;o.models.filterValue=ac.filterText}function c(){o.models.filterName="";o.filters.input="";o.filters.tagFilters=[];o.filters.prefixFilters=[];o.exportFilterInfo={bucket:{},prefix:""}}function l(aa){o.models[aa]=false;if(aa===D.SAVING_FILTER||aa===D.DELETE_FILTER){o.models.showAddFilter=false;o.models.filterError=""}if(aa===D.APPLYING_CONFIG){o.models.toggleAnalyticsConfig=false}o.filters.tagFilters=[];o.filters.prefixFilters=[]}o.deleteFilter=function(){if(!o.models.deleteFilter&&!o.models.savingFilter){var aa={params:{id:o.models.filterName}};v(aa,D.DELETE_FILTER)}};o.cancelMetricsConfig=function(){o.metricTypes.storage.checked=o.metricTypes.storage.state;o.models.toggleAnalyticsConfig=false};function M(){var ab=new e(Y.OPERATION_NAME.ANALYTICS_GET_DATA),aa=new e(Y.OPERATION_NAME.ANALYTICS_GET_STATUS);o.quicksightLink="";if(o.selectedFilter){(function(){o.models[D.DATA_LOADING]=true;var ac=o.selectedFilter.Id;h.retrieveAnalyticsData(o.bucketName,ac,Y.S3_SHARED_DATA.DATA).then(function(ad){j.log(Y.OPERATION_NAME.ANALYTICS_GET_DATA,1,ab);m(ad);b();h.retrieveAnalyticsData(o.bucketName,ac,Y.S3_SHARED_DATA.STATUS).then(function(ae){j.log(Y.OPERATION_NAME.ANALYTICS_GET_STATUS,1,aa);p={RunDate:ae[0],JobType:ae[1],ConfigId:ae[2],ExportLocation:ae[3],Status:ae[4],ErrorCode:ae[5]};o.exportFailed=p.Status===Y.S3_SHARED_DATA.FAILED;o.selectedFilter.exportFailed=o.exportFailed})["catch"](function(ae){j.log(Y.OPERATION_NAME.ANALYTICS_GET_STATUS,0,aa)})})["catch"](function(ad){j.log(Y.OPERATION_NAME.ANALYTICS_GET_DATA,0,ab);if(ad===Y.ANALYTICS.ERROR.USER_INFO_MISSING){o.models.error=B.instant("management.analytics.data.error.userinfo.missing")}})["finally"](function(ad){o.models[D.DATA_LOADING]=false})})()}else{o.models[D.DATA_LOADING]=false}}function q(){if(o.allData.data.classes){var aa=_.filter(o.allData.data.classes,function(ab){return ab===Q.STANDARD});if(aa.length>0){o.selectedStorageClass.value=Q.STANDARD}else{o.selectedStorageClass.value=o.allData.data.classes[0]}}else{o.selectedStorageClass.value=Q.STANDARD}}function m(ac){if(ac){o.allData.data=ac;q()}if(!o.allData.data.all||!o.allData.data.rows){return}var aa=o.allData.data.all[Q.STANDARD];if(aa&&aa.length>0){var ab=aa[aa.length-1];if(ab.row.recommendation>=0){o.recommendation=ab.row.recommendation;o.selectedFilter.recommendation=o.recommendation}}if(o.allData.data.rows.length>0){o.numDays=C(o.allData.data.rows[0].date);o.startedOn=O(o.allData.data.rows[0].date);o.updatedOn=O(o.allData.data.rows[o.allData.data.rows.length-1].date)}V();W();d()}function W(){if(o.allData.data&&o.allData.data.all[o.selectedStorageClass.value]){var ae=o.allData.data.all[o.selectedStorageClass.value];var aa=[];var ad=ae.length;if(ad>30){var ac=ad-31;for(var ab=ad-1;ab>ac;ab--){aa.push(ae[ab])}ae=aa;o.xmax=aa[0].timestamp;o.xmin=aa[aa.length-1].timestamp}else{if(ad>0){o.xmax=ae[ad-1].timestamp;o.xmin=ae[0].timestamp}else{o.xmax=new Date().getTime();o.xmin=o.xmax-30*A}}o.graphData.area=ae}else{o.graphData.area=[]}}o.$watch("selectedStorageClass.value",function(ab,aa){if(ab!==aa){o.setSelectedStorageClass()}});o.setSelectedStorageClass=function(){y.analyticsTrackClick(Y.ANALYTICS.MANAGEMENT.ANALYTICS.CHANGE_STORAGE_CLASS,Y.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT);m()};function V(){o.storageOptions=y.getStorageClassOptions(o.allData.data.classes)}function d(){var ae=o.allData.data.all[o.selectedStorageClass.value];o.percentageGraphId="percentageGraphId";o.percentageGraphHeading="%";o.percentageXMin=new Date().getTime()-30*A;o.percentageXMax=new Date().getTime();if(ae){var aa=[];var ad=ae.length;if(ad>30){var ac=ae.length-31;for(var ab=ad-1;ab>ac;ab--){aa.push(ae[ab])}ae=aa}o.graphData.percentage=ae}else{o.graphData.percentage=[]}}function C(ab){var ac=24*60*60*1000;var ad=new Date(ab);var aa=new Date();return Math.round(Math.abs((aa.getTime()-ad.getTime())/ac))}function O(ac){var aa=new Date(ac);var ae=aa.getUTCMonth()+1;var ab=aa.getUTCDate();var ad=aa.getUTCFullYear();return ae+"/"+ab+"/"+ad}o.saveFilter=function(){var ab=o.exportFilterInfo;if(!o.models.deleteFilter&&!o.models.savingFilter&&!(!ab.bucket.bucket&&ab.prefix)){var aa=N();o.models.filterError="";if(o.validateFilter(aa)){(function(){var ae={params:{id:o.models.filterName}};var ad={},ac=undefined;ad.AnalyticsConfiguration={};ad.AnalyticsConfiguration.Id=o.models.filterName;if(o.models.editFilter){ad.AnalyticsConfiguration.Filter=o.selectedFilter.Filter}else{if(aa.tags.length+aa.prefixes.length>0){ad.AnalyticsConfiguration.Filter={};if(aa.tags.length>1||aa.tags.length+aa.prefixes.length>1){ad.AnalyticsConfiguration.Filter.And={};if(aa.tags.length>0){ad.AnalyticsConfiguration.Filter.And.Tag=[];angular.forEach(aa.tags,function(ag){var af=ag.Tag;return ad.AnalyticsConfiguration.Filter.And.Tag.push(af)})}if(aa.prefixes.length>0){ad.AnalyticsConfiguration.Filter.And.Prefix=[];angular.forEach(aa.prefixes,function(ag){var af=ag.Prefix;return ad.AnalyticsConfiguration.Filter.And.Prefix.push(af)})}}else{if(aa.prefixes.length>0){ad.AnalyticsConfiguration.Filter=aa.prefixes[0]}if(aa.tags.length>0){ad.AnalyticsConfiguration.Filter.Tag=aa.tags[0].Tag}}}}k(ad);ac=P.jsonToXml(ad);i(ac,ae,D.SAVING_FILTER)})()}}};o.getClassNameTranslation=function(aa){var ab=y.getStorageClassTranslations()[aa];if(!ab){ab=aa.charAt(0)+aa.substring(1).toLowerCase()}return ab};o.getMostRecentTotalSize=function(aa){return y.formatWithUnits(aa[aa.length-1].row.storage)};o.getMostRecentDataRetrieved=function(aa){return y.formatWithUnits(aa[aa.length-1].row.dataRetrieved)};o.getExportFailedStatusText=function(aa){if(p){var ac=p.ErrorCode.toLowerCase(),ab=p.RunDate;var ad=B.instant("management.analytics.data.exportstatus."+ac,{date:ab});return aa?ad.slice(0,52)+"...":ad}};function i(ad,ac,aa){var ab=new e(Y.OPERATION_NAME.ANALYTICS_PUT_CONFIG);o.models[aa]=true;ad=R(ad);if(aa===D.SAVING_FILTER){o.filterError=""}S.putBucketProperty(ab,o.bucketName,"analytics",ad,ac).then(function(af){var ae=af.response;j.log(Y.OPERATION_NAME.ANALYTICS_PUT_CONFIG,1,ab);y.analyticsTrackClick(Y.ANALYTICS.MANAGEMENT.SAVE_CONFIG,Y.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT);n(aa)})["catch"](function(ae){j.log(Y.OPERATION_NAME.ANALYTICS_PUT_CONFIG,0,ab);U(aa,ae);o.models[aa]=false})}function v(ac,aa){var ab=new e(Y.OPERATION_NAME.ANALYTICS_DELETE_CONFIG);if(aa===D.SAVING_FILTER||aa===D.DELETE_FILTER){o.models.filterError=""}y.analyticsTrackClick(Y.ANALYTICS.MANAGEMENT.DELETE_CONFIG,Y.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT);o.models[aa]=true;S.deleteBucketProperty(ab,o.bucketName,"analytics",ac).then(function(ae){var ad=ae.response;j.log(Y.OPERATION_NAME.ANALYTICS_DELETE_CONFIG,1,ab);if(o.selectedFilterTmp===o.selectedFilter){o.selectedFilterTmp=null;o.selectedFilter=null}else{o.selectedFilterTmp=null}n(aa)})["catch"](function(ad){j.log(Y.OPERATION_NAME.ANALYTICS_DELETE_CONFIG,0,ab);U(aa,ad);o.models[aa]=false})}function U(aa,ab){if(aa===D.SAVING_FILTER||aa===D.DELETE_FILTER){o.models.filterError=y.handleErrors(ab)}else{o.models.error=y.handleErrors(ab)}}function k(ac){ac.AnalyticsConfiguration.StorageClassAnalysis="";var ab=o.exportFilterInfo;if(ab.bucket.bucket){var aa=ab.bucket.bucket;ac.AnalyticsConfiguration.StorageClassAnalysis={};ac.AnalyticsConfiguration.StorageClassAnalysis.DataExport={OutputSchemaVersion:"V_1",Destination:{S3BucketDestination:{Format:"CSV",Bucket:y.getBucketARN(aa)}}};if(ab.prefix){ac.AnalyticsConfiguration.StorageClassAnalysis.DataExport.Destination.S3BucketDestination.Prefix=ab.prefix}if(ab.bucket.accountId){ac.AnalyticsConfiguration.StorageClassAnalysis.DataExport.Destination.S3BucketDestination.BucketAccountId=ab.bucket.accountId}f.createBucketPolicy(o.bucketName,aa,o.policyStatus)}}function R(aa){return aa.replace("<AnalyticsConfiguration>",'<?xml version="1.0" encoding="UTF-8"?> <AnalyticsConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">')}o.resetPolicyStatus=function(){o.policyStatus.policyMessage="";o.policyStatus.policyHeader="";o.policyDefinition="";o.policyType="info"};function b(){if(Z.isFeatureEnabled(Y.FAC.QUICKSIGHT_LINK)){o.quicksightLink=t.generateQuicksightLink(o.bucketName,o.selectedFilter,o.bucketRegion)}}o.quicksightLinkClicked=function(){y.analyticsTrackClick(Y.ANALYTICS.MANAGEMENT.ANALYTICS.QUICKSIGHT_LINK,Y.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT)};o.searchClicked=function(){y.analyticsTrackClick(Y.ANALYTICS.MANAGEMENT.SEARCH_CONFIG,Y.ANALYTICS.MANAGEMENT.ANALYTICS.CONTEXT)};function g(){n(D.CONFIG_LOADING)}g()}})();"use strict";(function(){angular.module("s3").directive("analyticsExport",[function(){return{restrict:"E",controller:"AnalyticsExportController",scope:{data:"=",saving:"=",editFilter:"="},templateUrl:"/s3/partials/analysisexport.html"}}]);angular.module("s3").controller("AnalyticsExportController",["$scope","AwsUrlsService","BucketPropertiesService","FACService","PathService","S3Constants","UtilService",function(b,e,d,g,f,c,a){g.isRegionalFeatureEnabled(c.FAC.QUICKSIGHT).then(function(h){b.showQuicksight=h});b.getLearnMoreLink=function(h){return e.getDocUrl(c.LEARN_MORE_LINKS["storage-management"][h])};b.getQuicksightLink=function(){return c.LEARN_MORE_LINKS["storage-management"]["quicksight"]};b.validatePrefix=function(){if(b.data.prefix&&b.data.prefix.indexOf(c.DELIMITER)===0&&b.data.bucket.bucket){b.prefixInfo=b.data.prefix}else{b.prefixInfo=""}}}])})();"use strict";(function(){angular.module("s3").directive("analyticsAreaChart",[function(){return{restrict:"E",scope:{data:"=",width:"=?",height:"=?",bcolor:"=?",tcolor:"=?",chartId:"=",xmin:"=?",xmax:"=?"},controller:"AnalyticsAreaChartController",templateUrl:"/s3/partials/analytics-area-chart.html",link:function a(b){b.$watch("data",function(c){if(c){b.draw()}})}}}]);angular.module("s3").controller("AnalyticsAreaChartController",["$scope","$translate","$window",function(a,c,e){a.labels=[c.instant("storageanalysis.label.storage"),c.instant("storageanalysis.label.dataRetrieved")];var b=e.d3;a.draw=function(){var l=a.data;var j=b.time.format("%m/%d");var s=9;var k={top:10,right:20,bottom:30,left:80},g=(a.width||960)-k.left-k.right,t=(a.height||500)-k.top-k.bottom;l.sort(function(w,v){return b.ascending(w.timestamp,v.timestamp)});var r=b.time.scale().range([0,g]);var p=b.scale.linear().range([t,0]);var h=b.svg.axis().scale(r).orient("bottom").ticks(5).tickFormat(j);var f=b.svg.axis().scale(p).orient("left").ticks(s).tickFormat(d);var u=b.svg.area().x(function(v){return r(v.timestamp)}).y0(t).y1(function(v){return p(v.row.storage)});var i=b.svg.area().x(function(v){return r(v.timestamp)}).y0(t).y1(function(v){return p(v.row.storage+v.row.dataRetrieved)});b.select("#"+a.chartId).selectAll("svg").remove();var m=b.select("#"+a.chartId).append("svg").attr("width",g+k.left+k.right).attr("height",t+k.top+k.bottom).append("g").attr("transform","translate("+k.left+","+k.top+")");if(a.xmin&&a.xmax){r.domain([a.xmin,a.xmax]).nice()}else{r.domain(b.extent(l,function(v){return v.timestamp})).nice()}if(l.length>0){var n=b.extent(l,function(v){return v.row.storage+v.row.dataRetrieved});var o=n[1];var q=o*0.3;if(q===0){if(o!==0){q=o*0.1}else{q=1;s=2;f.ticks(s)}}o+=q;p.domain([0,o]);p.nice([0,o])}else{p.domain([0,5]);p.nice([0,5])}m.append("path").datum(l).attr("class","data-fill").attr("d",i);m.append("path").datum(l).attr("class","storage-fill").attr("d",u);m.append("g").attr("class","x axis").attr("transform","translate(0,"+t+")").call(h);m.append("g").attr("class","y axis").call(f)};var d=function d(g){var f=b.format(".1f");if(g<1024){return f(g)}else{if(g<1024*1024){return f(g/1024)+" KB"}else{if(g<1024*1024*1024){return f(g/1024/1024)+" MB"}else{if(g<1024*1024*1024*1024){return f(g/1024/1024/1024)+" GB"}else{if(g<1024*1024*1024*1024*1024){return f(g/1024/1024/1024/1024)+" TB"}else{return f(g/1024/1024/1024/1024/1024)+" PB"}}}}}}}])})();"use strict";(function(){angular.module("s3").directive("targetmbox",["TargetMediatorScripts",function(a){return{restrict:"E",templateUrl:"/s3/partials/targetmbox.html",scope:{},controller:"TargetMboxController",link:function b(e,d,c){e.$watch(function(){return $(d).find(".js-mbox").css("visibility")},function(f){if(f==="visible"){a.setMBoxContent()}})}}}]);angular.module("s3").controller("TargetMboxController",["$scope","TargetMediatorScripts","InvokeTargetMediator",function(d,b,c){d.scriptsInvoked=c.getScriptCount();if(d.scriptsInvoked>0){var a=b.getMBoxContent();d.mBoxContent=a!==undefined?a:"";d.showDefault=false}else{d.showDefault=true}}]).filter("trusted",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}])})();"use strict";(function(){angular.module("s3").factory("TargetMediatorScripts",["$document","$window","S3Constants",function(e,a,f){function i(j){var k=j!==undefined?j.toLowerCase():"en";return f.TARGET_MEDIATOR.LANGUAGE_MAP[k]||"en"}function g(){return{pageLanguage:i($('meta[property="requestLocale"]').attr("content")),supportedLanguages:f.TARGET_MEDIATOR.SUPPORTED_LANGUAGES,isLoadedAtPageEnd:true}}function b(){var m=document.createElement("noscript");m.innerHTML="<style>.js-mbox { visibility: visible; }</style>";document.body.appendChild(m);var l="var AWS = {};";l+="AWS.TargetMediator = ";l+=JSON.stringify(g())+";";var k=document.createElement("script");k.innerHTML=l;document.body.appendChild(k);var j=document.createElement("script");j.type="text/javascript";j.defer=true;j.src="/s3/lib/target/aws-target-mediator.js";document.body.appendChild(j)}var c;function h(){var j=$("targetmbox").find(".js-mbox");if(j.length){c=j.get(0).innerHTML}else{c=""}}function d(){return c}return{addScripts:b,getLanguage:i,getMediatorObject:g,getMBoxContent:d,setMBoxContent:h}}]);angular.module("s3").factory("InvokeTargetMediator",["$document","TargetMediatorScripts",function(c,b){angular.injector(["ng","s3"]).invoke(function(){b.addScripts()});function a(){var d=$('script[src="/s3/lib/target/aws-target-mediator.js"]');return c.find(d).length}return{getScriptCount:a}}])})();"use strict";(function(){angular.module("s3").directive("bucketAccelerate",[function(){return{restrict:"E",scope:{cardOpen:"=",id:"@?"},templateUrl:"/s3/partials/bucketaccelerate.html",controller:"BucketAccelerateController"}}]);angular.module("s3").controller("BucketAccelerateController",["$scope","$timeout","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","PathService","S3Constants","UtilService",a]);function a(k,c,b,d,e,h,i,g,j){k.accelerateStates={enabled:"Enabled",suspended:"Suspended"};k.accelerate={};k.accelerate.selectedValue=k.accelerateStates.suspended;k.learnMoreLink=d.getDocUrl(g.LEARN_MORE_LINKS.ACCELERATE);k.accelerate.endpoint=""+i.getCurrentBucket()+g.ACCELERATE.ENDPOINT.PUBLIC;k.scrollCardId="#"+k.id;k.cardSummaryObj=_.cloneDeep(g.CARD_SUMMARY_INIT);k.cardSummaryObj.activeSummary.text=b.instant("bucketproperty.acceleration.endpoint");k.cardSummaryObj.inactiveSummary.text=b.instant("bucketproperty.suspended");m();function m(){if(k.accelerate.selectedValue===k.accelerateStates.enabled){k.cardSummaryObj.isActive=true;k.cardSummaryObj.isMultiValue=true;k.cardSummaryObj.activeSummary.value=k.accelerate.endpoint}else{k.cardSummaryObj.isActive=false;k.cardSummaryObj.isMultiValue=false}}function l(){var o=i.getCurrentBucket();var n=new h(g.ANALYTICS.GET_BUCKET_ACCELERATE);k.cardSummaryObj.isLoading=true;k.error=undefined;e.getBucketLocation(o).then(function(p){k.comparisonEndpoint=g.ACCELERATE.COMPARISON_ENDPOINT+"region="+p+"&origBucketName="+o});e.getBucketAccelerate(o,n).then(function(p){if(p===k.accelerateStates.enabled){k.accelerate.selectedValue=k.accelerateStates.enabled}})["catch"](function(p){k.error=j.handleErrors(p)})["finally"](function(){k.cachedAccelerate=angular.copy(k.accelerate);m();k.cardSummaryObj.isLoading=false})}k.cancelBucketAccelerate=function(n){j.analyticsTrackClick(g.ANALYTICS.CANCEL_ACCELERATE,g.ANALYTICS.DETAILS);n.stopPropagation();k.accelerate=angular.copy(k.cachedAccelerate);k.cardSummaryObj.isActive=k.accelerate.selectedValue===k.accelerateStates.enabled;k.error=undefined;k.cardOpen=false};k.saveBucketAccelerate=function(n){j.analyticsTrackClick(g.ANALYTICS.SAVE_ACCELERATE,g.ANALYTICS.DETAILS);n.stopPropagation();k.error=undefined;k.saving=true;e.putBucketAccelerate(i.getCurrentBucket(),new h(g.ANALYTICS.PUT_BUCKET_ACCELERATE),k.accelerate.selectedValue).then(function(){k.cachedAccelerate.selectedValue=angular.copy(k.accelerate.selectedValue);k.cardOpen=false})["catch"](function(o){k.error=o})["finally"](function(){k.saving=false;m()})};function f(){l()}f()}})();"use strict";(function(){angular.module("s3").service("FACService",["$q","BucketPropertiesService","FAC","PathService",a]);function a(c,d,b,e){this.isRegionalFeatureEnabled=function(f,g){if(g){return c.resolve(b.isFeatureEnabled(f+"-"+g))}return d.getBucketLocation(e.getCurrentBucket()).then(function(h){return b.isFeatureEnabled(f+"-"+h)})}}})();"use strict";(function(){angular.module("s3").directive("hint",[function(){return{restrict:"E",templateUrl:"/s3/partials/hint.html",scope:{},controller:"HintController"}}]);angular.module("s3").controller("HintController",["$scope","$interval","$location","$translate","$window","$cookies","ConsoleOperation","Region","S3Constants","SCLogService","UtilService",function(n,h,g,a,d,f,i,o,e,m,k){n.goToOldConsole=function(){var p=new i(e.OPERATION_NAME.SWITCH_BACK_TO_OLD_CONSOLE);m.log(e.OPERATION_NAME.SWITCH_BACK_TO_OLD_CONSOLE,1,p);var q={path:e.OPT_OUT_COOKIE.PATH};if(g.host().indexOf("s3.")!==0){f.put(e.OPT_OUT_COOKIE.COOKIE_KEY,e.OPT_OUT_COOKIE.VALUE[k.getCloudSystem()],q);d.location.reload()}else{d.location.href=d.location.href.replace("s3.","")+"&switchingBackToOldConsole=true"}};n.goToVideo=function(){d.open(e.YOUTUBE_VIDEO_LINK,"_blank")};n.showVideo=function(){var p=o.getCurrentRegion();return e.FALLBACK_REGION_LIST.CN.indexOf(p)===-1&&e.FALLBACK_REGION_LIST.ISO.indexOf(p)===-1};var c=8;var b=10000;var l=0;n.hintMessage=a.instant("hint.message."+l);var j=function j(){l=(l+1)%c;n.hintMessage=a.instant("hint.message."+l)};h(j,b)}])})();angular.module("s3").run(["$templateCache",function(a){a.put("/s3/partials/acl.html",'<awsui-alert visible="access.aclPublic && aclAfterAnalysis" class="block small-top-margin" type="warning" dismissible="false" header="{{ \'bucket.warningheader.granted.AllUsers\' | translate }}">\n    {{ \'world.access.detected.warning\' | translate }}\n</awsui-alert>\n<awsui-radio-group class="permission-radio-group" ng-model="radioSelect.displayName">\n    <div class="manage-grantee-title" translate="permissions.owner"></div>\n    <table class="table">\n        <thead class="table-header">\n        <tr>\n            <th class="grantee-radio"></th>\n            <th class="grantee-header">\n                {{\'permissions.acl.grantee\' | translate}}\n                <awsui-tooltip text="{{ \'permissions.acl.granteeTooltip\' | translate }}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n            <th class="grantee-header"> {{readHeader}}\n                <awsui-tooltip text="{{readTooltip}}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n            <th class="grantee-header" ng-if="isBucketPermission">{{writeHeader}}\n                <awsui-tooltip text="{{writeTooltip}}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n            <th class="grantee-header"> {{readACPHeader}}\n                <awsui-tooltip text="{{readACPTooltip}}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n            <th class="grantee-header"> {{writeACPHeader}}\n                <awsui-tooltip text="{{writeACPTooltip}}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n        </tr>\n        </thead>\n        <tbody class="table-body">\n        <tr ng-repeat="(name, permissions) in permissionObj.grantees.owner" ng-if="permissionObj.owner.DisplayName || permissionObj.owner.ID" class="grantee-row" ng-click="selectGrantee(name, permissions)" ng-class="{\'grantee-selected\': name === selectedGrantee.displayedValue, \'row-hover\' : hoverUser }" ng-mouseenter="hoverUser = true" ng-mouseleave="hoverUser = false">\n            <td ng-click="selectGrantee(name, permissions)">\n                <awsui-radio-button value="{{name}}"></awsui-radio-button>\n            </td>\n            <td>{{name}}</td>\n            <td>\n                <span ng-if="permissions.READ" translate="bucketproperty.yes"></span>\n                <span ng-if="!permissions.READ">-</span>\n            </td>\n            <td ng-if="isBucketPermission">\n                <span ng-if="permissions.WRITE" translate="bucketproperty.yes"></span>\n                <span ng-if="!permissions.WRITE">-</span>\n            </td>\n            <td>\n                <span ng-if="permissions.READ_ACP" translate="bucketproperty.yes"></span>\n                <span ng-if="!permissions.READ_ACP">-</span>\n            </td>\n            <td>\n                <span ng-if="permissions.WRITE_ACP" translate="bucketproperty.yes"></span>\n                <span ng-if="!permissions.WRITE_ACP">-</span>\n            </td>\n            \n            \n        </tr>\n        <tr>\n            <storage-console-config-panel ng-class="{\'side-config-panel acl-side-panel\': panelOpen, \'hide-config-panel acl-side-panel\': panelHide}" panel-open="panelOpen">\n                <header>\n                    <div class="truncate side-panel-header bucket-config-panel-header-image">{{ selectedGrantee.displayedValue }}</div>\n                    <span class="panel-close-icon" ng-click="panelCancel()"></span>\n                    \n                </header>\n                <content>\n                    <div class="permissions-side-panel-content">\n                        <p class="subheader" translate="{{resource.type}}.acl.objectaccess"></p>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ">{{ readHeader }}</awsui-checkbox>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-if="isBucketPermission" ng-model="selectedGrantee.permissions.WRITE">{{ writeHeader }}</awsui-checkbox>\n                        <p class="subheader padding-top-30" translate="{{resource.type}}.acl.permissionsaccess"></p>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ_ACP">{{ readACPHeader }}</awsui-checkbox>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.WRITE_ACP">{{ writeACPHeader }}</awsui-checkbox>\n                    </div>\n                </content>\n                <footer>\n                    <awsui-button variant="primary" text="{{ \'permissions.button.save\' | translate}}" class="awsui-util-f-r primary-button" click="updateGrantee(selectedGrantee)" loading="updatingGrantee"></awsui-button>\n                    <awsui-button variant="normal" text="{{ \'permissions.button.cancel\' | translate}}" class="awsui-util-f-r normal-button" click="panelCancel()"></awsui-button>\n                </footer>\n            </storage-console-config-panel>\n        </tr>\n        </tbody>\n    </table>\n    <div class="manage-grantee-title" translate="permissions.manageusers"></div>\n    <div class="acl-add-new">\n         <awsui-button variant="primary" data-disabled="shouldDisable" text="{{\'permissions.button.addgrantee\'  | translate}}" icon="plus" click="showAddGranteeRow()"></awsui-button>\n         <awsui-button data-disabled="disableDeleteButton() " text="{{\'permissions.button.deletegrantee\'  | translate}}" click="deleteAccountGrantee()"></awsui-button>\n     </div>\n    <table class="table">\n        <thead class="table-header">\n        <tr>\n            <th class="grantee-radio"></th>\n            <th class="grantee-header">\n                {{\'permissions.acl.grantee\' | translate}}\n                <awsui-tooltip text="{{ \'permissions.acl.granteeTooltip\' | translate }}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n            <th class="grantee-header"> {{readHeader}}\n                <awsui-tooltip text="{{readTooltip}}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n            <th class="grantee-header" ng-if="isBucketPermission">{{writeHeader}}\n                <awsui-tooltip text="{{writeTooltip}}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n            <th class="grantee-header"> {{readACPHeader}}\n                <awsui-tooltip text="{{readACPTooltip}}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n            <th class="grantee-header"> {{writeACPHeader}}\n                <awsui-tooltip text="{{writeACPTooltip}}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n        </tr>\n        </thead>\n        <tbody class="table-body">\n        <tr ng-if="isAddGranteeRowDisplayed">\n            <td></td>\n            <td class="add-grantee-options">\n                <awsui-control-group validation-message="{{ granteeList.inputError }}">\n                    <awsui-textfield class="grantee-list" placeholder="{{ \'permissions.addnewgratee.placeholder\' | translate }}" ng-change="resetInputError()" ng-model="granteeList.inputItem"></awsui-textfield>\n                </awsui-control-group>\n\n                <awsui-button id="save-grantee" variant="primary" text="{{ \'permissions.button.save\' | translate }}" class="awsui-util normal-button add-grantee-buttons" data-disabled="!granteeList.inputItem  || (!granteeList.grantPermissions.READ && !granteeList.grantPermissions.WRITE && !granteeList.grantPermissions.READ_ACP && !granteeList.grantPermissions.WRITE_ACP) || granteeList.inputError" click="save()" loading="addingGrantee">\n                </awsui-button>\n                <awsui-button id="cancel-grantee" variant="normal" text="{{ \'permissions.button.cancel\' | translate }}" class="awsui-util normal-button add-grantee-buttons" click="cancel()">\n                </awsui-button>\n            </td>\n            <td class="grantee-checkboxes">\n                <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model="granteeList.grantPermissions.READ">{{ \'bucketproperty.yes\' | translate }}</awsui-checkbox>\n            </td>\n            <td class="grantee-checkboxes" ng-if="isBucketPermission">\n                <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model="granteeList.grantPermissions.WRITE">{{ \'bucketproperty.yes\' | translate }}</awsui-checkbox>\n            </td>\n            <td class="grantee-checkboxes">\n                <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model="granteeList.grantPermissions.READ_ACP">{{ \'bucketproperty.yes\' | translate }}</awsui-checkbox>\n            </td>\n            <td class="grantee-checkboxes">\n                <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model="granteeList.grantPermissions.WRITE_ACP">{{ \'bucketproperty.yes\' | translate }}</awsui-checkbox>\n            </td>\n        </tr>\n        <tr ng-repeat="(name, permissions) in permissionObj.grantees.accounts" class="grantee-row" ng-click="selectGrantee(name, permissions)" ng-class="{\'grantee-selected\': name === selectedGrantee.displayedValue, \'row-hover\' : hoverUser }" ng-mouseenter="hoverUser = true" ng-mouseleave="hoverUser = false">\n            <td ng-click="selectGrantee(name, permissions)">\n                <awsui-radio-button value="{{name}}">\n            <td>{{name}}</td>\n            <td>\n                <span ng-if="permissions.READ" translate="bucketproperty.yes"></span>\n                <span ng-if="!permissions.READ">-</span>\n            </td>\n            <td ng-if="isBucketPermission">\n                <span ng-if="permissions.WRITE" translate="bucketproperty.yes"></span>\n                <span ng-if="!permissions.WRITE">-</span>\n            </td>\n            <td>\n                <span ng-if="permissions.READ_ACP" translate="bucketproperty.yes"></span>\n                <span ng-if="!permissions.READ_ACP">-</span>\n            </td>\n            <td>\n                <span ng-if="permissions.WRITE_ACP" translate="bucketproperty.yes"></span>\n                <span ng-if="!permissions.WRITE_ACP">-</span>\n            </td>\n            </awsui-radio-button>\n            </td>\n        </tr>\n        <tr>\n            <storage-console-config-panel ng-class="{\'side-config-panel acl-side-panel\': panelOpen, \'hide-config-panel acl-side-panel\': panelHide}" panel-open="panelOpen">\n                <header>\n                    <div class="truncate side-panel-header bucket-config-panel-header-image">{{ selectedGrantee.displayedValue }}</div>\n                    <span class="panel-close-icon" ng-click="panelCancel()"></span>\n                    \n                </header>\n                <content>\n                    <div class="permissions-side-panel-content">\n                        <p class="subheader" translate="{{resource.type}}.acl.objectaccess"></p>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ">{{ readHeader }}</awsui-checkbox>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-if="isBucketPermission" ng-model="selectedGrantee.permissions.WRITE">{{ writeHeader }}</awsui-checkbox>\n                        <p class="subheader padding-top-30" translate="{{resource.type}}.acl.permissionsaccess"></p>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ_ACP">{{ readACPHeader }}</awsui-checkbox>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.WRITE_ACP">{{ writeACPHeader }}</awsui-checkbox>\n                    </div>\n                </content>\n                <footer>\n                    <awsui-button variant="primary" text="{{ \'permissions.button.save\' | translate}}" class="awsui-util-f-r primary-button" click="updateGrantee(selectedGrantee)" loading="updatingGrantee"></awsui-button>\n                    <awsui-button variant="normal" text="{{ \'permissions.button.cancel\' | translate}}" class="awsui-util-f-r normal-button" click="panelCancel()"></awsui-button>\n                </footer>\n            </storage-console-config-panel>\n        </tr>\n        </tbody>\n    </table>\n<div class="manage-public-permission-title" translate="permissions.managepublicpermissions"></div>\n<table class="table">\n     <thead class="table-header">\n     <tr>\n         <th class="grantee-radio"></th>\n         <th class="grantee-header">\n             {{\'permissions.acl.group\' | translate}}\n             <awsui-tooltip text="{{ \'permissions.acl.groupTooltip\' | translate }}" position="right" size="small" initialized="true">\n                 <i class="awsui-icon alert-info-circle"></i>\n             </awsui-tooltip>\n         </th>\n         <th class="grantee-header"> {{readHeader}}\n             <awsui-tooltip text="{{readTooltip}}" position="right" size="small" initialized="true">\n                 <i class="awsui-icon alert-info-circle"></i>\n             </awsui-tooltip>\n         </th>\n         <th class="grantee-header" ng-if="isBucketPermission">{{writeHeader}}\n             <awsui-tooltip text="{{writeTooltip}}" position="right" size="small" initialized="true">\n                 <i class="awsui-icon alert-info-circle"></i>\n             </awsui-tooltip>\n         </th>\n         <th class="grantee-header"> {{readACPHeader}}\n             <awsui-tooltip text="{{readACPTooltip}}" position="right" size="small" initialized="true">\n                 <i class="awsui-icon alert-info-circle"></i>\n             </awsui-tooltip>\n         </th>\n         <th class="grantee-header"> {{writeACPHeader}}\n             <awsui-tooltip text="{{writeACPTooltip}}" position="right" size="small" initialized="true">\n                 <i class="awsui-icon alert-info-circle"></i>\n             </awsui-tooltip>\n         </th>\n     </tr>\n     </thead>\n     <tbody class="table-body">\n     \n     <tr ng-repeat="(name, permissions) in permissionObj.grantees.group" ng-click="selectGrantee(name, permissions)" class="grantee-row" ng-class="{\'grantee-selected\': name === selectedGrantee.displayedValue, \'row-hover\': hoverGroup}" ng-mouseenter="hoverGroup = true" ng-mouseleave="hoverGroup = false" ng-if="name === \'AllUsers\' || hasGrant(permissions)">\n         <td ng-click="selectGrantee(name, permissions)">\n             <awsui-radio-button value="{{name}}">\n         <td>{{ getPublicPermissionDisplayName(name)}}</td>\n         <td>\n             <span ng-if="permissions.READ" translate="bucketproperty.yes"></span>\n             <span ng-if="!permissions.READ">-</span>\n         </td>\n         <td ng-if="isBucketPermission">\n             <span ng-if="permissions.WRITE" translate="bucketproperty.yes"></span>\n             <span ng-if="!permissions.WRITE">-</span>\n         </td>\n         <td>\n             <span ng-if="permissions.READ_ACP" translate="bucketproperty.yes"></span>\n             <span ng-if="!permissions.READ_ACP">-</span>\n         </td>\n         <td>\n             <span ng-if="permissions.WRITE_ACP" translate="bucketproperty.yes"></span>\n             <span ng-if="!permissions.WRITE_ACP">-</span>\n         </td>\n         </awsui-radio-button>\n         </td>\n     </tr>\n     <tr>\n         <storage-console-config-panel ng-class="{\'side-config-panel acl-side-panel\': panelOpen, \'hide-config-panel acl-side-panel\': panelHide}" panel-open="panelOpen">\n             <header>\n                 <div class="truncate side-panel-header bucket-config-panel-header-image">{{ getPublicPermissionDisplayName(selectedGrantee.displayedValue) }}</div>\n                 <span class="panel-close-icon" ng-click="panelCancel()"></span>\n                 \n             </header>\n             <content>\n                 <div class="permissions-side-panel-content">\n                     <p class="subheader" translate="permissions.acl.objectaccess"></p>\n                     <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ">{{ readHeader }}</awsui-checkbox>\n                     <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.WRITE">{{ writeHeader }}</awsui-checkbox>\n                     <p class="subheader padding-top-30" translate="permissions.acl.permissionsaccess"></p>\n                     <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ_ACP">{{ readACPHeader }}</awsui-checkbox>\n                     <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.WRITE_ACP">{{ writeACPHeader }}</awsui-checkbox>\n                 </div>\n             </content>\n             <footer>\n                 <awsui-button variant="primary" text="{{ \'permissions.button.save\' | translate}}" class="awsui-util-f-r primary-button" click="updateGrantee(selectedGrantee)" loading="updatingGrantee"></awsui-button>\n                 <awsui-button variant="normal" text="{{ \'permissions.button.cancel\' | translate}}" class="awsui-util-f-r normal-button" click="panelCancel()"></awsui-button>\n             </footer>\n         </storage-console-config-panel>\n     </tr>\n     </tbody>\n </table>\n<div class="manage-public-permission-title" translate="permissions.managesystempermissions" ng-if="isBucketPermission"> </div>\n<table id="system-permissions-table" class="table" ng-if="isBucketPermission">\n    <thead class="table-header">\n    <tr>\n        <th class="grantee-radio"></th>\n        <th class="grantee-header">\n            {{\'permissions.acl.group\' | translate}}\n            <awsui-tooltip text="{{ \'permissions.acl.groupTooltip\' | translate }}" position="right" size="small" initialized="true">\n                <i class="awsui-icon alert-info-circle"></i>\n            </awsui-tooltip>\n        </th>\n        <th class="grantee-header"> {{readHeader}}\n            <awsui-tooltip text="{{readTooltip}}" position="right" size="small" initialized="true">\n                <i class="awsui-icon alert-info-circle"></i>\n            </awsui-tooltip>\n        </th>\n        <th class="grantee-header" ng-if="isBucketPermission">{{writeHeader}}\n            <awsui-tooltip text="{{writeTooltip}}" position="right" size="small" initialized="true">\n                <i class="awsui-icon alert-info-circle"></i>\n            </awsui-tooltip>\n        </th>\n        <th class="grantee-header"> {{readACPHeader}}\n            <awsui-tooltip text="{{readACPTooltip}}" position="right" size="small" initialized="true">\n                <i class="awsui-icon alert-info-circle"></i>\n            </awsui-tooltip>\n        </th>\n        <th class="grantee-header"> {{writeACPHeader}}\n            <awsui-tooltip text="{{writeACPTooltip}}" position="right" size="small" initialized="true">\n                <i class="awsui-icon alert-info-circle"></i>\n            </awsui-tooltip>\n        </th>\n    </tr>\n    </thead>\n    <tbody class="table-body">\n    <tr ng-repeat="(name, permissions) in permissionObj.grantees.system" ng-click="selectGrantee(name, permissions)" class="grantee-row" ng-class="{\'grantee-selected\': name === selectedGrantee.displayedValue, \'row-hover\': hoverGroup}" ng-mouseenter="hoverGroup = true" ng-mouseleave="hoverGroup = false">\n        <td ng-click="selectGrantee(name, permissions)">\n            <awsui-radio-button value="{{name}}">\n        <td> {{ getSystemPermissionDisplayName(name)}} </td>\n        <td>\n            <span ng-if="permissions.READ" translate="bucketproperty.yes"></span>\n            <span ng-if="!permissions.READ">-</span>\n        </td>\n        <td ng-if="isBucketPermission">\n            <span ng-if="permissions.WRITE" translate="bucketproperty.yes"></span>\n            <span ng-if="!permissions.WRITE">-</span>\n        </td>\n        <td>\n            <span ng-if="permissions.READ_ACP" translate="bucketproperty.yes"></span>\n            <span ng-if="!permissions.READ_ACP">-</span>\n        </td>\n        <td>\n            <span ng-if="permissions.WRITE_ACP" translate="bucketproperty.yes"></span>\n            <span ng-if="!permissions.WRITE_ACP">-</span>\n        </td>\n        </awsui-radio-button>\n        </td>\n    </tr>\n    <tr>\n        <storage-console-config-panel id="system-permissions-side-panel" ng-class="{\'side-config-panel acl-side-panel\': panelOpen, \'hide-config-panel acl-side-panel\': panelHide}" panel-open="panelOpen">\n            <header>\n                <div class="truncate side-panel-header bucket-config-panel-header-image">{{ getPublicPermissionDisplayName(selectedGrantee.displayedValue) }}</div>\n                <span class="panel-close-icon" ng-click="panelCancel()"></span>\n                \n            </header>\n            <content>\n                <div class="permissions-side-panel-content">\n                    <awsui-alert visible="getPublicPermissionsWarning().isVisible" class="block small-top-margin" type="warning" dismissible="false" header="{{ getPublicPermissionsWarning().header }}">\n                        {{ getPublicPermissionsWarning().body }}\n                    </awsui-alert>\n                    <p class="subheader" translate="{{resource.type}}.acl.objectaccess"></p>\n                    <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ">{{ readHeader }}</awsui-checkbox>\n                    <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-if="isBucketPermission" ng-model="selectedGrantee.permissions.WRITE">{{ writeHeader }}</awsui-checkbox>\n                    <p class="subheader padding-top-30" translate="{{resource.type}}.acl.permissionsaccess"></p>\n                    <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ_ACP">{{ readACPHeader }}</awsui-checkbox>\n                    <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.WRITE_ACP">{{ writeACPHeader }}</awsui-checkbox>\n                </div>\n            </content>\n            <footer>\n                <awsui-button id="save-system-permissions" variant="primary" text="{{ \'permissions.button.save\' | translate}}" class="awsui-util-f-r primary-button" click="updateGrantee(selectedGrantee)" loading="updatingGrantee"></awsui-button>\n                <awsui-button id="cancel-system-permissions" variant="normal" text="{{ \'permissions.button.cancel\' | translate}}" class="awsui-util-f-r normal-button" click="panelCancel()"></awsui-button>\n            </footer>\n        </storage-console-config-panel>\n    </tr>\n    </tbody>\n</table>\n</awsui-radio-group>');a.put("/s3/partials/addeventsform.html",'<div class="add-events-body">\n        <translate class="events-label-header">events.label.name</translate>\n        <awsui-tooltip text="{{ \'events.tooltip.name\' | translate }}" position="right" size="small" initialized="true">\n            <i class="awsui-icon alert-info-circle"></i>\n        </awsui-tooltip>\n        <awsui-control-group class="label-text">\n            <awsui-textfield class="input-text" placeholder="{{\'events.placeholder.name\' | translate}}" ng-model="selectedEvent.id" change="cachedSelectedEvents.id=selectedEvent.id"></awsui-textfield>\n        </awsui-control-group>\n        <translate class="events-label-header">events.label.events</translate>\n        <awsui-tooltip text="{{ \'events.tooltip.events\' | translate }}" position="right" size="small" initialized="true">\n            <i class="awsui-icon alert-info-circle"></i>\n        </awsui-tooltip>\n        <awsui-control-group class="checkboxes">\n            <awsui-checkbox ng-repeat="eventType in eventTypes" ng-model="eventsChecked[eventType.complexName]" change="handleCheckboxes()">{{ eventType.simpleName }}\n            </awsui-checkbox>\n        </awsui-control-group>\n        <translate class="events-label-header">events.label.prefix</translate>\n        <awsui-tooltip text="{{ \'events.tooltip.prefix\' | translate }}" position="right" size="small" initialized="true">\n            <i class="awsui-icon alert-info-circle"></i>\n        </awsui-tooltip>\n        <awsui-control-group class="label-text">\n            <awsui-textfield class="input-text" placeholder="{{\'events.placeholder.prefix\' | translate}}" ng-model="selectedEvent.prefix"></awsui-textfield>\n        </awsui-control-group>\n        <translate class="events-label-header">events.label.suffix</translate>\n        <awsui-tooltip text="{{ \'events.tooltip.suffix\' | translate }}" position="right" size="small" initialized="true">\n            <i class="awsui-icon alert-info-circle"></i>\n        </awsui-tooltip>\n        <awsui-control-group class="label-text">\n            <awsui-textfield class="input-text" placeholder="{{\'events.placeholder.suffix\' | translate}}" ng-model="selectedEvent.suffix"></awsui-textfield>\n        </awsui-control-group>\n        <translate class="events-label-header">events.label.sendto</translate>\n        <awsui-tooltip text="{{ \'events.tooltip.sendto\' | translate }}" position="right" size="small" initialized="true">\n            <i class="awsui-icon alert-info-circle"></i>\n        </awsui-tooltip>\n        <awsui-control-group class="label-text" validation-message="{{cardState.listTopicError}}">\n            <awsui-select placeholder="{{ \'addeventmodal.sendtoplaceholder\' | translate }}" items="resourceTypesDropdown" ng-model="selectedEvent.type" change="updateEventResources()"></awsui-select>\n        </awsui-control-group>\n        <awsui-control-group class="label-text" label="{{ selectedEvent.type }}">\n            <awsui-select id="event-resources" items="eventResources" disabled="isLoadingResources || !selectedEvent.type" ng-model="selectValue.value" change="selectChanged()"></awsui-select>\n        </awsui-control-group>\n\n        <awsui-control-group class="label-text" label="{{getCustomArnLabel()}}" ng-if="selectValue.value === S3Constants.EVENTS.CUSTOM">\n            <awsui-textfield class="input-text" placeholder="{{customarn_placeholder}}" ng-model="selectedEvent.arn"></awsui-textfield>\n        </awsui-control-group>\n    </div>');a.put("/s3/partials/analysisexport.html",'<div class="analysis-export-form">\n    <awsui-expandable-section class="export-form-dropdown" header="{{\'management.analytics.export.title\' | translate}}" expanded="editFilter">\n        <div class="export-form-hr"></div>\n        <div class="dropdown-text section">\n            <div class="export-form-labels" translate="report.label.bucket"></div>\n            <bucket-selector class="export-form-bucket" ng-class="{ \'bucket-missing\': data.prefix && !data.bucket.bucket}" selected-report="data.bucket" show-bucket-name-only="true" choose-accounts="true" same-region="true" editable="true" disabled="saving"></bucket-selector>\n            <div class="export-form-labels" translate="report.label.prefix"></div>\n            <awsui-textfield class="export-form-prefix" id="export-prefix" placeholder="{{ \'management.analytics.export.prefix.placeholder\' | translate}}" ng-keyup="validatePrefix()" data-disabled="saving || !data.bucket.bucket" ng-model="data.prefix"></awsui-textfield>\n\n            <div class="search-prefix-info" ng-if="prefixInfo" translate="" translate-values="{ bucket1 : data.bucket.bucket + \'/\' + prefixInfo, bucket2: data.bucket.bucket + prefixInfo }">prefixsearch.validation.slash.start.warning</div>\n\n            <div class="export-quicksight" translate="management.analytics.quicksight.export" translate-values="{quicksightLink : getQuicksightLink()}" ng-if="showQuicksight">\n            </div>\n        </div>\n    </awsui-expandable-section>\n</div>');a.put("/s3/partials/analytics-area-chart.html",'<div id="{{ chartId }}"></div>');a.put("/s3/partials/analytics.html",'<table class="metrics-content-table">\n\n    <tr>\n        <td class="metrics-content-cell management-side-panel-color">\n            <div class="select-metrics-side-panel">\n                <span class="awsui-icon awsui-spinner awsui-spinner-large config-spinner" ng-if="models.configLoading"></span>\n                <table border="0px" class="select-metrics-table" ng-if="!models.configLoading">\n                    <tr>\n                        <td>\n                            <span class="metrics-header">{{ \'management.view.analytics\' | translate }}</span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <table class="search-box prefix-search-box">\n                                <tbody>\n                                <tr>\n                                    <td class="search-icon"><i class="awsui-icon search"></i></td>\n                                    <td><input type="text" class="input-field ng-pristine ng-valid ng-empty ng-touched" ng-model="models.searchText" ng-keydown="filterKeyDown($event)" ng-click="searchClicked()" placeholder="{{ \'management.search.placeholder\' | translate }}"></td>\n                                </tr>\n                                </tbody>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td class="filter-header">\n                            <table class="filters-table-header">\n                                <tr>\n                                    <td>\n                                        <div class="filter-title-analytics" translate="management.metrics.side.filter.header" translate-values="{count: filterList.length}"></div>\n                                    </td>\n                                    <td>\n                                        <div class="filter-add" id="add-filter" ng-click="addFilter()">\n                                            <div class="awsui-icon awsui-icon-link plus">\n                                                {{\'management.metrics.side.filter.add\'|translate}}\n                                            </div>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n\n                    <tr ng-if="models.showAddFilter">\n                        <td class="bucket-dropdown-config dark">\n                            <table>\n                                <tr>\n                                    <td class="filter-title-cell">\n                                        <div class="filter-add-title">\n                                            {{ models.editFilter ? \'management.metrics.side.filter.dropdown.edit\' :\n                                            \'management.metrics.side.filter.dropdown.add\' | translate}}\n                                        </div>\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>\n                                        <div class="new-filter-params">\n                                            <div class="new-filter-text">\n                                                {{ \'management.metrics.side.filter.name.title\' | translate }}\n                                            </div>\n                                            <div class="new-filter-input">\n                                                <awsui-control-group validation-message="{{models.filterNameError}}">\n                                                    <awsui-textfield id="get-filter-name" placeholder="{{ \'management.metrics.side.filter.name.placeholder\' | translate}}" ng-keyup="validateFilter()" data-disabled="models.editFilter || models.savingFilter" ng-model="models.filterName"></awsui-textfield>\n                                                </awsui-control-group>\n                                            </div>\n\n                                            <div class="new-filter-text">\n                                                {{ \'management.metrics.side.filter.prefix.optional.title\' | translate }}\n                                            </div>\n                                            <div class="new-filter-input" ng-class="{\'new-filter-input-search\' : models.filterValue || (filters.tagFilters.length + filters.prefixFilters.length) > 0 }">\n                                                <awsui-textarea ng-if="models.editFilter" id="filter-value" placeholder="{{ \'management.metrics.side.filter.prefix.placeholder\' | translate}}" ng-keyup="validateFilter()" data-disabled="true" rows="1" ng-model="models.filterValue"></awsui-textarea>\n                                                <search empty="true" filters="filters" no-backend-calls="true" ng-if="!models.editFilter" search-error="models.filterValueError"></search>\n                                            </div>\n\n                                            <div>\n                                                <analytics-export data="exportFilterInfo" saving="models.savingFilter" edit-filter="models.editFilter">\n                                                </analytics-export>\n                                            </div>\n\n                                            <div class="select-analytics-buttons">\n                                                <table>\n                                                    <tr>\n                                                        <td colspan="2">\n                                                            <div class="filter-delete">\n                                                                <awsui-button data-disabled="models.deleteFilter || models.savingFilter" id="delete-filter" variant="link" ng-click="deleteFilter()" loading="models.deleteFilter" ng-if="models.editFilter" text="{{ \'management.metrics.action.delete\' | translate }}">\n                                                                </awsui-button>\n                                                            </div>\n                                                        </td>\n                                                    </tr>\n                                                    <tr>\n                                                        <td class="analytics-button-spacing">\n                                                            <awsui-button id="save-filter-button" variant="primary" text="{{ \'button.save\'   | translate}}" data-disabled="models.savingFilter || models.deleteFilter\n                                                                          || (!models.filterName || models.filterNameError)\n                                                                          || (exportFilterInfo.prefix.length > 0 && !exportFilterInfo.bucket.bucket)" class="normal-button" loading="models.savingFilter" ng-click="saveFilter()"></awsui-button>\n                                                        </td>\n                                                        <td>\n                                                            <awsui-button variant="normal" text="{{ \'button.cancel\' | translate}}" class="normal-button" data-disabled="models.savingFilter || models.deleteFilter" click="cancelFilter()"></awsui-button>\n                                                        </td>\n                                                    </tr>\n                                                </table>\n                                                <div class="filter-error">\n                                                    <awsui-alert type="error" header="{{\'error.header\'|translate}}" ng-if="models.filterError">{{models.filterError}}\n                                                    </awsui-alert>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n\n                    <tr ng-if="!models.showAddFilter && filterList.length > 0" class="filter-header">\n                        <td>\n                            <table class="filters-table">\n                                <tr ng-repeat="row in filterList | filter:models.searchText " ng-class="{\'row-selected\' : row.checked, \'row-hover\': hoverRule && !row.checked}" ng-click="filterChanged(row, $event)" ng-mouseenter="hoverRule = true" ng-mouseleave="hoverRule = false">\n                                    <td>\n                                        <div class="row-checkbox">\n                                            <span class="alert-exclamation-triangle awsui-icon warning-triangle-icon" ng-class="{\'awsui-icon-light\':row.checked}" ng-if="row.exportFailed"></span>\n                                            <span class="orange-lightbulb lightbulb-icon" ng-if="!row.recommendation"></span>\n                                            <span class="lightbulb-icon" ng-class="{\'enabled-lightbulb-blue-image\' : !row.checked,\n                                                            \'enabled-lightbulb-white-image\':row.checked}" ng-if="row.recommendation"></span>\n                                        </div>\n                                    </td>\n                                    <td class="filter-name-row">\n                                        <div>\n                                            {{row.Id}}\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <span class="awsui-icon awsui-icon-link pencil buckets-cog" ng-class="{\'awsui-icon-light\': row.checked}" ng-click="addFilter(row)"></span>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr ng-if="!models.showAddFilter && filterList.length === 0">\n                        <td>\n                            <div class="side-panel-metrics-help">\n\n                                <span> {{ \'storageanalysis.empty.additionalInformation\' | translate }}{{ \'management.metrics.cost.paid\' | translate}} </span> <br>\n\n                                <a href="{{ getLearnMoreLink(\'analytics-storage-class\') }}" target="_blank" class="ng-binding" translate="">learn.more</a>\n                                <br>\n                                <br>\n                                <awsui-button data-disabled="false" loading="false" icon="plus" variant="primary" ng-click="addFilter()">\n                                    {{ \'management.metrics.side.filter.add\' | translate }}\n                                </awsui-button>\n                            </div>\n                        </td>\n                    </tr>\n                </table>\n            </div>\n        </td>\n        <td class="metrics-content-cell">\n\n            <div class="analytics-content">\n                <div>\n                    <div class="si-top-right-header analytics-padding">\n                        <div class="title labels">\n                            {{ getGroupTitle(S3Constants.METRICS.TYPE.STORAGE) }}\n                        </div>\n                        <div ng-if="quicksightLink">\n                            <a href="{{quicksightLink}}" id="quicksightLink" target="_blank" class="quicksight awsui-icon external-link awsui-icon-light" ng-click="quicksightLinkClicked()" translate="">management.analytics.link.quicksight</a>\n                        </div>\n                    </div>\n\n                    <div class="empty-storage-class-analysis" ng-if="!models.configLoading && !models.savingFilter && !models.deleteFilter && filterList.length === 0">\n                        <span class="no-storage-class-analysis storage-class-analysis-icon"></span>\n                        <div class="empty-header" translate="">storageanalysis.empty.header</div>\n                        <div class="empty-additional-information" translate="">\n                            storageanalysis.empty.additionalInformation\n                        </div>\n                        <table class="empty-buttons">\n                            <tbody>\n                            <tr>\n                                <td>\n                                    <awsui-button variant="link" text="{{ \'storageanalysis.empty.addfilter\' | translate }}" ng-click="addFilter()"></awsui-button>\n                                </td>\n                            </tr>\n                            </tbody>\n                        </table>\n                    </div>\n\n                    <div class="storage-management-error-box">\n                        <awsui-alert type="error" header="{{\'error.header\'|translate}}" ng-if="models.error">{{models.error}}\n                        </awsui-alert>\n                    </div>\n\n                    <div class="storage-management-error-box" ng-if="policyStatus.policyMessage">\n\n                        <awsui-alert id="inventory-policy-message" dismiss="resetPolicyStatus()" type="{{policyStatus.policyType}}" dismissible="true" visible="policyStatus.policyMessage" header="{{policyStatus.policyHeader}}">\n                            <div>{{policyStatus.policyMessage}}\n                                <span>\n                                            <a href="{{getLearnMoreLink(\'analytics-storage-class\')}}" target="_blank" translate="">learn.more</a>\n                                        </span>\n                            </div>\n                            <div class="policy-definition" ng-if="policyStatus.policyDefinition">\n                                <pre>{{policyStatus.policyDefinition}}</pre>\n                            </div>\n                        </awsui-alert>\n                    </div>\n\n                    <div ng-if="!models.configLoading && !models.savingFilter && !models.deleteFilter && filterList.length > 0">\n                        <div class="metrics-loading" ng-if="models.dataLoading">\n                            <span class="awsui-icon awsui-spinner awsui-spinner-large"></span>\n                        </div>\n\n                        <div class="analyzing-data" ng-if="!models.dataLoading && !recommendation">\n                            <div class="info-box">\n                                <table class="info-table">\n                                    <tr>\n                                        <td><span class="info-icon orange-lightbulb lightbulb-icon"></span></td>\n                                        <td class="info-text-cell">\n                                            <div class="info-text" translate="management.analytics.analyzing.title"></div>\n                                            <div class="info-text" translate="management.analytics.analyzing.date" translate-values="{ date: startedOn }" ng-if="allData.data && allData.data.rows && allData.data.rows.length > 0"></div>\n\n                                        </td>\n                                        <td>\n                                            <div class="info-desc" translate="management.analytics.analyzing.desc"></div>\n                                        </td>\n                                    </tr>\n                                </table>\n                            </div>\n\n                            <div class="analyzing-data-no-data" ng-if="!allData.data.rows || allData.data.rows.length == 0 ">\n                                <span class="no-graph-image no-graph-image-class"></span>\n                                <div class="no-data-available" translate="">management.analytics.data.not.available</div>\n                            </div>\n\n                        </div>\n\n                        <div class="analytics-data-analysis" ng-if="!models.dataLoading && allData.data && allData.data.rows && allData.data.rows.length > 0 ">\n                            <div class="info-box" ng-if="recommendation">\n                                <table class="info-lifecycle-table">\n                                    <tr>\n                                        <td>\n                                            <span class="info-icon enabled-lightbulb-blue-image lightbulb-icon lightbulb-adj"></span>\n                                        </td>\n                                        <td>\n                                            <span class="info-lifecycle-text-title" translate="management.analytics.data.info.recommendation.title"></span>\n                                        </td>\n                                        <td>\n                                            <span class="info-lifecycle-text-date" translate="management.analytics.data.info.updated.date" translate-values="{ date: updatedOn }"></span>\n                                        </td>\n                                    </tr>\n                                </table>\n                                <div class="info-lifecycle-desc" translate="management.analytics.data.info.recommendation.desc" translate-values="{ range: numDays, rec: recommendation }"></div>\n                                <awsui-button class="view-lifecycle-rules" id="view-lifecycle-rules" ng-click="goToLifecycleTab()" text="{{ \'management.analytics.data.info.viewlifecyclerules\' | translate }}">\n                                </awsui-button>\n                            </div>\n\n                            <div class="info-box-storage-container">\n                                <div class="info-box-storage" ng-repeat="(key, value) in allData.data.all">\n                                    <h3 translate="{{getClassNameTranslation(key)}}"></h3>\n                                    <table class="info-table-storage">\n                                        <tr>\n                                            <td translate="management.analytics.data.size"></td>\n                                            <td>{{getMostRecentTotalSize(value)}}</td>\n                                        </tr>\n                                        <tr class="info-data">\n                                            <td translate="management.analytics.data.retrieved"></td>\n                                            <td>{{getMostRecentDataRetrieved(value)}}</td>\n                                        </tr>\n                                    </table>\n                                </div>\n                                <awsui-tooltip text="{{getExportFailedStatusText(false)}}" position="bottom" size="small">\n                                    <div class="info-box-storage awsui-alert-type-warning" ng-if="exportFailed">\n                                        <h3>Export failed</h3>\n                                        <span>{{getExportFailedStatusText(true)}}</span>\n                                    </div>\n                                </awsui-tooltip>\n                            </div>\n\n                            <div class="info-question">\n                                <span class="info-icon enabled-lightbulb-blue-image lightbulb-icon-question"></span>\n                                <div class="info-question-text" translate="management.analytics.data.info.retrieved.question">\n                                </div>\n                                <div class="info-storage-select" ng-if="storageOptions">\n                                    <awsui-select items="storageOptions" ng-model="selectedStorageClass.value" ng-change="setSelectedStorageClass()"></awsui-select>\n                                </div>\n                                <div class="info-legend-group">\n                                    <div class="info-legend">\n                                        <div class="info-color-box storage-back"></div>\n                                        <span class="storage-color" translate="storageanalysis.label.storage"></span>\n                                    </div>\n                                    <div class="info-legend">\n                                        <div class="info-color-box data-back"></div>\n                                        <span class="data-color" translate="storageanalysis.label.dataRetrieved"></span>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div class="info-area-chart">\n                                <analytics-area-chart chart-id="storageAreaChartId" data="graphData.area" height="360" xmin="xmin" xmax="xmax"></analytics-area-chart>\n                            </div>\n\n                            <div class="info-question">\n                                <span class="info-icon enabled-lightbulb-blue-image lightbulb-icon-question"></span>\n                                <div class="info-question-text" translate="management.analytics.data.info.percentage.question">\n                                </div>\n\n                                <div class="info-per-legend">\n                                    <div class="info-dotted-line"></div>\n                                    <div class="info-per-text" translate="management.analytics.data.info.retrieved.label"></div>\n                                </div>\n                            </div>\n\n                            <div class="info-percentage-graph">\n                                <storage-console-line-chart chartid="percentageGraphId" data="graphData.percentage" heading="percentageGraphHeading" isxdate="true" xticks="8" xid="percentageGraphXValue" yid="percentageGraphYValue" xmin="xmin" xmax="xmax" totalwidth="940" totalheight="300" dotted="\'3px\'" color="\'#9066A7\'" pattern="\'3, 3\'" template-url="partials/storageConsoleLineChartAnalytics.html">\n                                </storage-console-line-chart>\n                                <hr class="hr-props">\n                            </div>\n\n                            <div class="info-age-tiers">\n                                <object-frequency-analytics data="allData.data" storage-class="selectedStorageClass"></object-frequency-analytics>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n\n        </td>\n    </tr>\n</table>');a.put("/s3/partials/barchartcard.html",'<div class="bar-chart-card" ng-style="{width: width + \'px\', height: height + \'px\'}">\n    <div class="card-header-text">{{chartTitle}}</div>\n\n    <div id="chart"></div>\n    <hr ng-style="{\'background-color\': colors.row || \'gray\'}" class="line">\n    <div id="footer-layout">\n        <table>\n            <tr ng-if="footer.title">\n                <td class="footer-title">\n                    {{footer.title}}\n                </td>\n            </tr>\n            <tr ng-if="footer.text">\n                <td class="footer-text">\n                    {{footer.text}}\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>');a.put("/s3/partials/breadcrumbs.html",'<div class="breadcrumbs-container">\n    <awsui-breadcrumb-group class="breadcrumbs" ng-if="!condenseBreadcrumbs">\n        <awsui-breadcrumb-item text="{{ \'breadcrumbs.amazons3\' | translate }}" href="/s3/home?region={{currentRegion}}"></awsui-breadcrumb-item>\n        <span class="awsui-icon angle-right"></span>\n        <span ng-repeat="object in objects"><span ng-if="!$first">/</span><awsui-breadcrumb-item ng-class="{\'breadcrumb-last\': $last}" text="{{object.displayName}}" href="{{object.path}}"></awsui-breadcrumb-item></span>\n    </awsui-breadcrumb-group>\n    <awsui-breadcrumb-group class="breadcrumbs" ng-if="condenseBreadcrumbs">\n        <awsui-breadcrumb-item text="{{ \'breadcrumbs.amazons3\' | translate }}" href="/s3/buckets?region={{currentRegion}}"></awsui-breadcrumb-item>\n        <span class="awsui-icon angle-right"></span>\n        <awsui-breadcrumb-item text="..." href=""></awsui-breadcrumb-item>\n        <awsui-breadcrumb-item text="{{objects[objects.length-2].displayName}}" href="{{objects[objects.length-2].path}}"></awsui-breadcrumb-item>\n        <span>/</span>\n        <awsui-breadcrumb-item class="breadcrumb-last" text="{{objects[objects.length-1].displayName}}" href="{{objects[objects.length-1].path}}"></awsui-breadcrumb-item>\n    </awsui-breadcrumb-group>\n</div>');a.put("/s3/partials/bucket-replication/bucketreplication.html",'<div ng-if="isLoadingReplication" class="replication-loading"><span class="awsui-spinner awsui-spinner-large"></span></div>\n<div ng-if="!isLoadingReplication" class="replication-page">\n    <awsui-alert type="error" visible="replicationObj.errorMessage">\n        {{replicationObj.errorMessage}}\n    </awsui-alert>\n    <div ng-if="replicationObj.showSignoutWarning" class="signout-warning-section">\n        <span icon="times" class="awsui-alert-dismiss-control awsui-alert-times-warning awsui-button-as-link awsui-icon signout-close" ng-click="closeSignOutWarning($event)"></span>\n        <span class="alert-exclamation-triangle awsui-alert-icon awsui-icon awsui-icon-big"></span>\n        <h3 class="warning-title" translate="bucketreplication.signoutmessage"></h3>\n        <p class="warning-message" translate="bucketreplication.signouttitle"></p>\n        <awsui-button class="signout-button" text="{{ \'bucketreplication.signout\' | translate }}" click="signout()"></awsui-button>\n    </div>\n    <replication-modal ng-if="globalConfigInfo && globalConfigInfo.flag" modal-info="globalConfigInfo" replication-obj="replicationObj" selected-rule="selectedRule"></replication-modal>\n    <div class="action-strip">\n        <awsui-tooltip id="replication-table-disableadd-tooltip" ng-if="checkPrefix()" text="{{\'crr.prefixtooltip\' | translate}}" position="bottom">\n            <awsui-button id="add-rule" class="action-button-spacing" text="{{\'bucketreplication.addnew\' | translate}}" data-disabled="true" icon="plus" ng-click="showReplicationModal(true, checkPrefix(), false)" variant="primary"></awsui-button>\n        </awsui-tooltip>\n        <awsui-button id="add-rule" ng-if="!checkPrefix()" class="action-button-spacing" text="{{\'bucketreplication.addnew\' | translate}}" icon="plus" ng-click="showReplicationModal(true, checkPrefix(), false)" variant="primary"></awsui-button>\n        <awsui-button id="edit-rule" class="action-button-spacing" text="{{ \'bucketreplication.edit\' | translate }}" data-disabled="!selectedRule.flag" ng-click="showReplicationModal(false, false, false)"></awsui-button>\n        <awsui-button id="delete-rule" class="action-button-spacing" text="{{ \'bucketreplication.delete\' | translate }}" data-disabled="!selectedRule.flag" click="deleteRule()"></awsui-button>\n        <action-dropdown class="bucket-more-dropdown" text="{{ \'bucketlifecycle.label.more\' | translate }}" ng-click="triggerMoreDropdown(); $event.stopPropagation();" items="moreOptions" disable-take-action="true"></action-dropdown>\n    </div>\n    <empty-state ng-if="!(replicationObj.ruleSettings.Rule && replicationObj.ruleSettings.Rule.length > 0)" open-modal="showReplicationModal" type="\'replication\'" one-intro-image="oneIntroImage"></empty-state>\n    <awsui-radio-group class="permission-radio-group" ng-model="selectedRule.ruleObj.ID">\n        <table class="table table-condense crr-rule-table" ng-if="replicationObj.ruleSettings.Rule && replicationObj.ruleSettings.Rule.length > 0">\n            <thead class="table-header">\n            <tr>\n                <th></th>\n                <th>\n                    {{\'bucketreplication.source\' | translate}}\n                    <awsui-tooltip text="{{ \'crr.tooltips.crrsource\' | translate }}" position="right" size="small" initialized="true">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </th>\n                <th>\n                    {{\'bucketreplication.status\' | translate}}\n                    <awsui-tooltip text="{{ \'crr.tooltips.rulestatus\'| translate }}" position="right" size="small" initialized="true">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </th>\n                <th>\n                    {{\'bucketreplication.storageclass\' | translate}}\n                    <awsui-tooltip text="{{ \'crr.tooltips.rulestorageclass\'| translate }}" position="right" size="small" initialized="true">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </th>\n                <th fac-id="s3-crr-kms">\n                    {{\'bucketreplication.accesscontroltranslation\' | translate}}\n                    <awsui-tooltip text="{{ \'crr.tooltips.accesscontroltranslation\'| translate }}" position="right" size="small" initialized="true">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </th>\n                <th fac-id="s3-crr-kms">\n                    {{\'bucketreplication.replicatekmsencrypt\' | translate}}\n                    <awsui-tooltip text="{{ \'crr.tooltips.replicatekmsencrypt\'| translate }}" position="top" size="small" initialized="true">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </th>\n            </tr>\n            </thead>\n            <tbody class="table-body">\n            <tr ng-repeat="rule in replicationObj.ruleSettings.Rule" class="grantee-row" ng-click="selectRule(rule); $event.stopPropagation();" ng-class="{\'row-selected\' : selectedRule.flag && selectedRule.ruleObj.ID===rule.ID, \'row-hover\': hoverReplicationRule && !(selectedRule.flag && selectedRule.ruleObj.ID===rule.ID)}" ng-mouseenter="hoverReplicationRule = true" ng-mouseleave="hoverReplicationRule = false">\n                <td ng-click="selectRule(rule); $event.stopPropagation();">\n                    <awsui-radio-button value="{{rule.ID}}">\n                <td class="crr-table-scope-column" ng-if="rule.isEntireBucket === \'true\'"><span translate="bucketreplication.entirebucket"></span></td>\n                <td class="crr-table-scope-column" ng-if="rule.isEntireBucket === \'false\'"><span translate="bucketreplication.prefix" translate-values="{ prefix: \'{{rule.Prefix}}\' }"></span></td>\n                <td class="crr-table-status-column" ng-if="rule.Status === REPLICATION.ENABLED " translate="replicationmodal.sourcestep.enabled"></td>\n                <td class="crr-table-status-column" ng-if="rule.Status === REPLICATION.DISABLED " translate="replicationmodal.sourcestep.disabled"></td>\n                <td class="crr-table-storageclass-column"> {{ rule.Destination.StorageClass.text }} </td>\n                <td fac-id="s3-crr-kms" class="crr-table-accesscontroltranslation-column" ng-if="rule.Destination.isAccessControlTranslation" translate="bucketreplicationtable.accesscontroltranslation"></td>\n                <td fac-id="s3-crr-kms" class="crr-table-accesscontroltranslation-column" ng-if="!rule.Destination.isAccessControlTranslation" translate="bucketreplicationtable.noaccesscontroltranslation"></td>\n                <td fac-id="s3-crr-kms" class="crr-table-replicatekmsencrypt-column" ng-if="rule.Destination.isKmsEncryption" translate="bucketreplicationtable.replicatekmsencrypt"></td>\n                <td fac-id="s3-crr-kms" class="crr-table-replicatekmsencrypt-column" ng-if="!rule.Destination.isKmsEncryption" translate="bucketreplicationtable.noreplicatekmsencrypt"></td>\n                </awsui-radio-button>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    </awsui-radio-group>\n    <replication-modal ng-if="replicationModalInfo && replicationModalInfo.isOpen.flag" modal-info="replicationModalInfo" replication-obj="replicationObj" selected-rule="selectedRule"></replication-modal>\n    <dialog-modal class="rule-confirmation-modal" is-open="confirmationModalObj.isOpen" close-callback="closeConfirmationModal" header-title="confirmationModalObj.title">\n        <dialog-modal-content>\n            <awsui-alert type="warning"> {{ confirmationModalObj.contentText }} </awsui-alert>\n        </dialog-modal-content>\n        <dialog-modal-footer>\n            <awsui-button id="crr-confirmation-cancel" text="{{ \'bucketreplication.cancel\' | translate }}" variant="normal" click="closeConfirmationModal()"></awsui-button>\n            <awsui-button id="crr-confirmation-save" click="saveConfirmation()" variant="primary" text="{{ \'bucketreplication.confirm\' | translate }}" loading="isConfirming" class="awsui-util-f-r primary-button">\n            </awsui-button>\n        </dialog-modal-footer>\n    </dialog-modal>\n    <crr-receive-object-modal ng-if="receiveObjectsModalObj.isOpen.flag" modal-info="receiveObjectsModalObj" replication-obj="replicationObj"></crr-receive-object-modal>\n</div>\n');a.put("/s3/partials/bucket-replication/crr-errormodal.html",'<dialog-modal class="replication-confirmation-modal" is-open="modalOpen" close-callback="closeErrorModal" header-title="errorModal.title">\n    <dialog-modal-content>\n        <awsui-alert header="{{errorModal.header}}" type="warning" visible="bucketSelectorObj.destinationBucket.versioningEnabled === false">\n            {{errorModal.contentText}}\n        </awsui-alert>\n        <awsui-button ng-if="bucketSelectorObj.destinationBucket.versioningEnabled === false" variant="primary" text="{{ \'crr.errormodal.enableversioning\' | translate }}" class="primary-button" click="enableDestinationVersioning()" loading="isEnablingVersioning.flag"></awsui-button>\n        <awsui-alert header="{{\'crr.warningmsg.content.cannotenableversioning\' | translate}}" type="warning" visible="bucketSelectorObj.destinationBucket.Errors.enabledVersioningError"><span translate="crr.warningmsg.detail.cannotenableversioning"></span></awsui-alert>\n        <awsui-alert header="{{\'crr.warningmsg.content.bucketnotexist\' | translate}}" type="warning" visible="bucketSelectorObj.destinationBucket.Errors.bucketNotExistError"></awsui-alert>\n        <awsui-alert header="{{\'crr.warningmsg.content.sameregion\' | translate }}" type="warning" visible="bucketSelectorObj.destinationBucket.Errors.generalErrors"></awsui-alert>\n        <div ng-if="bucketSelectorObj.destinationBucket.Errors.enabledVersioningError || bucketSelectorObj.destinationBucket.Errors.getVersioningError">\n            <span class="text-color-light" translate="crr.confirmationmodal.bucketpolicytitle"></span>\n            <div class="copy-message">\n                <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant="link" class="dark crr-copy-button" ng-click="copyPolicyToClipboard(bucket.name, copyFinished, true, true)"></awsui-button>\n                <span class="copied-msg" ng-class="{ \'fade-in\' : copyFinished.flag === true, \'fade-out\' : copyFinished.flag === false, \'hide-msg\' : copyFinished.flag === null}" translate="copytoclipboard.path"></span>\n            </div>\n            <div class="crr-modal-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: policyEditorLoaded}" class="code" readonly="true"></div>\n        </div>\n    </dialog-modal-content>\n    <dialog-modal-footer>\n        <awsui-button click="closeErrorModal()" variant="normal" text="{{ \'crr.errormodal.close\' | translate }}" class="awsui-util-f-r primary-button">\n        </awsui-button>\n    </dialog-modal-footer>\n</dialog-modal>');a.put("/s3/partials/bucket-replication/crr-globalsettings.html",'<div ng-if="modalInfo.isEditing" class="global-settings-background"></div>\n<div class="global-settings wrapper">\n    <table class="global-setting-table">\n        <thead>\n        <th>\n            <p class="section-title" translate="crr.globalconfig.source.title"></p>\n            <div class="divider"></div>\n        </th>\n        <th>\n            <p class="section-title" translate="crr.globalconfig.destination.title"></p>\n            <div class="divider"></div>\n        </th>\n        <th>\n            <p class="section-title" translate="crr.globalconfig.permissions.title"></p>\n            <div class="divider"></div>\n        </th>\n        </thead>\n        <tbody>\n        <tr class="global-setting-title">\n            <td translate="crr.globalconfig.sourcescope">\n            </td>\n            <td translate="crr.globalconfig.dstbucket">\n            </td>\n            <td translate="crr.globalconfig.iamroletitle">\n            </td>\n        </tr>\n        <tr>\n            <td class="value-display bold-text" ng-if="!modalInfo.isEditing">\n                <div id="crr-global-display-entirebucket" ng-if="modalInfo.prefixOrWholeBucket.value === modalInfo.ENTIRE_BUCKET" translate="crr.globalconfig.source.entirebucket"></div>\n                <div id="crr-global-display-prefix" ng-if="modalInfo.prefixOrWholeBucket.value === modalInfo.PREFIX" translate="crr.globalconfig.source.prefix"></div>\n            </td>\n            <td class="value-display" ng-if="modalInfo.isEditing">\n                <div><dropdown id="crr-global-changescope-dropdown" items="modalInfo.prefixOrWholeBucketOptions" selected-item="modalInfo.prefixOrWholeBucket" placeholder="{{ \'createbucketmodal.placeholder.region\' | translate }}"></dropdown></div>\n            </td>\n            <td id="crr-global-display-destBucket" class="value-display bold-text" ng-if="!modalInfo.isEditing">\n                {{replicationObj.globalSettings.destinationBucket.name}}\n            </td>\n            <td class="value-display" ng-if="modalInfo.isEditing">\n                <div>\n                    <bucket-selector class="replication-modal-bucketselector" show-bucket-name-only="true" choose-accounts="true" editable="true" bucket-replication="bucketSelectorObj"></bucket-selector>\n                    <div class="createbucketbodycontent" ng-if="bucketSelectorObj.destinationBucket.createNewDestBucket">\n                        <div class="name-title">\n                            <span translate="createbucketmodal.label.name"></span>\n                            <awsui-tooltip text="{{\'createbucketmodal.bucketname.tooltip\' | translate}}" position="bottom" size="small">\n                                <i class="awsui-icon alert-info-circle info-circle"></i>\n                            </awsui-tooltip>\n                        </div>\n                        <div class="bucketname-and-region">\n                            <awsui-control-group>\n                        <span dom-region="validationMessage" ng-if="bucketSelectorObj.destinationBucket.bucketNameValidationErrors.length > 0">\n                            <label ng-repeat="message in bucketSelectorObj.destinationBucket.bucketNameValidationErrors">{{message}}</label><br>\n                        </span>\n                                <span dom-region="control">\n                            <awsui-textfield class="create-bucket-modal-input" autocomplete="true" ng-keyup="validateBucketName()" placeholder="{{\'createbucketmodal.placeholder.name\' | translate}}" ng-model="bucketSelectorObj.destinationBucket.name">\n                            </awsui-textfield>\n                        </span>\n                            </awsui-control-group>\n                        </div>\n                        <div class="region-title">\n                            <span translate="createbucketmodal.label.region"></span>\n                        </div>\n                        <dropdown items="modalInfo.regions" selected-item="bucketSelectorObj.destinationBucket.region" placeholder="{{ \'createbucketmodal.placeholder.region\' | translate }}" filter="true"></dropdown>\n                    </div>\n                </div>\n            </td>\n            <td id="crr-global-display-iamrole" class="value-display bold-text" ng-if="!modalInfo.isEditing">\n                {{replicationObj.globalSettings.Role.text}}\n            </td>\n            <td class="value-display" ng-if="modalInfo.isEditing">\n                <div>\n                    <dropdown id="crr-global-iamrole-selector" items="modalInfo.iamRoles" selected-item="tmpReplicationObj.Role" placeholder="{{ \'createbucketmodal.placeholder.region\' | translate }}" filter="true"></dropdown>\n                </div>\n            </td>\n        </tr>\n        <tr class="global-setting-title" ng-class="{ \'global-title-editing\': modalInfo.isEditing }">\n            <td translate="crr.globalconfig.sourceregion"></td>\n            <td><span ng-if="!modalInfo.isEditing" translate="crr.globalconfig.sourceregion"></span></td>\n            <td translate="crr.globalconfig.bucketpolicytitle"></td>\n        </tr>\n        <tr>\n            <td class="value-display bold-text">{{replicationObj.globalSettings.sourceBucket.region}}</td>\n            <td class="value-display bold-text"><span ng-if="!modalInfo.isEditing">{{replicationObj.globalSettings.destinationBucket.region}}</span></td>\n            <td class="value-display bold-text">\n                <div class="global-config-copybutton">\n                    <awsui-button variant="link" text="{{ \'crr.globalconfig.copypolicy\' | translate }}" ng-click="copyPolicyToClipboard(tmpReplicationObj.Destination.Bucket.name, copyFinished, true, true)"></awsui-button>\n                    <span class="copied-msg" ng-class="{ \'fade-in\' : copyFinished.flag === true, \'fade-out\' : copyFinished.flag === false, \'hide-msg\' : copyFinished.flag === null}" translate="copytoclipboard.path"></span>\n                </div>\n            </td>\n        </tr>\n        <tr>\n            <td></td>\n            <td class="error-display">\n                <table class="global-config-warning" ng-if="bucketSelectorObj.destinationBucket.versioningEnabled === false && !bucketSelectorObj.destinationBucket.Errors.getVersioningError && !bucketSelectorObj.destinationBucket.Errors.enabledVersioningError " ng-click="showGlobalConfigErrorModal(\'disabled\')">\n                    <tr>\n                        <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td>\n                        <td class="warning-text" translate="crr.warningmsg.content.notenabled"></td>\n                    </tr>\n                </table>\n                <table class="global-config-warning" ng-if="bucketSelectorObj.destinationBucket.Errors.getVersioningError" ng-click="showGlobalConfigErrorModal(\'getFailure\')">\n                    <tr>\n                        <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td>\n                        <td class="warning-text" translate="crr.warningmsg.content.cannotdetectversioning"></td>\n                    </tr>\n                </table>\n                <table class="global-config-warning" ng-if="bucketSelectorObj.destinationBucket.Errors.enabledVersioningError" ng-click="showGlobalConfigErrorModal(\'saveFailure\')">\n                    <tr>\n                        <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td>\n                        <td class="warning-text" translate="crr.warningmsg.content.cannotenableversioning"></td>\n                    </tr>\n                </table>\n                <table class="global-config-warning non-clickable" ng-if="bucketSelectorObj.destinationBucket.Errors.bucketNotExistError">\n                    <tr>\n                        <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td>\n                        <td class="warning-text" translate="crr.warningmsg.content.bucketnotexist"></td>\n                    </tr>\n                </table>\n                <table class="global-config-warning non-clickable" ng-if="bucketSelectorObj.destinationBucket.Errors.generalErrors && bucketSelectorObj.destinationBucket.Errors.generalErrors.header">\n                    <tr>\n                        <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td>\n                        <td class="warning-text">{{bucketSelectorObj.destinationBucket.Errors.generalErrors.header}}</td>\n                    </tr>\n                </table>\n                <table class="global-config-warning non-clickable" ng-if="tmpReplicationObj.getSourceKMSKeyError">\n                    <tr>\n                        <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td>\n                        <td class="warning-text">{{tmpReplicationObj.getSourceKMSKeyError.text }}<span bind-compiled-html="<a href=\'{{tmpReplicationObj.getSourceKMSKeyError.link}}\'>Click here.</a>"></span></td>\n                    </tr>\n                </table>\n            </td>\n            <td class="error-display">\n                <div ng-if="modalInfo.modalError.listRoleError" class="alert-exclamation-triangle awsui-icon awsui-icon-big global-config-errors">\n                    <span>{{modalInfo.modalError.listRoleError.text}}</span><span bind-compiled-html="<a href=\'{{modalInfo.modalError.listRoleError.link}}\'> Click here.</a>"></span>\n                </div>\n            </td>\n        </tr>\n        </tbody>\n    </table>\n    <div class="config-sections global-config-buttons">\n        <div class="global-setting-buttons">\n            <div class="config-buttons">\n                <awsui-button id="crr-global-enable-editing-button" ng-if="!modalInfo.isEditing" variant="link" ng-click="enableEditGlobalConfig()">\n                    <span translate="crr.globalconfig.editglobalsettings"></span>\n                </awsui-button>\n                <awsui-button id="crr-global-cancel" ng-if="modalInfo.isEditing" text="{{ \'crr.globalsettings.cancel\' | translate }}" variant="normal" click="cancelModifyGlobalConfig()"></awsui-button>\n                <awsui-button ng-if="modalInfo.isEditing" click="savePressed()" variant="primary" text="{{ \'crr.globalsettings.save\' | translate }}" loading="isSaving.flag || bucketSelectorObj.isLoading || multiSelectorObj.isLoadingData" class="primary-button" id="crr-global-save">\n                </awsui-button>\n            </div>\n            <table class="global-config-errors" ng-if="modalInfo.modalError.saveError">\n                <tr>\n                    <td class="alert-exclamation-triangle awsui-icon awsui-icon-big warning-icon"></td>\n                    <td class="warning-text">{{modalInfo.modalError.saveError}}</td>\n                </tr>\n            </table>\n        </div>\n    </div>\n</div>\n<crr-error-modal ng-if="errorModal.isOpen.flag" bucket-selector-obj="bucketSelectorObj" modal-open="errorModal.isOpen" bucket="tmpReplicationObj.Destination.Bucket" error-type="errorType" access-control-translation-ids="replicationObj.globalSettings.accessControlTranslationIds" copy-policy-to-clipboard="copyPolicyToClipboard">\n</crr-error-modal>');a.put("/s3/partials/bucket-replication/crr-receiveobjectmodal.html",'<dialog-modal class="receive-object-modal" is-open="modalInfo.isOpen" close-callback="closeReceiveObjectsModal" header-title="modalInfo.title">\n    <dialog-modal-content>\n        <div class="modal-section">\n            <p class="section-text" translate="receiveobjectsmodal.sourceaccountid"></p>\n            <awsui-control-group validation-message="{{accountIdError}}">\n                <awsui-textfield ng-model="modalInfo.sourceAccountId" ng-keydown="resetAccountIdError()" placeholder="{{ \'receiveobjectsmodal.sourceaccountidplaceholder\' | translate}}" class="accountid-input" blur="updateEditor()"></awsui-textfield>\n            </awsui-control-group>\n        </div>\n        <div class="modal-content-divider"></div>\n        <div class="modal-section">\n            <div class="section-title" translate="receiveobjectsmodal.bucketversioningtitle"></div>\n            <awsui-button ng-if="!modalInfo.isVersioningEnabled &&  !modalInfo.isLoading.versioning && !modalInfo.isLoading.getVersioning" click="enableBucketVersion()" variant="primary" loading="modalInfo.isLoading.versioning" text="{{ \'receiveobjectsmodal.enableversioning\' | translate }}" class="awsui-util-f-r primary-button dark enable-versioning-button">\n            </awsui-button>\n            <span ng-if="modalInfo.isVersioningEnabled && !modalInfo.isLoading.versioning" class="awsui-icon alert-check-circle float-to-right"></span>\n            <span ng-if="modalInfo.isLoading.getVersioning" class="awsui-spinner awsui-spinner-light float-to-right"></span>\n            \n            <p class="section-text" translate="receiveobjectsmodal.bucketversioningtext"></p>\n            <awsui-alert type="warning" header="{{\'error.header\'|translate}}" ng-if="modalInfo.versioningError">{{modalInfo.versioningError}}\n            </awsui-alert>\n        </div>\n        <div class="modal-content-divider"></div>\n        <div class="modal-section">\n            <awsui-button data-disabled="!modalInfo.sourceAccountId || accountIdError" click="updateBucketPolicy()" variant="primary" loading="modalInfo.isLoading.bucketPolicy" text="{{ \'receiveobjectsmodal.applysettings\' | translate }}" class="awsui-util-f-r primary-button dark">\n            </awsui-button>\n            <div class="copy-message">\n                <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant="link" class="dark" ng-click="copyBucketPolicyToClipboard( copyBucketPolicyFinished)"></awsui-button>\n                <span class="copied-msg" ng-class="{ \'fade-in\' : copyBucketPolicyFinished.flag === true, \'fade-out\' : copyBucketPolicyFinished.flag === false, \'hide-copied-msg\' : copyBucketPolicyFinished.flag === null}" translate="copytoclipboard.path"></span>\n            </div>\n            <awsui-expandable-section id="expand-bucket-policy" class="dark content-section expand-section" header="{{ \'receiveobjectsmodal.bucketpolicyheader\' | translate}}" ng-click="scrollIntoView(\'expand-bucket-policy\')">\n                <awsui-checkbox class="rogueactor-checkboxtext" checked="modalInfo.isRogueActorEnabled" ng-model="modalInfo.isRogueActorEnabled" ng-change="updateEditor(true)">\n                    <span translate="receiveobjectsmodal.enablerogueactortext"></span>\n                </awsui-checkbox>\n                <div class="crr-modal-bucketpolicy-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: bucketPolicyEditorLoaded}" class="code" readonly="true"></div>\n                <div class="section-text" translate="receiveobjectsmodal.bucketpolicy"></div>\n            </awsui-expandable-section>\n            <awsui-alert type="warning" header="{{\'error.header\'|translate}}" ng-if="modalInfo.bucketPolicyError">{{modalInfo.bucketPolicyError}}\n            </awsui-alert>\n        </div>\n        <div class="modal-content-divider"></div>\n\n        <div class="modal-section">\n            <div class="copy-message">\n                <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant="link" class="dark crr-copy-button" ng-click="copyKMSPolicyToClipboard( copyKmsPolicyFinished)"></awsui-button>\n                <span class="copied-msg" ng-class="{ \'fade-in\' : copyKmsPolicyFinished.flag === true, \'fade-out\' : copyKmsPolicyFinished.flag === false, \'hide-copied-msg\' : copyKmsPolicyFinished.flag === null}" translate="copytoclipboard.path"></span>\n            </div>\n            <awsui-expandable-section id="expand-kms-policy" class="dark content-section expand-section" header="{{ \'receiveobjectsmodal.kmskeypolicyheader\' | translate}}" ng-click="scrollIntoView(\'expand-kms-policy\')">\n                <div class="crr-modal-kmskey-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: kmsPolicyEditorLoaded}" class="code" readonly="true"></div>\n                <p class="section-text"><span translate="replicationmodal.permissionstep.kmskeypolicytext"></span><a target="_blank" href="{{docLink}}" translate="">learn.more</a></p>\n            </awsui-expandable-section>\n        </div>\n    </dialog-modal-content>\n    <dialog-modal-footer>\n        <awsui-button id="crr-confirmation-cancel" text="{{ \'receiveobjectsmodal.cancel\' | translate }}" variant="normal" click="closeReceiveObjectsModal()"></awsui-button>\n    </dialog-modal-footer>\n</dialog-modal>');a.put("/s3/partials/bucket-replication/replicationmodal.html",'<crr-global-settings ng-if="modalInfo.flag" bucket-selector-obj="bucketSelectorObj" replication-obj="replicationObj" tmp-replication-obj="tmpReplicationObj" modal-info="modalInfo" selected-rule="selectedRule" multi-selector-obj="multiSelectorObj"></crr-global-settings>\n<modal class="replication-modal" is-open="modalInfo.isOpen" steps="STEP" state="state" close-callback="closeReplicationModal" header-title="headerTitle" next-state="nextState" previous-state="previousState" set-state="setState">\n    <modal-content>\n        <div class="replication-modal-content">\n            <div class="body-content" ng-if="state === STEP.SOURCE">\n                <div ng-if="!modalState.showSourceVersioningWarning">\n                    <p class="subheader" translate="replicationmodal.label.source"></p>\n                    <div class="modal-content-divider"></div>\n                    <div class="upper-section">\n                        <awsui-radio-group ng-model="tmpReplicationObj.isEntireBucket">\n                            <awsui-tooltip class="replication-modal-disabledradio-tooltip" ng-if="replicationObj.ruleSettings.Rule && (!replicationObj.globalSettings.isEntireBucket && !modalInfo.isOverride || modalInfo.isOverride && modalInfo.prefixOrWholeBucket.value === modalInfo.PREFIX)" text="{{\'crr.prefixtooltip\' | translate}}" position="bottom">\n                                <awsui-radio-button value="true" disabled="true" id="crr-modal-disabled-entirebucket-button">\n                                    <span translate="replicationmodal.sourcestep.entirebucketradiobutton.disabled" translate-values="{ sourceBucket: replicationObj.globalSettings.sourceBucket.name }"></span>\n                                </awsui-radio-button>\n                            </awsui-tooltip>\n                            <awsui-radio-button id="entirebucket-radiobtn" ng-if="!replicationObj.ruleSettings.Rule || !(!replicationObj.globalSettings.isEntireBucket && !modalInfo.isOverride || modalInfo.isOverride && modalInfo.prefixOrWholeBucket.value === modalInfo.PREFIX)" value="true" disabled="false">\n                                <span translate="replicationmodal.sourcestep.entirebucketradiobutton.enabled" translate-values="{ sourceBucket: replicationObj.globalSettings.sourceBucket.name }"></span>\n                            </awsui-radio-button>\n                            <awsui-tooltip class="replication-modal-disabledradio-tooltip" id="crr-modal-disabled-prefix-tooltip" ng-if="replicationObj.ruleSettings.Rule && (replicationObj.globalSettings.isEntireBucket && !modalInfo.isOverride || modalInfo.isOverride && modalInfo.prefixOrWholeBucket.value === modalInfo.ENTIRE_BUCKET)" text="{{\'crr.prefixtooltip\' | translate}}" position="bottom">\n                                <awsui-radio-button value="false" disabled="true"><span class="text-disabled" translate="replicationmodal.sourcestep.prefixinbucket"></span></awsui-radio-button>\n                            </awsui-tooltip>\n                            <awsui-radio-button id="prefix-radiobtn" ng-if="!replicationObj.ruleSettings.Rule || !(replicationObj.globalSettings.isEntireBucket && !modalInfo.isOverride || modalInfo.isOverride && modalInfo.prefixOrWholeBucket.value === modalInfo.ENTIRE_BUCKET)" value="false" disabled="false"><span translate="replicationmodal.sourcestep.prefixinbucket"></span></awsui-radio-button>\n                            <awsui-control-group validation-message="{{ modalInfo.modalError.inputPrefixError }}" class="prefix-input">\n                                <awsui-textfield ng-if="tmpReplicationObj.isEntireBucket === \'false\'" class="replication-modal-input" ng-keydown="resetInputPrefixError()" ng-keyup="checkInputPrefix(tmpReplicationObj.Prefix)" placeholder="{{\'replicationmodal.placeholder.prefix\' | translate}}" ng-model="tmpReplicationObj.Prefix"></awsui-textfield>\n                            </awsui-control-group>\n                        </awsui-radio-group>\n                    </div>\n                    <p class="subheader" translate="replicationmodal.sourcestep.rulestatus"></p>\n                    <div class="modal-content-divider"></div>\n                    <awsui-radio-group ng-model="tmpReplicationObj.Status">\n                        <awsui-radio-button id="crr-status-enabled" value="Enabled" label="{{\'replicationmodal.sourcestep.enabled\' | translate}}"></awsui-radio-button>\n                        <awsui-radio-button id="crr-status-disabled" value="Disabled" label="{{\'replicationmodal.sourcestep.disabled\' | translate}}"></awsui-radio-button>\n                    </awsui-radio-group>\n                    <div fac-id="s3-crr-kms">\n                        <p class="subheader soruce-criteria-title" translate="replicationmodal.sourcestep.replicationcriteria"></p>\n                        <div class="modal-content-divider"></div>\n                        <awsui-checkbox id="crr-modal-kmskey" ng-model="tmpReplicationObj.Destination.isKmsEncryption" checked="tmpReplicationObj.Destination.isKmsEncryption" ng-change="fetchSourceSelectedKMSKeys(tmpReplicationObj.Destination.isKmsEncryption)">\n                            <span translate="replicationmodal.sourcestep.kmskeytext"></span>\n                        </awsui-checkbox>\n                        <awsui-tooltip class="crr-modal-accesscontroltranslation-tooltip" text="{{ \'crr.tooltips.replicatekmsencrypt\'| translate }}" position="right" size="small" initialized="true">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                        <p ng-if="tmpReplicationObj.Destination.isKmsEncryption" class="choose-sourcekmskey" translate="crr.choosesourcekmskeytext"></p>\n                        <awsui-control-group class="source-kmskey" ng-if="tmpReplicationObj.Destination.isKmsEncryption" validation-message="{{ tmpReplicationObj.getSourceKMSKeyError.text }}">\n                            <multi-selector multi-selector-obj="multiSelectorObj" api-call="getListKMS"></multi-selector>\n                        </awsui-control-group>\n                        <awsui-alert type="warning" class="replicationmoal-kmswarning" ng-if="tmpReplicationObj.Destination.isKmsEncryption">{{\'replicationmodal.sourcestep.kmskeywarningmessage\' | translate}}\n                        </awsui-alert>\n                    </div>\n                </div>\n                <div ng-if="modalState.showSourceVersioningWarning">\n                    <awsui-alert header="{{ \'crr.warningmsg.content.notenabled\' | translate}}" type="warning" visible="modalInfo.modalError.sourceVersioning === null">\n                        <span translate="crr.warningmsg.detail.notenabled "></span>\n                    </awsui-alert>\n                    <awsui-button id="crr-modal-enablesourceversioning-button" variant="primary" text="{{ \'replicationmodal.destinationstep.enableversioningbutton\' | translate }}" class="primary-button" click="enableSourceVersioning()" loading="isEnablingSourceVersioning"></awsui-button>\n                    <awsui-alert header="{{\'error.header\' | translate}}" type="error" visible="modalInfo.modalError.sourceVersioning !== null">{{modalInfo.modalError.sourceVersioning}}</awsui-alert>\n                </div>\n            </div>\n            <div class="body-content" ng-if="state === STEP.DESTINATION">\n                <div class="upper-section">\n                    <p class="subheader" translate="replicationmodal.destinationstep.bucket"></p>\n                    <awsui-button ng-show="modalInfo.showChangeDestinationBtn" variant="link" class="dark change-bucket-button" ng-click="hideChangeDestinationBtn()" text="{{ \'replicationmodal.destinationstep.changebutton\' | translate}}"></awsui-button>\n                    <div class="modal-content-divider"></div>\n                    <div class="upper-section" ng-show="modalInfo.showChangeDestinationBtn">\n                        <div class="truncate"><span class="text-color-light">{{ tmpReplicationObj.Destination.Bucket.name}}</span></div>\n                    </div>\n                    <div ng-show="!modalInfo.showChangeDestinationBtn">\n                        <bucket-selector class="replication-modal-bucketselector" id="crr-modal-dstbucket-selector" show-bucket-name-only="true" choose-accounts="true" editable="true" bucket-replication="bucketSelectorObj" is-open="bucketSelectorObj.isOpen">\n                        </bucket-selector>\n                        <awsui-alert type="warning" visible="showOverrideDestWarning"><span translate="replicationmodal.destinationstep.overridemsg"></span></awsui-alert>\n                        <awsui-alert header="{{ \'crr.warningmsg.content.notenabled\' | translate }}" type="warning" visible="bucketSelectorObj.destinationBucket.versioningEnabled === false"><span translate="crr.warningmsg.detail.notenabled"></span></awsui-alert>\n                        <awsui-alert header="{{ \'crr.warningmsg.content.cannotdetectversioning\' | translate }}" type="warning" visible="bucketSelectorObj.destinationBucket.Errors.getVersioningError"><span translate="crr.warningmsg.detail.cannotdetectversioning"></span></awsui-alert>\n                        <awsui-button ng-if="bucketSelectorObj.destinationBucket.versioningEnabled === false" id="crr-modal-enable-dstbucketversioning-button" variant="primary" text="{{\'replicationmodal.destinationstep.enableversioningbutton\' | translate}}" class="primary-button" click="enableDestinationVersioning()" loading="isEnablingDestinationVersioning.flag"></awsui-button>\n                        <awsui-alert header="{{\'crr.warningmsg.content.cannotenableversioning\' | translate}}" type="warning" visible="bucketSelectorObj.destinationBucket.Errors.enabledVersioningError"><span translate="crr.warningmsg.detail.cannotenableversioning"></span></awsui-alert>\n                        <awsui-alert header="{{ \'crr.warningmsg.content.bucketnotexsit\' | translate}}" type="warning" visible="bucketSelectorObj.destinationBucket.Errors.bucketNotExistError"><span translate="crr.warningmsg.content.bucketnotexist"></span></awsui-alert>\n                        <awsui-alert header="{{ bucketSelectorObj.destinationBucket.Errors.generalErrors.header }}" type="warning" visible="bucketSelectorObj.destinationBucket.Errors.generalErrors">{{bucketSelectorObj.destinationBucket.Errors.generalErrors.content}}</awsui-alert>\n                    </div>\n                    <div class="createbucketbodycontent" ng-if="bucketSelectorObj.destinationBucket.createNewDestBucket">\n                        <p class="label" translate="createbucketmodal.label.name"></p>\n                        <awsui-tooltip text="{{\'createbucketmodal.bucketname.tooltip\' | translate}}" position="bottom" size="small">\n                            <i class="awsui-icon alert-info-circle info-circle"></i>\n                        </awsui-tooltip>\n                        <div class="bucketname-and-region"><awsui-control-group>\n                            <span dom-region="validationMessage" ng-if="bucketSelectorObj.destinationBucket.bucketNameValidationErrors.length > 0">\n                                <label ng-repeat="message in bucketSelectorObj.destinationBucket.bucketNameValidationErrors">{{message}}</label><br>\n                            </span>\n                                <span dom-region="control">\n                                <awsui-textfield id="bucket-name" class="create-bucket-modal-input" ng-keyup="validateBucketName()" placeholder="{{\'createbucketmodal.placeholder.name\' | translate}}" ng-model="bucketSelectorObj.destinationBucket.name"></awsui-textfield>\n                            </span></awsui-control-group>\n                        </div>\n                        <p class="label" translate="createbucketmodal.label.region"></p>\n                        <dropdown items="modalInfo.regions" class="crr-modal-region-dropdown" selected-item="bucketSelectorObj.destinationBucket.region" placeholder="{{ \'createbucketmodal.placeholder.region\' | translate }}" filter="true"></dropdown>\n                    </div>\n                </div>\n                <div fac-id="s3-crr-kms" class="lower-section" ng-if="tmpReplicationObj.Destination.isKmsEncryption">\n                    <p class="subheader" translate="replicationmodal.destinationstep.kmskeytitle"></p>\n                    <div class="modal-content-divider"></div>\n                    <p class="choose-destinationkmskey" translate="replicationmodal.destinationstep.kmskeytext"></p>\n                    <awsui-textfield ng-if="!bucketSelectorObj.destinationBucket.name || bucketSelectorObj.isCrossAccount || KMSServiceError || kmsKeys.length === 0" class="crr-modal-destinationkmskey-input" ng-model="tmpReplicationObj.Destination.replicaKmsKeyId" placeholder="{{ \'replicationmodal.typecustomarnplaceholderforcrossaccount\' | translate }}"></awsui-textfield>\n                    <awsui-control-group ng-if="!bucketSelectorObj.isCrossAccount && bucketSelectorObj.destinationBucket.name && !KMSServiceError && kmsKeys.length > 0" validation-message="{{ KMSServiceError }}">\n                        <dropdown class="destination-kmskey-dropdown" items="kmsKeys" placeholder="{{ \'replicationmodal.typecustomarnplaceholder\' | translate }}" disabled="KMSServiceError" selected-item="selectedKmsKeyObj.content" filter="true">\n                        </dropdown>\n                    </awsui-control-group>\n                </div>\n                <div class="lower-section">\n                    <p class="subheader" translate="replicationmodal.destinationstep.options"></p>\n                    <div class="modal-content-divider"></div>\n                    <awsui-checkbox id="crr-modal-changestorageclass" ng-model="tmpReplicationObj.Destination.changeDefaultStorageClass" checked="tmpReplicationObj.Destination.changeDefaultStorageClass" ng-change="resetStorageClassValue()">\n                        <span translate="replicationmodal.destinationstep.storageclasstext"></span>\n                    </awsui-checkbox>\n                    <awsui-select id="crr-modal-storageclass-selector" ng-if="tmpReplicationObj.Destination.changeDefaultStorageClass" placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-model="tmpReplicationObj.Destination.StorageClass.value" ng-change="updateStorageClassText(tmpReplicationObj.Destination.StorageClass.value)" items="storageClasses"></awsui-select>\n                    <div fac-id="s3-crr-kms">\n\n                        <awsui-tooltip class="replication-modal-disabledradio-tooltip" text="{{!bucketSelectorObj.isCrossAccount ? \'crr.accesscontroltranslation\' : \'\' | translate}}" position="bottom">\n                            <awsui-checkbox data-disabled="!bucketSelectorObj.isCrossAccount" id="crr-modal-accesscontroltranslate" ng-model="tmpReplicationObj.Destination.isAccessControlTranslation" checked="tmpReplicationObj.Destination.isAccessControlTranslation">\n                                <span translate="replicationmodal.destinationstep.accesscontroltranslationtext"></span>\n                            </awsui-checkbox>\n                        </awsui-tooltip>\n                        <awsui-tooltip class="crr-modal-accesscontroltranslation-tooltip" text="{{ \'crr.tooltips.accesscontroltranslation\'| translate }}" position="right" size="small" initialized="true">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                        <awsui-control-group ng-if="tmpReplicationObj.Destination.isAccessControlTranslation && showAccountIdTextField" validation-message="{{accountIdError}}">\n                            <awsui-textfield class="crr-modal-destinationkmskey-input" ng-model="accountIdForRogueActor.text" placeholder="{{ \'replicationmodal.accountidplaceholder\' | translate}}" ng-change="resetAccountIdError()" blur="checkAccountId(accountIdForRogueActor)"></awsui-textfield>\n                        </awsui-control-group>\n                    </div>\n                </div>\n            </div>\n            <div class="body-content" ng-if="state === STEP.PERMISSIONS">\n                <div class="upper-section">\n                    <p class="subheader" translate="replicationmodal.permissionstep.selectrole"></p>\n                    <awsui-button ng-if="modalInfo.showChangeRoleBtn" variant="link" class="dark change-role-button" ng-click="hideChangeRoleBtn()" text="{{\'replicationmodal.permissionstep.changebutton\' | translate}}"></awsui-button>\n                    <div class="modal-content-divider"></div>\n                    <div class="upper-section" ng-if="modalInfo.showChangeRoleBtn">\n                        <div class="truncate"><span class="text-color-light">{{tmpReplicationObj.Role.text}}</span></div>\n                    </div>\n                    <div ng-if="!modalInfo.showChangeRoleBtn">\n                        <dropdown class="iamrole-dropdown" items="modalInfo.iamRoles" selected-item="tmpReplicationObj.Role" placeholder="{{ \'replicationmodal.permissionstep.roleplaceholder\' | translate }}" filter="true"></dropdown>\n                        <awsui-alert type="warning" visible="showOverrideDestWarning"><span translate="replicationmodal.permissionstep.overriderolewarning"></span></awsui-alert>\n                    </div>\n                    <awsui-alert type="error" visible="modalInfo.modalError.listRoleError">\n                        {{modalInfo.modalError.listRoleError.text}}\n                    </awsui-alert>\n                </div>\n                <div ng-if="showBucketPolicyTemplate" class="lower-section">\n                    <p class="subheader" translate="replicationmodal.permissionstep.bucketpolicyheader"></p>\n                    <div class="modal-content-divider"></div>\n                    <p translate="replicationmodal.permissionstep.bucketpolicytext"></p>\n                    <span class="text-color-light" translate="replicationmodal.permissionstep.bucketpolicyheader"></span>\n                    <div class="copy-message">\n                        <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant="link" class="dark crr-copy-button" ng-click="copyPolicyToClipboard(crrBucketPolicy, copyBucketPolicyFinished); $event.stopPropagation();"></awsui-button>\n                        <span class="copied-msg" ng-class="{ \'fade-in\' : copyBucketPolicyFinished.flag === true, \'fade-out\' : copyBucketPolicyFinished.flag === false, \'hide-msg\' : copyBucketPolicyFinished.flag === null}" translate="replicataionmodal.copiedtoclipboard"></span>\n                    </div>\n                    <div class="crr-modal-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: policyEditorLoaded}" class="code" readonly="true"></div>\n                </div>\n                <div fac-id="s3-crr-kms" ng-if="showKMSPolicyTemplate" class="lower-section">\n                    <p class="subheader" translate="replicationmodal.permissionstep.kmskeypolicyheader"></p>\n                    <div class="modal-content-divider"></div>\n                    <p><span translate="replicationmodal.permissionstep.kmskeypolicytext"></span> <a class="learnmoreinmodal" target="_blank" href="{{docLink}}" translate="">learn.more</a></p>\n                    <span class="text-color-light" translate="replicationmodal.permissionstep.kmskeypolicyheader"></span>\n                    <div class="copy-message">\n                        <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant="link" class="dark crr-copy-button" ng-click="copyPolicyToClipboard(crrKmsKeyPolicy, copyKmsKeyPolicyFinished); $event.stopPropagation();"></awsui-button>\n                        <span class="copied-msg" ng-class="{ \'fade-in\' : copyKmsKeyPolicyFinished.flag === true, \'fade-out\' : copyKmsKeyPolicyFinished.flag === false, \'hide-msg\' : copyKmsKeyPolicyFinished.flag === null}" translate="replicataionmodal.copiedtoclipboard"></span>\n                    </div>\n                    <div class="crr-kms-modal-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: kmsKeyPolicyEditorLoaded}" class="code" readonly="true"></div>\n                </div>\n            </div>\n            <div class="body-content" ng-if="state === STEP.REVIEW">\n                <table class="review-table">\n                    <tr>\n                        <td class="review-subheader" translate="replicationmodal.reviewstep.sourcetitle"></td>\n                        <td class="edit-button">\n                            <awsui-button class="button-in-darkbg" class="button-in-darkbg" text="{{ \'createbucketmodal.button.edit\' | translate }}" variant="link" ng-click="setState(STEP.SOURCE)"></awsui-button></td>\n                    </tr>\n                </table>\n                <table class="crr-modal-review-table">\n                    <tr>\n                        <td class="review-title" translate="replicationmodal.reviewstep.sourcepart.bucket"></td>\n                        <td id="crr-modal-review-sourcebucket" class="review-value">{{ replicationObj.globalSettings.sourceBucket.name}}</td>\n                    </tr>\n                    <tr>\n                        <td class="review-title"></td>\n                        <td class="review-value">\n                            <span ng-if="tmpReplicationObj.isEntireBucket===\'true\'" translate="replicationmodal.reviewstep.entirebucket"></span>\n                            <span ng-if="tmpReplicationObj.isEntireBucket === \'false\'" translate="replicationmodal.reviewstep.prefix" translate-values="{prefix: tmpReplicationObj.Prefix}"></span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td class="review-title" translate="replicationmodal.reviewstep.sourcepart.region"></td>\n                        <td class="review-value">{{ replicationObj.globalSettings.sourceBucket.region}}</td>\n                    </tr>\n                    <tr>\n                        <td class="review-title" translate="replicationmodal.reviewstep.status"></td>\n                        <td ng-if="tmpReplicationObj.Status === REPLICATION.ENABLED" class="review-value" translate="{{\'replicationmodal.sourcestep.enabled\' | translate}}"></td>\n                        <td ng-if="tmpReplicationObj.Status === REPLICATION.DISABLED" class="review-value" translate="{{\'replicationmodal.sourcestep.disabled\' | translate}}"></td>\n                    </tr>\n                </table>\n                <table class="review-table">\n                    <tr>\n                        <td class="review-subheader" translate="replicationmodal.reviewstep.destinationtitle"></td>\n                        <td class="edit-button">\n                            <awsui-button class="button-in-darkbg" class="button-in-darkbg" text="{{ \'createbucketmodal.button.edit\' | translate }}" variant="link" ng-click="setState(STEP.DESTINATION)"></awsui-button></td>\n                    </tr>\n                </table>\n                <table class="crr-modal-review-table">\n                    <tr>\n                        <td class="review-title" translate="replicationmodal.reviewstep.destpart.bucket"></td>\n                        <td id="crr-modal-review-dstbucket" class="review-value">{{ tmpReplicationObj.Destination.Bucket.name }}</td>\n                    </tr>\n                    <tr>\n                        <td class="review-title" translate="replicationmodal.reviewstep.destpart.region"></td>\n                        <td class="review-value">{{ tmpReplicationObj.Destination.Bucket.region }}</td>\n                    </tr>\n                    <tr>\n                        <td class="review-title" translate="replicationmodal.reviewstep.destpart.storageclass"></td>\n                        <td id="crr-modal-review-dststorageclass" class="review-value">{{tmpReplicationObj.Destination.StorageClass.text}}</td>\n                    </tr>\n                    <tr fac-id="s3-crr-kms" ng-if="tmpReplicationObj.Destination.isAccessControlTranslation">\n                        <td class="review-title" translate="replicationmodal.reviewstep.destpart.accesscontroltranslation" colspan="2"></td>\n                    </tr>\n                    <tr fac-id="s3-crr-kms" ng-if="tmpReplicationObj.Destination.isKmsEncryption">\n                        <td class="review-title" translate="replicationmodal.reviewstep.destpart.kmsencryption" colspan="2"></td>\n                    </tr>\n                </table>\n                <table class="review-table">\n                    <tr>\n                        <td class="review-subheader" translate="replicationmodal.reviewstep.permissionstitle"></td>\n                        <td class="edit-button">\n                            <awsui-button class="button-in-darkbg" class="button-in-darkbg" text="{{ \'createbucketmodal.button.edit\' | translate }}" variant="link" ng-click="setState(STEP.PERMISSIONS)"></awsui-button></td>\n                    </tr>\n                </table>\n                <table class="crr-modal-review-table crr-modal-review-iamrole-table">\n                    <tr>\n                        <td class="review-title" translate="replicationmodal.reviewstep.iamrole"></td>\n                        <td id="crr-modal-review-iamrole" class="review-value">{{tmpReplicationObj.Role.text}}</td>\n                    </tr>\n                </table>\n                <div class="review-policy" ng-if="showBucketPolicyTemplate">\n                    <div class="copy-message">\n                        <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant="link" class="dark crr-copy-button" ng-click="copyPolicyToClipboard(crrBucketPolicy, copyBucketPolicyFinished)"></awsui-button>\n                        <span class="copied-msg" ng-class="{ \'fade-in\' : copyBucketPolicyFinished.flag === true, \'fade-out\' : copyBucketPolicyFinished.flag === false, \'hide-msg\' : copyBucketPolicyFinished.flag === null}" translate="copytoclipboard.path"></span>\n                    </div>\n                    <awsui-expandable-section id="expand-bucket-policy" class="dark" header="{{ \'receiveobjectsmodal.bucketpolicyheader\' | translate}}" ng-click="scrollIntoView(\'expand-bucket-policy\')">\n                        <div class="crr-modal-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: policyEditorLoaded}" class="code" readonly="true"></div>\n                    </awsui-expandable-section>\n                </div>\n                <div fac-id="s3-crr-kms" class="kms-policy review-policy" ng-if="showKMSPolicyTemplate">\n                    <div class="copy-message">\n                        <awsui-button text="{{ \'crr.globalconfig.copypolicy\' | translate }}" variant="link" class="dark crr-copy-button" ng-click="copyPolicyToClipboard(crrKmsKeyPolicy, copyKmsKeyPolicyFinished)"></awsui-button>\n                        <span class="copied-msg" ng-class="{ \'fade-in\' : copyKmsKeyPolicyFinished.flag === true, \'fade-out\' : copyKmsKeyPolicyFinished.flag === false, \'hide-msg\' : copyKmsKeyPolicyFinished.flag === null}" translate="copytoclipboard.path"></span>\n                    </div>\n                    <awsui-expandable-section id="expand-kms-policy" class="dark" header="{{ \'replicationmodal.permissionstep.kmskeypolicyheader\' | translate }}" ng-click="scrollIntoView(\'expand-kms-policy\')">\n                        <div class="crr-kms-modal-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: kmsKeyPolicyEditorLoaded}" class="code" readonly="true"></div>\n                    </awsui-expandable-section>\n                </div>\n                <awsui-alert visible="modalInfo.modalError.saveError" class="block small-top-margin crr-save-error" type="error" dismissible="false" header="{{ \'error.header\' | translate }}"> {{ modalInfo.modalError.saveError }}\n                </awsui-alert>\n            </div>\n        </div>\n    </modal-content>\n    <modal-footer>\n        <div class="replication-modal-footer" transclude-name="footer">\n            <awsui-button id="next-step" ng-if="state !== STEP.REVIEW" data-disabled="!modalState.showNext || tmpReplicationObj.isEntireBucket===null || state === STEP.SOURCE && (tmpReplicationObj.isEntireBucket===\'false\' && (!tmpReplicationObj.Prefix\n                          || modalInfo.modalError.inputPrefixError) || tmpReplicationObj.Destination && tmpReplicationObj.Destination.isKmsEncryption && !multiSelectorObj.totalSelectedCount ) || state === STEP.DESTINATION && ( bucketSelectorObj.destinationBucket.Errors.bucketNotExistError || bucketSelectorObj.destinationBucket.Errors.generalErrors || bucketSelectorObj.destinationBucket.createNewDestBucket && bucketSelectorObj.destinationBucket.bucketNameValidationErrors.length > 0 || !bucketSelectorObj.destinationBucket.name\n                          || bucketSelectorObj.destinationBucket.createNewDestBucket && !bucketSelectorObj.destinationBucket.region\n                          || !tmpReplicationObj.Destination.StorageClass.value && tmpReplicationObj.Destination.changeDefaultStorageClass\n                          || bucketSelectorObj.destinationBucket.versioningEnabled === false && !bucketSelectorObj.destinationBucket.Errors.getVersioningError && !bucketSelectorObj.destinationBucket.Errors.enabledVersioningError || tmpReplicationObj.Destination.isKmsEncryption && (!bucketSelectorObj.isCrossAccount && !selectedKmsKeyObj.content || bucketSelectorObj.isCrossAccount && !tmpReplicationObj.Destination.replicaKmsKeyId) || tmpReplicationObj.Destination.isAccessControlTranslation && (!bucketSelectorObj.destinationBucket.accountId && !accountIdForRogueActor.text|| accountIdError))\n                          || state === STEP.PERMISSIONS && !tmpReplicationObj.Role.text" variant="primary" text="{{ \'replicationmodal.reviewstep.next\' | translate }}" loading="bucketSelectorObj.isLoading || multiSelectorObj.isLoadingData" class="awsui-util-f-r primary-button" click="nextCRRStep()">\n            </awsui-button>\n            <awsui-button id="save-rule" ng-if="state === STEP.REVIEW" click="savePressed()" loading="isSaving.flag" variant="primary" text="{{ \'replicationmodal.reviewstep.save\' | translate }}" class="awsui-util-f-r primary-button">\n            </awsui-button>\n            <awsui-button id="cancel-rule" text="{{ \'replicationmodal.reviewstep.cancel\' | translate }}" variant="normal" ng-if="state === STEP.SOURCE" class="awsui-util-f-r" click="closeReplicationModal()">\n            </awsui-button>\n            <awsui-button id="previous-step" text="{{ \'replicationmodal.reviewstep.previous\' | translate }}" variant="normal" ng-if="state !== STEP.SOURCE" data-disabled="isSaving.flag" class="awsui-util-f-r" click="previousState(); copyFinished.flag=null">\n            </awsui-button>\n        </div>\n    </modal-footer>\n</modal>');a.put("/s3/partials/bucketaccelerate.html",'<card card-id="scrollCardId" card-summary-obj="cardSummaryObj" is-open="cardOpen" ng-class="{ \'card-disable-bolt-water-mark\': !cardOpen, \'card-enable-bolt-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="bucketproperties.label.accelerate"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelBucketAccelerate($event)"></div>\n    </card-header>\n    <card-content>\n        <p ng-if="!cardOpen" class="bucketproperties-summary" translate="bucketproperties.summary.accelerate"></p>\n        <p class="accelerate-endpoint" ng-if="cardOpen" translate="bucketproperties.acceleration.endpoint" translate-values="{ endpoint: \'{{accelerate.endpoint}}\' }"></p>\n        <p class="accelerate-description" ng-if="cardOpen" translate="bucketproperties.description.accelerate"></p>\n        <a class="accelerate-compare" ng-if="cardOpen" target="_blank" href="{{comparisonEndpoint}}" translate="bucketproperties.compare.accelerate"></a>\n        <div ng-if="cardOpen" class="padding-bottom-20"></div>\n        <div class="awsui-container" ng-if="cardOpen">\n            <awsui-radio-group ng-model="accelerate.selectedValue">\n                <div class="awsui-row card-content-row">\n                    \n                    <awsui-radio-button class="enableAccelerate" value="Enabled" ng-model="accelerate.selectedValue" label="{{ \'bucketproperty.enabled\' | translate }}"></awsui-radio-button>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <awsui-radio-button class="suspendAccelerate" value="Suspended" ng-model="accelerate.selectedValue" label="{{ \'bucketproperty.suspended\' | translate }}">\n                    </awsui-radio-button>\n                </div>\n            </awsui-radio-group>\n        </div>\n        <awsui-alert type="error" class="error-alert" ng-if="error && cardOpen"> {{ error }}</awsui-alert>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{learnMoreLink}}" translate="">learn.more</a>\n        <div ng-if="cardOpen" class="padding-bottom-20"></div>\n    </card-content>\n    <card-footer>\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="cancel-bucket-accelerate" ng-click="cancelBucketAccelerate($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-accelerate" ng-click="saveBucketAccelerate($event)" text="{{ \'button.save\' | translate }}" variant="primary" loading="saving"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/bucketconfirmationmodal.html",'<div class="confirmation-modal">\n    <dialog-modal class="bucket-confirmation-modal" is-open="isOpen" close-callback="closeConfirmationModal()" header-title="headerTitle">\n        <dialog-modal-content>\n            <awsui-alert class="confirmation-warning" visible="!showContinue" type="warning"> {{ warningMessage }} </awsui-alert>\n            <p class="label"> {{ \'confirmationmodal.typebucketname\' | translate }} </p>\n            <awsui-textfield id="deletebucket-input" ng-keydown="compareBucketNames($event)" class="bucket-name" ng-model="confirmationModal.bucketName"></awsui-textfield>\n            <awsui-alert class="confirmation-warning" type="warning" dismissable="true" ng-if="isDelete">\n                {{ \'confirmationmodal.uniquebucketwarning\' | translate }}\n            </awsui-alert>\n            <awsui-alert class="confirmation-warning" type="error" dismissible="false" visible="showIncorrectBucketError">\n                {{ \'confirmationmodal.incorrectbucketerror\' | translate }}\n            </awsui-alert>\n        </dialog-modal-content>\n        <dialog-modal-footer>\n            <awsui-button id="cancel" text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant="normal" click="closeConfirmationModal()"></awsui-button>\n            <awsui-button id="save" click="saveOperation()" variant="primary" text="{{ \'confirmationmodal.footer.confirm\' | translate }}" class="awsui-util-f-r primary-button">\n            </awsui-button>\n        </dialog-modal-footer>\n    </dialog-modal>\n</div>');a.put("/s3/partials/bucketdetails.html",'<div class="header-section watermark-wrapper">\n    <div class="watermark-bucket watermark"></div>\n    <breadcrumbs class="listobjects-breadcrumbs"></breadcrumbs>\n</div>\n<awsui-tabs class="bucket-tabs bucket-details-tabs" tabs="tabs" ng-model="selectedTab" ng-switch="selectedTab" ng-click="setTabParam(selectedTab)">\n    <div ng-switch-default="">\n        <ng-include src="\'/s3/partials/objects.html\'"></ng-include>\n    </div>\n    <div ng-switch-when="properties">\n        <ng-include src="\'/s3/partials/bucketproperties.html\'"></ng-include>\n    </div>\n    <div class="access-public-label show-public-on-tab" ng-if="access.bucketPublic && tabs.length > 1" translate="">world.access.public.label</div>\n    <div ng-switch-when="permissions">\n        <bucketpermissions access="access" analyze-access="analyzeAccess(cacheAllowed)"></bucketpermissions>\n    </div>\n    <div ng-switch-when="management" fac-id="s3-si">\n        <storage-management></storage-management>\n    </div>\n</awsui-tabs>\n<div operation-manager="" selected-tab="selectedTab"></div>');a.put("/s3/partials/bucketlifecycle.html",'<div>\n    <awsui-alert header="{{\'error.header\'|translate}}" type="error" ng-if="lifecycleError"> {{ lifecycleError }}</awsui-alert>\n    <div class="action-strip">\n        <awsui-button id="add-rule" class="action-button-spacing" text="{{\'bucketlifecycle.label.addlifecyclepolicy\' | translate}}" icon="plus" click="showLifecycleModalForCreate()" variant="primary"></awsui-button>\n        <awsui-button id="edit-rule" class="action-button-spacing" text="{{ \'bucketlifecycle.label.edit\' | translate }}" data-disabled="isEdit" click="showLifecycleModalForEdit()"></awsui-button>\n        <awsui-button id="delete-rule" class="action-button-spacing" text="{{ \'bucketlifecycle.label.delete\' | translate }}" data-disabled="isDelete" click="showConfirmationModal(\'deletePolicy\')"></awsui-button>\n        <action-dropdown class="bucket-more-dropdown" text="{{ \'bucketlifecycle.label.more\' | translate }}" items="moreOptions"></action-dropdown>\n        <awsui-button class="lifecycle-refresh-icon" id="refresh-button" icon="refresh" variant="standalone-icon" loading="isRefreshing" click="initialize()"></awsui-button>\n    </div>\n    <empty-state ng-if="showEmptyScreen" open-modal="showLifecycleModalForCreate" type="\'lifecycle\'"></empty-state>\n    <div ng-if="!showEmptyScreen" class="columbia-table">\n        <table class="table table-condensed">\n            <thead>\n            <tr class="black-header">\n                <th></th>\n                <th><a translate="bucketlifecycle.policy"></a></th>\n                <th><a translate="bucketlifecycle.applied"></a></th>\n                <th><a translate="bucketlifecycle.currentversiontransition"></a></th>\n                <th><a translate="bucketlifecycle.previousversionaction"></a></th>\n            </tr>\n            </thead>\n            <tbody>\n            <tr ng-class="{\'row-selected\' : rule.selected, \'row-hover\': hoverRule && !rule.selected}" ng-mouseenter="hoverRule = true" ng-mouseleave="hoverRule = false" ng-repeat="rule in lifecycle.listViewRules" ng-click="selectRule(rule, $index); $event.stopPropagation();">\n                <td><span class="lifecycle-rule-status enabled-icon" ng-if="rule.Status === \'Enabled\'"></span>\n                    <span class="lifecycle-rule-status disabled-icon" ng-if="rule.Status === \'Disabled\'"></span>\n                </td>\n                <td> {{ rule.ID }} </td>\n                <td> {{ rule.Prefix }} </td>\n                <td> {{ rule.transitionsList }} </td>\n                <td> {{ rule.prevActions }} </td>\n            </tr>\n            </tbody>\n        </table>\n    </div>\n    <lifecycle-modal ng-if="isLifecycleModalOpen.flag" is-open="isLifecycleModalOpen" selected-rule="lifecycle.selectedRule" rule-to-be-edited="lifecycle.ruleToBeEdited" disable-edit="isEdit" disable-delete="isDelete" is-editing="forEdit" initial-response="lifecycleConfiguration.Rules" initialize="initialize" initial-xml="lifecycle.initialXML" more-options="moreOptions" operation="operation"></lifecycle-modal>\n    <lifecycle-confirmation-modal selected-rule="lifecycle.selectedRule" rule-to-be-edited="lifecycle.ruleToBeEdited" disable-edit="isEdit" disable-delete="isDelete" list-rules="lifecycle.listViewRules" header-title="headerTitle" is-open="isConfirmationModalOpen" action-type="actionType" warning-message="warningMessage" initial-xml="lifecycle.initialXML" selected-rule-index="lifecycle.selectedRuleIndex" initial-response="lifecycleConfiguration.Rules" operation="operation" initialize="initialize" more-options="moreOptions"></lifecycle-confirmation-modal>\n</div>');a.put("/s3/partials/bucketlogging.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-logging-water-mark\': !cardOpen, \'card-enable-logging-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="bucketproperties.logging.label.logging"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelBucketLogging($event)"></div>\n    </card-header>\n    <card-content>\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="bucketproperties.logging.summary"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="logging.selectedValue">\n                    <awsui-radio-button value="enable" ng-model="logging.selectedValue" label="{{ \'bucketproperties.logging.label.enablelogging\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n            </div>\n            <div ng-if="logging.selectedValue === \'enable\'">\n                <div class="awsui-row card-content-row">\n                    <label class="target-value" translate="bucketproperties.logging.label.targetbucket"></label>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <awsui-select class="logging-select target-value" items="logging.targetBucketOptions" placeholder="{{ \'bucketproperties.logging.placeholder.selectbucket\' | translate }}" ng-model="logging.targetBucket"></awsui-select>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <label class="target-value" translate="bucketproperties.logging.label.targetprefix"></label>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <input type="text" class="properties-placeholder" ng-model="logging.targetPrefix" placeholder="{{ \'bucketproperties.logging.placeholder.entertargetprefix\' | translate }}">\n                    <awsui-tooltip text="{{\'bucketproperties.logging.targetprefix.tooltip\' | translate}}" position="top" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </div>\n            </div>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="logging.selectedValue">\n                    <awsui-radio-button value="disable" ng-model="logging.selectedValue" label="{{ \'bucketproperties.logging.label.disablelogging\' | translate }}">\n                    </awsui-radio-button>\n                </awsui-radio-group>\n            </div>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert type="error" class="error-alert" readonly="readonly" ng-if="loggingError && cardOpen">{{loggingErrorMessage}}</awsui-alert>\n    </card-content>\n    <card-footer>\n        <div id="logging-properties-buttons" ng-if="cardOpen" class="bucket-properties-buttons">\n            <awsui-button id="cancel-bucket-logging" ng-click="cancelBucketLogging($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-logging" ng-click="saveBucketLogging($event)" text="{{ \'button.save\' | translate }}" variant="primary" loading="saving"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/bucketpermissions.html",'<div>\n    <div class="permissions-header">\n        <awsui-button-group class="permissions-category-buttons">\n            <awsui-tooltip id="acl-button-tooltip" text="{{\'permissions.types.tooltip.acl\'|translate}}" position="top">\n                <div class="permissions-access-container">\n                    <awsui-button id="permission-acl-button" class="permission-action-button" text="{{ \'permissions.types.acl\' | translate }} " ng-click="showView(S3Constants.BUCKET_PERMISSION_TYPE.ACL)" ng-class="{ \'show-public\' : access.aclPublic }" variant="{{ permissions.selectedItem.value === S3Constants.BUCKET_PERMISSION_TYPE.ACL ? \'primary\' : \'\' }}"></awsui-button>\n                    <div class="access-public-label permission-access-label" ng-if="access.aclPublic" translate="">world.access.public.label</div>\n                </div>\n            </awsui-tooltip>\n            <awsui-tooltip id="buttonpolicy-button-tooltip" text="{{\'permissions.types.tooltip.policy\'|translate}}" position="top">\n                <div class="permissions-access-container">\n                    <awsui-button id="permission-policy-button" class="permission-action-button" text="{{ (\'permissions.types.policy\' | translate) }}" variant="{{ permissions.selectedItem.value === S3Constants.BUCKET_PERMISSION_TYPE.POLICY ? \'primary\' : \'\' }}" ng-click="showView(S3Constants.BUCKET_PERMISSION_TYPE.POLICY)" ng-class="{ \'show-public\' : access.policyPublic }"></awsui-button>\n                    <div class="access-public-label permission-access-label" ng-if="access.policyPublic" translate="">world.access.public.label</div>\n                </div>\n            </awsui-tooltip>\n            <awsui-tooltip text="{{\'permissions.types.tooltip.cors\'|translate}}" position="top">\n                <awsui-button id="permission-cors-button" class="permission-action-button" text="{{ \'permissions.types.cors\' | translate }}" variant="{{ permissions.selectedItem.value === S3Constants.BUCKET_PERMISSION_TYPE.CORS ? \'primary\' : \'\' }}" ng-click="showView(S3Constants.BUCKET_PERMISSION_TYPE.CORS)"></awsui-button>\n            </awsui-tooltip>\n        </awsui-button-group>\n    </div>\n    <awsui-alert visible="access.policyPublic && policyAfterAnalysis" class="block small-top-margin" type="warning" dismissible="false" header="{{ \'bucket.warningheader.granted.AllUsers\' | translate }}">\n        {{ \'world.access.detected.warning\' | translate }}\n    </awsui-alert>\n    <div class="permissions-container" ng-switch="permissions.selectedItem.value">\n        <awsui-alert visible="error" class="block permissions-error small-top-margin" type="error" dismissible="false" header="{{ \'permissions.error.header\' | translate }}"> {{ error }}\n        </awsui-alert>\n        <table class="editor-header">\n            <tr>\n                <td ng-switch-when="policy">\n                    <div class="description-container">\n                        <span class="ace-editor-title">{{ \'permissions.policy.header\' | translate}} </span>\n                        <span translate="permissions.label.bucketarn"></span>\n                        <span>{{bucketARN}}</span>\n                        <div class="ace-editor-description" translate="permissions.policy.description"></div>\n                    </div>\n                </td>\n                <td ng-switch-when="cors" class="permissions-editor">\n                    <div class="description-container">\n                        <span class="ace-editor-title">{{ \'permissions.cors.header\' | translate}} </span>\n                        <span translate="permissions.label.bucketarn"></span>\n                        <span> {{ bucketARN }}</span>\n                        <div class="ace-editor-description" translate="permissions.cors.description"></div>\n                    </div>\n                </td>\n                <td class="editor-buttons" ng-if="permissions.selectedItem.value===\'policy\' || permissions.selectedItem.value===\'cors\'">\n                    <awsui-button id="delete" variant="normal" text="{{ \'permissions.button.delete\' | translate }}" class="awsui-util normal-button" click="deletePermission()" loading="isDeleting" data-disabled="isSaving || isDeleting || (permissions.selectedItem.value===\'policy\' && !policy|| permissions.selectedItem.value===\'cors\' && !cors)">\n                    </awsui-button>\n                    <awsui-button id="cancel" variant="normal" text="{{ \'permissions.button.cancel\' | translate }}" class="awsui-util normal-button" click="cancel()" data-disabled="isSaving || isDeleting || (permissions.selectedItem.value===\'policy\' && !policyChanged || permissions.selectedItem.value===\'cors\' && !corsChanged)">\n                    </awsui-button>\n                    <awsui-button id="save-code" variant="primary" text="{{ \'permissions.button.save\' | translate }}" class="awsui-util normal-button" click="save()" loading="isSaving" data-disabled="disableSave()">\n                    </awsui-button>\n                </td>\n            </tr>\n        </table>\n\n        <div ng-if="permissions.selectedItem.value===\'policy\'" class="permissions-editor">\n            <div ng-if="gettingPolicy" class="editor-spinner-container">\n                <span class="awsui-spinner awsui-spinner-large"></span>\n            </div>\n            <div id="policy-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: policyEditorLoaded, onChange: policyEditorChanged }" class="code" ng-if="!gettingPolicy">\n            </div>\n            <table class="editor-docs-button">\n                <tr>\n                    <td>\n                        <awsui-button id="documentation" variant="link" text="{{ \'permissions.button.documentation\' | translate }}" class="awsui-util link-button" target="_blank" href="{{policyDocLink}}">\n                        </awsui-button>\n                    </td>\n                    <td>\n                        <awsui-button id="policy-generator" variant="link" text="{{ \'permissions.button.policygenerator\' | translate }}" class="awsui-util link-button" target="_blank" href="{{policyGenLink}}">\n                        </awsui-button>\n                    </td>\n                </tr>\n            </table>\n        </div>\n        <div ng-if="permissions.selectedItem.value===\'cors\'" class="permissions-editor">\n            <div ng-if="gettingCors" class="editor-spinner-container">\n                <span class="awsui-spinner awsui-spinner-large"></span>\n            </div>\n            <div id="cors-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'xml\', firstLineNumber: 1, onLoad: corsEditorLoaded, onChange: corsEditorChanged }" class="code" ng-if="!gettingCors"></div>\n            <div class="editor-docs-button">\n                <awsui-button id="cors-documentation" variant="link" text="{{ \'permissions.button.documentation\' | translate }}" class="awsui-util link-button" target="_blank" href="{{corsDocLink}}">\n                </awsui-button>\n            </div>\n        </div>\n        <div ng-switch-default="">\n            <acl permission-obj="permissionObj" put-acl="putAcl" error="error" bucket="bucket" is-bucket-permission="true" access="access" analyze-access="analyzeAccess({cacheAllowed : cacheAllowed})"></acl>\n        </div>\n    </div>\n</div>');a.put("/s3/partials/bucketproperties.html",'<div class="card-enabled-icon"></div>\n<div class="awsui-grid">\n    <div class="awsui-container properties-cards">\n        <hr class="properties-headers-line-space">\n        <div class="wrapper awsui-row">\n            <bucket-versioning id="bucket-versioning-card" card-open="toggleVersioning" versioning="versioning"></bucket-versioning>\n            <bucket-logging id="bucket-logging-card" card-open="toggleLogging" logging="logging"></bucket-logging>\n            <bucket-website id="bucket-website-card" card-open="toggleWebsite" website="website"></bucket-website>\n            <cloud-trail id="bucket-data-events" event-selectors="eventSelectors" card-open="toggleEventSelectors"></cloud-trail>\n            <default-encryption id="default-encryption-card" card-open="toggleDefaultEncryption" ng-if="enableDefaultDecryption"></default-encryption>\n        </div>\n        <hr class="properties-headers-line-space">\n        <div class="properties-headers">\n            <h1 translate="bucketproperties.title.advancedsettings"></h1>\n        </div>\n        <div class="wrapper awsui-row">\n            <bucket-tagging id="bucket-tagging-card" card-open="toggleTagging" bucket-tags="bucketTags.tagSet"></bucket-tagging>\n            <bucket-replication-v1 id="bucket-crr-card" ng-if="displayCRRV1" card-open="toggleCRR" versioning-status="versioning.selectedValue"></bucket-replication-v1>\n            <bucket-accelerate id="bucket-accelerate-card" ng-if="displayAcceleration" card-open="toggleAccelerate"></bucket-accelerate>\n            <events id="bucket-events-card" card-open="toggleEvents"></events>\n            <bucket-requester-pays id="bucket-requesterpays-card" card-open="toggleRequesterPays"></bucket-requester-pays>\n        </div>\n    </div>\n</div>');a.put("/s3/partials/bucketreports.html",'<div class="inventory-reports">\n    <div ng-if="!finishedLoading && !showError" class="awsui-spinner awsui-spinner-large" style="margin: 10% 50%">\n    </div>\n    <div ng-if="showError && reportsTable.length === 0">\n        <awsui-alert type="error" visible="showError">{{ errorMessage }}</awsui-alert>\n    </div>\n    <div class="empty-object-inventory" ng-if="reportsTable.length === 0 && finishedLoading && !showError">\n        <span class="no-reports-enabled" translate="">report.emptymessage</span>\n        <div class="no-inventory-reports-icon"><img src="/s3/img/no-inventory-reports.png"></div>\n        <div class="inventory-header" translate="">report.inventory</div>\n        <div class="inventory-additional-information" translate="">report.additionalInformation</div>\n        <awsui-button id="add-new-report" variant="link" icon="plus" text="{{ \'report.button.add\' | translate }}" click="addRow($event)"></awsui-button>\n    </div>\n    <div ng-if="reportsTable.length > 0 && finishedLoading">\n        <awsui-button id="create-new-report" disabled="isAdding || isEditingRow" variant="primary" icon="plus" text="{{ \'report.button.add\' | translate }}" click="addRow($event)"></awsui-button>\n        <awsui-button id="edit-report" disabled="reportsTable.length === 0 || isAdding || isEditingRow || selectedRowIndex < 0" variant="normal" text="{{ \'report.button.edit\' | translate }}" click="editRow($event)">\n        </awsui-button>\n        <awsui-button id="delete-report" disabled="reportsTable.length === 0 || isAdding || isEditingRow || selectedRowIndex < 0" variant="normal" text="{{ \'events.button.delete\' | translate }}" click="deletePressed()" loading="isDeleting">\n        </awsui-button>\n\n        <div class="events-table">\n            <div class="events-table">\n                <awsui-radio-group ng-model="radioValue.value">\n                    <table class="table table-condense reports-table">\n                        <thead>\n                        <tr>\n                            <td class="report-radio"></td>\n                            <td translate="">report.label.name</td>\n                            <td translate="">report.label.filter</td>\n                            <td>\n                                {{\'report.label.bucket\' | translate}}\n                                <awsui-tooltip text="{{ \'report.bucketPolicy.tooltip\' | translate }}" position="right" size="small">\n                                    <i class="awsui-icon alert-info-circle"></i>\n                                </awsui-tooltip>\n                            </td>\n                            <td translate="">report.label.prefix</td>\n                            <td translate="">report.label.freq</td>\n                            <td translate="">report.label.lastexport</td>\n                        </tr>\n                        </thead>\n                        <tbody>\n                            <tr ng-if="flags.displayDelayWarning">\n                                <td colspan="6">\n                                    <awsui-alert id="inventory-delay-alert" dismissible="true" ng-click="resetDelayWarning()" visible="flags.displayDelayWarning" header="{{\'report.warning.header\' | translate}}">\n                                        <span translate="">report.warning.text</span>\n                                    </awsui-alert>\n                                </td>\n                            </tr>\n                            <tr ng-if="policyStatus.policyMessage">\n                                <td colspan="6">\n                                    <awsui-alert id="inventory-policy-message" dismiss="resetPolicyStatus()" type="{{policyStatus.policyType}}" dismissible="true" visible="policyStatus.policyMessage" header="{{policyStatus.policyHeader}}">\n                                        <div>{{policyStatus.policyMessage}}\n                                            <span>\n                                                <a href="{{getLearnMoreLink(\'configure-inventory\')}}" target="_blank" translate="">learn.more</a>\n                                            </span>\n                                        </div>\n                                        <div class="policy-definition" ng-if="policyStatus.policyDefinition">\n                                            <pre>{{policyStatus.policyDefinition}}</pre>\n                                        </div>\n                                    </awsui-alert>\n                                </td>\n                            </tr>\n                            <tr ng-if="row.isEditing" ng-repeat-start="row in reportsTable" class="no-top-border">\n                                <td></td>\n                                <td class="report-input input-td">\n                                    <awsui-control-group class="label-text" validation-message="{{row.invalidNameMessage}}">\n                                        <awsui-textfield id="report-name-input" ng-class="{\'inventory-input-text\' : !row.nameError, \'verification-error\': row.nameError}" placeholder="{{\'report.placeholder.name\' | translate}}" ng-keyup="validateName(row)" ng-model="row.name"></awsui-textfield>\n                                    </awsui-control-group>\n                                </td>\n\n                                <td class="input-td">\n                                    <awsui-control-group class="label-text">\n                                        <span dom-region="validationMessage" ng-if="filterInfo">\n                                            <span translate="" translate-values="{ bucket1 : bucketName + \'/\' + filterInfo, bucket2: bucketName + filterInfo }">prefixsearch.validation.slash.start.warning</span>\n                                        </span>\n                                        <span dom-region="control">\n                                            <awsui-textfield id="report-filter-input" class="inventory-input-text" placeholder="{{\'report.placeholder.filter\' | translate}}" ng-keyup="validatePrefix()" ng-model="row.filter"></awsui-textfield>\n                                        </span>\n                                    </awsui-control-group>\n                                </td>\n                                <td class="input-td">\n                                    <awsui-control-group id="bucket-options-dropdown" class="label-text" validation-message="{{row.bucketUnknown}}">\n                                        <bucket-selector class="bucket-selector-object-inventory" selected-report="row" show-bucket-name-only="true" choose-accounts="true" editable="true" same-region="true" is-open="selectingBucket.selected">\n                                    </awsui-control-group>\n                                </td>\n                                <td class="input-td">\n                                    <awsui-control-group class="label-text">\n                                        <span dom-region="validationMessage" ng-if="prefixInfo">\n                                            <span translate="" translate-values="{ bucket1 : bucketNamePre + \'/\' + prefixInfo, bucket2: bucketNamePre + prefixInfo }">prefixsearch.validation.slash.start.warning</span>\n                                        </span>\n                                        <span dom-region="control">\n                                            <awsui-textfield id="report-dest-prefix-input" class="inventory-input-text" placeholder="{{\'report.placeholder.prefix\' | translate}}" ng-keyup="validatePrefix()" ng-model="row.prefix" data-disabled="!row.bucket">\n                                            </awsui-textfield>\n                                         </span>\n                                    </awsui-control-group>\n                                </td>\n                                <td class="frequency-input input-td">\n                                    <awsui-control-group class="label-text">\n                                        <awsui-select items="freqTypes" class="select-type-dropdown" ng-model="row.freq" ng-click="$event.stopPropagation()"></awsui-select>\n                                    </awsui-control-group>\n                                </td>\n                            </tr>\n                            <tr ng-if="row.isEditing" class="no-top-border">\n                                <td></td>\n                                <td colspan="5" ng-if="!showAdvancedSettingsDropdown"><awsui-button icon="plus" text="{{ \'bucketproperties.title.advancedsettings\' | translate }}" variant="link" ng-click="toggleAdvancedSettingsDropdown()"></awsui-button></td>\n                                <td colspan="5" ng-if="showAdvancedSettingsDropdown"><awsui-button text="- {{ \'bucketproperties.title.advancedsettings\' | translate }}" variant="link" ng-click="toggleAdvancedSettingsDropdown()"></awsui-button>\n                                    <table>\n                                        <tbody>\n                                        <tr fac-id="s3-report-format">\n                                            <th class="advanced-header">\n                                                <div class="advanced-header-label" translate="">report.label.outputformat</div>\n                                            </th>\n                                            <td>\n                                                <div class="inventory-encryption" ng-repeat="value in reportFormat">\n                                                    <div class="inventory-encryption-radio-button" ng-class="{\'radio-checked\': row.format === value[0]}" ng-click="reportFormatSelected(row, value[0])"></div>\n                                                    <span>{{value[0]}}</span>\n                                                    <awsui-tooltip text="{{value[1]}}" position="right" size="small">\n                                                        <i class="awsui-icon alert-info-circle"></i>\n                                                    </awsui-tooltip>\n                                                </div>\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <th class="advanced-header">\n                                                <div class="advanced-header-label" translate="">report.label.versions</div>\n                                            </th>\n                                            <td>\n                                                <awsui-control-group class="label-text">\n                                                    <awsui-select items="versionTypes" class="select-type-dropdown" ng-model="row.versioning" ng-click="$event.stopPropagation()"></awsui-select>\n                                                </awsui-control-group>\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <th class="advanced-header">\n                                                <div class="advanced-header-label" translate="">report.label.optional</div>\n                                            </th>\n                                            <td class="inventory-optional-fields">\n                                                <awsui-control-group class="label-text">\n                                                    <awsui-checkbox id="report-size" ng-model="row.optional.Size" checked="row.optional.Size">{{\'report.optional.size\' | translate}}</awsui-checkbox>\n                                                    <awsui-checkbox id="last-modified-date" ng-model="row.optional.LastModifiedDate" checked="row.optional.LastModifiedDate">{{\'report.optional.modified\' | translate}}</awsui-checkbox>\n                                                    <awsui-checkbox id="storage-class" ng-model="row.optional.StorageClass" checked="row.optional.StorageClass">{{\'report.optional.storageclass\' | translate}}</awsui-checkbox>\n                                                    <awsui-checkbox id="etag" ng-model="row.optional.ETag" checked="row.optional.ETag">{{\'report.optional.ETag\' | translate}}</awsui-checkbox>\n                                                    <awsui-checkbox id="multi-part" ng-model="row.optional.IsMultipartUploaded" checked="row.optional.IsMultipartUploaded">{{\'report.optional.multipart\' | translate}}</awsui-checkbox>\n                                                    <awsui-checkbox id="replication-status" ng-model="row.optional.ReplicationStatus" checked="row.optional.ReplicationStatus">{{\'report.optional.replicationstatus\' | translate}}</awsui-checkbox>\n                                                    <awsui-checkbox id="encryption-status" ng-click="encryptionStatusClicked($event, row)" ng-model="row.optional.EncryptionStatus" checked="row.optional.EncryptionStatus" fac-id="s3-inventory-encryption">{{\'report.optional.encryptionstatus\' | translate}}</awsui-checkbox>\n                                                </awsui-control-group>\n                                            </td>\n                                        </tr>\n                                        <tr fac-id="s3-inventory-encryption">\n                                            <th class="advanced-header">\n                                                <div class="advanced-header-label" translate="">report.encryptreport</div>\n                                            </th>\n                                            <td>\n                                                <div class="inventory-encryption" ng-repeat="value in encryption">\n                                                    <div class="inventory-encryption-radio-button" ng-class="{\'radio-checked\': row.encryption.type === value[0]}" ng-click="encryptionSelected(row, value[0])"></div>\n                                                    <span>{{value[1]}}</span>\n                                                </div>\n                                                <awsui-control-group class="encryption-keys">\n                                                    <dropdown ng-if="row.encryption.type === awsKMS" items="kmsKeys" items="kmsKeys" placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled="KMSServiceError" selected-item="row.encryption.kmsOption.kmsId" filter="true">\n                                                    </dropdown>\n                                                </awsui-control-group>\n                                                <div fac-id="s3-kms" ng-if="row.encryption.type === awsKMS" class="configure-kms-key">\n                                                    <awsui-control-group validation-message="{{ KMSServiceError }}">\n                                                    </awsui-control-group>\n                                                    <awsui-textfield ng-if="row.encryption.type === awsKMS && row.encryption.kmsOption.kmsId.value === customARN" ng-model="row.encryption.kmsOption.kmsARN">\n                                                    </awsui-textfield>\n                                                    <awsui-alert type="warning" dismissible="false" visible="true" header="{{\'report.encryption.kms.header\' | translate}}">{{\'report.encryption.kms.content\' | translate}} <a ng-href="{{inventoryEncryptionLink}}" target="_blank" translate="">learn.more</a></awsui-alert>\n                                                </div>\n                                            </td>\n                                        </tr>\n                                        </tbody>\n                                    </table>\n                                </td>\n                                <td colspan="4"></td>\n                            </tr>\n                            <tr ng-if="row.isEditing" class="bucket-properties-buttons no-top-border">\n                                <td></td>\n                                <td colspan="5" class="save-cancel-row">\n                                    <awsui-button id="cancel-report" text="{{ \'events.button.cancel\' | translate }}" variant="normal" ng-click="!isSaving && cancelPressed($event)" data-disabled="isSaving" class="cancel-button"></awsui-button>\n                                    <awsui-button id="save-report" text="{{ \'events.button.save\' | translate }}" variant="primary" data-disabled="shouldDisableSave(row)" ng-click="savePressed($event)" loading="isSaving"></awsui-button>\n                                </td>\n                            </tr>\n                            <tr ng-if="row.isEditing && showError">\n                                <td colspan="6">\n                                    <awsui-alert type="error" visible="showError">{{ errorMessage }}</awsui-alert>\n                                </td>\n                            </tr>\n                            <tr ng-class="{\'row-hover\': hoverRule && ($index !== selectedRowIndex), \'row-selected\': $index === selectedRowIndex}" ng-mouseenter="hoverRule = true" ng-mouseleave="hoverRule = false" ng-if="!row.isEditing" ng-click="selectRow($index)" class="inventory-row" ng-repeat-end="">\n                                <td class="report-radio">\n                                    <awsui-radio-button value="{{$index}}" disabled="isEditingRow">\n                                        <td ng-if="!row.isEditing" class="report-row">{{ row.name }}</td>\n                                        <td ng-if="!row.isEditing" class="report-row">{{ getFilterValue(row.filter) }}</td>\n                                        <td class="awsui-icon bucket report-row" ng-class="{\'awsui-icon-light\': $index === selectedRowIndex}" ng-if="!row.isEditing" class="report-row">{{ row.bucket }}</td>\n                                        <td ng-if="!row.isEditing" class="report-row">{{ getPrefixValue(row.prefix) }}</td>\n                                        <td ng-if="!row.isEditing">{{ getFrequencyTranslationValue(row.freq) }}</td>\n                                        <td ng-if="!row.isEditing">\n                                            <awsui-tooltip text="{{getLastExportTooltipMessage(row.name)}}" position="bottom" size="small">\n                                                <span class="alert-exclamation-triangle awsui-icon warning-triangle-icon" ng-if="hasLastExportFailed(row.name)" ng-class="{\'awsui-icon-light\': $index === selectedRowIndex}"></span>\n                                            </awsui-tooltip>\n                                            {{ getLastExportInfo(row.name) }}\n                                        </td>\n                                    </awsui-radio-button>\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </awsui-radio-group>\n            </div>\n        </div>\n    </div>\n</div>');a.put("/s3/partials/bucketrequesterpays.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-requesterpays-water-mark\': !cardOpen, \'card-enable-requesterpays-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="bucketproperties.requesterpays.label.requesterpays"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelBucketRequesterPays($event)"></div>\n    </card-header>\n    <card-content>\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="bucketproperties.requesterpays.summary"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <awsui-radio-group ng-model="requesterPays.selectedValue">\n                <div class="awsui-row card-content-row">\n                    <awsui-radio-button class="enableRequesterPays" value="Requester" ng-model="requesterPays.selectedValue" label="{{ \'bucketproperties.requesterpays.label.enablerequesterpays\' | translate }}"></awsui-radio-button>\n                    <p class="requesterpays-description" translate="bucketproperties.requesterpays.description.enablerequesterpays"></p>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <awsui-radio-button class="disableRequesterPays" value="BucketOwner" ng-model="requesterPays.selectedValue" label="{{ \'bucketproperties.requesterpays.label.disablerequesterpays\' | translate }}">\n                    </awsui-radio-button>\n                    <p class="requesterpays-description" translate="bucketproperties.requesterpays.description.disablerequesterpays"></p>\n                </div>\n            </awsui-radio-group>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert type="error" class="error-alert" ng-if="error && cardOpen"> {{ error }}</awsui-alert>\n    </card-content>\n    <card-footer>\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="cancel-bucket-requesterpays" ng-click="cancelBucketRequesterPays($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-requesterpays" ng-click="saveBucketRequesterPays($event)" text="{{ \'button.save\' | translate }}" variant="primary" loading="saving"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/buckets.html",'<div class="bucket-list">\n    <awsui-alert class="notification dark" type="info" ng-if="notificationShow">\n        <targetmbox></targetmbox>\n        <div class="notificationdoc awsui-util-f-r"><a href="{{docLink}}" target="_blank" class="awsui-icon awsui-icon-link-light" translate="notification.doc"></a></div>\n    </awsui-alert>\n    <div class="buckets-header">\n        <div class="breadcrumbs">\n            <span class="s3-logo-icon logo"></span>\n            <span translate="">lamb.label.allbuckets</span>\n        </div>\n        <div>\n            <hint></hint>\n        </div>\n    </div>\n    <div ng-class="{ \'bucket-nav-wrapper\': bucketList.length > 0, \'bucket-nav-wrapper-empty\': bucketList.length === 0 }">\n        <div class="action-strip" sticky-nav="fix-to-top" sticky-nav-padding-top="140">\n            <search ng-if="!showEmptyScreen" filters="filters" markers="markers" is-lamb-page="true"></search>\n            <awsui-button class="bucket-action-strip-button action-button-spacing" icon="plus" text="{{ \'bucketactionstrip.createbucket\' | translate }}" variant="primary" click="showCreateBucketModal()" data-disabled="!isFeatureEnabled(\'s3-cb\')"></awsui-button>\n            <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'bucketactionstrip.deletebucket\' | translate }}" variant="normal" click="deleteBucket()" data-disabled="selectedBucket === undefined || !isFeatureEnabled(\'s3-db\')"></awsui-button>\n            <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'bucketactionstrip.emptybucket\' | translate }}" variant="normal" click="emptyBucket()" data-disabled="selectedBucket === undefined || !isFeatureEnabled(\'s3-eb\')"></awsui-button>\n            <awsui-button class="refresh-button" icon="refresh" variant="standalone-icon" loading="isRefreshing" click="reloadBuckets()" data-disabled="isReloadDisabled()"></awsui-button>\n            <div class="num-regions">\n                <label class="counter-literal">{{ numRegions }}</label>\n                <label class="counter-literal counter-text" translate="">lamb.label.regions</label>\n            </div>\n            <div class="num-public-buckets" fac-id="s3-access" ng-click="showPublic()">\n                <label class="counter-literal public-count">{{ !bucketsLeftToAnalyze ? numPublic : numPublic || \'-\'}}</label>\n                <awsui-tooltip text="{{\'world.access.public.info\' | translate}}" position="bottom" size="small">\n                    <label class="counter-literal counter-text public-text" translate="">world.access.public.label</label>\n                </awsui-tooltip>\n            </div>\n            <div class="num-buckets">\n                <label class="counter-literal">{{ (bucketList | filter:filters.input).length}}</label>\n                <label class="counter-literal counter-text" translate="">lamb.label.buckets</label>\n            </div>\n        </div>\n    </div>\n    <awsui-alert class="lamb-error" type="error" header="{{\'error.header\'|translate}}" visible="error">{{error}}</awsui-alert>\n    <div class="columbia-table bucket-table" sticky-nav-padding-top="80">\n        <empty-state ng-if="showEmptyBucketScreen()" open-modal="showCreateBucketModal" type="\'bucket\'"></empty-state>\n        <table ng-if="!showEmptyBucketScreen()" class="table table-condensed fix-width-table">\n            <thead>\n            <tr>\n                <th ng-click="setSortOrder(\'Name\')">\n                    <a translate="lamb.column.name"></a>\n                    <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Name\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Name\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Name\'}"></span>\n                </th>\n                <th fac-id="s3-access" ng-click="setSortOrder(\'Access\')">\n                    <a translate="lamb.column.access"></a>\n                    <awsui-tooltip text="{{\'lamb.column.accessinfo\' | translate}}" position="bottom" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                    <span ng-class="{\'sorting-icon sorting-ascending\': sortColumnName===\'Access\' && !reverseSortOrder && !bucketsLeftToAnalyze, \'sorting-icon sorting-descending\': sortColumnName===\'Access\' && reverseSortOrder && !bucketsLeftToAnalyze, \'awsui-spinner awsui-spinner-disabled card-spinner\' : bucketsLeftToAnalyze, \'sorting-icon sorting-disabled\': sortColumnName !== \'Access\' && !bucketsLeftToAnalyze}"></span>\n                </th>\n                <th ng-click="setSortOrder(\'Location\')" ng-show="isAccessFilterDisabled()">\n                    <a translate="lamb.column.region"></a>\n                    <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Location\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Location\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Location\'}"></span>\n                </th>\n                <th ng-click="setSortOrder(\'CreationDate\')" ng-show="isAccessFilterDisabled()">\n                    <a translate="lamb.column.creationdate"></a>\n                    <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'CreationDate\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'CreationDate\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'CreationDate\'}"></span>\n                </th>\n                <th ng-click="setSortOrder(\'Read\')" ng-show="filters.accessFilters.length > 0" fac-id="s3-access">\n                    <a translate="lamb.column.read"></a>\n                    <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Read\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Read\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Read\'}"></span>\n                </th>\n                <th ng-click="setSortOrder(\'Write\')" ng-show="filters.accessFilters.length > 0" fac-id="s3-access">\n                    <a translate="lamb.column.write"></a>\n                    <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Write\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Write\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Write\'}"></span>\n                </th>\n                <th ng-click="setSortOrder(\'Source\')" ng-show="filters.accessFilters.length > 0" fac-id="s3-access">\n                    <a translate="lamb.column.source"></a>\n                    <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Source\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Source\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Source\'}"></span>\n                </th>\n            </tr>\n            </thead>\n            <tbody>\n            <tr class="unselectable" unselectable="on" onselectstart="return false" ng-show="!isLoadingPage" ng-repeat="bucket in bucketList | filter:filters.input| orderBy:sortColumnName:reverseSortOrder" ng-click="openConfigPanel(bucket)" class="bucket-row" ng-class="{\'row-selected\': bucket.Name===selectedBucket.Name, \'row-hover\' : hoverBucketRow && bucket.Name!==selectedBucket.Name}" ng-mouseenter="hoverBucketRow = true" ng-mouseleave="hoverBucketRow = false">\n                <td class="awsui-icon bucket truncate" ng-class="{\'awsui-icon-light\': bucket.Name===selectedBucket.Name}"><a class="list-view-item-name" ng-href="buckets/{{bucket.Name}}/?region={{regionFromUrl}}&tab=overview" ng-click="selectBucket(bucket.Name, \'overview\')">{{bucket.Name}}</a></td>\n                <td fac-id="s3-access"><span ng-class="{\'public-text\': bucket.isPublic}">{{bucket.Access}}</span></td>\n                <td ng-show="isAccessFilterDisabled()">{{bucket.Location}}</td>\n                <td ng-show="isAccessFilterDisabled()">{{bucket.CreationDate | date:"medium" }}</td>\n                <td ng-show="filters.accessFilters.length > 0" fac-id="s3-access">{{bucket.Read}}</td>\n                <td ng-show="filters.accessFilters.length > 0" fac-id="s3-access">{{bucket.Write}}</td>\n                <td ng-show="filters.accessFilters.length > 0" class="bucket-source" fac-id="s3-access" ng-click="selectBucket(bucket.Name, \'permissions\')">{{bucket.Source}}</td>\n            </tr>\n            <tr>\n                <storage-console-config-panel ng-mouseenter="hoverSidePanelAction(true)" ng-mouseleave="hoverSidePanelAction(false)" class="bucket-side-panel" ng-class="{\'side-config-panel bucket-side-panel\': panelOpen, \'hide-config-panel bucket-side-panel\': panelHide}" panel-open="panelOpen">\n                    <header>\n                        <div class="bucket-side-panel-header">\n                            <div class="truncate side-panel-header-name">{{ selectedBucket.Name }}</div>\n                            <span class="panel-close-icon" ng-click="closePanel()"></span>\n                        </div>\n                        <awsui-button size="small" text="{{ \'bucketproperties.sideconfigpanel.copyarn\' | translate }}" click="copyARNToClipboard($event)"></awsui-button>\n                    </header>\n                    <content>\n                        <ul class="bucket-panel-config-lists" ng-repeat="(configTitle, configContent) in configData" ng-click="moveToBucketTab(configTitle)">\n                            <li>\n                                <div class="subtitle" translate="bucketproperties.{{configTitle}}"></div>\n                                <ul class="bucket-config-panel-content">\n                                    <li ng-repeat="(configKey, configValue) in configContent">\n                                        <div class="truncate config-panel-content-left" translate="bucketproperties.sideconfigpanel.{{configKey}}"></div>\n                                        <div class="truncate config-panel-content-right">{{configValue}}</div>\n                                    </li>\n                                </ul>\n                            </li>\n                        </ul>\n                    </content>\n                </storage-console-config-panel>\n            </tr>\n            </tbody>\n        </table>\n        <div class="access-warning" fac-id="s3-access" ng-show="!isLoadingPage && !showEmptyBucketScreen()">\n            <translate>lamb.column.tooltip.access.disclaimer</translate>\n            <a ng-href="{{accessDocLink}}" translate="" target="_blank">learn.more</a>\n        </div>\n        <div ng-if="isLoadingPage" class="loading-spinner">\n            <span class="awsui-spinner awsui-spinner-large"></span>\n        </div>\n    </div>\n    <div ng-if="!isLoadingPage" operation-manager=""></div>\n    <create-bucket-modal ng-if="isCreateBucketModalOpen.flag" is-open="isCreateBucketModalOpen" bucket-list="bucketList" regions="regions" num-regions="numRegions" load-buckets="loadBuckets"></create-bucket-modal>\n    <bucket-confirmation-modal ng-if="isConfirmationModalOpen.flag" header-title="bucketConfirmationDetails.headerTitle" is-open="isConfirmationModalOpen" warning-message="bucketConfirmationDetails.warningMessage" operation="bucketConfirmationDetails.operation" is-delete="bucketConfirmationDetails.isDelete">\n    </bucket-confirmation-modal>\n</div>');a.put("/s3/partials/bucketselector.html",'<div id="bucket-selector" class="bucket-selector" clickoutside="" on-click-outside="closeDropDown">\n    <table id="current-displayed-table" class="awsui-select-target current-displayed bucket-not-selected" ng-class="{\'with-bucket-name\' : !showBucketNameOnly, \'deselect\' : enableDeselect && copySettingsSourceBucket && copySettingsSourceBucket.Name, \'bucket-selected\' : !bucketReplication && !selectedReport && copySettingsSourceBucket || (bucketReplication || selectedReport ) && copySettingsSourceBucket && copySettingsSourceBucket.Name, \'bucket-not-selected-card\' : editable && !selectedReport.bucketError, \'bucket-not-selected-card-error\' : editable && selectedReport.bucketError}" ng-click="toggleDropDown()">\n        <tr class="current-displayed-row">\n            <td ng-if="!bucketReplication && copySettingsSourceBucket.Name && !showBucketNameOnly" class="awsui-icon bucket bucket-icon"></td>\n            <td class="current-displayed-item">\n                <div class="current-displayed-item truncate" ng-class="{\'bucket-name-display\' : !showBucketNameOnly }">{{ copySettingsSourceBucket.Name || (bucketList.length === 0 &&\n                    emptyText) || getBucketPlaceHolder() }}</div>\n                <table id="selected-bucket" ng-if="copySettingsSourceBucket && !showBucketNameOnly" class="current-displayed-summary">\n                    <tr>\n                        <td class="current-displayed-summary-item"><span translate="bucketselector.summary.label.region"></span><span> {{copySettingsSourceBucket.Location}}</span></td>\n                        <td class="current-displayed-summary-item" ng-if="copySettingsSourceBucket.granteeCount">{{copySettingsSourceBucket.granteeCount}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                        <td class="current-displayed-summary-item" ng-if="copySettingsSourceBucket.propertyCount">{{copySettingsSourceBucket.propertyCount}} <span translate="bucketselector.summary.label.properties"></span></td>\n                    </tr>\n                </table>\n            </td>\n            <td ng-if="!copySettingsSourceBucket" class="bucket-count">\n                <div ng-if="!showBucketNameOnly">\n                    <span translate="bucketselector.label.buckets" translate-values="{ bucketCount: bucketList.length || 0 }"></span>\n                </div>\n            </td>\n            <td ng-if="enableDeselect && copySettingsSourceBucket && copySettingsSourceBucket.Name" ng-click="deselectBucket()">\n                <div class="bucketdeselect bucketselector-cancel-icon"></div>\n            </td>\n        </tr>\n    </table>\n\n    <div class="list-items" ng-if="isOpen" ng-class="{\'list-items-normal\' : !chooseAccounts, \'list-items-choose\': chooseAccounts}">\n        <div ng-if="chooseAccounts">\n            <awsui-radio-group ng-model="account.outside">\n                <table class="choose-accounts-table">\n                    <tbody>\n                        <tr>\n                            <td class="choose-account-button">\n                                <awsui-radio-button value="false">\n                                    <span class="choose-accounts-text">\n                                        {{\'bucketselector.inputfield.currentAccount\' | translate}}\n                                    </span>\n                                </awsui-radio-button>\n                            </td>\n                            <td class="choose-account-button">\n                                <awsui-radio-button value="true" id="cross-account-radiobutton">\n                                    <span class="choose-accounts-text">\n                                        {{\'bucketselector.inputfield.anotherAccount\' | translate}}\n                                    </span>\n                                </awsui-radio-button>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </awsui-radio-group>\n        </div>\n        <table ng-if="!chooseAccounts || account.outside === \'false\'" id="search-box" class="search-box">\n            <tr>\n                <td>\n                    <input id="bucket-name-search-box" type="text" class="input-field" ng-model="tableFiltering.filter[filterColumn]" ng-keydown="filterKeyDown($event)" placeholder="{{ getSearchPlaceHolder() }}"></td>\n                <td><i class="awsui-icon search"></i></td>\n            </tr>\n        </table>\n        <div ng-if="chooseAccounts && account.outside === \'true\'">\n            <table class="choose-bucket-other-account-table">\n                <tbody>\n                    <tr ng-if="!bucketReplication">\n                        <td><span class="enter-another-bucket">{{\'bucketselector.inputfield.label.account\' | translate}}</span></td>\n                    </tr>\n                    <tr ng-if="bucketReplication">\n                        <td><span class="enter-another-bucket">{{\'bucketselector.inputfield.label.crraccount\' | translate}}</span></td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <div class="input-text-field bucket-account-field">\n                                <awsui-control-group validation-message="{{tmpValues.accountIdError}}">\n                                <awsui-textfield class="test-css" ng-model="tmpValues.accountId" placeholder="{{\'bucketselector.inputfield.enterId.placeholder\' | translate}}"></awsui-textfield>\n                                </awsui-control-group>\n                            </div>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td><span class="enter-another-bucket">{{\'bucketselector.inputfield.label.bucket\' | translate}}</span></td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <div class="input-text-field bucket-name-field">\n                                <awsui-control-group validation-message="{{tmpValues.regionError}}">\n                                    <awsui-textfield class="test-css" ng-model="tmpValues.bucket" placeholder="{{\'bucketselector.inputfield.bucketName.placeholder\' | translate}}">\n                                    </awsui-textfield>\n                                </awsui-control-group>\n                            </div>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <awsui-button class="another-account-save" text="{{ \'events.button.save\' | translate }}" variant="normal" ng-click="!tmpValues.bucket || savePressed($event)" disabled="!tmpValues.bucket" loading="savingBucket"></awsui-button>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n        <div class="bucketselector-divider" ng-if="bucketReplication &&  account.outside === \'false\' && chooseAccounts"></div>\n        <div ng-if="(!chooseAccounts || account.outside === \'false\') && bucketReplication" class="item create-new-item" ng-click="createNewBucket()" translate="bucketselector.createnew">\n        </div>\n        <div ng-if="isLoadingBuckets &&  account.outside === \'false\' && chooseAccounts" class="awsui-spinner awsui-spinner-bigger awsui-spinner-light bucketselector-spinner"></div>\n        <span ng-if="isLoadingBuckets &&  account.outside === \'false\' && chooseAccounts" class="loading-bucket-text" translate="bucketselector.loadingbucket"></span>\n        <div id="select-bucket" ng-if="!chooseAccounts || account.outside === \'false\'" class="item" ng-repeat="bucket in bucketList | filter:tableFiltering.filter" ng-click="selectBucket(bucket)">\n            <table>\n                <tr>\n                    <td class="arrow" ng-click="toggleBucket($event, bucket)"><div ng-class="bucket.isExpanded ? \'arrow-down\' : \'arrow-right\'"></div></td>\n                    <td><div class="bucket-item">{{bucket.Name}}</div></td>\n                </tr>\n                <tr>\n                    <td></td>\n                    <td>\n                        <table class="bucket-summary">\n                                <tr>\n                                    <td class="bucket-summary-item"><span translate="bucketselector.summary.label.region"></span><span> {{bucket.Location}}</span></td>\n                                    <td ng-if="bucket.granteeCount" class="bucket-summary-item">{{bucket.granteeCount}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                                    <td ng-if="bucket.propertyCount" class="bucket-summary-item">{{bucket.propertyCount}} <span translate="bucketselector.summary.label.properties"></span></td>\n                                </tr>\n                        </table>\n                    </td>\n                </tr>\n            </table>\n            <div class="bucket-content" ng-if="bucket.isExpanded">\n                <p class="bucket-content-title" translate="createbucketmodal.label.permissions"></p>\n                <p class="bucket-content-column-header" translate="createbucketmodal.label.object"></p>\n                <table class="bucket-summary">\n                    <tr>\n                        <td class="bucket-content-value" translate="bucketselector.content.label.read"></td>\n                        <td class="bucket-content-value">{{bucket.permissionCount.READ}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                    </tr>\n                    <tr>\n                        <td class="bucket-content-value" translate="bucketselector.content.label.write"></td>\n                        <td class="bucket-content-value">{{bucket.permissionCount.WRITE}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                    </tr>\n                </table>\n                <p class="bucket-content-column-header" translate="bucketselector.content.label.permissionaccess"></p>\n                <table class="bucket-summary">\n                    <tr>\n                        <td class="bucket-content-value" translate="bucketselector.content.label.read"></td>\n                        <td class="bucket-content-value">{{bucket.permissionCount.READ_ACP}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                    </tr>\n                    <tr>\n                        <td class="bucket-content-value" translate="bucketselector.content.label.write"></td>\n                        <td class="bucket-content-value">{{bucket.permissionCount.WRITE_ACP}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                    </tr>\n                </table>\n                <div class="bucket-content-divider"></div>\n                <p class="bucket-content-title" translate="bucketselector.summary.label.properties"></p>\n                <table class="bucket-summary">\n                    <tr>\n                        <td class="bucket-content-column-header" translate="bucketselector.content.label.versioning"></td>\n                        <td class="bucket-content-column-header" translate="bucketselector.content.label.tags"></td>\n                        <td class="bucket-content-column-header" translate="bucketselector.content.label.logging"></td>\n                    </tr>\n                    <tr>\n                        <td class="bucket-content-value">{{bucket.versioningStatus}}</td>\n                        <td class="bucket-content-value">{{bucket.tagCount}} <span translate="bucketselector.content.label.tags"></span></td>\n                        <td class="bucket-content-value">{{bucket.loggingStatus}}</td>\n                    </tr>\n                </table>\n            </div>\n        </div>\n        <div class="no-matches-found" ng-if="((bucketList | filter:tableFiltering.filter).length == 0)">{{getResultsMessage()}}</div>\n    </div>\n</div>');a.put("/s3/partials/buckettagging.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-tags-water-mark\': !cardOpen, \'card-enable-tags-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="bucketproperties.tagging.label.tags"></span>\n        <div class="card-close-icon" ng-show="cardOpen" ng-click="cancelBucketTagging($event)"></div>\n    </card-header>\n    <card-content>\n        <p class="bucketproperties-summary" ng-show="!cardOpen" translate="bucketproperties.tagging.summary"></p>\n        <table class="tagging-table" ng-if="cardOpen">\n            <tr>\n                <th>\n                    <translate>bucketproperties.tagging.label.key</translate>\n                    <awsui-tooltip text="{{\'bucketproperties.tagging.key.tooltip\' | translate}}" position="right" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </th>\n                <th>\n                    <translate>bucketproperties.tagging.label.value</translate>\n                    <awsui-tooltip text="{{\'bucketproperties.tagging.value.tooltip\' | translate}}" position="right" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </th>\n                <th></th>\n            </tr>\n            <tr ng-repeat="tag in bucketTags.tags">\n                <td><input type="text" ng-model="tag.Key" class="tag-input"></td>\n                <td><input type="text" ng-model="tag.Value" class="tag-input"></td>\n                <td>\n                    <awsui-button class="remove-tag" icon="times-circle" variant="standalone-icon" ng-click="removeTag($index)"></awsui-button>\n                </td>\n            </tr>\n            <tr>\n                <td><awsui-button id="add-bucket-tag" ng-click="addTag()" class="bucket-properties-buttons" text="{{\'bucketproperties.tagging.label.addtag\' | translate}}" icon="plus"></awsui-button></td>\n                <td></td>\n                <td></td>\n            </tr>\n        </table>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert type="error" class="error-alert" readonly="readonly" ng-show="tagError && cardOpen">{{ tagErrorMessage }}</awsui-alert>\n    </card-content>\n    <card-footer>\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="cancel-bucket-tagging" class="bucket-properties-buttons" ng-click="cancelBucketTagging($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-tagging" class="bucket-properties-buttons" ng-click="saveBucketTagging($event)" text="{{ \'button.save\' | translate }}" variant="primary"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/bucketversioning.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-version-water-mark\': !cardOpen, \'card-enable-version-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="bucketproperties.versioning.label.versioning"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelBucketVersioning($event)"></div>\n    </card-header>\n    <card-content>\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="bucketproperties.versioning.summary"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <awsui-radio-group ng-model="versioning.selectedValue" change="updateWarningMsg()">\n            <div class="awsui-row card-content-row">\n                \n                <awsui-radio-button class="enableVersioning" value="enable" ng-model="versioning.selectedValue" label="{{ \'bucketproperties.versioning.label.enableversioning\' | translate }}"></awsui-radio-button>\n            </div>\n            <awsui-alert class="bucketversion-warning" visible="versioning.selectedValue === \'enable\' && versioningWarningMsg " type="warning">{{versioningWarningMsg}}</awsui-alert>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-button class="disableVersioning" value="disable" ng-model="versioning.selectedValue" label="{{ \'bucketproperties.versioning.label.disableversioning\' | translate }}">\n                </awsui-radio-button>\n                <p class="disable-versioning-description" translate="bucketproperties.versioning.description.disableversioning"></p>\n                <awsui-alert class="bucketversion-warning" visible="versioning.selectedValue === \'disable\' && versioningWarningMsg " type="warning">{{versioningWarningMsg}}</awsui-alert>\n            </div>\n            </awsui-radio-group>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert type="error" class="error-alert" ng-if="versioningError && cardOpen"> {{ versioningErrorMessage }}</awsui-alert>\n    </card-content>\n    <card-footer>\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="cancel-bucket-versioning" ng-click="cancelBucketVersioning($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-versioning" ng-click="saveBucketVersioning($event)" text="{{ \'button.save\' | translate }}" variant="primary"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/bucketwebsite.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-webhost-water-mark\': !cardOpen, \'card-enable-webhost-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="bucketproperties.website.label.cardopen"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelBucketWebsite($event)"></div>\n    </card-header>\n    <card-content>\n        <div id="bucket-website-card-content">\n            <p class="bucketproperties-summary" ng-if="!cardOpen" translate="bucketproperties.website.summary"></p>\n            <div class="awsui-container" ng-if="cardOpen">\n                <div class="awsui-row card-content-row">\n                    <span class="endpoint-label" translate="bucketproperties.website.label.endpoint"></span>\n                    <span class="region-endpoint"> <a ng-click="openBucketEndpoint()"> {{ bucketEndpoint }}</a></span>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <awsui-radio-group ng-model="website.selectedValue">\n                        <awsui-radio-button name="staticWebsite" style="display: inline" value="useBucket" class="website-radio-button" ng-model="website.selectedValue" label="{{ \'bucketproperties.website.label.usethisbuckettohost\' | translate }}"></awsui-radio-button>\n                        <awsui-tooltip text="{{\'bucketproperties.website.usethisbuckettohost.tooltip\' | translate}}" position="right" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                        <a class="learn-more-card-open-link" target="_blank" href="{{docLinks[\'configure\']}}" translate="">learn.more</a>\n                    </awsui-radio-group>\n                </div>\n                <div ng-if="website.selectedValue === \'useBucket\'">\n                    <div class="awsui-row card-content-row">\n                        <label class="target-value" translate="bucketproperties.website.label.indexdocument"></label>\n                        <awsui-tooltip text="{{\'bucketproperties.website.indexdocument.tooltip\' | translate}}" position="right" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </div>\n                    <div class="awsui-row card-content-row">\n                        <awsui-textfield class="website-text-field" ng-model="website.indexDocument" placeholder="{{ websitePlaceholder }}"></awsui-textfield>\n                    </div>\n                    <div class="awsui-row card-content-row">\n                        <label class="target-value" translate="bucketproperties.website.label.errordocument"></label>\n                        <awsui-tooltip text="{{\'bucketproperties.website.errordocument.tooltip\' | translate}}" position="right" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </div>\n                    <div class="awsui-row card-content-row">\n                        <awsui-textfield class="website-text-field" ng-model="website.errorDocument" placeholder="{{ \'bucketproperties.website.placeholder.errordocument\' | translate }}"></awsui-textfield>\n                    </div>\n                    <div class="awsui-row card-content-row">\n                        <label class="target-value edit-redirection-rules" translate="bucketproperties.website.label.editredirectionrules"></label>\n                        <awsui-tooltip text="{{\'bucketproperties.website.editredirectionrules.tooltip\' | translate}}" position="right" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </div>\n                    <div class="awsui-row card-content-row" ng-if="cardOpen">\n                        <div class="bucket-website-content">\n                            <awsui-textarea class="routing-xml" ng-if="cardOpen" ng-model="website.routingXML"></awsui-textarea>\n                        </div>\n                    </div>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <awsui-radio-group ng-model="website.selectedValue">\n                        <awsui-radio-button name="staticWebsite" style="display: inline" value="redirectRequest" ng-model="website.selectedValue" label="{{ \'bucketproperties.website.label.redirectrequests\' | translate }}">\n                        </awsui-radio-button>\n                        <awsui-tooltip text="{{\'bucketproperties.website.redirectrequests.tooltip\' | translate}}" position="right" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                        <a class="learn-more-card-open-link" target="_blank" href="{{docLinks[\'redirect\']}}" translate="">learn.more</a>\n                    </awsui-radio-group>\n                </div>\n                <div ng-if="website.selectedValue === \'redirectRequest\'">\n                    <div class="awsui-row card-content-row">\n                        <label class="target-value" translate="bucketproperties.website.label.targetdomain"></label>\n                    </div>\n                    <div class="awsui-row card-content-row">\n                        <awsui-textfield class="website-text-field" ng-model="website.targetDomain" placeholder="{{ \'bucketproperties.website.placeholder.targetdomain\' | translate }}"></awsui-textfield>\n                    </div>\n                    <div class="awsui-row card-content-row">\n                        <label class="target-value" translate="bucketproperties.website.label.redirectrequestprotocol"></label>\n                    </div>\n                    <div class="awsui-row card-content-row">\n                        <awsui-textfield class="website-text-field" ng-model="website.redirectRequestProtocol" placeholder="{{ \'bucketproperties.website.placeholder.redirectrequestprotocol\' | translate }}"></awsui-textfield>\n                    </div>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <awsui-radio-group ng-model="website.selectedValue">\n                        <awsui-radio-button name="staticWebsite" value="disable" ng-model="website.selectedValue" ng-if="cardOpen" label="{{ \'bucketproperties.website.label.disablewebsitehosting\' | translate }}">\n                        </awsui-radio-button>\n                    </awsui-radio-group>\n                </div>\n            </div>\n            <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLinks[\'hosting\']}}" translate="">learn.more</a>\n            <awsui-alert type="error" class="error-alert" readonly="readonly" ng-if="websiteError && cardOpen">{{ websiteErrorMessage }}</awsui-alert>\n        </div>\n    </card-content>\n    <card-footer>\n        <div ng-if="cardOpen" class="bucket-properties-buttons">\n            <awsui-button ng-click="cancelBucketWebsite($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-website-hosting" data-disabled="shouldDisableSaveButton()" ng-click="saveBucketWebsite($event)" text="{{ \'button.save\' | translate }}" variant="primary"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/card.html",'<div class="card" ng-click="openCard()" ng-class="{ \'cardexpand\' : isOpen }">\n    <div class="card-header">\n        <div class="card-header-wrapper" ng-transclude="header"></div>\n    </div>\n    <div class="card-content">\n        <div class="card-content-wrapper" ng-transclude="content"></div>\n    </div>\n    <div class="card-footer awsui-util-t-r" ng-transclude="footer"></div>\n    <div class="bucket-status-display single-line" ng-if="!isOpen && cardSummaryObj && !cardSummaryObj.isMultiValue">\n        <div class="divide-line"></div>\n        <div ng-class="{\'icon card-disabled-icon\': !cardSummaryObj.isActive && !cardSummaryObj.isLoading, \'icon card-enabled-icon\': cardSummaryObj.isActive && !cardSummaryObj.isLoading, \'awsui-spinner awsui-spinner-disabled card-spinner\' : cardSummaryObj.isLoading }"></div>\n        <div ng-class="{\'card-status-text-gray\': !cardSummaryObj.isActive && !cardSummaryObj.isLoading, \'card-status-text\': cardSummaryObj.isActive && !cardSummaryObj.isLoading, \'card-summary-loading\': cardSummaryObj.isLoading }" translate="{{ cardSummaryObj.isLoading ? cardloadingMsg : cardSummaryObj.isActive ? cardSummaryObj.activeSummary.text : cardSummaryObj.inactiveSummary.text }}"></div>\n    </div>\n    <div class="bucket-status-display" ng-if="!isOpen && cardSummaryObj && cardSummaryObj.isMultiValue && !cardSummaryObj.isLoading">\n        <div class="divide-line"></div>\n        <table class="cardfooter-summary-table" ng-class="{\'multi-lines\' : cardSummaryObj.isActive}">\n            <tr>\n                <td class="icon-column" rowspan="2">\n                    <div class="icon" ng-class="{\'card-disabled-icon\': !cardSummaryObj.isActive, \'card-enabled-icon\': cardSummaryObj.isActive }"></div>\n                </td>\n                <td class="card-summary-valuetitle" ng-class="{\'card-status-text-gray\': !cardSummaryObj.isActive, \'card-status-text\': cardSummaryObj.isActive }" translate="{{ cardSummaryObj.isActive ? cardSummaryObj.activeSummary.text : cardSummaryObj.inactiveSummary.text }}">\n                </td>\n            </tr>\n            <tr>\n                <td><p class="truncate card-summary-value">{{ cardSummaryObj.activeSummary.value  }}</p></td>\n                <td></td>\n            </tr>\n        </table>\n    </div>\n</div>');a.put("/s3/partials/cloudtrail.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-cloudtrail-water-mark\': !cardOpen, \'card-enable-cloudtrail-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="bucketproperties.dataevents.label.dataevents"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelEventSelectors($event)"></div>\n    </card-header>\n    <card-content>\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="bucketproperties.dataevents.summary"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <div ng-if="!cardSummaryObj.isActive">\n                <div class="awsui-row card-content-row bucket-status-display single-line">\n                    <div class="icon card-disabled-icon"></div>\n                    <label class="card-status-text-gray manage-trail-description" translate="bucketproperty.disabled"></label>\n                    <div class="enabled-data-events">\n                        <label class="trail-for-recording" translate="bucketproperties.dataevents.label.trailforrecording"></label>\n                        <awsui-tooltip text="{{\'bucketproperties.dataevents.label.tooltip.trail\' | translate}}" position="top" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                        <awsui-button id="refresh-trail-button" class="trail-refresh" icon="refresh" variant="standalone-icon" loading="isRefreshing" click="refreshTrails()"></awsui-button>\n                        <awsui-select id="trail-dropdown" class="event-selectors-dropdown" items="eventSelectors.trailNames" placeholder="{{ \'bucketproperties.dataevents.placeholder.choosetrail\' | translate }}" ng-model="eventSelectors.targetTrail"></awsui-select>\n                    </div>\n                    <div class="event-selectors-text">\n                        <span>\n                            <label class="manage-trail-description" translate="bucketproperties.dataevents.label.visit"></label>\n                            <label class="manage-trail-description" translate="bucketproperties.dataevents.label.goto"></label>\n                            <awsui-button id="cloudtrail-console-link" class="cloudtrail-link" target="_blank" variant="link" icon="external-link" href="{{cloudTrailLink}}" text="{{ \'bucketproperties.dataevents.label.cloudtrailconsole\' | translate }}"></awsui-button>\n                        </span>\n                    </div>\n                    <div class="enabled-data-events">\n                        <label class="trail-for-recording" translate="bucketproperties.dataevents.label.events"></label>\n                        <awsui-tooltip text="{{\'bucketproperties.dataevents.label.tooltip.readwrite\' | translate}}" position="top" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </div>\n                    <table class="access-table">\n                        <tr>\n                            <td>\n                                <awsui-checkbox id="trail-read-access" ng-model="eventSelectors.access.read">\n                                    <span class="access-text" translate="objects.details.READ"></span>\n                                </awsui-checkbox>\n                            </td>\n                            <td class="trail-access-row">\n                                <awsui-checkbox id="trail-write-access" ng-model="eventSelectors.access.write">\n                                    <span class="access-text" translate="objects.details.WRITE"></span>\n                                </awsui-checkbox>\n                            </td>\n                        </tr>\n                    </table>\n                </div>\n            </div>\n            <awsui-alert type="error" class="error-alert" readonly="readonly" ng-if="eventSelectorsErrorMessage && cardOpen">{{eventSelectorsErrorMessage}}</awsui-alert>\n            <div ng-if="cardSummaryObj.isActive">\n                <div class="awsui-row card-content-row bucket-status-display single-line">\n                    <div class="icon card-enabled-icon"></div>\n                    <label id="trail-enabled-text" class="card-status-text enabled-trail-status" translate="bucketproperty.enabled"></label>\n                    <div class="enabled-data-events">\n                        <label class="manage-trail-description" translate="bucketproperties.dataevents.label.trailsetup"></label>\n                    </div>\n                    <div class="enabled-data-events">\n                        <span class="manage-trail-description">\n                            <label class="manage-trail-description" translate="bucketproperties.dataevents.label.paidfeature"></label>\n                            <a target="_blank" href="{{docLink}}" translate="">learn.more</a>\n                        </span>\n                    </div>\n                    <awsui-button id="visit-cloudtrail-button" class="visit-cloudtrail" target="_blank" href="{{cloudTrailLink}}" text="{{ \'bucketproperties.dataevents.label.visitcloudtrail\' | translate }}"></awsui-button>\n                </div>\n            </div>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n    </card-content>\n    <card-footer ng-if="!cardSummaryObj.isActive">\n        <div ng-if="!cardSummaryObj.isActive && cardOpen" id="event-selectors-properties-buttons" class="bucket-properties-buttons">\n            <awsui-button id="cancel-bucket-event-selectors" ng-click="cancelEventSelectors($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-event-selectors" data-disabled="(eventSelectors.targetTrail === \'\' || (!eventSelectors.access.read && !eventSelectors.access.write))" ng-click="saveEventSelectors($event)" text="{{ \'bucketproperties.dataevents.label.create\' | translate }}" variant="primary" loading="saving"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/cloudwatch.html",'<table class="metrics-content-table">\n\n    <tr>\n        <td class="metrics-content-cell management-side-panel-color">\n            <div class="select-metrics-side-panel">\n                <span class="awsui-icon awsui-spinner awsui-spinner-large config-spinner" ng-if="models.configLoading"></span>\n                <table class="select-metrics-table" ng-if="!models.configLoading">\n                    <tr>\n                        <td>\n                            <span class="metrics-header">Metrics</span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <table class="search-box prefix-search-box">\n                                <tbody>\n                                <tr>\n                                    <td class="search-icon"><i class="awsui-icon search"></i></td>\n                                    <td><input type="text" class="input-field ng-pristine ng-valid ng-empty ng-touched" ng-model="models.searchText" ng-keydown="filterKeyDown($event)" ng-click="searchClicked()" placeholder="{{ \'management.search.placeholder\' | translate }}"></td>\n                                </tr>\n                                </tbody>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <awsui-alert class="save-filter-info-alert" header="{{\'management.metric.info\'|translate}}" dismissible="true" visible="models.addInfoMessage" ng-click="models.addInfoMessage=false">{{ \'management.metrics.statistics.delay\' | translate}}</awsui-alert>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td class="side-panel-row" ng-class="{\'row-highlight\': models.bucketChecked}">\n                            <table border="0px">\n                                <tr>\n                                    <td>\n                                        <div class="row-checkbox">\n                                            <awsui-checkbox checked="models.bucketChecked" data-disabled="false" ng-model="models.bucketChecked" change="getCloudwatchMetrics()"></awsui-checkbox>\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <i class="awsui-icon bucket buckets-bucket-icon" ng-class="{\'awsui-icon-light\': models.bucketChecked}"></i>\n                                    </td>\n                                    <td>\n                                        <div class="buckets-name" ng-class="{\'bucket-selected\': models.bucketChecked}">\n                                            {{ bucketName }}\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <span class="awsui-icon awsui-icon-link pencil buckets-cog" ng-class="{\'awsui-icon-light\': models.bucketChecked}" ng-click="configureMetrics()"></span>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr ng-if="models.toggleMetricsConfig">\n                        <td class="bucket-dropdown-config dark">\n                            <div class="new-filter-params">\n                                <div class="select-metrics-row">\n                                    <div class="select-metrics-text" translate="management.metrics.side.select.select.info">\n                                    </div>\n                                    <div class="select-metrics-learn-more dark">\n                                        <a href="{{ getLearnMoreLink(\'configure-metrics-filter\') }}" target="_blank" class="ng-binding" translate="">learn.more</a>\n                                    </div>\n                                </div>\n\n                                <div class="list-all-metrics">\n                                    <div ng-repeat="metricType in metricTypes">\n                                        <div class="expandable-metrics-dropdown" ng-model="collapsed" ng-init="collapsed=true" data-disabled="models.applyingConfig" ng-click="collapsed=!collapsed">\n                                            <awsui-checkbox class="checkbox" checked="metricType.checked" change="checkAllPaidMetrics(metricType)" data-disabled="metricType.disable" ng-model="metricType.checked"></awsui-checkbox>\n                                            <span ng-if="collapsed" class="awsui-icon caret-right awsui-icon-light section"></span>\n                                            <span ng-if="!collapsed" class="awsui-icon caret-down awsui-icon-light section"></span>\n                                            <div class="dropdown-text section">\n                                                {{metricType.title}} ({{metricType.metrics.length}})\n                                            </div>\n                                            <div class="metric-charge-info">{{ metricType.info }}</div>\n                                            <div class="specific-metrics" ng-show="!collapsed">\n                                                <div class="specific-metric" ng-repeat="specificMetric in metricType.metrics">\n                                                    <div class="specific-metric-text">\n                                                        <awsui-checkbox checked="true" data-disabled="true">\n                                                            {{specificMetric.name}}\n                                                        </awsui-checkbox>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div class="select-metrics-buttons">\n                                    <table>\n                                        <tr>\n                                            <td class="metric-button-spacing">\n                                                <awsui-button variant="primary" text="{{ \'button.save\'   | translate}}" class="normal-button" ng-click="applyMetricsConfig()" loading="models.applyingConfig"></awsui-button>\n                                            </td>\n                                            <td>\n                                                <awsui-button variant="normal" text="{{ \'button.cancel\' | translate}}" class="normal-button" ng-click="cancelMetricsConfig()" data-disabled="models.applyingConfig"></awsui-button>\n                                            </td>\n                                        </tr>\n                                    </table>\n                                </div>\n\n                            </div>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td class="filter-header">\n                            <table border="0px" class="filters-table-header">\n                                <tr>\n                                    <td>\n                                        <div class="row-checkbox">\n                                            <awsui-checkbox checked="false" change="viewAllFilters()" data-disabled="filterList.length === 0" ng-model="models.allFilters"></awsui-checkbox>\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div class="filter-title" translate="management.metrics.side.filter.header" translate-values="{count: filterList.length}"></div>\n                                    </td>\n                                    <td>\n                                        <div class="filter-add" ng-click="addFilter()">\n                                            <div class="awsui-icon awsui-icon-link plus" translate="management.metrics.side.filter.add"></div>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n\n                    <tr ng-if="models.showAddFilter">\n                        <td class="bucket-dropdown-config dark">\n                            <table>\n                                <tr>\n                                    <td class="filter-title-cell">\n                                        <div class="filter-add-title" translate="management.metrics.side.filter.dropdown.add">\n                                        </div>\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>\n                                        <div class="new-filter-params">\n                                            <div class="new-filter-text" translate="management.metrics.side.filter.name.title">\n                                            </div>\n                                            <div class="new-filter-input">\n                                                <awsui-control-group>\n                                                    <span class="error-background-fix" dom-region="validationMessage" ng-if="models.filterNameError">\n                                                        {{models.filterNameError}}\n                                                    </span>\n\n                                                    <awsui-textfield id="cloudwatch-filterinput" placeholder="{{ \'management.metrics.side.filter.name.placeholder\' | translate}}" ng-keyup="validateFilter()" data-disabled="models.editFilter || models.savingFilter" ng-model="models.filterName"></awsui-textfield>\n                                                </awsui-control-group>\n                                            </div>\n\n                                            <div class="new-filter-text" translate="management.metrics.side.filter.prefix.title">\n                                            </div>\n                                            <div class="new-filter-input" ng-class="{\'new-filter-input-search\' : models.filterValue || (filters.tagFilters.length + filters.prefixFilters.length) > 0 }">\n                                                <search filters="filters" no-backend-calls="true" search-error="models.filterValueError"></search>\n                                            </div>\n\n\n                                            <div class="select-metrics-buttons">\n                                                <table>\n                                                    <tr>\n                                                        <td colspan="2">\n                                                            <div class="filter-delete">\n                                                                <awsui-button data-disabled="models.deleteFilter || models.savingFilter" loading="models.deleteFilter" icon="" variant="link" ng-click="deleteFilter()" ng-if="models.editFilter" text="{{ \'management.metrics.action.delete\' | translate }}">\n                                                                </awsui-button>\n                                                            </div>\n                                                        </td>\n                                                    </tr>\n                                                    <tr>\n                                                        <td class="metric-button-spacing">\n                                                            <awsui-button variant="primary" text="{{ \'button.save\'   | translate}}" data-disabled="models.savingFilter || models.deleteFilter\n                                                                          || !models.filterName || models.filterNameError" class="normal-button" loading="models.savingFilter" ng-click="saveFilter()"></awsui-button>\n                                                        </td>\n                                                        <td>\n                                                            <awsui-button variant="normal" text="{{ \'button.cancel\' | translate}}" class="normal-button" data-disabled="models.savingFilter || models.deleteFilter" click="cancelFilter()"></awsui-button>\n                                                        </td>\n                                                    </tr>\n                                                </table>\n                                                <div class="filter-error">\n                                                    <awsui-alert type="error" header="{{\'error.header\'|translate}}" ng-if="models.filterError">{{models.filterError}}\n                                                    </awsui-alert>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n\n                    <tr ng-if="!models.showAddFilter && filterList.length > 0" class="filter-header">\n                        <td>\n                            <table class="filters-table">\n                                <tr ng-repeat="row in filterList | filter:models.searchText " ng-class="{\'row-selected\' : row.checked, \'row-hover\': hoverRule && !row.checked}" ng-click="filterChanged(row, $event)" ng-mouseenter="hoverRule = true" ng-mouseleave="hoverRule = false">\n                                    <td>\n                                        <div class="row-checkbox">\n                                            <awsui-checkbox data-disabled="false" checked="row.checked" change="filterChanged(row)" ng-click="$event.stopPropagation()"></awsui-checkbox>\n                                        </div>\n                                    </td>\n                                    <td class="filter-name-row">\n                                        <div>\n                                            {{row.Id}}\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <span class="awsui-icon awsui-icon-link pencil buckets-cog" ng-class="{\'awsui-icon-light\': row.checked}" ng-click="addFilter(row)"></span>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr ng-if="!models.showAddFilter && filterList.length === 0">\n                        <td>\n                            <div class="side-panel-metrics-help">\n                                <span translate="management.metrics.side.filter.help"></span> <br>\n\n                                <a href="{{ getLearnMoreLink(\'configure-metrics-filter\') }}" target="_blank" class="ng-binding" translate="">learn.more</a>\n                                <br>\n                                <br>\n                                <awsui-button data-disabled="false" loading="false" icon="plus" variant="primary" ng-click="addFilter()">\n                                    {{ \'management.metrics.side.filter.add\' | translate}}\n                                </awsui-button>\n                            </div>\n                        </td>\n                    </tr>\n                </table>\n            </div>\n        </td>\n        <td class="metrics-content-cell">\n\n            <div>\n                <div class="metrics-loading" ng-if="metricsLoading">\n                    <span class="awsui-icon awsui-spinner awsui-spinner-large">\n                </div>\n                <div ng-if="!metricsLoading">\n                    <div class="si-top-right-header">\n                        <div>\n                            <table class="metric-type">\n                                <tr>\n                                    <td ng-repeat="(key, metricType) in S3Constants.METRICS.TYPE" ng-class="{\'type-selected\' : selectedMetricType === metricType}" ng-click="setSelectedMetricType(metricType)">\n                                        {{ getGroupTitle(metricType) }}\n                                    </td>\n                                </tr>\n                            </table>\n                            <table class="time-range">\n                                <tr>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'H1\'}" ng-click="setTimeRange(\'H1\')" translate="">management.metrics.timeframe.1h\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'H3\'}" ng-click="setTimeRange(\'H3\')" translate="">management.metrics.timeframe.3h\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'H12\'}" ng-click="setTimeRange(\'H12\')" translate="">management.metrics.timeframe.12h\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'H24\'}" ng-click="setTimeRange(\'H24\')" translate="">management.metrics.timeframe.1d\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'W1\'}" ng-click="setTimeRange(\'W1\')" translate="">management.metrics.timeframe.1w\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'W2\'}" ng-click="setTimeRange(\'W2\')" translate="">management.metrics.timeframe.2w\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <span class="awsui-icon refresh awsui-icon-light" ng-click="refresh()"></span>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                    <div class="si-metrics-list-header">\n                        <div>\n                            <table class="metrics-link-table">\n                                <tr>\n                                    <td ng-repeat="metric in metricsWithStats" ng-click="goToChart(metric.ref.chartId)">\n                                        <div class="metric-name" ng-class="{\'timeframe-selected\': selectedMetricGroup === metric.display}" ng-click="setMetricGroup(metric.display)">\n                                            {{ metric.display }}\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n\n                        <div class="metrics-update-time">{{ models.updatedOn }}</div>\n                    </div>\n                    <div class="metrics-error-main">\n                        <awsui-alert type="error" header="{{\'error.header\'|translate}}" visible="error">{{error}}\n                        </awsui-alert>\n                        <awsui-alert header="{{\'management.metric.info\'|translate}}" visible="info">{{info}}\n                        </awsui-alert>\n                    </div>\n                    <div class="inner-tab-container" ng-if="metrics[selectedMetricType]">\n                        <metrics-monitoring metric-list="metrics[selectedMetricType]" zoom="selectedTimeFrame"></metrics-monitoring>\n                    </div>\n                </div>\n            </div>\n\n        </td>\n    </tr>\n</table>');a.put("/s3/partials/confirmationdialogmodal.html",'<div class="confirmation-modal" ng-show="isOpen.flag">\n    <dialog-modal is-open="isOpen.dialogOpen" close-callback="closeConfirmationModal()" header-title="modalInfo.headTitle" has-warning-msg="modalInfo.warningInfo" count-info="countInfo" source-dst-info="sourceDstInfo">\n        <dialog-modal-content>\n            <file-list-in-modal selected="selected" close-icon-show="closeIconShow"></file-list-in-modal>\n        </dialog-modal-content>\n        <dialog-modal-footer>\n            <awsui-button id="cancel" text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant="normal" click="closeConfirmationModal()"></awsui-button>\n            <awsui-button id="create-primary" variant="primary" text="{{modalInfo.buttonName}}" class="awsui-util-f-r primary-button" loading="isCounting.flag" click="operationFunc()"></awsui-button>\n        </dialog-modal-footer>\n    </dialog-modal>\n</div>');a.put("/s3/partials/createbucketmodal.html",'<modal id="create-bucket-modal" class="create-bucket-modal" ng-class="{\'overflow-y-visible\': state===STEP.NAME_AND_REGION}" id="create-S3-bucket-modal" is-open="isOpen" steps="STEP" state="state" close-callback="closeCreateBucketModal" header-title="headerTitle" next-state="nextState" previous-state="previousState" set-state="setState">\n    \n    <modal-content>\n        <div id="content" class="create-bucket-modal-content">\n            <div class="createbucketbodycontent" ng-if="state === STEP.NAME_AND_REGION">\n                <p class="subheader" translate="createbucketmodal.label.nameandregion"></p>\n                <p class="label" translate="createbucketmodal.label.name"></p>\n                <awsui-tooltip text="{{\'createbucketmodal.bucketname.tooltip\' | translate}}" position="bottom" size="small">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n                <div class="bucketname-and-region">\n                    <awsui-control-group>\n                        <span dom-region="validationMessage" ng-if="bucketNameValidationErrors.length > 0">\n                            <label ng-repeat="message in bucketNameValidationErrors">{{message}}</label><br>\n                        </span>\n                        <span dom-region="control">\n                            <awsui-textfield id="bucket-name" class="create-bucket-modal-input" autocomplete="true" ng-keyup="validateBucketName()" placeholder="{{\'createbucketmodal.placeholder.name\' | translate}}" ng-model="createBucketValues.name">\n                            </awsui-textfield>\n                        </span>\n                    </awsui-control-group>\n                </div>\n                <p class="label" translate="createbucketmodal.label.region"></p>\n                <dropdown items="regions" id="bucket-region" selected-item="createBucketValues.region" placeholder="{{ \'createbucketmodal.placeholder.region\' | translate }}" filter="true"></dropdown>\n                <div class="modal-content-divider"></div>\n                <p class="subheader" translate="createbucketmodal.label.copysettings"></p>\n                <bucket-selector class="bucket-selector" enable-deselect="true" get-source-bucket-properties="createBucketProperties.getResponse" get-source-bucket-permissions="sourceBucketPermissions" curr-bucket-permissions="currPermissions" copy-settings-source-bucket="createBucketValues.copySettingsSourceBucket" bucket-list="bucketList" operation="operation" default-acls="defaultAcls"></bucket-selector>\n            </div>\n            \n            <div class="createbucketproperites" ng-if="state === STEP.PROPERTIES">\n                <div class="wrapper create-bucket-card-style">\n                    <bucket-versioning id="create-bucket-versioning-card" card-open="toggleVersioning" versioning="createBucketProperties.getResponse.versioning" for-create-bucket-modal="forCreateBucketModal" replication="createBucketProperties.getResponse.replication"></bucket-versioning>\n                    <bucket-logging id="create-bucket-logging-card" card-open="toggleLogging" logging="createBucketProperties.getResponse.logging" create-bucket-values="createBucketValues" bucket-list="bucketList" for-create-bucket-modal="forCreateBucketModal"></bucket-logging>\n                    <bucket-tagging id="create-bucket-tagging-card" card-open="toggleTagging" bucket-tags="createBucketProperties.getResponse.tagging" for-create-bucket-modal="forCreateBucketModal"></bucket-tagging>\n                    <cloud-trail id="create-event-selectors-card" card-open="toggleDataEvents" event-selectors="createBucketProperties.getResponse.eventSelectors" for-create-bucket-modal="forCreateBucketModal" region="createBucketValues.region.value"></cloud-trail>\n                    <default-encryption id="create-bucket-default-encryption-card" card-open="toggleDefaultEncryption" default-encryption="createBucketProperties.getResponse.defaultEncryption" for-create-bucket-modal="forCreateBucketModal" bucket-name="createBucketValues.name" region="createBucketValues.region.value" ng-if="enableDefaultEncryption"></default-encryption>\n                </div>\n            </div>\n            \n            <div ng-if="state === STEP.PERMISSIONS" class="createbucketpermissionsstep">\n                <modal-permissions public-permissions="currPermissions.publicPermissions" user-permissions="currPermissions.userPermissions" aws-account-permissions="currPermissions.awsAccountPermissions" is-adding-account="isAddingAwsAccountAcl" system-permissions="currPermissions.systemPermissions" show-system-permissions="true" modal-type="MODAL_TYPE.CREATE_BUCKET"></modal-permissions>\n            </div>\n            \n            <div ng-if="state === STEP.REVIEW" class="createbucketbodycontent">\n                <table id="review-table" class="review-table">\n                    <tr>\n                        <td class="review-subheader" translate="createbucketmodal.label.nameandregion"></td>\n                        <td class="edit-button">\n                            <awsui-button class="button-in-darkbg" class="button-in-darkbg" text="{{ \'createbucketmodal.button.edit\' | translate }}" variant="link" ng-click="setState(STEP.NAME_AND_REGION)">\n                            </awsui-button>\n                        </td>\n                    </tr>\n                </table>\n                <table class="details-table">\n                    <tr>\n                        <td class="review-nameregion"><span class="review-detail-title" translate="createbucketmodal.label.name"></span><span class="review-detail-content"> {{createBucketValues.name}}</span></td>\n                        <td><span class="review-detail-title" translate="createbucketmodal.label.region"></span><span class="review-detail-content"> {{createBucketValues.region.text}}</span></td>\n                    </tr>\n                </table>\n                <table class="review-table">\n                    <tr>\n                        <td class="review-subheader" translate="createbucketmodal.label.properties"></td>\n                        <td class="edit-button">\n                            <awsui-button class="button-in-darkbg" text="{{ \'createbucketmodal.button.edit\' | translate }}" variant="link" click="setState(STEP.PROPERTIES)">\n                            </awsui-button>\n                        </td>\n                    </tr>\n                </table>\n                <table class="details-table">\n                    <tr ng-repeat="property in propertyStatuses">\n                        <td class="review-detail-title">{{property.name}}</td>\n                        <td class="review-detail-content">{{property.status}}</td>\n                    </tr>\n                </table>\n\n                <table class="review-table">\n                    <tr>\n                        <td class="review-subheader" translate="createbucketmodal.label.permissions"></td>\n                        <td class="edit-button">\n                            <awsui-button class="button-in-darkbg" text="{{ \'createbucketmodal.button.edit\' | translate }}" variant="link" click="setState(STEP.PERMISSIONS)">\n                            </awsui-button>\n                        </td>\n                    </tr>\n                </table>\n                <table class="details-table">\n                    <tr ng-repeat="acl in aclsSummaries">\n                        <td class="review-detail-title">{{acl.summaryTitle}}</td>\n                        <td class="review-detail-content">{{acl.value}}</td>\n                    </tr>\n                </table>\n\n                <awsui-alert visible="createS3BucketWarning" class="block small-top-margin" type="warning" dismissible="false" header="{{ \'warning.header\' | translate }}"> {{ createS3BucketWarning }}\n                </awsui-alert>\n\n                <awsui-alert visible="createS3BucketError" class="block small-top-margin" type="error" dismissible="false" header="{{ \'createbucketmodal.error.header\' | translate }}"> {{ createS3BucketError }}\n                </awsui-alert>\n            </div>\n        </div>\n    </modal-content>\n    <modal-footer>\n        <div class="create-bucket-modal-footer">\n            <awsui-button id="next" ng-if="state !== STEP.REVIEW" loading="checkingName" variant="primary" text="{{ \'createbucketmodal.footer.next\' | translate }}" class="awsui-util-f-r primary-button" click="generateSummary()" data-disabled="!createBucketValues.name || bucketNameValidationErrors.length > 0 || !createBucketValues.region">\n            </awsui-button>\n            <awsui-button id="create-primary" ng-if="state === STEP.REVIEW" variant="primary" text="{{ \'createbucketmodal.footer.confirm\' | translate }}" class="awsui-util-f-r primary-button" click="createBucket(createBucketValues.name, createBucketValues.region)" loading="isCreatingBucket" data-disabled="!createBucketValues.name || !createBucketValues.region || createS3BucketWarning">\n            </awsui-button>\n            <awsui-button id="cancel" text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant="normal" ng-if="state === STEP.NAME_AND_REGION" class="awsui-util-f-r" click="closeCreateBucketModal()">\n            </awsui-button>\n            <awsui-button id="previous" text="{{ \'createbucketmodal.footer.previous\' | translate }}" variant="normal" ng-if="state !== STEP.NAME_AND_REGION" class="awsui-util-f-r" click="goToPreviousState()" data-disabled="createS3BucketWarning">\n            </awsui-button>\n            <awsui-button id="create-secondary" ng-if="state === STEP.NAME_AND_REGION" variant="normal" text="{{ \'createbucketmodal.footer.createnow\' | translate }}" class="awsui-util-f-l" click="createBucketNow(createBucketValues.name, createBucketValues.region)" loading="isCreatingBucket" data-disabled="createS3BucketError || !createBucketValues.name || !createBucketValues.region || bucketNameValidationErrors.length > 0 ">\n            </awsui-button>\n        </div>\n    </modal-footer>\n</modal>');a.put("/s3/partials/defaultencryption.html",'<card card-summary-obj="cardSummaryObj" id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-webhost-water-mark\': !cardOpen, \'card-enable-webhost-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="bucketproperties.defaultencryption.title"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelDefaultEncryption($event)"></div>\n    </card-header>\n    <card-content>\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="bucketproperties.defaultencryption.blurb"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <p translate="bucketproperties.defaultencryption.disclaimer"></p>\n            <awsui-radio-group value="{{defaultEncryption.encryption}}" ng-model="defaultEncryption.encryption">\n                <div ng-repeat="encryption in encryptionOptions">\n                    <awsui-radio-button class="encryption-radio-btn" value="{{encryption.value}}" label="{{encryption.value}}" ng-class="{ \'no-description\': !encryption.description }"></awsui-radio-button>\n                    <p class="default-encryption-description" ng-if="encryption.description">{{encryption.description}}</p>\n                    <div ng-if="encryption.value === encryptionConstants.AWSKMS && defaultEncryption.encryption === encryptionConstants.AWSKMS" class="kms-arn-selector" fac-id="s3-kms">\n                        <awsui-control-group validation-message="{{ KMSServiceError }}">\n                            <dropdown items="kmsKeys" placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled="KMSServiceError" selected-item="defaultEncryption.kmsId" filter="true" dropdown-disabled="true">\n                            </dropdown>\n                        </awsui-control-group>\n                        <awsui-textfield class="custom-kms-arn" ng-if="defaultEncryption.encryption===encryptionConstants.AWSKMS && defaultEncryption.kmsId.value===encryptionConstants.CUSTOM_ARN" ng-model="defaultEncryption.customKMSARN"></awsui-textfield>\n                    </div>\n                </div>\n            </awsui-radio-group>\n            <awsui-alert type="warning" ng-if="shouldShowBucketPolicyWarning()">\n                <span class="property-card-warning" translate="bucketproperties.defaultencryption.checkbucketpolicy"></span>\n                <awsui-button class="bucket-policy-btn" text="{{ \'bucketproperties.defaultencryption.viewbucketpolicy\' | translate }}" ng-click="goToBucketPermissionsTab()"></awsui-button>\n            </awsui-alert>\n            <awsui-alert class="custom-kms-arn-error" type="error" ng-if="sseError && cardOpen"> {{ sseError }} </awsui-alert>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n    </card-content>\n    <card-footer>\n        <div ng-if="cardOpen">\n            <awsui-button ng-click="cancelDefaultEncryption($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button ng-click="saveDefaultEncryption($event)" text="{{ \'button.save\' | translate }}" data-disabled="shouldDisableSave()" variant="primary"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/detailprogress.html",'<modal class="detail-progress" is-open="isOpen" header-title="targetOperation.displayName" close-callback="closeCallback">\n    <modal-header>\n        <div class="detail-progress-header">\n            <span class="operation-water-mark operation-water-mark-image"></span>\n            <div class="operation-modal-title" ng-if="isActiveUploadOperation()">{{ targetOperation.displayName }} ({{ targetOperation.currentUploadSpeed }}/s)</div>\n            <div class="operation-modal-title" ng-if="!isActiveUploadOperation()">{{ targetOperation.displayName }}</div>\n            <div class="operation-modal-percentage">{{ targetOperation.successPercentage }}% {{ "operation.progress.complete" | translate }}</div>\n            <div class="detail-progress-overall-progress">\n                <div class="detail-progress-bar"></div>\n                <div class="detail-progress-bar-fill"></div>\n            </div>\n        </div>\n    </modal-header>\n    <modal-content>\n        <div class="operation-info">\n            <div class="source-info truncate">\n                <span class="info-text" translate="operation.detail.sourcepath"></span>\n                <a href="{{targetOperation.operationInitialLocationUrl}}">{{ targetOperation.operationPath }}</a>\n            </div>\n            <div class="target-info truncate" ng-if="targetOperation.dstBucket">\n                <span class="info-text" translate="operation.detail.targetpath"></span>\n                <a href="{{targetOperation.operationDestinationUrl}}">{{ targetOperation.operationDestinationPath }}</a>\n            </div>\n        </div>\n        <div class="detail-progress-content">\n            <table class="detail-progress-overall-table">\n                <tr>\n                    <td>\n                        <span class="object-progress-icon awsui-icon" ng-class="{\'alert-check-circle\': targetOperation.parameters.operationSuccessful, \'alert-exclamation-circle\': targetOperation.parameters.operationUnsuccessful, \'alert-exclamation-triangle\': targetOperation.parameters.operationPartiallySuccessful}"></span>\n                        <div ng-if="targetOperation.name === UPLOAD_OPERATION" class="detail-progress-text total-count" translate="">operation.detail.totalfiles</div>\n                        <div ng-if="targetOperation.name !== UPLOAD_OPERATION" class="detail-progress-text total-count" translate="">operation.detail.totalObjects</div>\n                    </td>\n                    <td><div class="detail-progress-text total-objects-count">{{ targetOperation.totalObjectCount }}</div></td>\n                </tr>\n                <tr>\n                    <td class="success-count-line">\n                        <div class="detail-progress-text total-successful" translate="">operation.detail.successful</div>\n                    </td>\n                    <td class="total-success-count-percentage">\n                        <div ng-if="targetOperation.parameters.isDeleteBucketSuccessful" class="detail-progress-text total-successful-count">{{ targetOperation.succeedKeyCount }} ({{ targetOperation.successPercentage-50 }}%)</div>\n                        <div ng-if="shouldShowByteText()" class="detail-progress-text total-successful-count" translate="" translate-values="{ succeedKeyCount : {{targetOperation.succeedKeyCount}}, successPercentage: {{targetOperation.successPercentage}} }">operation.detail.successInfo</div>\n                        <div ng-if="!shouldShowByteText()" class="detail-progress-text total-successful-count">{{ targetOperation.succeedKeyCount }} ({{ targetOperation.successPercentage }}%)</div>\n                    </td>\n                </tr>\n                <tr ng-repeat="errorType in targetOperation.errorTypes">\n                    <td class="error-files-list-expander">\n                        <i class="awsui-icon alert-exclamation-circle hidden"></i>\n                        <awsui-expandable-section class="expander dark" header="{{errorType.errorMessage}}" expanded="false">\n                            <table class="files-list-table">\n                                <tr class="file-role" ng-repeat="errorKey in targetOperation.errorDetails[errorType.errorMessage]">\n                                    <td class="file-icon">\n                                        <span class="awsui-icon awsui-icon-light" ng-class="getFileIconClass(errorKey)"></span>\n                                    </td>\n                                    <td class="object-detail">\n                                        <div class="object-name">{{ errorKey }}</div>\n                                        <div class="object-info">/{{ targetOperation.initialBucket }}/{{ targetOperation.initialPath }}</div>\n                                    </td>\n                                    <td class="error-icon"><i class="awsui-icon alert-exclamation-circle"></i></td>\n                                </tr>\n                            </table>\n                        </awsui-expandable-section>\n                    </td>\n                    <td class="error-count-percentage">\n                        <div ng-if="targetOperation.name === deleteBucketOperationName" class="detail-progress-text total-successful-count">{{ errorType.errorCount }} ({{ targetOperation.errorPercentage-50 }}%)</div>\n                        <div ng-if="targetOperation.name !== deleteBucketOperationName" class="detail-progress-text total-successful-count">{{ errorType.errorCount }} ({{ targetOperation.errorPercentage }}%)</div>\n                    </td>\n                </tr>\n                <tr ng-if="targetOperation.name === deleteBucketOperationName">\n                    <td>\n                        <span class="object-progress-icon awsui-icon" ng-class="{\'alert-check-circle\': targetOperation.parameters.isDeleteBucketSuccessful, \'alert-exclamation-circle\': !targetOperation.parameters.isDeleteBucketSuccessful }"></span>\n                        <div class="detail-progress-text total-count" translate="">operation.detail.bucketDeletion</div>\n                    </td>\n                    <td ng-if="targetOperation.parameters.isDeleteBucketSuccessful"><div class="detail-progress-text deletion-status" translate="">operation.detail.successful</div></td>\n                    <td ng-if="!targetOperation.parameters.isDeleteBucketSuccessful"><div class="detail-progress-text deletion-status" translate="">operation.detail.failed</div></td>\n                </tr>\n                <tr ng-if="targetOperation.name === deleteBucketOperationName">\n                    <td>\n                        <span class="detail-progress-text delete-bucket-error-message"> {{ targetOperation.errorMessage }} </span>\n                    </td>\n                </tr>\n            </table>\n        </div>\n    </modal-content>\n    <modal-footer>\n        <div class="detail-progress-footer">\n            <div class="cancel-operation-button" ng-click="cancelOperationFunction(targetOperation)">\n                <div class="cancel-operation-button-text">{{ cancelButtonText }}</div>\n            </div>\n        </div>\n    </modal-footer>\n</modal>');a.put("/s3/partials/dialogmodal.html",'<div class="aws-modal" id="confirmation-modal">\n    <div ng-show="isOpen.flag" class="modal-frame fade in ng-hide">\n        <div class="modal-header" ng-class="getClass()">\n            <i class="panel-close-icon modal-close" ng-click="closeModal()"></i>\n            <div class="modal-header-title">{{headerTitle}}</div>\n            <div class="modal-header-divider"></div>\n            <div ng-transclude="header"></div>\n        </div>\n        <div ng-if="countInfo.flag" class="confirmation-info-subheader">\n            <table class="dialog-info-table">\n                <tr class="dialog-info-text">\n                    <td colspan="2" class="confirmation-info-text" translate="confirmationmodal.countinfo.title.currentlevel"></td>\n                    <td colspan="2" class="confirmation-info-text">\n                        <span translate="">confirmationmodal.countinfo.title.totalimpact</span>\n                        <awsui-tooltip text="{{\'confirmationmodal.totalimpact.tooltip\' | translate}}" position="bottom" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </td>\n                </tr>\n                <tr class="dialog-info-data">\n                    <td id="confirmation-modal-folder-count" translate="confirmationmodal.countinfo.folders" translate-values="{ folderCount : {{countInfo.folders}} }"></td>\n                    <td id="confirmation-modal-object-count" translate="confirmationmodal.countinfo.objects" translate-values="{ objectCount : {{countInfo.currLevelObjs}} }"></td>\n                    <td translate="confirmationmodal.countinfo.totalobjects" translate-values="{ totalObjCount : {{countInfo.objects}} }"></td>\n                    <td>\n                        <awsui-tooltip ng-if="countInfo.sizeDataMissing" text="{{\'confirmationmodal.info.sizedatamissing\' | translate}}" position="bottom" size="small">\n                            <span>\n                                {{countInfo.size | humanReadableBytes}}\n                                <span>*</span>\n                            </span>\n                        </awsui-tooltip>\n                        <span ng-if="!countInfo.sizeDataMissing">\n                            {{countInfo.size | humanReadableBytes}}\n                        </span>\n\n                        <span translate="confirmationmodal.countinfo.totalsize"></span>\n                    </td>\n                </tr>\n            </table>\n        </div>\n        <div ng-if="sourceDstInfo.flag" class="paste-subheader-info">\n            <table>\n                <tr>\n                    <td>\n                        <translate class="confirmation-label">confirmationmodal.source</translate>\n                        <span>{{sourceDstInfo.source}}</span>\n                    </td>\n                    <td>\n                        <translate class="confirmation-label">confirmationmodal.dst</translate>\n                        <span>{{dstFolderPath}}</span>\n                    </td>\n                </tr>\n            </table>\n        </div>\n        <div class="modal-body" ng-transclude="content" ng-class="{\n                           \'modal-body-height-with-warning\': hasWarningMsg.flag && !sourceDstInfo.flag,\n                           \'modal-body-height-without-warning\': !hasWarningMsg.flag,\n                           \'modal-body-height-with-warning-and-source-dst-info\': hasWarningMsg.flag && sourceDstInfo.flag\n                       }">\n        </div>\n        <div class="modal-footer">\n            <div class="confirmation-banner">\n                <div class="footer-divider"></div>\n                <awsui-alert ng-if="hasWarningMsg.flag" type="warning" dismissible="false">\n                    <p translate="{{hasWarningMsg.text}}" translate-values="{val: \'{{hasWarningMsg.val}}\' }"></p>\n                </awsui-alert>\n            </div>\n            <div ng-transclude="footer"></div>\n        </div>\n    </div>\n    <div ng-show="isOpen.flag" class="modal-background ng-hide"></div>\n</div>');a.put("/s3/partials/dropdown.html",'<div id="dropdown" class="dropdown" clickoutside="" on-click-outside="closeDropDown">\n    <table id="current-displayed-table" class="awsui-select-target current-displayed" ng-class="{\'dropdown-disabled\' : disabled}" ng-click="toggleDropDown(disabled)">\n        <tr ng-if="!selectedItem.displayTextField && !enableInput" class="current-displayed-row" ng-class="{\'dropdown-disabled\' : disabled, \'item-selected\' : selectedItem && !disabled, \'item-not-selected\': (!selectedItem || selectedItem.error || selectedItem.inputError) && !disabled}">\n            <td class="current-displayed-item" ng-class="{ \'disabled-text\': disabled }"><div class="truncate-dropdown" ng-style="{\'width\':getDisplayWidth()}">{{ selectedItem.error || selectedItem.inputError ? placeholder : selectedItem.text || selectedItem || placeholder }}</div></td>\n        </tr>\n        <tr class="current-displayed-row" ng-class="{\'dropdown-disabled\' : disabled, \'item-selected\' : selectedItem, \'item-not-selected\': !selectedItem}" ng-if="enableInput">\n            <td>\n                <awsui-textfield class="dropdown-inputfield" name="inputValidation" ng-model="inputField.text" ng-change="updateInput(inputField)" ng-click="$event.stopPropagation();"></awsui-textfield>\n            </td>\n        </tr>\n        <tr class="current-displayed-row" ng-class="{\'dropdown-disabled\' : disabled}" ng-if="selectedItem.displayTextField">\n            <td class="dropdown-input-td">\n                <awsui-textfield class="dropdown-inputfield" data-disabled="disabled" ng-model="selectedItem.inputValue" ng-change="updateInput(selectedItem)" placeholder="{{ selectedItem.value }}" ng-click="$event.stopPropagation();"></awsui-textfield>\n            </td>\n        </tr>\n    </table>\n    <div class="list-items" ng-class="{\'dropdown-no-filter\' : !filter}" ng-if="isOpen">\n        <table ng-if="filter" id="search-box" class="search-box">\n            <tr>\n                <td class="dropdown-search-inputtext"><input type="text" class="input-field" ng-model="tableFiltering.filter[filterColumn]" ng-keydown="filterKeyDown($event)" placeholder="{{ \'dropdown.inputfield.placeholder\' | translate }}"></td>\n                <td><i class="awsui-icon search"></i></td>\n            </tr>\n        </table>\n        <div class="item" ng-repeat="item in items | filter:tableFiltering.filter | orderBy:[\'pinnedTop\', \'text || toString()\'] " ng-click="selectItem(item)">\n            <div class="list-item">{{item.text || item}}</div>\n        </div>\n        <span class="no-matches-found" ng-if="((items | filter:tableFiltering.filter).length == 0)" translate="dropdown.nomatchesfound"></span>\n    </div>\n</div>');a.put("/s3/partials/editor.html",'<div class="ide-container">\n    <div id="editor" class="ide" ng-class="{ \'editor-large\': large, \'readonly\': readonly }" ng-model="code" ui-ace="{theme: \'dawn\', mode: \'javascript\', fontSize: 14, onLoad: aceLoaded}">\n    </div>\n</div>');a.put("/s3/partials/emptystate.html",'<div id="initial-start-page">\n    <div id="initial-start-top-content" class="awsui-util-t-c">\n        <div class="initial-start-paragraph" translate="emptystate.{{type}}.title"></div>\n    </div>\n    <table id="initial-start-selling-points">\n        <tbody>\n        <tr class="awsui-util-t-c" ng-if="!oneIntroImage">\n            <td>\n                <div class="intro-image no-{{type}}-1"></div>\n                <div class="intro-feature" translate="emptystate.{{type}}.firstheader"></div>\n            </td>\n            <td>\n                <div class="intro-image no-{{type}}-2"></div>\n                <div class="intro-feature" translate="emptystate.{{type}}.secondheader"></div>\n            </td>\n            <td>\n                <div class="intro-image no-{{type}}-3"></div>\n                <div class="intro-feature" translate="emptystate.{{type}}.thirdheader"></div>\n            </td>\n        </tr>\n        <tr class="awsui-util-t-c" ng-if="oneIntroImage">\n            <td>\n                <div class="intro-image no-{{type}}-1"></div>\n                <div class="intro-feature" translate="emptystate.{{type}}.firstheader"></div>\n            </td>\n        </tr>\n        <tr ng-if="!oneIntroImage">\n            <td class="intro-feature-details" translate="emptystate.{{type}}.firstdetails"></td>\n            <td class="intro-feature-details" translate="emptystate.{{type}}.seconddetails"></td>\n            <td class="intro-feature-details" translate="emptystate.{{type}}.thirddetails"></td>\n        </tr>\n        <tr ng-if="oneIntroImage">\n            <td class="replication-intro-feature-details"><div class="replication-detail-msg" translate="emptystate.{{type}}.firstdetails"></div></td>\n        </tr>\n        <tr id="initial-start-feature-learn-more" class="awsui-util-t-c" ng-if="!oneIntroImage">\n            <td><a href="{{getLearnMoreLink(0)}}" target="_blank">{{\'learn.more\'|translate}}</a></td>\n            <td><a href="{{getLearnMoreLink(1)}}" target="_blank">{{\'learn.more\'|translate}}</a></td>\n            <td><a href="{{getLearnMoreLink(2)}}" target="_blank">{{\'learn.more\'|translate}}</a></td>\n        </tr>\n        <tr class="awsui-util-t-c" ng-if="oneIntroImage">\n            <td><a href="{{getLearnMoreLink(0)}}" target="_blank">{{\'learn.more\'|translate}}</a></td>\n        </tr>\n        </tbody>\n    </table>\n    <div id="initial-start-support">\n        <awsui-button class="awsui-util-mb-s" text="{{\'get.started\' | translate}}" variant="primary" click="openModal()"></awsui-button>\n    </div>\n</div>');a.put("/s3/partials/events.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-events-water-mark\': !cardOpen, \'card-enable-events-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="events.header"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="closeCard($event)"></div>\n    </card-header>\n    <card-content>\n        <awsui-button ng-if="cardOpen" data-disabled="cardState.isAdding" text="{{\'events.button.addnotification\' | translate}}" icon="plus" variant="link" click="addEvent()"></awsui-button>\n        <awsui-button ng-if="cardOpen" data-disabled="cardState.selectedEventTable === null || cardState.isAdding" text="{{ \'events.button.delete\' | translate }}" variant="link" click="deletePressed()" loading="isDeleting">\n        </awsui-button>\n        <awsui-button ng-if="cardOpen" data-disabled="cardState.selectedEventTable === null || cardState.isAdding" text="{{ \'events.button.edit\' | translate }}" variant="link" click="editPressed()">\n        </awsui-button>\n        <div class="events-table" ng-if="cardOpen">\n            <awsui-radio-group ng-model="cardState.radioValue">\n                <table class="table table-condense">\n                    <thead>\n                        <tr>\n                            <td></td>\n                            <td translate="">events.table.name</td>\n                            <td translate="">events.table.events</td>\n                            <td translate="">events.table.filter</td>\n                            <td translate="">events.table.type</td>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr ng-repeat-start="event in eventsTable" class="add-events-row" ng-if="event.isEditing">\n                            <td colspan="4">{{ cardState.headerTitle }}</td>\n                            <td colspan="1">\n                                <span class="panel-close-icon close-button" ng-click="closeAddEvents()"></span>\n                            </td>\n                        </tr>\n                        <tr ng-repeat-end="">\n                            <td colspan="5" ng-if="event.isEditing">\n                                <add-events-form id="add-events-form" event-types="eventTypes" selected-event="cardState.selectedEventObj" resource-types="resourceTypes" modal-info="modalInfo" for-create-bucket-modal="forCreateBucketModal" card-state="cardState" current-events="currentEvents"></add-events-form>\n                            </td>\n                            <td ng-if="!event.isEditing">\n                                <awsui-radio-button ng-click="selectEvent(event)" value="{{event.id}}">\n                                    <td ng-if="!event.isEditing" class="event-id">{{event.id}}</td>\n                                    <td ng-if="!event.isEditing">{{event.events}}</td>\n                                    <td ng-if="!event.isEditing">{{event.filter}}</td>\n                                    <td ng-if="!event.isEditing">{{event.type}}</td>\n                                </awsui-radio-button>\n                            </td>\n                        </tr>\n                    </tbody>\n                    <tr ng-if="currEvents.length === 0 && !isAddingEvent">\n                        <td colspan="5">\n                            <div class="empty-message">\n                                {{ \'events.table.emptymessage\' | translate }}\n                                <awsui-button text="{{\'events.button.addnotification\' | translate}}" ng-click="openAddEventModal()"></awsui-button>\n                            </div>\n                        </td>\n                    </tr>\n                </table>\n            </awsui-radio-group>\n        </div>\n        <p ng-if="!cardOpen" class="bucketproperties-summary" translate="bucketproperties.events.summary"></p>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert ng-if="cardOpen" type="error" visible="cardState.showError">{{ cardState.errorMessage }}</awsui-alert>\n    </card-content>\n    <card-footer>\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button text="{{ \'events.button.save\' | translate }}" variant="primary" data-disabled="cardState.selectedEventObj.name === \'\' || cardState.selectedEventObj.arn === \'\'" class="awsui-util-f-r buttons" ng-click="savePressed($event)" loading="cardState.isSaving">\n            </awsui-button>\n            <awsui-button text="{{ \'events.button.cancel\' | translate }}" variant="normal" class="awsui-util-f-r buttons" ng-click="cancelPressed($event)">\n            </awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/fileslistinmodal.html",'<div ng-show="haveSelectedItems()" class="truncate">\n    <table class="modal-selected-files">\n        <tr ng-show="forUploads">\n            <td colspan="4">\n                <span class="awsui-icon plus awsui-icon-link" for="uploadInput"></span>\n                <label class="modal-add-files-label" id="modal-selected-files-upload-add" for="uploadInput">{{\'uploadmodal.label.add.more.files\' | translate }}</label>\n            </td>\n        </tr>\n        <tr ng-repeat="folder in selectedItems.folders">\n            <td class="modal-file-icon"><span class="folder awsui-icon awsui-icon-light"></span></td>\n            <td>\n                <p class="modal-selected-files-file-name">{{ folder.Prefix }}</p>\n                <p class="modal-selected-files-file-size">\n                    <span ng-if="folder.objsCount === null || folder.objsCount === undefined" translate="confirmationmodal.filelist.calculating"></span>\n                    <span ng-if="folder.objsCount !== null && folder.objsCount !== undefined" translate="confirmationmodal.folders" translate-values="{totalFolders: {{folder.objsCount}} }"></span>\n                    <span ng-if="folder.objsCount !== null && folder.objsCount !== undefined">- {{folder.folderSize | humanReadableBytes }} </span>\n                </p>\n            </td>\n            <td>\n                <span class="awsui-icon times awsui-icon-big awsui-icon-light" ng-show="closeIconShow" ng-click="closeIconFunc(folder)"></span>\n            </td>\n        </tr>\n        <tr ng-repeat="file in selectedItems.objects">\n            <td><span class="awsui-icon awsui-icon-light" ng-class="getFileIconClass(file)"></span></td>\n            <td>\n                <p class="modal-selected-files-file-name">{{ file.Key }}</p>\n                <p ng-if="file.VersionId && file.VersionId != \'null\'" class="modal-selected-files-file-size"> {{ \'objects.column.versionid\' | translate }}: {{file.VersionId}} </p>\n                <p class="modal-selected-files-file-size">\n                    <span ng-if="file.Size">- {{ file.Size | humanReadableBytes }}</span>\n                    <span ng-if="!file.Size"> -- </span>\n                </p>\n            </td>\n            <td>\n                <span class="awsui-icon times awsui-icon-big awsui-icon-light" ng-show="closeIconShow" ng-click="closeIconFunc(file)"></span>\n            </td>\n        </tr>\n    </table>\n</div>');a.put("/s3/partials/hint.html",'<div class="useful-links">\n    <div class="hint-button" fac-id="s3-old-console">\n        <awsui-tooltip text="{{\'tooltip.oldconsole\' | translate}}" position="bottom" size="small">\n            <span class="switch-oldconsole hint-icons"></span><awsui-button variant="link" click="goToOldConsole()" text="{{\'button.oldconsole\' | translate}}" class="switch-back-button"></awsui-button>\n        </awsui-tooltip>\n    </div>\n    <div ng-if="showVideo()" class="hint-button" fac-id="s3-intro-video">\n        <span class="introvideo hint-icons"></span><awsui-button variant="link" click="goToVideo()" text="{{\'button.introvideo\' | translate}}" class="switch-back-button"></awsui-button>\n    </div>\n    <div class="tips-button" fac-id="s3-quick-tips">\n        <awsui-tooltip text="{{hintMessage}}" position="bottom" size="small">\n            <i class="blue-lightbulb hint-icons"></i><awsui-button variant="link" text="{{\'hint.label\' | translate}}" class="hint-tips-button"></awsui-button>\n        </awsui-tooltip>\n    </div>\n</div>');a.put("/s3/partials/initiaterestore.html",'<div class="initiate-restore-modal" ng-show="isOpen.flag">\n    <dialog-modal is-open="isOpen" close-callback="closeModal()" header-title="headerTitle" count-info="countInfo">\n        <dialog-modal-content>\n            <div class="num-of-days-section">\n                <p class="label" translate="initiaterestoremodal.label.numOfDays"></p>\n                <awsui-control-group>\n                        <span dom-region="validationMessage" ng-if="numOfDaysError.length > 0">\n                            <label ng-repeat="message in numOfDaysError">{{message}}</label><br>\n                        </span>\n                    <span dom-region="control">\n                            <awsui-textfield id="num-of-days" class="num-of-days" ng-model="params.numOfDays" ng-keyup="validateNumOfDays()" placeholder="{{\'initiaterestoremodal.placeholder.numOfDays\' | translate}}">\n                            </awsui-textfield>\n                        </span>\n                </awsui-control-group>\n            </div>\n            <div class="retrieval-option-section">\n                <div class="retrieval-option-text">\n                    <p class="label" translate="initiaterestoremodal.label.retrievalOption"></p>\n                </div>\n                <dropdown items="retrievalOptions" placeholder="{{ \'initiaterestoremodal.dropboxselectwarning\' | translate }}" id="retrieval-option-dropdown" selected-item="params.retrievalOption"></dropdown>\n                <p ng-if="!showCapacityInfo" class="label learn-more-pricing" translate="initiaterestoremodal.label.glacierPricing" translate-values="{link: learnMoreUrl}"></p>\n            </div>\n            <div ng-if="showCapacityInfo" class="provisioned-capacity-info">\n                <span class="provisioned-capacity-availability">\n                    <p class="label provisioned-capacity-available-text" translate="initiaterestoremodal.label.provisionedCapacity"></p>\n                    <p class="label">{{ capacityUnitsAvailable }}</p>\n                </span>\n                <div>\n                    <awsui-button class="add-capacity" text="{{ \'initiaterestoremodal.button.addCapacity\' | translate }}" variant="normal" click="addCapacity()" loading="isPurchasingCapacity"></awsui-button>\n                    <awsui-alert ng-if="showBuyConfirmation" type="info" dismissible="false">\n                        <span dom-region="header" translate="initiaterestoremodal.label.provisionedCapacityCost" translate-values="{ val: capacityCost, link: learnMoreUrl }"></span>\n                        <span dom-region="content">\n                             <awsui-button class="buy-capacity" text="{{ \'initiaterestoremodal.button.buy\' | translate }}" variant="normal" click="buyCapacity()" loading="isPurchasingCapacity"></awsui-button>\n                         </span>\n                    </awsui-alert>\n\n                    <awsui-alert ng-if="isPurchaseSuccessful" type="success" dismissible="false" header="{{ \'initiaterestoremodal.purchasedetails.succeedText\' | translate }}">\n                        <p translate="initiaterestoremodal.purchasedetails.priceText" translate-values="{ val: capacityCost }"></p>\n                        <p translate="initiaterestoremodal.purchasedetails.learnMore" translate-values="{link: learnMoreUrl}"></p>\n                    </awsui-alert>\n                </div>\n            </div>\n            <div>\n                <div ng-if="showCapacityInfo && capacityUnitsAvailable < 1" class="provisioned-capacity-info-text" translate="initiaterestoremodal.label.provisionedCapacityInfo" translate-values="{link: learnMoreDataRetrievalUrl}"></div>\n                <div ng-if="showCapacityInfo && capacityUnitsAvailable > 0">\n                    <table class="expandsectable">\n                        <tr class="subsectitle-row">\n                            <td ng-repeat="title in titles">\n                                {{title.txt}}\n                                <awsui-tooltip text="{{title.info}}" position="{{title.pos}}" size="small">\n                                    <i class="awsui-icon alert-info-circle"></i>\n                                </awsui-tooltip>\n                            </td>\n                        </tr>\n                        <tr class="subseccontent-row" ng-repeat="unit in capacityUnits">\n                            <td>{{unit.id}}</td>\n                            <td>{{unit.purchaseDate}}</td>\n                            <td>{{unit.expirationDate}}</td>\n                        </tr>\n                    </table>\n                </div>\n            </div>\n            <awsui-alert class="retrieval-error" type="error" ng-if="retrievalError" dismissible="false"> {{ retrievalError }} </awsui-alert>\n        </dialog-modal-content>\n        <dialog-modal-footer>\n            <div class="upload-modal-footer">\n                <div class="confirmation-banner">\n                    <awsui-alert type="warning" dismissible="false">\n                        <p translate="initiaterestoremodal.alert.storageMessage"></p>\n                    </awsui-alert>\n                </div>\n                <awsui-button id="cancel" text="{{ \'button.cancel\' | translate }}" variant="normal" click="closeModal()"></awsui-button>\n                <awsui-button id="restore" class="awsui-util-f-r primary-button" text="{{ \'initiaterestoremodal.footer.restore\' | translate }}" variant="primary" click="restore()" data-disabled="!params.numOfDays || !params.retrievalOption || numOfDaysError.length > 0"></awsui-button>\n            </div>\n        </dialog-modal-footer>\n    </dialog-modal>\n</div>');a.put("/s3/partials/lifecycleconfirmationmodal.html",'<dialog-modal class="lifecycle-confirmation-modal" is-open="isOpen" close-callback="closeConfirmationModal" header-title="headerTitle">\n    <dialog-modal-content>\n        <awsui-alert class="confirmation-warning" visible="!showContinue" type="warning"> {{ warningMessage }} </awsui-alert>\n        <awsui-alert class="confirmation-warning" visible="showContinue" type="warning"> {{ stateChangeWarning }}</awsui-alert>\n        <awsui-alert visible="lifecycleError" class="block small-top-margin" type="error" dismissible="false" header="{{ \'lifecyclemodal.step3.error.header\' | translate }}"> {{ lifecycleError }}\n        </awsui-alert>\n    </dialog-modal-content>\n    <dialog-modal-footer>\n        <awsui-button id="cancel" text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant="normal" click="closeConfirmationModal()"></awsui-button>\n        <awsui-button id="continue" variant="primary" ng-if="!showContinue" text="{{ \'lifecycleconfirmationmodal.footer.confirm\' | translate }}" class="awsui-util-f-r primary-button" click="detectStateChange()">\n        </awsui-button>\n        <awsui-button id="save" ng-if="showContinue" click="saveLifecycle()" variant="primary" text="{{ \'lifecyclemodal.footer.continue\' | translate }}" class="awsui-util-f-r primary-button">\n        </awsui-button>\n    </dialog-modal-footer>\n</dialog-modal>');a.put("/s3/partials/lifecyclemodal.html",'<modal id="lifecycle-modal" class="lifecycle-modal" ng-class="{\'overflow-y-visible\': state===STEP.NAME_AND_SCOPE}" is-open="isOpen" steps="STEP" state="state" close-callback="closeLifecycleModal" header-title="headerTitle" next-state="nextState" previous-state="previousState" set-state="setState">\n    <modal-content>\n        <div class="lifecycle-modal-content">\n            <div class="body-content" ng-if="state === STEP.NAME_AND_SCOPE">\n                <p class="label" translate="lifecyclemodal.label.policyname"></p>\n                <awsui-textfield id="rule-name" class="policy-name" change="updateNextButtonDisabled()" ng-model="selectedRule.ID" placeholder="{{\'lifecyclemodal.placeholder.policyname\' | translate}}">\n                </awsui-textfield>\n                <table>\n                    <tr>\n                        <td>\n                            <p class="label" translate="lifecyclemodal.label.applypolicy"></p>\n                        </td>\n                        <td class="tool-tip-text-subheader">\n                            <awsui-tooltip text="{{ \'lifecyclemodal.prefixtag.tooltip\' | translate }}" position="right" size="small">\n                                <i class="awsui-icon alert-info-circle"></i>\n                            </awsui-tooltip>\n                        </td>\n                    </tr>\n                </table>\n                <div ng-if="showOldUI" fac="s3-ot" fac-toggle="">\n                    <awsui-radio-group class="step1-radio-buttons" ng-model="selectedRule.applied" change="updateNextButtonDisabled()">\n                        <awsui-radio-button class="step1-radio-buttons" value="whole" ng-model="selectedRule.applied" label="{{ \'lifecyclemodal.step1.wholebucket\' | translate }}"></awsui-radio-button>\n                        <awsui-radio-button class="step1-radio-buttons" value="prefix" ng-model="selectedRule.applied" label="{{ \'lifecyclemodal.step1.prefix\' | translate }}"></awsui-radio-button>\n                    </awsui-radio-group>\n                    <awsui-textfield ng-if="selectedRule.applied === \'prefix\'" change="updateNextButtonDisabled()" class="policy-name" autocomplete="true" ng-model="selectedRule.Prefix" placeholder="{{\'lifecyclemodal.placeholder.prefix\' | translate}}">\n                    </awsui-textfield>\n                </div>\n                <div ng-if="!showOldUI" class="lifecycle-tag-search">\n                    <search fac-id="s3-ot" fetch-one-page-prefix="fetchOnePagePrefix(prefix)" fetch-one-page-tag="fetchOnePageTag()" filters="selectedRule.filters" markers="markers" tag-continuation-tokens="tagContinuationTokens" no-backend-calls="true" enforce-selection="updateNextButtonDisabled()" search-error="tag.error" tag-search-selected="tagSearchSelected" show-tag="showTag">\n                    </search>\n                </div>\n                <awsui-alert visible="showFinishSelectionWarning" type="warning" id="finish-filter-selection-warning">\n                    {{  \'lifecyclemodal.warning.finishselectionwarning\' | translate }}\n                </awsui-alert>\n                <awsui-alert visible="showV2FormatWarning" type="warning">\n                    {{ \'lifecyclemodal.warning.newformatwarning\' | translate }}\n                </awsui-alert>\n                <awsui-alert visible="clearLDMAMUWarning" type="warning">\n                    {{ \'lifecyclemodal.warning.removeldmamu\' | translate }}\n                </awsui-alert>\n            </div>\n            <div class="body-content" ng-if="state === STEP.TRANSITION">\n                <table>\n                    <tr>\n                        <td>\n                            <p class="configure-label" translate="lifecyclemodal.step2.configurerule"></p>\n                        </td>\n                        <td class="tool-tip-text-header">\n                            <awsui-tooltip text="{{ \'lifecyclemodal.standardia.tooltip\' | translate }}" position="bottom" size="small">\n                                <i class="awsui-icon alert-info-circle"></i>\n                            </awsui-tooltip>\n                        </td>\n                    </tr>\n                </table>\n                <table class="upload-modal-radio-button-properties">\n                    <tr>\n                        <td>\n                            <awsui-checkbox id="current-version-transition" class="step2-radio-label" ng-model="selectedRule.showCurrent" change="showStep2CurrentVersionChange()">\n                                <span class="show-version" translate="lifecyclemodal.step2.current"></span>\n                            </awsui-checkbox>\n                        </td>\n                        <td class="show-previous">\n                            <awsui-checkbox id="previous-version-transition" class="step2-radio-label" ng-model="selectedRule.showPrevious" change="showStep2PreviousVersionChange()">\n                                <span class="show-version" translate="lifecyclemodal.step2.noncurrent"></span>\n                            </awsui-checkbox>\n                        </td>\n                    </tr>\n                </table>\n                <div class="review-section-header"></div>\n                <div ng-if="selectedRule.showCurrent">\n                    <p class="current-version-label" translate="lifecyclemodal.step2.currentversion"></p>\n                    <div class="modal-content-divider"></div>\n                    <p ng-if="selectedRule.currentRuleActions.length === 0" class="empty-transitions" translate="lifecyclemodal.step2.emptycurrenttransitions"></p>\n                    <table class="lifecycle-table">\n                        <tr ng-if="selectedRule.currentRuleActions.length !== 0">\n                            <td id="object-creation" class="options" translate="lifecyclemodal.objectcreated"></td>\n                            <td class="object-created-days" translate="lifecyclemodal.step2.daysafterobjectcreation"></td>\n                        </tr>\n                    </table>\n                    <div class="add-transition">\n                        <a id="add-current-transition" ng-class="{ \'add-disabled\' : selectedRule.isAddCurrentTransitionDisabled }" ng-click="addCurrentRuleAction()"> {{\'lifecyclemodal.step2.addtransition\' | translate}}</a>\n                    </div>\n                    <table class="lifecycle-table">\n                        <tr ng-repeat="action in selectedRule.currentRuleActions">\n                            <td class="transition-options">\n                                <awsui-select class="lifecycle-modal-select" change="selectCurrentRuleAction(selectedRule.currentRuleActions[$index].action,$index)" items="selectedRule.currentRuleOptions[$index]" ng-model="selectedRule.currentRuleActions[$index].action" placeholder="{{\'lifecyclemodal.selectrule\' | translate}}"></awsui-select>\n                            </td>\n                            <td class="object-transition-days">\n                                <awsui-textfield ng-class="{ \'highlight-error\' : highlightTextBoxErrorCurrent[$index] }" placeholder="{{\'lifecyclemodal.days\' | translate}}" class="lifecycle-modal-input" ng-model="selectedRule.currentRuleActions[$index].value" disabled="selectedRule.currentRuleActions[$index].action === \'\'" ng-keyup="validateDays($index, \'current\')">\n                                </awsui-textfield>\n                                <span class="close-transition" ng-click="removeCurrentRuleAction($index)"> X </span>\n                            </td>\n                        </tr>\n                    </table>\n                    <awsui-alert type="error" visible="notANumberErrorCurrent.SIA" header="{{ \'lifecyclemodal.step2.numbersiaerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="notANumberErrorCurrent.Glacier" header="{{ \'lifecyclemodal.step2.numberglaciererrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="minimumDaysCurrent.SIA" header="{{ \'lifecyclemodal.step2.minimumdayssiaerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.minimumdayssiaerrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="minimumDaysCurrent.Glacier" header="{{ \'lifecyclemodal.step2.minimumdaysglaciererrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.minimumdaysglaciererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="higherNumberErrorCurrent.SIA" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="higherNumberErrorCurrent.Glacier" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="greaterThanCurrentError.GlacierGreaterThanSIA" header="{{ \'lifecyclemodal.step2.glaciergreaterthansiaerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.glaciergreaterthansiaerrormessage\' | translate }} {{ currentGlacierGreaterThanSIAValue }} </awsui-alert>\n                    <awsui-alert type="error" visible="currentError" header="{{ \'lifecyclemodal.step2.noruleactionerrorheader\' | translate }}"> {{ \'lifecyclemodal.step2.selectruleactionerror\'| translate }} </awsui-alert>\n                    <div ng-if="selectedRule.currentRuleActions.length === 0" class="modal-section"></div>\n                </div>\n                <div ng-if="selectedRule.showPrevious">\n                    <table>\n                        <tr>\n                            <td>\n                                <p class="current-version-label" translate="lifecyclemodal.step2.previousversion"></p>\n                            </td>\n                            <td class="tool-tip-text">\n                                <awsui-tooltip text="{{ \'lifecyclemodal.previousversion.tooltip\' | translate }}" position="right" size="small">\n                                    <i class="awsui-icon alert-info-circle"></i>\n                                </awsui-tooltip>\n                            </td>\n                        </tr>\n                    </table>\n                    <div class="modal-content-divider"></div>\n                    <p ng-if="selectedRule.noncurrentRuleActions.length === 0" class="empty-transitions" translate="lifecyclemodal.step2.emptynoncurrenttransitions"></p>\n                    <table class="lifecycle-table">\n                        <tr ng-if="selectedRule.noncurrentRuleActions.length !== 0">\n                            <td class="options" translate="lifecyclemodal.objectbecomespreviousversion"></td>\n                            <td class="object-created-days" translate="lifecyclemodal.step2.daysafterobjectcreation"></td>\n                        </tr>\n                    </table>\n                    <span class="add-transition">\n                    <a ng-class="{ \'add-disabled\' : selectedRule.isAddPrevTransitionDisabled }" ng-click="addNoncurrentRuleAction()"> {{\'lifecyclemodal.step2.addtransition\' | translate}} </a>\n                </span>\n                    <table class="lifecycle-table">\n                        <tr ng-repeat="action in selectedRule.noncurrentRuleActions">\n                            <td class="transition-options"><awsui-select class="lifecycle-modal-select" change="selectNoncurrentRuleAction(selectedRule.noncurrentRuleActions[$index].action, $index)" items="selectedRule.noncurrentRuleOptions[$index]" ng-model="selectedRule.noncurrentRuleActions[$index].action" placeholder="{{\'lifecyclemodal.selectrule\' | translate}}"></awsui-select>\n                                <div ng-if="selectedRule.noncurrentRuleActions[$index].showRldm"><awsui-checkbox ng-model="selectedRule.noncurrentRuleActions[$index].removeExpire">{{ \'lifecyclemodal.removeexpire\' | translate }}</awsui-checkbox></div>\n                            </td>\n                            <td ng-class="{ \'object-transition-days\' : !selectedRule.noncurrentRuleActions[$index].showRldm , \'remove-expire\' : selectedRule.noncurrentRuleActions[$index].showRldm }">\n                                <awsui-textfield ng-class="{ \'highlight-error\' : highlightTextBoxErrorNonCurrent[$index] }" placeholder="{{\'lifecyclemodal.days\' | translate}}" class="text-input lifecycle-modal-input" ng-model="selectedRule.noncurrentRuleActions[$index].value" disabled="selectedRule.noncurrentRuleActions[$index].action === \'\'" ng-keyup="validateDays($index,\'nonCurrent\')">\n                                </awsui-textfield>\n                                <span class="close-transition" ng-click="removeNoncurrentRuleAction($index)"> X </span>\n                            </td>\n                        </tr>\n                    </table>\n                    <awsui-alert type="error" visible="notANumberErrorNoncurrent.SIA" header="{{ \'lifecyclemodal.step2.numbersiaerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="notANumberErrorNoncurrent.Glacier" header="{{ \'lifecyclemodal.step2.numberglaciererrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="minimumDaysNoncurrent.SIA" header="{{ \'lifecyclemodal.step2.minimumdayssiaerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.minimumdayssiaerrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="minimumDaysNoncurrent.Glacier" header="{{ \'lifecyclemodal.step2.minimumdaysglaciererrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.minimumdaysglaciererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="higherNumberErrorNoncurrent.SIA" header="{{ \'lifecyclemodal.step2.numbersiaerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="higherNumberErrorNoncurrent.Glacier" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="greaterThanNonCurrentError.GlacierGreaterThanSIA" header="{{ \'lifecyclemodal.step2.glaciergreaterthansiaerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.glaciergreaterthansiaerrormessage\' | translate }} {{ noncurrentGlacierGreaterThanSIAValue }}</awsui-alert>\n                    <awsui-alert type="error" visible="hasPrevError" header="{{ \'lifecyclemodal.step2.noruleactionerrorheader\' | translate }}"> {{ \'lifecyclemodal.step2.selectruleactionerror\'| translate }}</awsui-alert>\n                    <div ng-if="selectedRule.noncurrentRuleActions.length === 0" class="modal-section"></div>\n                </div>\n            </div>\n            <div class="body-content" ng-if="state === STEP.EXPIRATION">\n                <p class="configure-expiration-label" translate="lifecyclemodal.step3.configureexpiration"></p>\n                <table class="upload-modal-radio-button-properties">\n                    <tr>\n                        <td>\n                            <awsui-checkbox id="current-version-transition" class="step2-radio-label" ng-model="selectedRule.showStep3CurrentVersion" change="showStep3CurrentVersionChange()">\n                                <span class="show-version" translate="lifecyclemodal.step2.current"></span>\n                            </awsui-checkbox>\n                        </td>\n                        <td class="show-previous">\n                            <awsui-checkbox id="previous-version-transition" class="step2-radio-label" ng-model="selectedRule.showStep3PreviousVersion" change="showStep3PreviousVersionChange()">\n                                <span class="show-version" translate="lifecyclemodal.step2.noncurrent"></span>\n                            </awsui-checkbox>\n                        </td>\n                    </tr>\n                </table>\n                <div ng-show="selectedRule.showStep3CurrentVersion">\n                    <awsui-checkbox change="selectCurrentExpiration()" class="step2-radio-label" ng-model="selectedRule.expiration.enabled">\n                        <span class="expiration-label" translate="lifecyclemodal.expirecurrentversion"></span>\n                        <span class="tool-tip-cursor">\n                        <awsui-tooltip text="{{ \'lifecyclemodal.expirecurrobjs.tooltip\' | translate }}" position="bottom" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </span>\n                    </awsui-checkbox>\n                    <div ng-show="selectedRule.expiration.enabled">\n                        <span class="expiration-after" translate="lifecyclemodal.step3.after"></span>\n                        <span>\n                        <awsui-textfield id="expiration-days" class="expiration-days lifecycle-modal-input" ng-class="{ \'highlight-error\' : highlightTextBoxErrorCurrent[2] }" ng-keyup="validateCurrentExpiration()" ng-model="selectedRule.expiration.days">\n                        </awsui-textfield>\n                    </span>\n                        <span class="from-object-creation" translate="lifecyclemodal.fromobjectcreation"></span>\n                    </div>\n                    <awsui-alert type="error" visible="notANumberErrorCurrent.Expire" header="{{ \'lifecyclemodal.step2.numberexpireerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="minimumDaysCurrent.Expire" header="{{ \'lifecyclemodal.step2.minimumdaysexpireerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.minimumdaysexpireerrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="higherNumberErrorCurrent.Expire" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="greaterThanCurrentError.DeleteGreaterThanGlacier">\n                        {{ \'lifecyclemodal.step2.expiregreaterthanglaciererrormessage\' | translate }} {{ expireGreaterThanGlacierValue }} </awsui-alert>\n                    <awsui-alert type="error" visible="greaterThanCurrentError.DeleteGreaterThanSIA">\n                        {{ \'lifecyclemodal.step2.expiregreaterthansiaerrormessage\' | translate }} {{ expireGreaterThanSIAValue }} </awsui-alert>\n                </div>\n                <div ng-show="selectedRule.showStep3PreviousVersion">\n                    <awsui-checkbox class="step2-radio-label" change="selectNoncurrentExpiration()" class="step2-radio-label" ng-model="selectedRule.permanentlyDelete.enabled">\n                        <span class="expiration-label"> {{ \'lifecyclemodal.step3.permanentlydelete\' | translate }} </span>\n                        <span class="tool-tip-cursor">\n                        <awsui-tooltip text="{{ \'lifecyclemodal.delprevversions.tooltip\' | translate }}" position="bottom" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </span>\n                    </awsui-checkbox>\n                    <div ng-show="selectedRule.permanentlyDelete.enabled">\n                        <span class="expiration-after" translate="lifecyclemodal.step3.after"></span>\n                        <span>\n                        <awsui-textfield id="permanently-delete-days" class="expiration-days lifecycle-modal-input" ng-class="{ \'highlight-error\' : highlightTextBoxErrorNonCurrent[2] }" ng-keyup="validateNoncurrentExpiration()" ng-model="selectedRule.permanentlyDelete.days">\n                        </awsui-textfield>\n                    </span>\n                        <span class="from-object-creation" translate="lifecyclemodal.step3.afterbecomingpreviousversion"></span>\n                    </div>\n                    <awsui-alert type="error" visible="minimumDaysNoncurrent.PermanentlyDelete" header="{{ \'lifecyclemodal.step2.minimumdayspermanentlydeleteerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.minimumdayspermanentlydeleteerrormessage\' | translate }}</awsui-alert>\n                    <awsui-alert type="error" visible="notANumberErrorNoncurrent.PermanentlyDelete" header="{{ \'lifecyclemodal.step2.numberpermanentlydeleteerrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="higherNumberErrorNoncurrent.PermanentlyDelete" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                        {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                    <awsui-alert type="error" visible="greaterThanNonCurrentError.DeleteGreaterThanSIA">\n                        {{ \'lifecyclemodal.step2.permanentlydeletegreaterthansiaerrormessage\' | translate }} {{ permanentlyDeleteGreaterThanSIAValue }} </awsui-alert>\n                    <awsui-alert type="error" visible="greaterThanNonCurrentError.DeleteGreaterThanGlacier">\n                        {{ \'lifecyclemodal.step2.permanentlydeletegreaterthanglaciererrormessage\' | translate }} {{ permanentlyDeleteGreaterThanGlacierValue }} </awsui-alert>\n                </div>\n                <p class="for-amu" translate="lifecyclemodal.step3.ldmamucleanup"></p>\n\n                <awsui-checkbox id="cleanup-expired" data-disabled="(!selectedRule.showRldm || (selectedRule.filters.tagFilters.length > 0))" class="expiration-after-section" change="updateNextButtonDisabled()" ng-model="selectedRule.removeExpire">\n                    <span ng-class="{ \'disable-text\' : (!selectedRule.showRldm || (selectedRule.filters.tagFilters.length > 0)) }" class="expiration-label" translate="lifecyclemodal.step3.ldmcleanup"></span>\n                    <span class="tool-tip-cursor">\n                        <awsui-tooltip text="{{ \'lifecyclemodal.cleanupldm.tooltip\' | translate }}" position="bottom" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </span>\n                </awsui-checkbox>\n                <awsui-alert class="modal-warning" visible="(!selectedRule.showRldm && !(selectedRule.filters.tagFilters.length > 0))" type="warning">\n                    {{ \'lifecyclemodal.warning.disableldmexpire\' | translate }}\n                </awsui-alert>\n                <awsui-checkbox id="cleanup-multipart" data-disabled="(selectedRule.filters.tagFilters.length > 0)" class="expiration-after-section" change="selectAmuAction()" ng-model="selectedRule.amu.enabled">\n                    <span ng-class="{ \'disable-text\' : (selectedRule.filters.tagFilters.length > 0) }" class="expiration-label" translate="lifecyclemodal.step3.imucleanup"></span>\n                    <span class="tool-tip-cursor">\n                        <awsui-tooltip text="{{ \'lifecyclemodal.cleanupuploads.tooltip\' | translate }}" position="bottom" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </span>\n                </awsui-checkbox>\n                <div id="cleanup-multipart-days" ng-if="selectedRule.amu.enabled">\n                    <span class="expiration-after" translate="lifecyclemodal.step3.after"></span>\n                    <span>\n                        <awsui-textfield ng-keyup="validateAmuDays()" id="incomplete-multipart-days" class="expiration-days date-styling-override lifecycle-modal-input" ng-model="selectedRule.amu.days">\n                        </awsui-textfield>\n                    </span>\n                    <span class="from-object-creation" translate="lifecyclemodal.step3.fromstartofupload"></span>\n                </div>\n                <awsui-alert type="error" visible="notANumberAmuError" header="{{ \'lifecyclemodal.step2.numberamuerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="minimumDaysAmuError" header="{{ \'lifecyclemodal.step2.minimumdaysamuerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.minimumdaysamuerrormessage\' | translate }} </awsui-alert>\n                <awsui-alert class="modal-warning" visible="(selectedRule.filters.tagFilters.length > 0)" type="warning">\n                    {{ \'lifecyclemodal.warning.disableldmandamu\' | translate }}\n                </awsui-alert>\n                <awsui-alert type="error" visible="higherNumberErrorAmu" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n            </div>\n            <div class="body-content" ng-if="state === STEP.REVIEW">\n                <table id="review-table" class="review-table">\n                    <tr>\n                        <td class="review-subheader" translate="lifecyclemodal.label.nameandscope"></td>\n                        <td class="edit-button">\n                            <awsui-button class="button-in-darkbg" text="{{ \'lifecyclemodal.button.edit\' | translate }}" variant="link" ng-click="setState(STEP.NAME_AND_SCOPE)">\n                            </awsui-button>\n                        </td>\n                    </tr>\n                </table>\n                <table class="details-table">\n                    <tr>\n                        <td><span class="detail-name" translate="lifecyclemodal.step3.label.name"></span><span class="details"> {{ selectedRule.summary.ruleName }} </span></td>\n                    </tr>\n                    <tr>\n                        <td class="scope-name"><span class="detail-name" translate="lifecyclemodal.step3.label.scope"></span><span class="details"> {{ selectedRule.summary.prefix }} </span></td>\n                    </tr>\n                </table>\n                <table class="review-table">\n                    <tr>\n                        <td class="review-rule" translate="lifecyclemodal.label.rule"></td>\n                        <td class="edit-button">\n                            <awsui-button class="button-in-darkbg" text="{{ \'lifecyclemodal.button.edit\' | translate }}" variant="link" click="setState(STEP.TRANSITION)">\n                            </awsui-button>\n                        </td>\n                    </tr>\n                </table>\n                <div class="review-content"></div>\n                <p ng-if="selectedRule.summary.currentVersionHeader" class="review-subheader version-header" translate="lifecyclemodal.currentversion"></p>\n                <div class="review-content" ng-if="selectedRule.summary.currentTransitionsList[0] !== \'\'">\n                    <div class="review-subheader review-content-description">\n                        <span class="review-content-header" translate="lifecyclemodal.review.transition"></span>\n                        <span class="transition-details">{{ selectedRule.summary.currentTransitionsList[0] }} </span>\n                    </div>\n                </div>\n                <div class="review-content" ng-if="selectedRule.summary.currentTransitionsList[1] !== \'\'">\n                    <div class="review-subheader review-content-description">\n                        <span class="review-content-header" translate="lifecyclemodal.review.transition"></span>\n                        <span class="transition-details">{{ selectedRule.summary.currentTransitionsList[1] }} </span>\n                    </div>\n                </div>\n                <p ng-if="selectedRule.summary.noncurrentVersionHeader" class="review-subheader version-header review-section-header" translate="lifecyclemodal.noncurrentversion"></p>\n                <div class="review-content" ng-if="selectedRule.summary.noncurrentTransitionsList[0] !== \'\'">\n                    <div class="review-subheader review-content-description">\n                        <span class="review-content-header" translate="lifecyclemodal.review.transition"></span>\n                        <span class="transition-details">{{ selectedRule.summary.noncurrentTransitionsList[0] }} </span>\n                    </div>\n                </div>\n                <div class="review-content" ng-if="selectedRule.summary.noncurrentTransitionsList[1] !== \'\'">\n                    <div class="review-subheader review-content-description">\n                        <span class="review-content-header" translate="lifecyclemodal.review.transition"></span>\n                        <span class="transition-details">{{ selectedRule.summary.noncurrentTransitionsList[1] }} </span>\n                    </div>\n                </div>\n                <table class="review-table">\n                    <tr>\n                        <td class="review-rule" translate="lifecyclemodal.expiration"></td>\n                        <td class="edit-button">\n                            <awsui-button class="button-in-darkbg" text="{{ \'lifecyclemodal.button.edit\' | translate }}" variant="link" click="setState(STEP.EXPIRATION)">\n                            </awsui-button>\n                        </td>\n                    </tr>\n                </table>\n                <div class="review-content"></div>\n                <div class="review-content" ng-if="(selectedRule.expiration.enabled && selectedRule.expiration.days !==\'\')">\n                    <div class="review-subheader review-content-description">\n                        <span class="review-content-header" translate="lifecyclemodal.expire"></span>\n                        <span class="transition-details"> {{ selectedRule.expiration.days }} </span>\n                        <span translate="lifecyclemodal.days"></span>\n                    </div>\n                </div>\n                <div class="review-content" ng-if="(selectedRule.permanentlyDelete.enabled && selectedRule.permanentlyDelete.days !==\'\')">\n                    <div class="review-subheader review-content-description">\n                        <span class="review-content-header" translate="lifecyclemodal.permanentlydelete"></span>\n                        <span class="transition-details"> {{ selectedRule.permanentlyDelete.days }} </span>\n                        <span translate="lifecyclemodal.days"></span>\n                    </div>\n                </div>\n                <p ng-if="selectedRule.summary.rldm" class="review-subheader review-content-header" translate="lifecyclemodal.step3.ldmcleanup"></p>\n                <div ng-if="selectedRule.summary.amu !== \'\'">\n                    <div class="review-subheader review-content-description">\n                        <span class="review-content-header" translate="lifecyclemodal.step3.imucleanup"></span>\n                        <span translate="lifecyclemodal.step3.afterdays"></span>\n                        <span class="transition-details"> {{ selectedRule.summary.amu }} </span>\n                        <span translate="lifecyclemodal.days"></span>\n                    </div>\n                </div>\n                <awsui-alert visible="lifecycleError" class="block small-top-margin" type="error" dismissible="false" header="{{ \'lifecyclemodal.step3.error.header\' | translate }}"> {{ lifecycleError }}\n                </awsui-alert>\n                <awsui-alert visible="stateChangeWarning" type="warning"> {{ stateChangeWarning }}</awsui-alert>\n                <awsui-alert visible="showOverlappingPrefixWarning" type="warning">\n                    <div translate="lifecyclemodal.warning.overlappingprefix" translate-values="{ overlappingRule : overlappingRule }">\n                    </div>\n                    <div ng-if="showOverlappingNewFormatWarning" translate="lifecyclemodal.warning.overlappingprefixnewformatwarning">\n                    </div>\n                </awsui-alert>\n            </div>\n        </div>\n    </modal-content>\n    <modal-footer>\n        <div class="lifecycle-modal-footer" transclude-name="footer">\n            <awsui-button id="next-step" ng-if="state !== STEP.REVIEW" data-disabled="((state === STEP.NAME_AND_SCOPE && (!selectedRule.ID || (selectedRule.applied === \'prefix\' && !selectedRule.Prefix)\n                      || tag.error !== \'\'))\n                      || selectedRule.isNextButtonDisabled)" variant="primary" text="{{ \'lifecyclemodal.footer.next\' | translate }}" class="awsui-util-f-r primary-button" click="generateSummary()">\n            </awsui-button>\n            <awsui-button id="save-rule" ng-if="state === STEP.REVIEW && !showContinue" click="detectStateChange()" variant="primary" text="{{ \'lifecyclemodal.footer.save\' | translate }}" class="awsui-util-f-r primary-button">\n            </awsui-button>\n            <awsui-button id="continue-rule" ng-if="state === STEP.REVIEW && showContinue" click="saveLifecycle()" variant="primary" text="{{ \'lifecyclemodal.footer.continue\' | translate }}" class="awsui-util-f-r primary-button">\n            </awsui-button>\n            <awsui-button id="cancel-rule" text="{{ \'lifecyclemodal.footer.cancel\' | translate }}" variant="normal" ng-if="state === STEP.NAME_AND_SCOPE" class="awsui-util-f-r" click="closeLifecycleModal()">\n            </awsui-button>\n            <awsui-button id="previous-step" text="{{ \'lifecyclemodal.footer.previous\' | translate }}" variant="normal" ng-if="state !== STEP.NAME_AND_SCOPE" class="awsui-util-f-r" click="goToPreviousStep()">\n            </awsui-button>\n        </div>\n    </modal-footer>\n</modal>');a.put("/s3/partials/modal.html",'<div class="aws-modal">\n    <div ng-show="isOpen.flag" class="modal-frame fade in ng-hide">\n        <div class="modal-header modal-header-image">\n            <i class="panel-close-icon modal-close" ng-click="closeModal()"></i>\n            <div class="modal-header-title">{{headerTitle}}</div>\n            \n            <table id="header-steps" class="header-steps" ng-if="steps">\n                <tr>\n                    <td class="attained-step" ng-if="getState(0)">\n\n                        <div class="modal-header-value" ng-class="{ \'selected-step\': state === getState(0) }"><span class="modal-image" ng-class="state === getState(0) ? \'modal-stepone-selected-image\' : \'modal-checked-image\'"></span><span class="modal-stepname">{{getState(0).value}}</span></div>\n                    </td>\n                    <td ng-if="getState(1)" ng-class="state !== getState(0) ? \'attained-step\' : \'step\'">\n\n                        \n                        <div class="modal-header-value" ng-class="{ \'selected-step\': state === getState(1) }"><span class="modal-image" ng-class="{\'modal-steptwo-selected-image\': state==getState(1),\n                            \'modal-steptwo-unselected-image\': state === getState(0),\n                            \'modal-checked-image\': state === getState(2) || state===getState(3)}"></span><span class="modal-stepname">{{getState(1).value}}</span></div>\n                    </td>\n                    <td ng-if="getState(2)" ng-class="state === getState(2) || state===getState(3)? \'attained-step\' : \'step\'">\n                        \n                        <div class="modal-header-value" ng-class="{ \'selected-step\': state === getState(2) }"><span class="modal-image" ng-class="{\'modal-stepthree-selected-image\': state==getState(2),\n                            \'modal-stepthree-unselected-image\': state === getState(0) || state===getState(1),\n                            \'modal-checked-image\': state === getState(3)}"></span><span class="modal-stepname">{{getState(2).value}}</span></div>\n                    </td>\n                    <td ng-if="getState(3)" ng-class="state === getState(3) ? \'attained-step\' : \'step\'">\n                        \n\n                        <div class="modal-header-value" ng-class="{ \'selected-step\': state === getState(3) }"><span class="modal-image" ng-class="state === getState(3) ? \'modal-stepfour-selected-image\' : \'modal-stepfour-unselected-image\'"></span><span class="modal-stepname">{{getState(3).value}}</span></div>\n                    </td>\n                </tr>\n            </table>\n            <div ng-transclude="header"></div>\n        </div>\n        <div class="modal-body" ng-transclude="content"></div>\n        <div class="modal-footer">\n            <div class="footer-divider"></div>\n            <div ng-transclude="footer"></div>\n        </div>\n    </div>\n    <div ng-show="isOpen.flag" class="modal-background ng-hide"></div>\n</div>');a.put("/s3/partials/modalpermissions.html",'<div class="modal-permissions">\n    <div id="user-permissions-section" class="modal-permissions-section">\n        <h3 class="subheader dark" translate="{{\'modal.acl.header.manageusers\'}}"></h3>\n        \n        <permissions-sub-modal is-public="false" acl-modal-titles="manageUserTitles" permissions="userPermissions">\n        </permissions-sub-modal>\n    </div>\n    <div id="awsaccount-permissions-section" class="modal-permissions-section">\n        <h3 class="subheader manageawsaccounts-title dark" translate="{{\'modal.acl.header.manageawsaccount\'}}"></h3>\n        <permissions-sub-modal is-public="false" is-aws-account="true" is-adding-account="isAddingAccount" acl-modal-titles="manageAWSAccountTitles" permissions="awsAccountPermissions">\n        </permissions-sub-modal>\n    </div>\n    <div id="public-permissions-section" class="modal-permissions-section">\n        <h3 class="subheader dark" translate="{{\'modal.acl.header.managepublicpermissions\'}}"></h3>\n        \n        <dropdown id="make-public-dropdown" items="makePublicOptions" selected-item="selectedItems.makePublic"></dropdown>\n        <awsui-alert class="padding-top-20" ng-class="{\'padding-bottom-20\': modalType === MODAL_TYPES.UPLOAD}" ng-if="publicPermissions[1].permissions.READ" type="warning" header="{{makePublicWarningHeader}}">\n                {{makePublicWarningBody}}\n        </awsui-alert>\n    </div>\n    <div id="system-permissions-section" ng-if="showSystemPermissions" class="modal-permissions-section" style="height: 193px">\n        <h3 class="subheader dark" translate="{{\'modal.acl.header.managesystempermissions\' | translate}}"></h3>\n        <dropdown id="log-delivery-dropdown" items="logDeliveryOptions" selected-item="selectedItems.logDelivery"></dropdown>\n    </div>\n</div>');a.put("/s3/partials/multiselector.html",'<div id="multi-selector" class="multi-selector" clickoutside="" on-click-outside="closeDropDown">\n    <div class="awsui-select-target" ng-click="toggleDropDown()">\n        <div class="current-displayed-item"><span>{{ multiSelectorObj.totalSelectedCount > 0 ? multiSelectorObj.totalSelectedCount + multiSelectorObj.nonEmptyDisplayPlaceholder : multiSelectorObj.emptyDisplayPlaceholder }}</span></div>\n    </div>\n    <div ng-if="multiSelectorObj.isDropDownOpen" class="multiselector-dropdown">\n        <div class="search-box">\n            <input type="text" class="input-field" ng-model="tableFilter.filter" ng-keydown="filterKeyDown($event, tableFilter.filter, filteredItems)" placeholder="{{ multiSelectorObj.searchPlaceholder }}"><i class="awsui-icon search"></i>\n        </div>\n        <div class="multiselector-divider"></div>\n        <div class="select-option-button" ng-if="filteredItems.length > 0 && !multiSelectorObj.isLoadingData">\n            <div class="select-all-button" translate="multiselector.selectall" ng-click="selectAll()"></div>\n            <div class="unselect-all-button" translate="multiselector.unselectall" ng-click="unSelectAll()"></div>\n        </div>\n        <div ng-if="multiSelectorObj.isLoadingData" class="awsui-spinner awsui-spinner-bigger awsui-spinner-light multiselector-spinner"></div>\n        <span ng-if="multiSelectorObj.isLoadingData" class="loading-data-text" translate="loading"></span>\n        <table class="list-items-table">\n            <tr class="list-item" ng-repeat="option in (filteredItems = (multiSelectorObj.optionList | filter: {text: tableFilter.filter} | orderBy: text))" ng-click="selectRow($event, option)">\n                <td class="checkbox">\n                    <awsui-checkbox ng-click="$event.stopPropagation(); $event.preventDefault(); selectCheckBox($event, option)" checked="option.selected"></awsui-checkbox>\n                </td>\n                <td class="item-text">{{option.text}}</td>\n            </tr>\n            <tr class="noresult-text" ng-if="filteredItems.length === 0 && !multiSelectorObj.isLoadingData">\n                <td colspan="2">{{multiSelectorObj.noSearchResult.text}}</td>\n            </tr>\n            <tr class="noresult-addinput" ng-if="filteredItems.length === 0 && !multiSelectorObj.isLoadingData" ng-click="$event.stopPropagation();addCustomerInput(tableFilter.filter)">\n                <td colspan="2">{{multiSelectorObj.noSearchResult.addInputText}}</td>\n            </tr>\n        </table>\n    </div>\n    <awsui-alert type="error" ng-if="multiSelectorObj && multiSelectorObj.errorMsg">{{ multiSelectorObj.errorMsg }}</awsui-alert>\n</div>');a.put("/s3/partials/object-details/objectdetails.html",'<div class="object-details">\n    <div class="watermark-wrapper header-section">\n        <div class="watermark watermark-file"></div>\n        <breadcrumbs></breadcrumbs>\n        <div class="file-name-container">\n            <span class="file-name">{{obj.Key}}</span>\n            <div class="version-label-container" ng-click="listVersions($event)">\n                <span ng-if="obj.versionLabel" class="version-label">{{obj.versionLabel}}</span>\n                <span ng-if="!obj.versionLabel" class="version-label">{{obj.LastModified | date: dateFormat}}</span>\n                <div class="versions-dropdown-caret"></div>\n            </div>\n\n            <versions-dropdown ng-if="obj" bucket="bucket" error="error" get-metadata="getMetadata(operation, versionId)" key="key" obj="obj" selected-tab="selectedTab" show-versions-dropdown="showVersionsDropdown" tabs="tabs" versions-dropdown-selected-object="versionsDropdownSelectedObject.obj">\n            </versions-dropdown>\n        </div>\n    </div>\n    <awsui-tabs class="object-tabs" tabs="tabs" ng-model="selectedTab" ng-switch="selectedTab" ng-click="setTabParam(selectedTab)">\n        <div ng-switch-default="" class="overview">\n            <awsui-alert type="success" visible="showSuccessMessage">{{ successMessageString }}</awsui-alert>\n            <awsui-button class="action-button-spacing" id="open" variant="normal" text="{{ \'objectdetails.button.open\' | translate }}" click="openSelectedObject()" data-disabled="actionButtonsDisabled()">\n            </awsui-button>\n            <awsui-button class="action-button-spacing" id="download" variant="normal" text="{{ \'objectdetails.button.download\' | translate }}" click="downloadSelectedObject()" data-disabled="actionButtonsDisabled()">\n            </awsui-button>\n            <awsui-button class="action-button-spacing" id="downloadAs" variant="normal" text="{{ \'objectdetails.button.downloadAs\' | translate }}" click="openDownloadAsPanel()" data-disabled="actionButtonsDisabled()">\n            </awsui-button>\n            <awsui-button class="action-button-spacing" id="makepublic" variant="normal" text="{{ \'objectdetails.button.makepublic\' | translate }}" click="makePublic()" loading="isMakingPublic" data-disabled="actionButtonsDisabled() || makePublicButtonsDisabled()">\n            </awsui-button>\n            <awsui-button class="action-button-spacing" id="copypath" variant="normal" text="{{ \'objects.button.copypath\' | translate }}" click="copyPathToClipboard()">\n            </awsui-button>\n            <span class="copy-message" ng-class="{ \'fade-in\' : copyFinished.flag, \'fade-out\' : !copyFinished.flag}" translate="copytoclipboard.path"></span>\n            <div class="awsui-util-p-l"></div>\n            <div class="header" translate="objectdetails.overview.owner"></div>\n            <div class="awsui-util-pb-m" id="objectOwner">{{obj.Owner.DisplayName || obj.Owner.ID}}</div>\n            <div class="header" translate="last.modified"></div>\n            <div class="awsui-util-pb-m" id="objectLastActivity">{{obj.LastModified | date: dateFormat}}</div>\n            <div class="header" translate="objectdetails.overview.etag"></div>\n            <div class="awsui-util-pb-m" id="objectEtag">{{obj.ETag}}</div>\n            <div class="header" translate="objectdetails.overview.storageclass"></div>\n            <div class="awsui-util-pb-m" id="objectStorageClass">{{ getStorageClassTranslation() }}</div>\n            <div class="header" translate="objectdetails.overview.sse"></div>\n            <div class="awsui-util-pb-m" id="objectServerSideEncryption">{{ getEncryptionTranslation() }}</div>\n            <div ng-if="obj.KmsID !== undefined" class="header" translate="objectdetails.overview.kmsid"></div>\n            <div ng-if="obj.KmsID !== undefined" class="awsui-util-pb-m">{{obj.KmsID}}</div>\n            <div ng-if="showReplication" class="header" translate="objectdetails.overview.replicationstatus"></div>\n            <div id="crr-objectdetail-status" ng-if="showReplication" class="awsui-util-pb-m">{{obj.ReplicationStatus}}</div>\n            <div ng-if="showExpiry" class="header" translate="objectdetails.overview.expirydate"></div>\n            <div ng-if="showExpiry" class="awsui-util-pb-m">{{obj.ExpirationDate}}</div>\n            <div ng-if="showExpiry" class="header" translate="objectdetails.overview.expiryrule"></div>\n            <div ng-if="showExpiry" class="awsui-util-pb-m">{{obj.ExpirationRule}}</div>\n            <div ng-if="showRestoration" class="header" translate="objects.details.Restoration"></div>\n            <div ng-if="showRestoration" class="awsui-util-pb-m" translate="objectdetails.value.restoration"></div>\n            <div ng-if="restorationExpiry" class="header" translate="objects.details.RestorationExpiry"></div>\n            <div ng-if="restorationExpiry" class="awsui-util-pb-m">{{restorationExpiry}}</div>\n            <div class="header" translate="objectdetails.overview.size"></div>\n            <div class="awsui-util-pb-m" id="objectSize">{{obj.Size}}</div>\n            <div ng-if="showVersionId" class="header" translate="objectdetails.overview.versionid"></div>\n            <div ng-if="showVersionId" class="awsui-util-pb-m">{{obj.VersionId}}</div>\n            <div class="header" translate="objectdetails.overview.link"></div>\n            <a class="link awsui-util-pb-m" id="object-link" href="{{obj.Link}}">{{obj.Link}}</a>\n            <storage-console-config-panel class="download-side-panel" ng-class="{\'side-config-panel objects-side-panel\': downloadAsPanel, \'hide-config-panel objects-side-panel\': !downloadAsPanel}" panel-open="downloadAsPanel">\n                <header>\n                    <span class="side-panel-header download-as-panel-header" translate="object.download.destination"></span>\n                    <span class="panel-close-icon" ng-click="closeDownloadAsPanel()"></span>\n                </header>\n                <content>\n                    <div class="download-as-directions">\n                        <div class="download-as-directions-text" translate="object.download.directions"></div>\n                        <a ng-show="!downloadAsPanelGenerating && !downloadPanelError" ng-href="{{downloadPanel.url}}" id="downloadAsLink">{{ obj.Key }}</a>\n                        <div class="download-as-directions-text" ng-show="!downloadAsPanelGenerating && downloadPanelError" translate="object.download.error"></div>\n                        <span ng-show="downloadAsPanelGenerating" class="awsui-spinner awsui-spinner-light"></span>\n                    </div>\n                </content>\n            </storage-console-config-panel>\n        </div>\n        <div ng-switch-when="properties">\n            <object-properties obj="obj" options="options" bucket="bucket"></object-properties>\n        </div>\n        <div ng-switch-when="permissions" class="permissions-container">\n            <acl ng-if="obj" permission-obj="permissionObj" put-acl="putAcl" error="aclError" is-bucket-permission="false" bucket="bucket" should-disable="obj && (obj.StorageClass === \'GLACIER\' && !restorationExpiry || obj.IsLatest && obj.IsLatest !== \'true\')">\n            </acl>\n        </div>\n        <awsui-alert visible="objectDetailError" class="block small-top-margin permissions-error" type="error" dismissible="false" header="{{ \'error.header\' | translate }}"> {{ objectDetailError }}\n        </awsui-alert>\n        <awsui-alert visible="warning" class="block small-top-margin permissions-error" type="warning" dismissible="false" header="{{ \'warning.header\' | translate }}"> {{ warning }}\n        </awsui-alert>\n        <awsui-alert visible="restoreWarning && selectedTab === \'properties\'" class="block small-top-margin permissions-error" type="warning" dismissible="false" header="{{ \'warning.header\' | translate }}"> {{ restoreWarning }}\n        </awsui-alert>\n    </awsui-tabs>\n</div>');a.put("/s3/partials/object-details/objectmetadata.html",'<card card-id="scrollCardId" card-summary-obj="cardSummaryObj" is-open="cardOpen" ng-class="{ \'card-disable-metadata-water-mark\': !cardOpen, \'card-enable-metadata-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="objectproperties.label.metadata"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancel($event)"></div>\n    </card-header>\n    <card-content>\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="objectdetail.metadata.blurb"></p>\n        <div ng-if="cardOpen">\n            <awsui-button id="objectmetadata-addnew" data-disabled="obj && (obj.StorageClass === \'GLACIER\' || obj.IsLatest && obj.IsLatest !== \'true\')" text="{{\'objectdetail.metadata.addnew\' | translate}}" icon="plus" variant="link" click="addMetadata(selectedRow)"></awsui-button>\n            <awsui-button id="objectmetadata-delete" data-disabled="isDeleteAndEditDisabled(selectedRow)" text="{{\'events.button.delete\' | translate}}" variant="link" click="deleteMetadata(selectedRow)" loading="isDeleting">\n            </awsui-button>\n            <awsui-button id="objectmetadata-edit" data-disabled="isDeleteAndEditDisabled(selectedRow)" text="{{ \'events.button.edit\' | translate }}" variant="link" click="editMetadata(selectedRow)">\n            </awsui-button>\n            <awsui-tooltip text="{{\'objectproperties.metadata.tooltip\' | translate}}" position="right" size="small">\n                <i class="awsui-icon alert-info-circle"></i>\n            </awsui-tooltip>\n            <awsui-radio-group ng-model="selectedRow.scopeIndex" ng-change="switchSelectedRow(selectedRow)">\n                <table class="table-condense metadata-table">\n                    <thead>\n                    <tr>\n                        <td class="metadata-table-tds"></td>\n                        <td class="metadata-table-tds" translate="">objectdetail.metadata.key</td>\n                        <td class="metadata-table-tds" translate="">objectdetail.metadata.value</td>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    <tr class="newmetadatarow" ng-repeat-start="newMetadata in newMetadataList">\n                        <td class="metadata-table-tds">\n                            <awsui-radio-button value="newMetadataList:{{$index}}">\n                        <td class="metadata-table-tds" translate="">objectdetail.metadata.newmetadata</td>\n                        <td class="metadata-table-tds">\n                            <span class="newmetadata-delete close-icon" ng-click="removeNewMetadata($index, $event, selectedRow)"></span>\n                        </td>\n                        </awsui-radio-button>\n                        </td>\n                    </tr>\n                    <tr ng-repeat-end="">\n                        <td class="metadata-table-tds"></td>\n                        <td class="newMetadata-dropdown metadata-table-tds">\n                            <awsui-control-group validation-message="{{ newMetadata.metadataKey.error }}">\n                                <dropdown disabled="!newMetadata.isEditing" items="predefinedMetadata" selected-item="newMetadata.metadataKey" filter="true" placeholder="{{ \'objectdetail.metadata.key-placeholder\' | translate }}"></dropdown>\n                            </awsui-control-group>\n                        </td>\n                        <td class="metadata-value-input">\n                            <dropdown disabled="!newMetadata.isEditing" ng-if="newMetadata.metadataKey.dropDownValue && newMetadata.metadataKey.dropDownValue.length > 2" items="newMetadata.metadataKey.dropDownValue" enable-input="true" selected-item="newMetadata.metadataValue" filter="true" input-field="newMetadata.metadataValue" placeholder="{{\'objectdetail.metadata.value-placeholder\' | translate}}">\n                            </dropdown>\n                            <dropdown disabled="!newMetadata.isEditing" ng-if="newMetadata.metadataKey.dropDownValue && newMetadata.metadataKey.dropDownValue.length <= 2" items="newMetadata.metadataKey.dropDownValue" enable-input="true" selected-item="newMetadata.metadataValue" input-field="newMetadata.metadataValue" placeholder="{{\'objectdetail.metadata.value-placeholder\' | translate}}">\n                            </dropdown>\n                            <awsui-control-group id="metadata-input-error" validation-message="{{  newMetadata.metadataValue.inputError }}">\n                                <awsui-textfield data-disabled="!newMetadata.isEditing" ng-model="newMetadata.metadataValue.text" ng-if="newMetadata.metadataKey && !newMetadata.metadataKey.dropDownValue"></awsui-textfield>\n                            </awsui-control-group>\n                        </td>\n                    </tr>\n                    <tr class="metadatarow" ng-repeat="metadata in userDefinedMetadata | orderBy: \'metadataKey.text\' ">\n                        <td class="metadata-table-tds">\n                            <awsui-radio-button value="userDefinedMetadata:{{getIndex(metadata)}}">\n                        <td class="metadata-table-tds">\n                            <div class="metatext" ng-if="!metadata.isEditing">{{ metadata.metadataKey.inputValue || metadata.metadataKey.text }}</div>\n                            <awsui-control-group validation-message="{{ metadata.metadataKey.error }}">\n                                <dropdown ng-if="metadata.isEditing" items="predefinedMetadata" selected-item="metadata.metadataKey" filter="true" placeholder="{{ \'objectdetail.metadata.key-placeholder\' | translate }}"></dropdown>\n                            </awsui-control-group>\n                        </td>\n                        <td class="metadata-value-input">\n                            <div class="metatext" ng-if="!metadata.isEditing">{{ metadata.metadataValue.text }}</div>\n                            <dropdown ng-if="metadata.isEditing && metadata.metadataKey.dropDownValue && metadata.metadataKey.dropDownValue.length > 2" items="metadata.metadataKey.dropDownValue" selected-item="metadata.metadataValue" enable-input="true" filter="true" input-field="metadata.metadataValue" placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}"></dropdown>\n                            <dropdown ng-if="metadata.isEditing && metadata.metadataKey.dropDownValue && metadata.metadataKey.dropDownValue.length <= 2" items="metadata.metadataKey.dropDownValue" selected-item="metadata.metadataValue" enable-input="true" input-field="metadata.metadataValue" placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}"></dropdown>\n                            <awsui-control-group validation-message="{{ metadata.metadataValue.inputError }}">\n                                <awsui-textfield ng-model="metadata.metadataValue.text" ng-if="metadata.isEditing && metadata.metadataKey && !metadata.metadataKey.dropDownValue"></awsui-textfield>\n                            </awsui-control-group>\n                        </td>\n                    </awsui-radio-button></td></tr>\n                    </tbody>\n                </table>\n            </awsui-radio-group>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert class="input-error" type="error" header="{{ \'error.header\' | translate }}" ng-if="validationError && validationError.text && cardOpen">\n            <p translate="objectdetail.metadata.multisamekeywarning" translate-values="{ errorMsg : \'{{validationError.text}}\' }"></p>\n        </awsui-alert>\n        <awsui-alert class="input-error" type="error" header="{{ \'error.header\' | translate }}" ng-if="metadataError && cardOpen">{{ metadataError }}</awsui-alert>\n    </card-content>\n    <card-footer>\n        <div ng-if="cardOpen">\n            <awsui-button id="objectmetadata-save" ng-click="save($event)" data-disabled="obj && (obj.StorageClass === \'GLACIER\' || obj.IsLatest && obj.IsLatest !== \'true\') || validationError.text" text="{{ \'button.save\' | translate }}" class="awsui-util-f-r object-property-button" loading="isSaving" variant="primary"></awsui-button>\n            <awsui-button id="objectmetadata-cancel" ng-click="cancel($event)" text="{{ \'button.cancel\' | translate }}" class="awsui-util-f-r object-property-button"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/object-details/objectproperties.html",'<div class="awsui-grid">\n    <div class="awsui-container properties-cards">\n        <div class="wrapper awsui-row object-properties">\n            <object-storage-class ng-if="obj" id="object-storage-card" obj="obj"></object-storage-class>\n            <object-encryption ng-if="obj && obj.Encryption" id="object-sse-card" obj="obj" options="options"></object-encryption>\n            <object-metadata ng-if="obj" id="object-metadata-card" obj="obj"></object-metadata>\n            <object-tag ng-if="obj" id="object-tags-card" obj="obj" fac-id="s3-ot"></object-tag>\n        </div>\n    </div>\n</div>');a.put("/s3/partials/object-details/objectsse.html",'<card card-id="scrollCardId" card-summary-obj="cardSummaryObj" is-open="cardOpen" disable-expand="obj && (obj.StorageClass === \'GLACIER\' || obj.IsLatest && obj.IsLatest !== \'true\')" ng-class="{ \'card-disable-sse-water-mark\': !cardOpen, \'card-enable-sse-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="objectproperties.label.sse"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancel($event)"></div>\n    </card-header>\n    <card-content>\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="objectproperties.sse.blurb"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <div class="awsui-row card-content-row" fac-id="s3-no-enc">\n                <awsui-radio-group ng-model="model.selectedOption" ng-change="updateKMSKey(model.selectedOption)">\n                    <awsui-radio-button id="objectsse-none" value="NONE" ng-model="model.selectedOption" label="{{ \'sse.none\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n            </div>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="model.selectedOption" ng-change="updateKMSKey(model.selectedOption)">\n                    <awsui-radio-button id="objectsse-aes256" value="AES256" ng-model="model.selectedOption" label="{{ \'sse.aes256\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <p class="object-radio-description" translate="objectproperties.sse.aes256description"></p>\n            </div>\n            <div class="awsui-row card-content-row" fac-id="s3-kms">\n                <awsui-radio-group ng-model="model.selectedOption" ng-change="updateKMSKey(model.selectedOption)">\n                    <awsui-radio-button id="objectsse-kms" value="aws:kms" ng-model="model.selectedOption" label="{{ \'sse.aws.kms\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n            </div>\n            <awsui-control-group validation-message="{{ KMSServiceError }}">\n                <dropdown ng-if="model.selectedOption===aws_kms" items="kmsKeys" placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled="KMSServiceError" selected-item="options.kmsId" filter="true">\n                </dropdown>\n            </awsui-control-group>\n            <awsui-textfield class="custom-kms-arn" ng-if="model.selectedOption===aws_kms && options.kmsId.value===custom_arn" ng-model="options.kmsARN"></awsui-textfield>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert class="custom-kms-arn-error" type="error" ng-if="sseError && cardOpen"> {{ sseError }} </awsui-alert>\n    </card-content>\n    <card-footer>\n        <div ng-if="cardOpen">\n            <awsui-button id="objectsse-save" ng-click="save($event)" data-disabled="disableSave()" text="{{ \'button.save\' | translate }}" class="awsui-util-f-r object-property-button" loading="isSaving" variant="primary"></awsui-button>\n            <awsui-button id="objectsse-cancel" ng-click="cancel($event)" text="{{ \'button.cancel\' | translate }}" class="awsui-util-f-r object-property-button"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/object-details/objectstorageclass.html",'<card card-id="scrollCardId" card-summary-obj="cardSummaryObj" is-open="cardOpen" disable-expand="obj && (obj.StorageClass === \'GLACIER\' || obj.IsLatest && obj.IsLatest !== \'true\')" ng-class="{ \'card-disable-storage-class-water-mark\': !cardOpen, \'card-enable-storage-class-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="objectproperties.label.storageclass"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancel($event)"></div>\n    </card-header>\n    <card-content>\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="objectproperties.storageclass.blurb"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="obj.StorageClass">\n                    <awsui-radio-button id="objectstorage-standard" value="STANDARD" ng-model="obj.StorageClass" label="{{ \'storageclasses.standard\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <p class="object-radio-description" translate="objectproperties.storageclass.standarddescription"></p>\n            </div>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="obj.StorageClass">\n                    <awsui-radio-button id="objectstorage-standardia" value="STANDARD_IA" ng-model="obj.StorageClass" label="{{ \'storageclasses.standardia\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <p class="object-radio-description" translate="objectproperties.storageclass.siadescription"></p>\n            </div>\n            <div class="awsui-row card-content-row" fac-id="s3-rrs">\n                <awsui-radio-group ng-model="obj.StorageClass">\n                    <awsui-radio-button id="objectstorage-reduced" value="REDUCED_REDUNDANCY" ng-model="obj.StorageClass" label="{{ \'storageclasses.rrs\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <p class="object-radio-description" translate="objectproperties.storageclass.rrsdescription"></p>\n            </div>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <div class="error-alert" ng-if="storageClassError && cardOpen">{{ storageClassError }}</div>\n    </card-content>\n    <card-footer>\n        <div class="object-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="objectstorage-save" ng-click="save($event)" data-disabled="obj.StorageClass == cachedValue.StorageClass" text="{{ \'button.save\' | translate }}" class="awsui-util-f-r object-property-button" loading="isSaving" variant="primary"></awsui-button>\n            <awsui-button id="objectstorage-cancel" ng-click="cancel($event)" text="{{ \'button.cancel\' | translate }}" class="awsui-util-f-r object-property-button"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/object-details/objecttag.html",'<card card-id="scrollCardId" card-summary-obj="cardSummaryObj" is-open="cardOpen" ng-class="{ \'card-disable-tags-water-mark\': !cardOpen, \'card-enable-tags-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="objectproperties.tags.label"></span>\n        <div class="card-close-icon" ng-show="cardOpen" ng-click="cancelObjectTagging($event)"></div>\n    </card-header>\n    <card-content>\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="objectproperties.tags.summary"></p>\n        <table class="tagging-table" ng-if="cardOpen">\n            <thead>\n            <tr>\n                <td class="tagging-table-tds"></td>\n                <td class="tagging-table-tds" translate="objectproperties.tags.key"></td>\n                <td class="tagging-table-tds" translate="objectproperties.tags.value"></td>\n            </tr>\n            </thead>\n            <tbody>\n            <tr ng-repeat="tag in obj.Tagging">\n                <td class="tagging-table-tds">\n                    <awsui-control-group validation-message="{{tag.errorMessage}}">\n                        <awsui-textfield class="tag-input" ng-model="tag.Key"></awsui-textfield>\n                    </awsui-control-group>\n                </td>\n                <td class="tagging-table-tds">\n                    <awsui-control-group>\n                        <awsui-textfield class="tag-input" ng-model="tag.Value"></awsui-textfield>\n                    </awsui-control-group>\n                </td>\n                <td class="tagging-table-tds"><a href="" class="remove-tag" ng-click="removeTag($index)">X</a></td>\n            </tr>\n            </tbody>\n        </table>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-button id="add-object-tag" ng-click="addTag()" ng-show="cardOpen" data-disabled="obj.Tagging.length >= maxAllowedTags || isAnyKeyEmpty()" icon="plus" class="object-properties-button" text="{{\'objectproperties.tags.addnew\' | translate}}"></awsui-button>\n        <awsui-alert class="tag-error" type="error" ng-show="tagError && tagErrorMessage !== \'\' && cardOpen">{{tagErrorMessage}}</awsui-alert>\n        <awsui-alert class="objecttag-replication-warning" ng-if="cardOpen" dismissible="false" type="warning" fac-id="s3-crr"><p translate="replicationcard.warningmsg"></p></awsui-alert>\n    </card-content>\n    <card-footer>\n        <div class="object-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="objecttag-save" class="object-property-button awsui-util-f-r" ng-click="saveObjectTagging($event)" text="{{ \'button.save\' | translate }}" variant="primary"></awsui-button>\n            <awsui-button id="objecttag-cancel" class="object-property-button awsui-util-f-r" ng-click="cancelObjectTagging($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/objectfrequencyanalytics.html",'<div class="object-freq">\n    <table ng-if="storage && dataRetrieved && frequencyTypes" class="info-table">\n        <tbody>\n            <tr>\n                <td>\n                    <span class="enabled-lightbulb-blue-image lightbulb-icon"></span>\n                </td>\n                <td>\n                    <table>\n                        <tbody>\n                            <tr>\n                                <td>\n                                    <span class="header-text header" translate="storageanalysis.label.accession"></span>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>\n                                    <span class="secondary-text header" translate="storageanalysis.label.analyzed" translate-values="{ days : daysAnalyzed}"></span>\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </td>\n                <td>\n                    <awsui-select items="objectTypes" class="select-object-types" ng-model="storageClass.value" change="processData()" placeholder="{{\'storageanalysis.label.standard\' | translate}}"></awsui-select>\n                </td>\n                <td>\n                    <div class="info-legend-group">\n                        <div class="info-legend">\n                            <div class="info-color-box storage-back"></div>\n                            <span class="storage-color" translate="storageanalysis.label.storage"></span>\n                        </div>\n                        <div class="info-legend">\n                            <div class="info-color-box data-back"></div>\n                            <span class="data-color" translate="storageanalysis.label.dataRetrieved"></span>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    <table ng-if="storage && dataRetrieved && frequencyTypes" class="object-freq-table">\n        <tbody>\n            <tr>\n                <td class="cards" data-ng-repeat="i in [0, 1, 2]">\n                    <bar-chart-card chart-title="titles[i]" data="[storage[i], dataRetrieved[i]]" labels="labels" colors="{row: frequencyTypes[i].color, bars: barColors}" max-value="maxValue" width="width" height="height" footer="frequencyTypes[i]">\n                    </bar-chart-card>\n                </td>\n            </tr>\n            <tr>\n                <td class="cards" data-ng-repeat="i in [3, 4, 5]">\n                    <bar-chart-card chart-title="titles[i]" data="[storage[i], dataRetrieved[i]]" labels="labels" colors="{row: frequencyTypes[i].color, bars: barColors}" max-value="maxValue" width="width" height="height" footer="frequencyTypes[i]">\n                    </bar-chart-card>\n                </td>\n            </tr>\n            <tr>\n                <td class="cards" data-ng-repeat="i in [6, 7, 8]">\n                    <bar-chart-card chart-title="titles[i]" data="[storage[i], dataRetrieved[i]]" labels="labels" colors="{row: frequencyTypes[i].color, bars: barColors}" max-value="maxValue" width="width" height="height" footer="frequencyTypes[i]">\n                    </bar-chart-card>\n                </td>\n            </tr>\n            <tr>\n                <td class="cards" data-ng-repeat="i in [9, 10, 11]">\n                    <bar-chart-card chart-title="titles[i]" data="[storage[i], dataRetrieved[i]]" labels="labels" colors="{row: frequencyTypes[i].color, bars: barColors}" max-value="maxValue" width="width" height="height" footer="frequencyTypes[i]">\n                    </bar-chart-card>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n</div>');a.put("/s3/partials/objects.html",'<awsui-alert type="error" header="{{\'error.header\'|translate}}" visible="currLocation.objects.error">{{currLocation.objects.error}}</awsui-alert>\n<div ng-hide="objectListError" class="object-list" filedrop="">\n    <div ng-class="{ \'object-nav-wrapper\': !showEmptyScreen, \'object-nav-wrapper-empty\': showEmptyScreen }">\n        <div class="action-strip" sticky-nav="fix-to-top" sticky-nav-padding-top="160">\n            <search ng-if="!showEmptyScreen" fetch-one-page-prefix="fetchOnePagePrefix(prefix)" fetch-one-page-tag="fetchOnePageTag()" filters="filters" markers="markers" versionskeymarkers="versionsIdMarkers" versionsidmarkers="versionsIdMarkers" showversions="showVersions" tag-continuation-tokens="tagContinuationTokens">\n            </search>\n            <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'objectactionstrip.upload\' | translate }}" ng-click="openUploadModal()" variant="primary" icon="upload" data-disabled="!isFeatureEnabled(\'s3-up\')"></awsui-button>\n            <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'objectactionstrip.createfolder\' | translate }}" ng-click="showCreateFolder()" variant="primary" icon="plus" data-disabled="!isFeatureEnabled(\'s3-cf\')"></awsui-button>\n            <action-dropdown class="moredropdown" get-selected-objects="getSelectedObjects" get-selected-folders="getSelectedFolders" is-single-object-only-selected="isSingleObjectOnlySelected" tag-filter-length="filters.tagFilters.length" text="{{ \'objectactionstrip.more\' | translate }}" items="more_dropdown" bucketname="bucketName" show-versions="showVersions" show-deleted="showDeleted"></action-dropdown>\n            <div ng-if="showVersionedView" class="version-text"> {{\'objectactionstrip.versiontext\' | translate}} </div>\n            <awsui-button-group ng-if="isVersionedBucket && !showVersionedView" class="bucket-action-show-deleted-objs" fac-id="s3-sdo">\n                <awsui-button ng-class="{selected: !showDeleted}" ng-click="showAllObjects()" text="{{ \'objectactionstrip.showall\' | translate }}"></awsui-button>\n                <awsui-button ng-class="{selected: showDeleted}" ng-click="showDeletedObjects()" text="{{ \'objectactionstrip.showdeleted\' | translate }}"></awsui-button>\n            </awsui-button-group>\n            <awsui-button-group ng-if="isVersionedBucket && showVersionedView" class="bucket-action-show-obj-version">\n                <awsui-button ng-class="{selected: !showVersions}" ng-click="hideObjectVersions()" text="{{ \'objectactionstrip.hide\' | translate }}"></awsui-button>\n                <awsui-button ng-class="{selected: showVersions}" ng-click="showObjectVersions()" text="{{ \'objectactionstrip.show\' | translate }}"></awsui-button>\n            </awsui-button-group>\n\n            <div class="refresh-button">\n                <span class="object-bucket-region" ng-bind="bucketRegion.text"></span>\n                <awsui-button id="refreshButton" icon="refresh" variant="standalone-icon" loading="isRefreshing" click="fetchObjects(false, false)"></awsui-button>\n            </div>\n        </div>\n\n    </div>\n    <empty-state ng-if="showEmptyScreen" right-click="rightClick($event)" open-modal="openUploadModal" type="\'object\'"></empty-state>\n    <div ng-if="noResultsMessage" class="no-results" right-click="rightClick($event)">{{noResultsMessage}}</div>\n    <div class="columbia-table" ng-class="showVersions ? \'object-table-versioned\' : \'object-table\'" ng-if="!showEmptyScreen && !noResultsMessage" right-click="rightClick($event)">\n        <div class="pages-row pages-row-top">\n\n            <div class="pages">\n                <awsui-button id="fetchPreviousPageBtn" icon="angle-left" variant="standalone-icon" click="fetchPreviousPageOfObjects()" data-disabled="isFetchPreviousPageDisabled()"></awsui-button>\n                <span ng-if="endKeyNum" id="paginationNumbering">{{\'objects.pagination.viewing\' | translate}} {{ startKeyNum }} {{\'objects.pagination.to\' | translate}} {{ endKeyNum }} </span>\n                <awsui-button id="fetchNextPageBtn" icon="angle-right" variant="standalone-icon" click="fetchNextPageOfObjects()" data-disabled="isFetchNextPageDisabled()"></awsui-button>\n            </div>\n        </div>\n        <table class="table table-condensed fix-width-table">\n            <thead>\n            <tr class="black-header">\n                <th><awsui-checkbox ng-model="allKeys.selected" change="selectAllKeys()"></awsui-checkbox></th>\n\n                    <th ng-if="!showVersions" ng-click="setSortOrder(\'Key\')">\n                        <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position="bottom">\n                            <a translate="objects.column.key"></a>\n                            <span ng-if="!showVersions" class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Key\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Key\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Key\'}"></span>\n                        </awsui-tooltip>\n                    </th>\n                    <th ng-if="!showVersions" ng-click="setSortOrder(\'LastModified\')">\n                        <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position="bottom">\n                        <a translate="last.modified"></a>\n                        <span ng-if="!showVersions" class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'LastModified\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'LastModified\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'LastModified\'}"></span>\n                        </awsui-tooltip>\n                    </th>\n                    <th ng-if="!showVersions" ng-click="setSortOrder(\'Size\')">\n                        <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position="bottom">\n                        <a translate="objects.column.size"></a>\n                        <span ng-if="!showVersions" class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Size\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Size\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Size\'}"></span>\n                        </awsui-tooltip>\n                    </th>\n                    <th ng-if="!showVersions" ng-click="setSortOrder(\'StorageClass\')">\n                        <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position="bottom">\n                        <a translate="objects.column.storageclass"></a>\n                        <span ng-if="!showVersions" class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'StorageClass\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'StorageClass\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'StorageClass\'}"></span>\n                        </awsui-tooltip>\n                    </th>\n\n\n                    <th ng-if="showVersions">\n                        <span> {{ \'objects.column.key\' | translate }} </span>\n                    </th>\n                    <th ng-if="showVersions">\n                        <span> {{ \'objects.column.versionid\' | translate }} </span>\n                    </th>\n                    <th ng-if="showVersions">\n                        <span> {{ \'last.modified\' | translate }} </span>\n                    </th>\n                    <th ng-if="showVersions">\n                        <span> {{ \'objects.column.size\' | translate }} </span>\n                    </th>\n                    <th ng-if="showVersions">\n                        <span> {{ \'objects.column.storageclass\' | translate }} </span>\n                    </th>\n            </tr>\n            </thead>\n            <tbody ng-hide="currLocation.loading">\n                <tr ng-if="createFolder.displayed">\n                    <td></td>\n                    <td class="awsui-icon folder-open">\n                        <update-object show-operation="createFolder.displayed" default-encryption-enabled="defaultEncryptionEnabled" fetch-objects="fetchObjects" current-marker="currentMarker" default-placeholder="{{\'createfolder.input.defaultvalue\' | translate}}" operation="operation" reset-selection="resetSelection">\n                    </td>\n                    <td></td>\n                    <td></td>\n                    <td></td>\n                </tr>\n                <tr class="unselectable" unselectable="on" onselectstart="return false" ng-repeat="folder in currLocation.folders.relativePaths | orderBy:sortColumnName:reverseSortOrder" ng-class="{\'row-selected\': folder.selected, \'row-hover\' : hoverFolder && !folder.selected }" ng-mouseenter="hoverFolder = true" ng-mouseleave="hoverFolder = false" ng-show="currLocation.folders.relativePaths.length" ng-click="clickObjectRow($event, folder)" ng-dblclick="navigateIntoFolder(folder.Prefix)" right-click="rightClick($event, folder)">\n                    <td>\n                        <awsui-checkbox checked="folder.selected" change="selectOneMoreKey(folder)" ng-click="clickCheckBox($event, folder)"></awsui-checkbox>\n                    </td>\n                    <td class="awsui-icon folder-open truncate" ng-class="{\'awsui-icon-light\': folder.selected && !panelHide}">\n                        <a class="list-view-item-name object-name" ng-click="navigateIntoFolder(folder.Prefix); $event.stopPropagation()" ng-if="!folder.beingRenamed && folder.Prefix !== \'\'"> {{ folder.Prefix }} </a>\n                        <a class="list-view-item-name object-name empty-folder-name" ng-click="navigateIntoFolder(folder.Prefix); $event.stopPropagation()" ng-if="!folder.beingRenamed && folder.Prefix === \'\'"></a>\n                        <span ng-if="folder.beingRenamed">\n                            <update-object show-operation="folder.beingRenamed" default-encryption-enabled="defaultEncryptionEnabled" fetch-objects="fetchObjects" current-marker="currentMarker" default-value="{{folder.Prefix}}" operation="operation" reset-selection="resetSelection">\n                        </span>\n                    </td>\n                    <td> -- </td>\n                    <td> -- </td>\n                    <td> -- </td>\n                    <td ng-if="showVersions"> -- </td>\n                </tr>\n                <tr ng-if="showVersions" class="unselectable" unselectable="on" onselectstart="return false" ng-repeat="obj in currLocation.objects.relativePaths | orderBy:sortColumnName:reverseSortOrder" ng-class="{\'row-selected\': obj.selected , \'row-hover\' : hoverObj && !obj.selected, \'not-version-row\': !obj.isVersionRow, \'version-row\': obj.isVersionRow}" ng-mouseenter="hoverObj = true" ng-mouseleave="hoverObj = false" data-disabled="!obj.isVersionRow" ng-click="clickObjectRow($event, obj)" ng-dblclick="openObjectInBrowser(obj)" right-click="rightClick($event, obj)">\n\n                    <td ng-if="obj.isVersionRow"><awsui-checkbox checked="obj.selected" change="selectOneMoreKey(obj)" ng-click="clickCheckBox($event, obj)"></awsui-checkbox></td>\n                    <td ng-if="obj.isVersionRow" class="truncate">\n                        <span class="awsui-icon" ng-class="getIconClass(obj)" ng-click="openObjectInBrowser(obj)"></span>\n                        <a class="list-view-item-name object-name" ng-click="goToObjectDetails(obj)" ng-show="!obj.beingRenamed"> {{ obj.LastModified | date:"medium" }}\n                            <span ng-if="obj.ETag && obj.IsLatest === \'true\'"> ({{ \'versionsdropdown.label.latestVersion\' | translate }})</span>\n                            <span ng-if="!obj.ETag"> ({{ \'versionsdropdown.label.deleteMarker\' | translate }})</span>\n                        </a>\n                        <span ng-if="obj.beingRenamed">\n                            <update-object show-operation="obj.beingRenamed" default-encryption-enabled="defaultEncryptionEnabled" fetch-objects="fetchObjects" current-marker="currentMarker" default-value="{{obj.Key}}" operation="operation" reset-selection="resetSelection">\n                        </span>\n                    </td>\n                    <td class="truncate" ng-if="obj.isVersionRow && obj.VersionId !== \'\'">{{ obj.VersionId }}</td>\n                    <td class="truncate" ng-if="obj.isVersionRow && obj.VersionId === \'\'"> -- </td>\n                    <td ng-if="obj.isVersionRow"></td>\n                    <td ng-if="obj.isVersionRow &&  obj.Size">{{ obj.Size | humanReadableBytes }}</td>\n                    <td ng-if="obj.isVersionRow && (obj.Size === \'\' || !obj.Size)"> -- </td>\n                    <td ng-if="obj.isVersionRow && obj.StorageClass">{{ getStorageClassTranslation(obj.StorageClass) }}</td>\n                    <td ng-if="obj.isVersionRow && (obj.StorageClass === \'\' || !obj.StorageClass)"> -- </td>\n\n                    <td ng-if="!obj.isVersionRow"></td>\n                    <td ng-if="!obj.isVersionRow" class="truncate">\n                        <a ng-if="!obj.isVersionRow" class="list-view-item-name object-name" ng-click="goToObjectDetails(obj)" ng-show="!obj.beingRenamed"> {{ obj.Key }} </a>\n                    </td>\n                    <td ng-if="!obj.isVersionRow"></td>\n                    <td ng-if="!obj.isVersionRow"> {{ obj.LastModified | date:"medium" }} </td>\n                    <td ng-if="!obj.isVersionRow"></td>\n                    <td ng-if="!obj.isVersionRow"></td>\n                </tr>\n                <tr ng-if="!showVersions" class="unselectable" unselectable="on" onselectstart="return false" ng-repeat="obj in currLocation.objects.relativePaths | orderBy:sortColumnName:reverseSortOrder" ng-class="{\'row-selected\': obj.selected , \'row-hover\' : hoverObj && !obj.selected}" ng-mouseenter="hoverObj = true" ng-mouseleave="hoverObj = false" ng-click="clickObjectRow($event, obj)" ng-dblclick="openObjectInBrowser(obj)" right-click="rightClick($event, obj)">\n                    <td><awsui-checkbox checked="obj.selected" change="selectOneMoreKey(obj)" ng-click="clickCheckBox($event, obj)"></awsui-checkbox></td>\n                    <td class="truncate">\n                        <span class="awsui-icon" ng-class="getIconClass(obj)" ng-click="openObjectInBrowser(obj)"></span>\n                        <a class="list-view-item-name object-name" ng-click="goToObjectDetails(obj)" ng-show="!obj.beingRenamed"> {{ obj.Key }} </a>\n                        <span ng-if="obj.beingRenamed">\n                            <update-object show-operation="obj.beingRenamed" default-encryption-enabled="defaultEncryptionEnabled" fetch-objects="fetchObjects" current-marker="currentMarker" default-value="{{obj.Key}}" operation="operation" reset-selection="resetSelection">\n                        </span>\n                    </td>\n                    <td ng-if="obj.LastModified !== \'\'">{{ obj.LastModified | date: dateFormat }}</td>\n                    <td ng-if="obj.LastModified === \'\'"> -- </td>\n                    <td ng-if="obj.Size !== \'\'">{{ obj.Size | humanReadableBytes }}</td>\n                    <td ng-if="obj.Size === \'\'"> -- </td>\n                    <td ng-if="obj.StorageClass !== \'\'">{{ getStorageClassTranslation(obj.StorageClass)}}</td>\n                    <td ng-if="obj.StorageClass === \'\'"> -- </td>\n                </tr>\n            </tbody>\n        </table>\n        <div class="pages-row">\n            <div class="pages">\n                <awsui-button icon="angle-left" variant="standalone-icon" click="fetchPreviousPageOfObjects()" data-disabled="isFetchPreviousPageDisabled()"></awsui-button>\n                <span ng-if="endKeyNum">{{\'objects.pagination.viewing\' | translate}} {{ startKeyNum }} {{\'objects.pagination.to\' | translate}} {{ endKeyNum }} </span>\n                <awsui-button icon="angle-right" variant="standalone-icon" click="fetchNextPageOfObjects()" data-disabled="isFetchNextPageDisabled()"></awsui-button>\n\n            </div>\n        </div>\n    </div>\n    <storage-console-config-panel class="objects-side-panel download-side-panel" ng-mouseenter="hoverDownloadPanel(true)" ng-mouseleave="hoverDownloadPanel(false)" ng-class="{\'side-config-panel\': downloadAsPanel, \'hide-config-panel\': !downloadAsPanel}" panel-open="downloadAsPanel">\n        <header>\n            <span class="side-panel-header download-as-panel-header" translate="object.download.destination"></span>\n            <span class="panel-close-icon" ng-click="closeDownloadAsPanel()"></span>\n        </header>\n        <content>\n            <div class="download-as-directions">\n                <div class="download-as-directions-text" translate="object.download.directions"></div>\n                <a ng-show="!downloadAsPanelGenerating && !downloadPanelError" ng-href="{{downloadPanel.url}}" id="downloadAsLink">{{ getSelectedObjects()[0].Key }}</a>\n                <div class="download-as-directions-text" ng-show="!downloadAsPanelGenerating && downloadPanelError" translate="object.download.error"></div>\n                <span ng-show="downloadAsPanelGenerating" class="awsui-spinner awsui-spinner-light"></span>\n            </div>\n        </content>\n    </storage-console-config-panel>\n    <storage-console-config-panel class="objects-side-panel" ng-mouseenter="hoverObjectPropertiesPanel(true)" ng-mouseleave="hoverObjectPropertiesPanel(false)" ng-class="{\'side-config-panel\': objectPropertiesPanel.show, \'hide-config-panel\': !objectPropertiesPanel.show, \'deleted-version\': objectSelectedForSidePanel.obj.ETag === undefined}" panel-open="objectPropertiesPanel.show">\n        <header>\n            <div class="truncate side-panel-header"> {{ objectPropertiesConfig.overview.Key }}\n            </div>\n            <span class="panel-close-icon" ng-click="closeObjectPropertiesPanel()"></span>\n            <awsui-button class="sidepanel-header-button" ng-click="downloadSelectedObject(objectSelectedForSidePanel.obj.disableDownload)" text="{{ \'objects.button.download\' | translate }}"></awsui-button>\n            <awsui-button class="sidepanel-header-button" ng-click="$event.stopPropagation(); copySelectedObjectPath(getSelectedObjects()[0].Key)" text="{{ \'objects.button.copypath\' | translate }}"></awsui-button>\n            <span class="copy-message" ng-class="{ \'fade-in\' : copyFinished.flag, \'fade-out\' : !copyFinished.flag}" translate="copytoclipboard.path"></span>\n        </header>\n        <content>\n            <div ng-if="!showVersions" class="sidepanel-version-section">\n                <div class="version-label-container" ng-click="listVersions($event)">\n                    <span class="version-label"> {{ objectSelectedForSidePanel.obj.versionLabel }}</span>\n                    <div class="versions-dropdown-caret"></div>\n                </div>\n                <versions-dropdown bucket="bucketForVersionsDropdown.name" error="objectSelectedForSidePanel.error" get-metadata="getMetadata(operation, versionId)" set-up-metadata="setUpObjectMetadataForPropertiesPanel(obj)" update-obj-metadata="updateObjMetadata(obj)" update-obj-acl="updateObjAcl(obj)" key="versionDropdownKey.name" obj="objectSelectedForSidePanel.obj" versions="objectSelectedForSidePanel.versions" show-versions-dropdown="showVersionsDropdown" objects-page="objectsPage.show" refresh="refreshAndClearObjectsCacheForCurrentBucket()" object-properties-panel="objectPropertiesPanel" versions-dropdown-selected-object="versionsDropdownSelectedObject.obj">\n                </versions-dropdown>\n                <div ng-if="!$last" class="sidepanel-version-section-divider"></div>\n            </div>\n            <div ng-if="!showVersions" class="version-placeholder"></div>\n            <div class="object-panel-configcontent" ng-class="{\'versionview\': showVersions}">\n                <div class="objects-panel-config-lists" ng-repeat="(configTitle, configContent) in objectPropertiesConfig" ng-click="moveToObjectTab(configTitle)">\n                    <table ng-if="configTitle !== \'permissions\'">\n                        <tr class="objects-config-panel-content" ng-repeat="(configKey, configValue) in configContent" ng-class="{\'latestversion\': objectSelectedForSidePanel.obj.IsLatest === \'true\' || !showVersions}">\n                            <td class="subtitle">{{ getPropertyTitleConditionally($first, \'objects.details.\', configTitle) }}</td>\n                            <td class="config-panel-content-left" translate="objects.details.{{configKey}}" ng-click="takeActionFromSidePanel(configTitle, configKey, $event)"></td>\n                            <td ng-if="configKey !== \'Link\'" class="config-panel-content-right">{{configValue}}</td>\n                            <td ng-if="configKey === \'Link\'" class="config-panel-content-right link"><a href="{{configValue}}">{{configValue}}</a></td>\n                        </tr>\n                    </table>\n                    <table ng-if="configTitle === \'permissions\'">\n                        <tr class="objects-config-panel-content">\n                            <td class="subtitle"><span translate="objects.details.permissions"></span></td>\n                            <td class="config-panel-content-left" translate="objects.details.owner"></td>\n                            <td class="config-panel-content-right">{{ configContent.owner }}</td>\n                        </tr>\n                    </table>\n                    <table class="object-side-panel-permissions-table" ng-repeat="(permissionHeader, properties) in configContent.grantees">\n                        <tr class="objects-config-panel-content">\n                            <td></td>\n                            <td class="config-panel-content-left config-panel-content-subheading"><span translate="objects.details.{{permissionHeader}}"></span></td>\n                            <td class="config-panel-content-right"></td>\n                        </tr>\n                        <tr class="objects-config-panel-content" ng-repeat="(permissionKey, permissionValue) in properties">\n                            <td class="subtitle"></td>\n                            <td class="config-panel-content-left"><span translate="objects.details.{{permissionKey}}"></span></td>\n                            <td class="config-panel-content-right">{{ permissionValue }} {{ \'objects.details.grantees\' | translate }}</td>\n                        </tr>\n                    </table>\n                    <div ng-if="!$last" class="bucket-config-panel-divider"></div>\n                </div>\n            </div>\n            <awsui-alert class="version-dropdown-error" ng-if="objectSelectedForSidePanel.error !== \'\'" type="error"> {{ objectSelectedForSidePanel.error }} </awsui-alert>\n        </content>\n    </storage-console-config-panel>\n</div>\n<upload-modal modal-open="isUploadModalDisplayed" current-path="currentPath" fetch-objects="fetchObjects" operation="operations.dragAndDropOperation" selected="selected" flags="flags" filedrop=""></upload-modal>\n<initiate-restore-modal ng-if="operation && isInitiateRestoreDisplayed.flag" is-open="isInitiateRestoreDisplayed" count-info="countInfo" operation="operation">\n</initiate-restore-modal>\n<confirmation-dialog-modal ng-if="operation && isConfirmationModalOpen.dialogOpen.flag" is-open="isConfirmationModalOpen" count-info="countInfo" operation="operation" object-metadata="objectMetadata">\n</confirmation-dialog-modal>\n<storage-console-config-panel class="multiselect-config-panel" ng-class="{\'side-config-panel objects-side-panel\': isConfirmationModalOpen.sidePanelOpen,\n                                  \'hide-config-panel objects-side-panel\': !isConfirmationModalOpen.sidePanelOpen}" panel-open="isConfirmationModalOpen.sidePanelOpen" is-side-panel="true" ng-mouseenter="hoverConfirmationPanel(true)" ng-mouseleave="hoverConfirmationPanel(false)">\n    <header>\n        <span class="side-panel-header multi-selected-configpanel-header">{{modalInfo.headTitle}}</span>\n        <span class="panel-close-icon" ng-click="cancelConfirmationPanel($event)"></span>\n        <p translate="mutiselectpanel.files" translate-values="{totalObjs: {{countInfo.objects}} }"></p>\n    </header>\n    <content>\n        \n        <div class="initialrestore-panel" ng-if="opName === more_dropdown[3].items[1].opName">\n            <table>\n                <tr>\n                    <td class="initialrestore-toptext" translate="confirmationsidepanel.initiaterestore.toptext"></td>\n                </tr>\n                <tr>\n                    <td>\n                        <form class="initial-restore-panel-value" name="initialRestorePanel" autocomplete="off">\n                            <awsui-control-group validation-message="{{  (initialRestorePanel.initialRestoreValue.$error.required ? \'initialrestorevalue.emptywarning \' : panelSettingValues.inputErrorMsg) | translate }}">\n                                <awsui-textfield name="initialRestoreValue" ng-model="panelSettingValues.setting" ng-change="validateInitialRestoreValue(panelSettingValues)" required=""></awsui-textfield>\n                            </awsui-control-group>\n                        </form>\n                    </td>\n                </tr>\n                <tr>\n                    <td class="initialrestore-bottomtext" translate="confirmationsidepanel.initiaterestore.bottomtext"></td>\n                </tr>\n            </table>\n        </div>\n        \n        <div class="sidepanel-change-metadata" ng-if="opName === more_dropdown[3].items[3].opName">\n            <table class="sidepanel-metadata-table">\n                <thead>\n                <tr>\n                    <td translate="objectproperties.tags.key" class="sidepanel-metadata-key-header"></td>\n                    <td translate="objectproperties.tags.value" class="sidepanel-metadata-value-header"></td>\n                </tr>\n                </thead>\n                <tbody>\n                <tr ng-repeat="metadata in panelSettingValues.values">\n                    <td class="sidepanel-metadata-key">\n                        <awsui-control-group validation-message="{{ metadata.metadataKey.error }}">\n                            <dropdown items="predefinedMetadata" selected-item="metadata.metadataKey" filter="true" placeholder="{{ \'objectdetail.metadata.key-placeholder\' | translate }}"></dropdown>\n                        </awsui-control-group>\n                    </td>\n                    <td class="sidepanel-metadata-value">\n                        <awsui-control-group validation-message="{{ metadata.metadataValue.error || metadata.metadataValue.inputError }}">\n                            <dropdown ng-if="metadata.metadataKey.dropDownValue && metadata.metadataKey.dropDownValue.length > 2" items="metadata.metadataKey.dropDownValue" selected-item="metadata.metadataValue" enable-input="true" filter="true" input-field="metadata.metadataValue" placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}">\n                            </dropdown>\n                            <dropdown ng-if="metadata.metadataKey.dropDownValue && metadata.metadataKey.dropDownValue.length <= 2" items="metadata.metadataKey.dropDownValue" selected-item="metadata.metadataValue" enable-input="true" input-field="metadata.metadataValue" placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}">\n                            </dropdown>\n                            <awsui-textfield ng-if="metadata.metadataKey && !metadata.metadataKey.dropDownValue" ng-model="metadata.metadataValue.text" ng-change="clearMetadataErrorMsg(metadata.metadataValue)"></awsui-textfield>\n                        </awsui-control-group>\n                    </td>\n                    <td class="sidepanel-metadata-delete"><a href="" class="remove-metadata" ng-click="removeMetadata($index)">X</a></td>\n                </tr>\n                </tbody>\n            </table>\n            <awsui-button ng-click="addMetadata($event)" icon="plus" class="sidepanel-addmetadata-button" text="{{\'objectproperties.metadata.addnew\' | translate}}"></awsui-button>\n            <awsui-alert class="error-error" type="error" header="{{ \'error.header\' | translate }}" ng-if="sidepanelMetadataValidationError && sidepanelMetadataValidationError.text">\n                <p translate="objectdetail.metadata.multisamekeywarning" translate-values="{ errorMsg : \'{{sidepanelMetadataValidationError.text}}\' }"></p>\n            </awsui-alert>\n        </div>\n\n        \n        <div class="add-object-tags" ng-if="opName === more_dropdown[3].items[5].opName">\n            <table class="tagging-table">\n                <thead>\n                    <tr>\n                        <td translate="objectproperties.tags.key" class="key-header"></td>\n                        <td translate="objectproperties.tags.value" class="value-header"></td>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr ng-repeat="tag in panelSettingValues.values">\n                        <td>\n                            <awsui-textfield class="tag-input" ng-model="tag.Key"></awsui-textfield>\n                        </td>\n                        <td>\n                            <awsui-textfield class="tag-input" ng-model="tag.Value"></awsui-textfield>\n                        </td>\n                        <td><a href="" class="remove-tag" ng-click="removeTag($index)">X</a></td>\n                    </tr>\n                </tbody>\n            </table>\n            <awsui-button ng-click="addTag($event)" data-disabled="panelSettingValues.values.length >= panelSettingValues.setting.maxKeys || isAnyKeyEmpty()" icon="plus" class="object-properties-button" text="{{\'objectproperties.tags.addnew\' | translate}}"></awsui-button>\n            <awsui-alert class="error-alert" type="error" ng-show="tagError">{{tagErrorMessage}}</awsui-alert>\n            <awsui-alert class="objecttag-replication-warning" dismissible="false" type="warning" fac-id="s3-crr">\n                <p translate="replicationcard.warningmsg"></p>\n            </awsui-alert>\n        </div>\n\n        \n        <div ng-repeat="value in panelSettingValues.values" ng-if="opName !== more_dropdown[1].items[2].opName && opName !== more_dropdown[3].items[5].opName && opName !== more_dropdown[3].items[3].opName">\n            <div class="awsui-row">\n                <awsui-radio-group class="sidepanel-radio-settings" ng-model="panelSettingValues.setting" ng-change="updateConfigPanel()">\n                    <awsui-radio-button value="{{value[0]}}" ng-model="panelSettingValues.setting" label="{{ value[1] }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <div class="sidepanel-radio-description" translate="{{value[2]}}"></div>\n                <p class="learn-more" ng-if="value[3] !== undefined"><a ng-href="{{value[3]}}" target="_blank" translate="">learn.more</a></p>\n            </div>\n        </div>\n\n        \n        <div ng-if="opName === more_dropdown[3].items[2].opName" fac-id="s3-kms" class="configure-kms-key">\n            <awsui-control-group validation-message="{{ KMSServiceError }}">\n                <dropdown ng-if="panelSettingValues.setting === awsKMS" items="kmsKeys" placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled="KMSServiceError" selected-item="panelSettingValues.kmsOption.kmsId" filter="true">\n                </dropdown>\n            </awsui-control-group>\n            \n            <awsui-textfield ng-if="panelSettingValues.setting === awsKMS && panelSettingValues.kmsOption.kmsId.value === customARN" ng-model="panelSettingValues.kmsOption.kmsARN">\n            </awsui-textfield>\n        </div>\n    </content>\n\n    <footer>\n        <awsui-button id="save-confirmation-panel-btn" ng-click="saveConfirmationPanel($event)" text="{{ \'button.save\' | translate }}" class="awsui-util-f-r object-property-button" loading="isCounting.flag" variant="primary"></awsui-button>\n        <awsui-button ng-click="cancelConfirmationPanel($event)" text="{{ \'button.cancel\' | translate }}" class="awsui-util-f-r object-property-button"></awsui-button>\n    </footer>\n</storage-console-config-panel>\n<action-dropdown class="context-menu" id="context-menu" get-selected-objects="getSelectedObjects" get-selected-folders="getSelectedFolders" is-single-object-only-selected="isSingleObjectOnlySelected" tag-filter-length="filters.tagFilters.length" text="{{ \'objectactionstrip.more\' | translate }}" items="more_dropdown" bucketname="bucketName" show-versions="showVersions" show-deleted="showDeleted">\n</action-dropdown>');a.put("/s3/partials/permissionsSubModal.html",'<awsui-button icon="plus" ng-if="isAwsAccount" text="{{ \'permissonsubmodal.addnewaccount\' | translate }}" variant="primary" class="addawsaccount-button" click="addAwsAccountPermission()">\n</awsui-button>\n<awsui-alert class="input-error" header="{{ \'warning.header\' | translate }}" visible="isAwsAccount && isAddingAccount.warningMsg" type="warning"> {{ isAddingAccount.warningMsg }}</awsui-alert>\n<table class="expandsectable">\n    <tr class="subsectitle-row">\n        <td ng-repeat="aclTitle in aclModalTitles">\n            {{aclTitle.txt}}\n            <awsui-tooltip text="{{aclTitle.info}}" position="{{aclTitle.pos}}" size="small">\n                <i class="awsui-icon alert-info-circle"></i>\n            </awsui-tooltip>\n        </td>\n        <td></td>\n        <td ng-if="isAwsAccount"></td>\n        <td ng-if="isAwsAccount"></td>\n    </tr>\n    <tr ng-repeat="permission in permissions" ng-if="!permissions[$index].revokeAll && permissions[$index].detail.value !== \'AuthenticatedUsers\'">\n        <td ng-if="isPublic">{{permission.detail.text}}</td>\n        <td ng-if="!isPublic && !isAwsAccount">{{permission.detail.DisplayName}}<span ng-if="$index===0" translate="userpermission.owner"></span></td>\n        <td ng-if="isAwsAccount" class="truncate"><p class="awsaccount-text truncate">{{permission.detail.DisplayName || permission.detail.EmailAddress || permission.detail.ID}}</p></td>\n        <td>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="permission.permissions.READ">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="permission.permissions.WRITE">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n        </td>\n        <td>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="permission.permissions.READ_ACP">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="permission.permissions.WRITE_ACP">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n            <span class="permissions-sub-modal-close close-icon" ng-if="!isPublic && !isAwsAccount" ng-click="deleteUserAcl($index)"></span>\n        </td>\n        <td ng-if="isAwsAccount"></td>\n        <td ng-if="isAwsAccount"><span class="permissions-sub-modal-close close-icon" ng-click="deleteAwsAccountAcl(permission.detail)"></span></td>\n    </tr>\n    <tr ng-if="isAwsAccount && isAddingAccount.flag">\n        <td><awsui-textfield class="newawsaccount-permission-textbox" placeholder="{{ \'permissions.addnewgratee.placeholder\' | translate }}" ng-model="newAwsAccount.detail.ID"></awsui-textfield></td>\n        <td>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="newAwsAccount.permissions.READ">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="newAwsAccount.permissions.WRITE">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n        </td>\n        <td>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="newAwsAccount.permissions.READ_ACP">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="newAwsAccount.permissions.WRITE_ACP">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n        </td>\n        <td ng-if="isAwsAccount">\n            <awsui-button text="{{ \'permissonsubmodal.saveawsaccounts\' | translate }}" variant="primary" class="saveawsaccount-button" click="saveAwsAccountPermission()" data-disabled="!newAwsAccount.detail.ID && !newAwsAccount.detail.EmailAddress || !newAwsAccount.permissions.READ && !newAwsAccount.permissions.READ_ACP && !newAwsAccount.permissions.WRITE && !newAwsAccount.permissions.WRITE_ACP">\n            </awsui-button>\n        </td>\n        <td ng-if="isAwsAccount">\n            <awsui-button text="{{ \'permissonsubmodal.clearawsaccounts\' | translate }}" class="clearawsaccount-button awsui-util-f-r" click="clearAwsAccountPermission()">\n            </awsui-button>\n        </td>\n    </tr>\n</table>');a.put("/s3/partials/progressbar.html",'<div scroll="" selected-tab="{{selectedTab}}" total-operation="{{totalOperationCount}}" ng-show=" totalOperationCount > 0 " class="progress-bar-footer" ng-class="{ open: isExpanded }">\n    <div ng-show="isExpanded" class="progress-bar-session">\n        <table>\n            <tr class="progress-bar-operation" ng-repeat="operation in showingOperations">\n                <th class="progress-bar-icon-and-name">\n                    <span class="operation-icon awsui-icon awsui-icon-link" ng-click="openModal(operation)" ng-class="getIconForOperation(operation.name)"></span>\n                    <div class="operation-name" ng-click="openModal(operation)"> {{operation.displayName}} <div class="upload-speed-report" ng-if="isActiveUploadOperation(operation)"> ({{operation.currentUploadSpeed}}/s)</div></div>\n                </th>\n                <th class="progress-bar-real-progress-bar">\n                    <div class="operation-progress-bar {{ operation.state }}-fill">\n                        <div ng-if="!operation.successPercentage && !operation.errorPercentage" class="operation-percentage-text" translate="">operation.progress.started</div>\n                        <div ng-if="operation.successPercentage !== 0" class="current-progress-fill" ng-style="{width: operation.successPercentage + \'%\'}">\n                            <span ng-if="(operation.errorPercentage !== 0 && operation.successPercentage >= thresholdPercentage) || operation.errorPercentage === 0" class="operation-percentage-text">{{operation.successPercentage}}% {{\'operation.detail.successful\' | translate}}</span>\n                        </div>\n                        <div ng-if="operation.errorPercentage !== 0" class="current-error-fill" ng-style="{width: operation.errorPercentage + \'%\'}">\n                            <span class="operation-percentage-text">{{operation.errorPercentage}}% {{\'operation.detail.failed\' | translate}}</span>\n                        </div>\n                        <translate class="file-in-progress" ng-if="operation.fileInProgress && (operation.errorPercentage + operation.successPercentage) < 100" translate-values="{fileName: operation.fileInProgress}">operation.tab.uploadingfile</translate>\n                    </div>\n                </th>\n\n                <th class="progress-bar-cancel-icon">\n                    <span class="operation-cancel-button blue-cancel-icon" ng-click="cancelOperation(operation)"></span>\n                </th>\n                <div class="awsui-util-clearfix"></div>\n            </tr>\n        </table>\n    </div>\n\n    <div class="operation-summary">\n        <div class="total-operations">\n            {{ \'operation.tab.totalOperations\' | translate }}\n        </div>\n        <div class="in-progress-expander" ng-class="{ \'cursorpointer\' : hoverOnInprogress &&  totalOngoingOperations.length > 0 || operationState.ongoingOperations,\n        \'cursornomal\' : hoverOnInprogress &&  totalOngoingOperations.length === 0,\n        \'deselectprogresstab\': !operationState.ongoingOperations && totalOngoingOperations.length > 0}" ng-mouseenter="hoverOnInprogress = true" ng-mouseleave="hoverOnInprogress = false" ng-click="expandOrCollapseOperations(allOperations.ongoingOperations, totalOngoingOperations.length !== 0, \'ongoingOperations\')">\n            {{ totalOngoingOperations.length }} {{ \'operation.tab.inProgress\' | translate }}\n        </div>\n        <div class="completed-expander" ng-class="{ \'cursorpointer\' : hoverOnComplete &&  completedOperations.length > 0 || operationState.completedOperations,\n        \'cursornomal\' : hoverOnComplete &&  completedOperations.length === 0,\n        \'deselectprogresstab\': !operationState.completedOperations && completedOperations.length > 0 }" ng-mouseenter="hoverOnComplete = true" ng-mouseleave="hoverOnComplete = false" ng-click="expandOrCollapseOperations(allOperations.completedOperations, completedOperations.length !== 0, \'completedOperations\')">\n            {{ completedOperations.length}} {{ \'operation.tab.success\' | translate }}\n        </div>\n        <div class="error-expander" ng-class="{ \'cursorpointer\' : hoverOnError &&  incompleteOperations.length > 0 || operationState.incompleteOperations,\n        \'cursornomal\' : hoverOnError &&  incompleteOperations.length === 0,\n        \'deselectprogresstab\': !operationState.incompleteOperations && incompleteOperations.length > 0}" ng-mouseenter="hoverOnError = true" ng-mouseleave="hoverOnError = false" ng-click="expandOrCollapseOperations(allOperations.incompleteOperations, incompleteOperations.length !== 0, \'incompleteOperations\')">\n            {{ incompleteOperations.length }} {{ \'operation.tab.error\' | translate }}\n        </div>\n    </div>\n</div>\n<detail-progress is-open="modalOpen" cancel-button-text="detailCancelButtonText" target-operation="detailOperation" cancel-operation-function="cancelFromDetailView" close-callback="closeDetailView"></detail-progress>');a.put("/s3/partials/replicationv1.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-CRR-water-mark\': !cardOpen, \'card-enable-CRR-water-mark\': cardOpen }">\n    <card-header>\n        <span translate="bucketproperties.crossregionreplication.label.crossregionreplication"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelPressed($event)"></div>\n    </card-header>\n    <card-content>\n        <p ng-if="!cardOpen" class="bucketproperties-summary" translate="bucketproperties.crossregionreplication.summary"></p>\n        <div class="awsui-row card-content-row">\n            <awsui-radio-group ng-if="cardOpen" ng-model="replicationObj.isEnabled">\n                <awsui-radio-button style="display: inline" value="Enabled" label="{{ \'replication.label.enable\' | translate }}" disabled="versioningStatus === S3Constants.BUCKET_PROPERTIES.DISABLE"></awsui-radio-button>\n                <awsui-tooltip text="{{\'replication.enable.tooltip\' | translate}}" position="right" size="small">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n                <awsui-alert ng-if="replicationObj.isEnabled == S3Constants.REPLICATION.DISABLED" class="warning-box" type="warning" dismissable="false">{{ \'replication.enablewarning\' | translate }}</awsui-alert>\n                <div class="enabled-replication-content" ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED" ng-click="$event.stopPropagation(); completeEdit()">\n                    <div class="source-section">\n                        <div class="section-header">\n                            <span translate="">replication.sectionheader.source</span>\n                            <div></div>\n                        </div>\n                        <div class="region-text">\n                            <span id="region-title" translate="">replication.label.region</span>\n                            <span>{{sourceRegion}}</span>\n                        </div>\n                        <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED">\n                            <awsui-select ng-change="resetError()" placeholder="{{ \'replication.placeholder.source\' | translate }}" ng-model="replicationObj.replicationType" items="sources">\n                            </awsui-select>\n                        </awsui-control-group>\n                    </div>\n                    <div class="destination-section">\n                        <div class="section-header">\n                            <span>{{ \'replication.sectionheader.destination\' | translate }}</span>\n                            <div></div>\n                        </div>\n                        <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED">\n                            <dropdown items="regionMapping" selected-item="replicationObj.destinationRegion" placeholder="{{ \'replication.placeholder.region\' | translate }}" filter="true"></dropdown>\n                        </awsui-control-group>\n                        <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED">\n                            <dropdown disabled="bucketList.length === 0" items="bucketList" selected-item="replicationObj.destinationBucket" placeholder="{{ \'replication.placeholder.destinationbucket\' | translate }}" filter="true"></dropdown>\n                        </awsui-control-group>\n                    </div>\n                    <div class="bottom-section">\n                        <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED && replicationObj.replicationType === \'bucket\'" label="{{ \'replication.label.storageclass\' | translate }}">\n                            <awsui-select ng-change="resetError()" placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-model="replicationObj.storageClass" items="storageClasses"></awsui-select>\n                        </awsui-control-group>\n                        <awsui-expandable-section class="collapsable-section" header="{{ \'replication.label.currentprefixes\' | translate }}" ng-if="cardOpen && replicationObj.replicationType === \'prefix\' && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED">\n                            <div class="replication-table-v1">\n                                <table class="table table-condensed">\n                                    <thead>\n                                    <tr>\n                                        <td></td>\n                                        <td translate="">replication.table.prefix</td>\n                                        <td translate="">replication.table.storageclass</td>\n                                        <td></td>\n                                    </tr>\n                                    </thead>\n                                    <tbody>\n                                    <tr class="add-rule">\n                                        <td colspan="2" ng-click="addRule($event)">{{ \'replication.table.add\' | translate }}</td>\n                                        <td></td>\n                                        <td></td>\n                                    </tr>\n                                    <tr ng-repeat="rule in replicationObj.rulesArray" ng-click="editRule(rule, $event)">\n                                        <td>\n                                            <div ng-if="rule.status === S3Constants.REPLICATION.ENABLED && !rule.markedForDelete" class="card-enabled-icon rule-status" ng-click="toggleRuleStatus(rule, $event)"></div>\n                                            <div ng-if="rule.status === S3Constants.REPLICATION.DISABLED && !rule.markedForDelete" class="card-disabled-icon rule-status" ng-click="toggleRuleStatus(rule, $event)"></div>\n                                            <span ng-if="rule.markedForDelete" class="awsui-icon awsui-icon-bigger times-circle" ng-click="toggleRuleStatus(rule, $event)"></span>\n                                        </td>\n                                        <td ng-if="rule.isEditing && !rule.prefixError">\n                                            <awsui-textfield placeholder="{{ \'replication.placeholder.prefix\' | translate }}" ng-model="rule.prefix" ng-change="resetError()" ng-click="$event.stopPropagation()"></awsui-textfield>\n                                        </td>\n                                        <td ng-if="rule.isEditing && rule.prefixError">\n                                            <awsui-textfield class="verification-error-v1" placeholder="{{ \'replication.placeholder.prefix\' | translate }}" ng-change="resetError()" ng-model="rule.prefix" ng-click="$event.stopPropagation()"></awsui-textfield>\n                                        </td>\n                                        <td ng-if="rule.isEditing && !rule.storageError">\n                                            <awsui-select ng-change="resetError()" placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-click="$event.stopPropagation()" ng-model="rule.storageClass" items="storageClasses"></awsui-select>\n                                        </td>\n                                        <td ng-if="rule.isEditing && rule.storageError">\n                                            <awsui-select ng-change="resetError()" class="verification-error-v1" placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-click="$event.stopPropagation()" ng-model="rule.storageClass" items="storageClasses"></awsui-select>\n                                        </td>\n                                        <td ng-if="!rule.isEditing">\n                                            {{ rule.prefix }}\n                                        </td>\n                                        <td ng-if="!rule.isEditing">\n                                            {{ storageClassesMap[rule.storageClass] }}\n                                        </td>\n                                        <td>\n                                            <awsui-button icon="times-circle" variant="standalone-icon" ng-click="removeRule(rule, $event, true)"></awsui-button>\n                                        </td>\n                                    </tr>\n                                    </tbody>\n                                </table>\n                            </div>\n                        </awsui-expandable-section>\n                        <div class="section-header">\n                            <div></div>\n                        </div>\n                        <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED" label="{{ \'replication.label.selectrole\' | translate }}" class="crr-listrole">\n                            <awsui-select placeholder="{{ \'replication.placeholder.selectrole\' | translate }}" ng-model="replicationObj.role" items="iamRoles"></awsui-select>\n                        </awsui-control-group>\n                        <awsui-alert class="crr-listrole-error" header="Error" dismissible="false" type="error" ng-if="displayListRoleError()">{{listRoleError}}</awsui-alert>\n                    </div>\n                </div>\n            </awsui-radio-group>\n        </div>\n        <div class="awsui-row card-content-row">\n            <awsui-radio-group ng-if="cardOpen" ng-model="replicationObj.isEnabled">\n                <awsui-radio-button value="Disabled" label="{{ \'replication.label.disable\' | translate }}"></awsui-radio-button>\n                <div class="disabled-replication-content">\n                    <div>\n                        <awsui-button ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.DISABLED && !forCreateBucketModal" text="{{ \'replication.label.delete\' | translate }}" click="deletePressed()" variant="danger" disabled="!replicationObj.configExists" loading="deleting">\n                        </awsui-button>\n                    </div>\n                </div>\n            </awsui-radio-group>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert class="warning-box" ng-if="errorMessage &&  cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED" type="error">{{ errorMessage }}</awsui-alert>\n    </card-content>\n    <card-footer>\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button ng-if="cardOpen" text="{{ \'replication.label.cancel\' | translate }}" ng-click="cancelPressed($event)">\n            </awsui-button>\n            <awsui-button ng-if="cardOpen" text="{{ \'replication.label.save\' | translate }}" ng-click="savePressed($event)" variant="primary" loading="cardState.isSaving" data-disabled="isDisable()">\n            </awsui-button>\n        </div>\n    </card-footer>\n</card>');a.put("/s3/partials/search.html",'<div class="object-search">\n    <div>\n        <div ng-repeat="prefixFilter in filters.prefixFilters track by $index" class="search-filter">\n            <span class="filter-identifier" translate="prefixsearch.identifier"></span>\n            <span class="filter-value">{{prefixFilter}}</span>\n            <span class="search-filter-cancel-button blue-cancel-icon" ng-click="removePrefixFilter(prefixFilter)"></span>\n        </div>\n        <div ng-repeat="tagFilter in filters.tagFilters track by $index" class="search-filter" ng-if="objectTaggingEnabled">\n            <span class="filter-identifier" translate="tagsearch.identifier"></span>\n            <span class="filter-value">{{tagFilter.tagKey}} | {{tagFilter.tagVal}}</span>\n            <span class="search-filter-cancel-button blue-cancel-icon" ng-click="removeTagFilter(tagFilter)"></span>\n        </div>\n        <div ng-repeat="accessFilter in filters.accessFilters track by $index" class="search-filter">\n            <span class="filter-identifier" translate="accesssearch.identifier"></span>\n            <span class="filter-value">{{accessFilter}}</span>\n            <span class="search-filter-cancel-button blue-cancel-icon" ng-click="removeAccessFilter(accessFilter)"></span>\n        </div>\n    </div>\n    <div class="searchbox-dropdown" clickoutside="" on-click-outside="clickedOutside">\n        <div id="search-box" class="search-box">\n            <span class="search-icon" ng-if="!noBackendCalls"><i class="awsui-icon search"></i></span>\n            <span>\n                <span ng-show="shouldShowTag()" class="show-tag" translate="tagsearch.tag"></span>\n                <input type="text" class="input-field" id="get-filter-value" ng-trim="false" ng-model="filters.input" ng-keydown="filterKeyDown($event)" ng-keyup="filterKeyUp($event)" ng-focus="openDropdown()" placeholder="{{getInputPlaceholder()}}" focus-when="prefixSearchInput">\n                \n            </span>\n        </div>\n        <div ng-show="dropdownOpen" id="search-dropdown">\n            <div ng-show="isSearchEmpty() && !isLambPage" class="search-instruction" ng-class="{\'filter-instruction\':noBackendCalls}">\n                {{inputDropdownText}}\n            </div>\n            <div ng-if="isLambPage" fac-id="s3-access">\n                <div class="search-instruction access-heading"><translate>accesssearch.text</translate></div>\n                <div class="search-instruction option" ng-click="accessSearch()"><translate>accesssearch.publicreadwriteaccess</translate></div>\n                <div class="search-instruction suboption" ng-click="accessSearch(\'read\')"><translate>accesssearch.publicreadaccess</translate></div>\n                <div class="search-instruction suboption" ng-click="accessSearch(\'write\')"><translate>accesssearch.publicwriteaccess</translate></div>\n            </div>\n            <div ng-show="!isSearchEmpty() && shouldShowTag() && !isLambPage" ng-click="tagSearch(true)" class="search-instruction" translate="tagsearch.entervalue" ng-if="objectTaggingEnabled">\n            </div>\n            <div ng-show="!isSearchEmpty() && !shouldShowTag() && !isLambPage">\n                <div class="search-option" id="prefixsearch-enter" ng-class="{\'search-option-selected\' : !tagSearchSelected}" ng-click="prefixSearch()" ng-mouseenter="highlightRow(false)" translate="{{tagSearchSelected ? \'prefixsearch.not.enter\' : \'prefixsearch.enter\'}}" translate-values="{ filterInput : filters.input }">\n                </div>\n                <div class="search-option" id="tagsearch-enter" ng-class="{\'search-option-selected\' : tagSearchSelected}" ng-click="selectTag()" ng-mouseenter="highlightRow(true)" translate="{{tagSearchSelected ? \'tagsearch.enter\' : \'tagsearch.not.enter\'}}" translate-values="{ filterInput : filters.input }" ng-if="objectTaggingEnabled">\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="search-prefix-info" ng-if="prefixInfo" translate="" translate-values="{ bucket1 : bucketName + \'/\' + prefixInfo, bucket2: bucketName + prefixInfo }">prefixsearch.validation.slash.start.warning\n    </div>\n    <awsui-control-group validation-message="{{searchError}}" id="search-validation"></awsui-control-group>\n</div>');a.put("/s3/partials/storageConsoleLineChartAnalytics.html",'<div class="line-chart-container">\n  <div class="analytics-line-chart-heading">{{ heading }}</div>\n  <div id="{{ chartid }}" class="chartgraph"></div>\n</div>');a.put("/s3/partials/storageConsoleLineChartS3.html",'<div class="line-chart-container">\n  <div class="metrics-line-chart-heading">{{ heading }}</div>\n  <div id="{{ chartid }}" class="chartgraph"></div>\n</div>');a.put("/s3/partials/storagemanagement.html",'<div class="storage-management-container">\n    <awsui-button-group class="si-category-buttons">\n        <awsui-tooltip text="{{\'management.view.tooltip.lifecycle\'|translate}}" position="top">\n            <awsui-button id="lifecycle-tab" class="si-action-button" text="{{ \'management.view.lifecycle\' | translate }}" ng-click="showView(S3Constants.MANAGEMENT.VIEWS.LIFECYCLE)" variant="{{ viewId.value === S3Constants.MANAGEMENT.VIEWS.LIFECYCLE ? \'primary\' : \'\' }}">\n            </awsui-button>\n        </awsui-tooltip>\n        <awsui-tooltip text="{{\'management.view.tooltip.replication\'|translate}}" position="top">\n            <awsui-button id="replication-tab" class="si-action-button" text="{{ \'management.view.replication\' | translate }}" ng-click="showView(S3Constants.MANAGEMENT.VIEWS.REPLICATION)" variant="{{ viewId.value === S3Constants.MANAGEMENT.VIEWS.REPLICATION ? \'primary\' : \'\' }}" fac-id="s3-crr-v2">\n            </awsui-button>\n        </awsui-tooltip>\n        <awsui-tooltip text="{{\'management.view.tooltip.analytics\'|translate}}" position="top">\n            <awsui-button id="analytics-tab" class="si-action-button" text="{{ \'management.view.analytics\' | translate }}" ng-click="showView(S3Constants.MANAGEMENT.VIEWS.ANALYTICS)" variant="{{ viewId.value === S3Constants.MANAGEMENT.VIEWS.ANALYTICS ? \'primary\' : \'\' }}" fac-id="s3-an"></awsui-button>\n        </awsui-tooltip>\n        <awsui-tooltip text="{{\'management.view.tooltip.metrics\'|translate}}" position="top">\n            <awsui-button id="cloudwatch-tab" class="si-action-button" text="{{ \'management.view.metrics\' | translate }}" variant="{{ viewId.value === S3Constants.MANAGEMENT.VIEWS.CLOUDWATCH ? \'primary\' : \'\' }}" ng-click="showView(S3Constants.MANAGEMENT.VIEWS.CLOUDWATCH)" fac-id="s3-me"></awsui-button>\n        </awsui-tooltip>\n        <awsui-tooltip text="{{\'management.view.tooltip.inventory\'|translate}}" position="top">\n            <awsui-button id="inventory-tab" class="si-action-button" text="{{ \'management.view.inventory\' | translate }}" variant="{{ viewId.value === S3Constants.MANAGEMENT.VIEWS.INVENTORY ? \'primary\' : \'\' }}" ng-click="showView(S3Constants.MANAGEMENT.VIEWS.INVENTORY)" fac-id="s3-oi"></awsui-button>\n        </awsui-tooltip>\n    </awsui-button-group>\n\n    <bucket-lifecycle ng-if="viewEnabled(S3Constants.MANAGEMENT.VIEWS.LIFECYCLE)"></bucket-lifecycle>\n    <bucket-replication ng-if="viewEnabled(S3Constants.MANAGEMENT.VIEWS.REPLICATION)"></bucket-replication>\n    <analytics view-id="viewId" ng-if="viewEnabled(S3Constants.MANAGEMENT.VIEWS.ANALYTICS)"></analytics>\n    <cloudwatch-metrics ng-if="viewEnabled(S3Constants.MANAGEMENT.VIEWS.CLOUDWATCH)"></cloudwatch-metrics>\n    <bucket-reports ng-if="viewEnabled(S3Constants.MANAGEMENT.VIEWS.INVENTORY)"></bucket-reports>\n\n</div>');a.put("/s3/partials/storagemetrics.html",'<div>\n    <div class="clearfix"></div>\n    <div class="metrics-table">\n        <table>\n            <tr ng-repeat="metric in metricList">\n                <td>\n                    <div class="storage-management-error-box">\n                        <awsui-alert type="error" header="{{\'error.header\'|translate}}" visible="metric.error">\n                            {{metric.error}}\n                        </awsui-alert>\n                    </div>\n                    <div ng-if="metric.statistics.Datapoints">\n                        <div class="cloudwatch-link">\n                            <awsui-button target="_blank" href="{{deepLinks[$index]}}" variant="link" icon="external-link" ng-click="cloudwatchLinkClicked()">\n                                <span translate="">management.metrics.cloudwatch</span>\n                            </awsui-button>\n                        </div>\n                        <div class="svg-chart-container">\n                            <storage-console-line-chart chartid="metric.chartId" data="metric.statistics.Datapoints" heading="metric.heading" isxdate="true" xid="timestamp" xscaleby="1000" yid="metric.statistic" xmin="metric.startTime" xmax="metric.endTime" totalwidth="940" totalheight="400" template-url="partials/storageConsoleLineChartS3.html">\n                            </storage-console-line-chart>\n                        </div>\n                        <div class="dimensions">\n                            <div class="square"></div>\n                            <span class="dimension-labels" ng-repeat="label in getChartLabels(metric)">{{ label }}</span>\n                            <div class="dimension-labels-stat">\n                                <span>\n                                    (<span translate="management.metric.statistic.{{metric.statistic.toLowerCase()}}"></span>)\n                                </span>\n                            </div>\n                        </div>\n                        <hr class="hr-props">\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>');a.put("/s3/partials/targetmbox.html",'\n<div ng-if="mBoxContent.length === 0">\n  <div class="js-mbox" data-mbox="en_s3_ed_1">\n    <div>{{ \'notification.text\' | translate }}</div>\n  </div>\n</div>\n\n<div ng-if="mBoxContent.length > 0">\n  <div class="js-mbox" data-mbox="en_s3_ed_1" ng-bind-html="mBoxContent | trusted" ng-style="{\'visibility\': \'visible\'}"></div>\n</div>\n \n<div ng-if="showDefault" class="mbox-default">\n  <div>{{ \'notification.text\' | translate }}</div>\n</div>');a.put("/s3/partials/updateobject.html",'<awsui-textfield class="input-text new-folder-input" ng-model="updateObject.name" ng-keypress="triggerKeyboardEvt($event)" value="{{defaultValue}}" placeholder="{{defaultPlaceholder}}" ng-click="$event.stopPropagation();" ng-dblclick="$event.stopPropagation();" auto-focus="true">\n</awsui-textfield>\n<div ng-if="showEncryptionModal" class="folder-encryption">\n    <div class="create-folder-encryption-blurb">{{\'createfolder.defaultencryption.blurb\' | translate}}</div>\n    <div>\n        <awsui-radio-group value="{{defaultEncryption.encryption}}" ng-model="defaultEncryption.encryption" ng-change="updateKMSKey(defaultEncryption.encryption)">\n            <div ng-repeat="encryption in encryptionOptions">\n                <awsui-radio-button class="encryption-radio-btn" value="{{encryption.value}}" label="{{encryption.text}}" ng-class="{ \'no-description\': !encryption.description }"></awsui-radio-button>\n                <p class="default-encryption-description" ng-if="encryption.description">{{encryption.description}}</p>\n                <div ng-if="encryption.text === encryptionConstants.AWSKMS && defaultEncryption.encryption === encryptionConstants.AWSKMS" class="kms-arn-selector">\n                    <awsui-control-group validation-message="{{ KMSServiceError }}">\n                        <dropdown items="kmsKeys" placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled="KMSServiceError" selected-item="defaultEncryption.kmsId" filter="true" dropdown-disabled="true">\n                        </dropdown>\n                    </awsui-control-group>\n                    <awsui-textfield class="custom-kms-arn" ng-if="defaultEncryption.encryption===encryptionConstants.AWSKMS && defaultEncryption.kmsId.value===encryptionConstants.CUSTOM_ARN" ng-model="defaultEncryption.customKMSARN"></awsui-textfield>\n                </div>\n            </div>\n        </awsui-radio-group>\n    </div>\n</div>\n<awsui-alert class="input-error" type="error" header="{{ \'error.header\' | translate}}" ng-show="updateObject.errorMessage">{{updateObject.errorMessage}}</awsui-alert>\n<div class="create-folder-btn" ng-class="{ \'create-folder-default-encryption-btn\' : showFolderEncryption }">\n    <awsui-button text="{{ \'updateobject.button.save\' | translate}}" ng-click="triggerAction($event)" ng-dblclick="$event.stopPropagation();" data-disabled="shouldDisableSave()"></awsui-button>\n    <awsui-button text="{{ \'updateobject.button.cancel\' | translate}}" ng-dblclick="$event.stopPropagation();" ng-click="resetOperationState($event, true)"></awsui-button>\n</div>');a.put("/s3/partials/upload.html",'<modal is-open="modalOpen" close-callback="closeModal" id="uploadModal" current-path="currentPath" steps="STEP" state="state" header-title="headerTitle" next-state="nextState" previous-state="previousState" set-state="setState" class="upload-modal">\n    <modal-content>\n        <div class="upload-modal-selected-files-properties" ng-show="haveSelectedItems() && state !== STEP.REVIEW">\n            <div class="upload-modal-selected-files-properties-inner-div truncate">\n                <span class="upload-modal-selected-files-properties-span">\n                    {{ getSelectedFilesData().files }} <span translate="uploadmodal.label.files"></span>\n                </span>\n                <span class="upload-modal-selected-files-properties-span">\n                    <span class="upload-modal-selected-files-properties-span-header" translate="uploadmodal.label.size"></span> {{ getSelectedFilesData().size | humanReadableBytes }}\n                </span>\n                <span class="upload-modal-selected-files-properties-span">\n                    <span class="upload-modal-selected-files-properties-span-header" translate="uploadmodal.label.path"></span> {{ currentPath }}\n                </span>\n            </div>\n        </div>\n        <div class="upload-modal-content">\n            <div ng-if="state === STEP.SELECT_FILES">\n                <div id="upload-modal-initial-select" ng-show="!haveSelectedItems()">\n                    <div class="file-and-folder drag-and-drop-image"></div>\n                    <div ng-if="isDragAndDropAvailable()" class="drag-and-drop-text" translate="uploadmodal.label.draganddrop"></div>\n                    <div ng-if="!isDragAndDropAvailable()" class="drag-and-drop-no-text"></div>\n                    <input type="file" id="uploadInput" name="uploadInput" fileread="" multiple="multiple">\n                    <label id="uploadInputNoFilesSelected" for="uploadInput">{{ \'uploadmodal.label.add.files\' | translate }}</label>\n                </div>\n\n                <label ng-if="!haveSelectedItems() && !isDragAndDropAvailable()" class="drag-and-drop-info" translate="uploadmodal.label.draganddropinfo"></label>\n                <awsui-alert type="error" header="Error" ng-show="errorMessage">\n                    {{ errorMessage }}\n                </awsui-alert>\n\n                <file-list-in-modal remove-item-from-upload="removeItemFromUpload(item)" close-icon-show="true" for-uploads="true" selected="selected"></file-list-in-modal>\n            </div>\n\n            \n            <div ng-if="state === STEP.PERMISSIONS" class="upload-modal-permissions-content">\n                <modal-permissions public-permissions="options.permissions.publicPermissions" user-permissions="options.permissions.userPermissions" aws-account-permissions="options.permissions.awsAccountPermissions" is-adding-account="isAddingAwsAccountAcl" modal-type="MODAL_TYPE.UPLOAD"></modal-permissions>\n            </div>\n            \n            <div ng-if="state === STEP.PROPERTIES" class="upload-modal-property-content">\n                <div class="upload-modal-properties-group">\n                    <div>\n                        <h2 class="upload-modal-properties-group-header" translate="uploadmodal.label.storage-class"></h2>\n                    </div>\n                    <h2 class="upload-modal-properties-group-desc" translate="uploadmodal.properties.storage.description"></h2>\n                    <awsui-radio-group ng-model="options.storageClass" ng-init="setStorageClassOption()">\n                        <table class="upload-modal-radio-button-properties">\n                            <tr>\n                                <td>\n                                    <awsui-radio-button class="radio-button" value="STANDARD">{{ \'uploadmodal.label.standard\' | translate }}</awsui-radio-button>\n                                </td>\n                                <td>\n                                    <awsui-radio-button class="radio-button" value="STANDARD_IA">{{ \'uploadmodal.label.standard_ia\' | translate }}</awsui-radio-button>\n                                </td>\n                                <td fac-id="s3-rrs">\n                                    <awsui-radio-button class="radio-button" value="REDUCED_REDUNDANCY">{{ \'uploadmodal.label.reduced_redundancy\' | translate }}</awsui-radio-button>\n                                </td>\n                            </tr>\n                        </table>\n                    </awsui-radio-group>\n\n                </div>\n\n                <div class="upload-modal-properties-group">\n                    <div>\n                        <h2 class="upload-modal-properties-group-header" translate="uploadmodal.label.encryption"></h2>\n                    </div>\n                    <h2 class="upload-modal-properties-group-desc" translate="uploadmodal.properties.encryption.description"></h2>\n                        <awsui-radio-group ng-model="options.serverSideEncryption" ng-init="setEncryptionOption()" ng-change="updateKMSKey(options.serverSideEncryption)">\n                        <table class="upload-modal-radio-button-properties">\n                            <tr>\n                                <td fac-id="s3-no-enc">\n                                    <awsui-radio-button class="radio-button with-info" value="{{S3Constants.OBJECT_SSE.NONE}}">{{ \'uploadmodal.label.none\' | translate }}</awsui-radio-button>\n                                    <awsui-tooltip text="{{ \'uploadmodal.properties.defaultencryption.info\' | translate }}" position="bottom" size="small">\n                                        <i class="awsui-icon info-circle awsui-icon-link"></i>\n                                    </awsui-tooltip>\n                                </td>\n                                <td>\n                                    <awsui-radio-button class="radio-button" value="{{S3Constants.OBJECT_SSE.AES256}}">{{ \'uploadmodal.label.AES256\' | translate }}</awsui-radio-button>\n                                </td>\n                                <td fac-id="s3-kms">\n                                    <awsui-radio-button class="radio-button" value="{{S3Constants.OBJECT_SSE.KMS_ENCRYPTION}}">{{ \'uploadmodal.label.kms\' | translate }}</awsui-radio-button>\n                                </td>\n                            </tr>\n                        </table>\n                    </awsui-radio-group>\n                    <awsui-control-group validation-message="{{ KMSServiceError }}">\n                        <awsui-select ng-if="options.serverSideEncryption===S3Constants.OBJECT_SSE.KMS_ENCRYPTION" items="kmsKeys" placeholder="{{ \'uploadmodal.placeholder.kmskeys\' | translate }}" data-disabled="KMSServiceError" ng-model="options.kmsId" class="upload-modal-properties-kms-dropdown">\n                        </awsui-select>\n                    </awsui-control-group>\n                    <awsui-textfield class="upload-modal-kms-textfield" ng-if="options.kmsId===\'CUSTOM_ARN\'" ng-model="options.kmsARN"></awsui-textfield>\n                </div>\n\n                <div class="upload-modal-properties-group">\n                    <div>\n                        <h2 class="upload-modal-properties-group-header" translate="uploadmodal.label.metadata"></h2>\n                    </div>\n                    <h2 class="upload-modal-properties-group-desc" translate="uploadmodal.properties.metadata.description"></h2>\n                    <table class="upload-modal-metadata-properties">\n                        <thead>\n                        <th class="header-key" translate="uploadmodal.metadata.label.header"></th>\n                        <th class="header-value" translate="uploadmodal.metadata.label.value"></th>\n                        <th></th>\n                        </thead>\n\n                        <tbody>\n\n                        <tr ng-repeat="(key, value) in options.displayMetadata">\n                            <td> {{ key }}</td>\n                            <td> {{ value }}</td>\n                            <td></td>\n                            <td>\n                                <awsui-button variant="standalone-icon" icon="times" ng-click="deleteMetadataHeader(key)"></awsui-button>\n                            </td>\n                        </tr>\n                        <tr class="upload-modal-metadata-properties-textfield">\n                            <td class="uploadmodal-metadata-key">\n                                <awsui-control-group validation-message="{{ tmpMetadata.metadataKey.error }}">\n                                    <dropdown items="predefinedMetadata" selected-item="tmpMetadata.metadataKey" filter="true" placeholder="{{ \'objectdetail.metadata.key-placeholder\' | translate }}"></dropdown>\n                                </awsui-control-group>\n                            </td>\n                            <td class="uploadmodal-metadata-value">\n                                <awsui-control-group validation-message="{{ tmpMetadata.metadataValue.error || tmpMetadata.metadataValue.inputError }}">\n                                    <dropdown ng-if="tmpMetadata.metadataKey.dropDownValue && tmpMetadata.metadataKey.dropDownValue.length > 2" items="tmpMetadata.metadataKey.dropDownValue" selected-item="tmpMetadata.metadataValue" enable-input="true" filter="true" input-field="tmpMetadata.metadataValue" placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}">\n                                    </dropdown>\n                                    <dropdown ng-if="tmpMetadata.metadataKey.dropDownValue && tmpMetadata.metadataKey.dropDownValue.length <= 2" items="tmpMetadata.metadataKey.dropDownValue" selected-item="tmpMetadata.metadataValue" enable-input="true" input-field="tmpMetadata.metadataValue" placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}">\n                                    </dropdown>\n                                    <awsui-textfield ng-if="tmpMetadata.metadataKey && !tmpMetadata.metadataKey.dropDownValue" ng-model="tmpMetadata.metadataValue.text" ng-change="clearMetadataErrorMsg(tmpMetadata.metadataValue)"></awsui-textfield>\n                                </awsui-control-group>\n                            </td>\n                            <td class="uploadmodal-metadata-savebutton">\n                                <awsui-button text="{{ \'uploadmodal.metadata.savebutton\' | translate }}" variant="normal" ng-click="addMetadataOptionsHeader(tmpMetadata)" data-disabled="!tmpMetadata.metadataKey">\n                                </awsui-button>\n                            </td>\n                            <td class="uploadmodal-metadata-savebutton">\n                                <awsui-button text="{{ \'uploadmodal.metadata.clearbutton\' | translate }}" variant="normal" ng-click="resetMetadataOptionsHeader()" data-disabled="!tmpMetadata.metadataKey">\n                                </awsui-button>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td colspan="4">\n                                <awsui-alert class="input-error" type="error" header="{{ \'error.header\' | translate }}" ng-if="metadataErrorMsg">\n                                    <p translate="objectdetail.metadata.multisamekeywarning" translate-values="{ errorMsg : \'{{metadataErrorMsg}}\' }"></p>\n                                </awsui-alert>\n                                <awsui-alert class="input-error" header="{{ \'warning.header\' | translate }}" visible="metadataWarningMsg" type="error"> {{ metadataWarningMsg }}</awsui-alert>\n                            </td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <div class="upload-modal-properties-group uploadmodal-tags" fac-id="s3-ot">\n                    <h2 class="upload-modal-properties-group-header" translate="uploadmodal.label.tags"></h2>\n                    <h2 class="upload-modal-properties-group-desc" translate="uploadmodal.tags.description"></h2>\n                    <table class="upload-modal-tag-properties">\n                        <thead>\n                            <th translate="uploadmodal.tags.label.header" class="header-key"></th>\n                            <th translate="uploadmodal.tags.label.value" class="header-value"></th>\n                            <th></th>\n                        </thead>\n\n                        <tbody>\n                        <tr ng-repeat="(key, value) in options.tags">\n                            <td> {{ key }}</td>\n                            <td> {{ value }}</td>\n                            <td></td>\n                            <td>\n                                <awsui-button variant="standalone-icon" icon="times" ng-click="deleteTag(key)"></awsui-button>\n                            </td>\n                        </tr>\n                        <tr class="upload-modal-tags-textfield">\n                            <td>\n                                <awsui-control-group>\n                                    <awsui-textfield ng-model="currentTagging.key" placeholder="{{ \'uploadmodal.tags.placehoder.key\' | translate }}" ng-change="updateTaggingError(currentTagging.key)">\n                                    </awsui-textfield>\n                                </awsui-control-group>\n                            </td>\n                            <td class="tagvalue">\n                                <awsui-textfield ng-model="currentTagging.value" placeholder="{{ \'uploadmodal.tags.placehoder.value\' | translate }}">\n                                </awsui-textfield>\n                            </td>\n                            <td class="tagvalue">\n                                <awsui-button text="{{ \'uploadmodal.metadata.savebutton\' | translate }}" variant="normal" ng-click="addTag(currentTagging.key, currentTagging.value)" data-disabled="!currentTagging.key">\n                                </awsui-button>\n                            </td>\n                            <td class="uploadmodal-metadata-savebutton">\n                                <awsui-button text="{{ \'uploadmodal.metadata.clearbutton\' | translate }}" variant="normal" ng-click="resetTagKeyValue()" data-disabled="!currentTagging.key">\n                                </awsui-button>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td colspan="4">\n                                <awsui-alert class="input-error" header="{{ \'warning.header\' | translate }}" visible="taggingError" type="error"> {{ taggingError }}</awsui-alert>\n                            </td>\n                        </tr>\n                        </tbody>\n                    </table>\n\n                </div>\n            </div>\n            \n            <div ng-if="state === STEP.REVIEW">\n                <div class="review-section">\n                    <table id="review-table" class="review-table">\n                        <tr>\n                            <td class="review-subheader" translate="uploadmodal.label.files"></td>\n                            <td class="edit-button">\n                                <awsui-button class="button-in-darkbg" text="{{ \'uploadmodal.label.edit\' | translate }}" variant="link" ng-click="setState(STEP.SELECT_FILES)">\n                                </awsui-button>\n                            </td>\n                        </tr>\n                    </table>\n                    <table class="review-table-details">\n                        <tr class="details">\n                            <td>{{ getSelectedFilesData().files }} <span translate="uploadmodal.label.files"></span>\n                            </td>\n                            <td><span translate="uploadmodal.label.size"></span> {{ getSelectedFilesData().size |\n                                humanReadableBytes }}\n                            </td>\n                        </tr>\n                    </table>\n                </div>\n                <div class="review-section">\n                    <table class="review-table">\n                        <tr>\n                            <td class="review-subheader" translate="uploadmodal.label.permissions"></td>\n                            <td class="edit-button">\n                                <awsui-button class="button-in-darkbg" text="{{ \'uploadmodal.label.edit\' | translate }}" variant="link" ng-click="setState(STEP.PERMISSIONS)">\n                                </awsui-button>\n                            </td>\n                        </tr>\n                    </table>\n                    <table class="review-table-details">\n                        <tr class="details">\n                            <td>{{ getGranteeCount() }} <span translate="uploadmodal.label.grantees"></span></td>\n                        </tr>\n                    </table>\n                </div>\n                <div class="review-section">\n                    <table class="review-table">\n                        <tr>\n                            <td class="review-subheader" translate="uploadmodal.label.properties"></td>\n                            <td class="edit-button">\n                                <awsui-button class="button-in-darkbg" text="{{ \'uploadmodal.label.edit\' | translate }}" variant="link" ng-click="setState(STEP.PROPERTIES)">\n                                </awsui-button>\n                            </td>\n                        </tr>\n                    </table>\n                    <table class="review-table-details">\n                        <tr class="detail-name">\n                            <th translate="uploadmodal.label.encryption"></th>\n                            <th translate="uploadmodal.label.storage-class"></th>\n                        </tr>\n                        <tr class="details">\n                            <td>{{ getEncryptionTranslation() }}</td>\n                            <td>{{ getStorageClassTranslation() }}</td>\n                        </tr>\n                        <tr class="detail-name">\n                            <th class="awsui-util-pt-m" translate="uploadmodal.label.metadata"></th>\n                            <th></th>\n                        </tr>\n                        <tr class="details" ng-repeat="(key, value) in options.displayMetadata">\n                            <td>{{ key }}</td>\n                            <td>{{ value }}</td>\n                        </tr>\n                        <tr class="detail-name" fac-id="s3-ot">\n                            <th class="awsui-util-pt-m" translate="uploadmodal.label.tags"></th>\n                            <th></th>\n                        </tr>\n                        <tr class="details" ng-repeat="(key, value) in options.tags" fac-id="s3-ot">\n                            <td>{{ key }}</td>\n                            <td>{{ value }}</td>\n                        </tr>\n                    </table>\n                </div>\n                <div ng-show="completedFiles.length > 0">\n                    <h3>Uploaded File(s):</h3>\n                    <table class="table table-striped">\n                        <thead>\n                        <tr>\n                            <th>Name</th>\n                            <th>Etag</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <tr ng-repeat="uploadResult in completedFiles">\n                            <td>{{ uploadResult.name }}</td>\n                            <td>{{ uploadResult.etag }}</td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <div ng-show="errorFiles.length > 0">\n                    <h3>File(s) That Had Errors:</h3>\n                    <table class="table table-striped">\n                        <thead>\n                        <tr>\n                            <th>Name</th>\n                            <th>Error</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <tr ng-repeat="uploadResult in errorFiles">\n                            <td>{{ uploadResult.name }}</td>\n                            <td>{{ uploadResult.errorMessage }}</td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <awsui-alert type="error" header="Error" ng-show="errorMessage">\n                    {{ errorMessage }}\n                </awsui-alert>\n            </div>\n        </div>\n    </modal-content>\n    <modal-footer>\n        <div class="upload-modal-footer">\n            <awsui-button text="{{ \'uploadmodal.footer.upload\' | translate }}" variant="primary" ng-class="{\'awsui-util-f-l\': state !== STEP.REVIEW, \'awsui-util-f-r primary-button\': state === STEP.REVIEW}" click="uploadNow()" data-disabled="uploadDisabled">\n            </awsui-button>\n            <awsui-button id="next" ng-if="state !== STEP.REVIEW" variant="primary" text="{{ \'uploadmodal.footer.next\' | translate }}" class="awsui-util-f-r primary-button" click="goToNextState()" data-disabled="!haveSelectedItems() || metadataErrorMsg || tmpMetadata.metadataKey && tmpMetadata.metadataKey.error || tmpMetadata.metadataValue && tmpMetadata.metadataValue.inputError">\n            </awsui-button>\n            <awsui-button id="previous" text="{{ \'uploadmodal.footer.previous\' | translate }}" ng-if="state !== STEP.SELECT_FILES" class="awsui-util-f-r" click="previousState()">\n            </awsui-button>\n        </div>\n    </modal-footer>\n</modal>');a.put("/s3/partials/versionsdropdown.html",'<div class="versions-dropdown" ng-class="{\'objects-side-panel-versions\': objectsPage}" ng-if="showVersionsDropdown.show == true" clickoutside="" on-click-outside="closeDropdown">\n    <table>\n        <tr class="version-row" ng-repeat="version in versions track by version.VersionId" ng-click="switchVersion($event, version)">\n            <td class="version-file-icon"><span class="awsui-icon awsui-icon-big" ng-class="version.fileIconClass"></span></td>\n            <td class="version-date">\n                {{version.LastModified | date: dateFormat}}\n                <span class="date-subtext" ng-if="version.IsLatest === \'true\' && version.ETag">\n                    (<span translate="versionsdropdown.label.latestVersion"></span>)\n                </span>\n                <span class="date-subtext" ng-if="!version.ETag">\n                    (<span translate="versionsdropdown.label.deleteMarker"></span>)\n                </span>\n            </td>\n            <td class="version-storage-class">{{version.StorageClass}}</td>\n            <td class="version-download-icon">\n                <span class="awsui-icon awsui-icon-big download" ng-class="{\'awsui-icon-link\':!version.downloadDisabled, \'awsui-icon-disabled\':version.downloadDisabled}" ng-click="downloadVersion($event, version)"></span>\n            </td>\n            <td class="version-delete-icon"><span class="awsui-icon awsui-icon-big trash-o" ng-class="{\'awsui-icon-link\':!version.deleteDisabled, \'awsui-icon-disabled\':version.deleteDisabled}" ng-click="deleteVersion($event, version)"></span></td>\n        </tr>\n    </table>\n</div>')}]);"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};(function(){angular.module("s3").service("BucketPolicyService",["$filter","$q","$translate","APIProxyService","BucketPropertiesService","ConsoleOperation","S3Constants","SCLogService","UtilService",a]);function a(m,u,p,q,f,l,o,b,v){var n=new l(o.OPERATION_NAME.GET_BUCKET_POLICY);var t=new l(o.OPERATION_NAME.PUT_BUCKET_POLICY);var c=new l(o.OPERATION_NAME.LAMB);var w={createBucketPolicy:d,generateBucketPolicy:j,generateBucketPolicyWithArn:g};return w;function s(x){return q.listAllMyBuckets(c,true).then(function(z){b.log(o.OPERATION_NAME.LAMB,1,c);var y=z.response.ListAllMyBucketsResult.Buckets.Bucket;return y.some(function(A){return A.Name===x})})}function j(x,y){var z=JSON.stringify(y,null,"    ");z=z.replace(/ACCOUNT_ID/g,v.getUserAccountId());z=z.replace(/DESTINATION_BUCKET/g,x);return z}function g(x,A,y){var z=JSON.stringify(y,null,"    ");if(A){z=z.replace(/IAM_ARN/g,A)}if(x){z=z.replace(/DESTINATION_BUCKET_ARN/g,x)}return z}function d(A,y,x){var C=v.getUserAccountId();var z=o.MANAGEMENT.POLICY.STATUS.FAILED;var B="";return s(A).then(function(D){if(D){return f.getBucketPolicy(y,n,false).then(function(F){b.log(o.OPERATION_NAME.GET_BUCKET_POLICY,1,n);var H=k(C,F,A,y);var G=e(C,A,y);if(H.deny){z=o.MANAGEMENT.POLICY.STATUS.DENY;B=m("json")(G.Statement[0],o.MANAGEMENT.POLICY.SPACING);r(z,x,B);return z}else{if(H.needsPolicy){var E=function(){if(H.warn){z=o.MANAGEMENT.POLICY.STATUS.WARN;B=m("json")(G.Statement[0],o.MANAGEMENT.POLICY.SPACING);r(z,x,B);return{v:z}}var J=false;if(F&&F.Statement){if(H.existingStatement){i(C,A,H.existingStatement);B=m("json")(H.existingStatement,o.MANAGEMENT.POLICY.SPACING)}else{F.Statement.push(G.Statement[0]);B=m("json")(G.Statement[0],o.MANAGEMENT.POLICY.SPACING)}G=F;J=true}var I=m("json")(G,o.MANAGEMENT.POLICY.SPACING);return{v:f.putBucketPolicy(y,I,t).then(function(K){b.log(o.OPERATION_NAME.PUT_BUCKET_POLICY,1,t);if(J){z=o.MANAGEMENT.POLICY.STATUS.MODIFIED;r(z,x,B)}else{z=o.MANAGEMENT.POLICY.STATUS.CREATED;r(z,x,I)}return z})["catch"](function(K){b.log(o.OPERATION_NAME.PUT_BUCKET_POLICY,0,t);r(z,x,B);return u.reject(z)})}}();if((typeof E==="undefined"?"undefined":_typeof(E))==="object"){return E.v}}else{z=o.MANAGEMENT.POLICY.STATUS.FOUND}}r(z,x);return z})["catch"](function(E){b.log(o.OPERATION_NAME.GET_BUCKET_POLICY,0,n);h(C,A,y,z,x);return z})}else{h(null,A,y,z,x);return z}})["catch"](function(){b.log(o.OPERATION_NAME.LAMB,0,c);h(null,A,y,z,x);return z})}function h(D,A,x,z,y){var C=e(D,A,x);var B=m("json")(C,o.MANAGEMENT.POLICY.SPACING);r(z,y,B)}function i(C,A,z){var y=v.getBucketARN(A);var x=v.transformObjectToArray(z.Condition.StringEquals[o.MANAGEMENT.POLICY.ACCOUNT_KEY]);if(x.indexOf(C)===-1){x.push(C);z.Condition.StringEquals[o.MANAGEMENT.POLICY.ACCOUNT_KEY]=x}var B=v.transformObjectToArray(z.Condition.ArnLike[o.MANAGEMENT.POLICY.SOURCE_ARN]);if(B.indexOf(y)===-1){B.push(y);z.Condition.ArnLike[o.MANAGEMENT.POLICY.SOURCE_ARN]=B}}function e(C,B,x){var A=v.getBucketARN(B);var z=v.getBucketARN(x);var y={Id:o.MANAGEMENT.POLICY.ID+"-"+new Date().getTime(),Version:"2012-10-17",Statement:[{Sid:o.MANAGEMENT.POLICY.SID+"-"+new Date().getTime(),Effect:"Allow",Principal:{Service:"s3.amazonaws.com"},Action:["s3:PutObject"],Resource:[],Condition:{ArnLike:{"aws:SourceArn":[]},StringEquals:{"aws:SourceAccount":[],"s3:x-amz-acl":"bucket-owner-full-control"}}}]};y.Statement[0].Resource.push(z+"/*");y.Statement[0].Condition.ArnLike["aws:SourceArn"].push(A);if(C){y.Statement[0].Condition.StringEquals["aws:SourceAccount"].push(C)}else{y.Statement[0].Condition.StringEquals["aws:SourceAccount"].push(p.instant("bucketproperties.policy.auto.create.account.replace"))}return y}function k(D,C,B,y){var x={deny:false,existingStatement:null,needsPolicy:true,warn:false};var A=v.getBucketARN(B);var z=v.getBucketARN(y);if(!D){x.needsPolicy=false;return x}if(C){_.forEach(C.Statement,function(E){if(E.Principal&&v.checkValue(E.Principal.Service,o.MANAGEMENT.POLICY.SERVICE_VAL)&&v.checkValue(E.Action,o.MANAGEMENT.POLICY.ACTION)&&v.checkValue(E.Resource,z+"/*")){if(!E.Condition){if(E.Effect===o.MANAGEMENT.POLICY.DENY){x.deny=true}else{x.warn=true}}else{if(E.Condition.ArnLike&&E.Condition.StringEquals&&E.Condition.ArnLike[o.MANAGEMENT.POLICY.SOURCE_ARN]&&E.Condition.StringEquals[o.MANAGEMENT.POLICY.ACCOUNT_KEY]&&v.checkValue(E.Condition.StringEquals[o.MANAGEMENT.POLICY.X_AMZ_ACL_KEY],o.MANAGEMENT.POLICY.X_AMZ_ACL_VAL)){if(!(v.checkValue(E.Condition.ArnLike[o.MANAGEMENT.POLICY.SOURCE_ARN],A)&&v.checkValue(E.Condition.StringEquals[o.MANAGEMENT.POLICY.ACCOUNT_KEY],D))){if(E.Effect==="Deny"){x.deny=true}else{if(!x.existingStatement&&E.Sid.indexOf(o.MANAGEMENT.POLICY.SID)!==-1){x.existingStatement=E}}}else{if(E.Effect===o.MANAGEMENT.POLICY.DENY){x.deny=true}else{if(E.Sid.indexOf(o.MANAGEMENT.POLICY.SID)!==-1){x.needsPolicy=false}else{x.warn=true}}}}}}})}return x}function r(y,x){var z=arguments.length<=2||arguments[2]===undefined?"":arguments[2];x.policyType="info";x.policyHeader=p.instant("bucketproperties.policy.auto.create.success.header");x.policyDefinition=z;switch(y){case o.MANAGEMENT.POLICY.STATUS.CREATED:x.policyMessage=p.instant("bucketproperties.policy.auto.create.success.info");break;case o.MANAGEMENT.POLICY.STATUS.MODIFIED:x.policyHeader=p.instant("bucketproperties.policy.auto.modify.success.header");x.policyMessage=p.instant("bucketproperties.policy.auto.modify.success.info");break;case o.MANAGEMENT.POLICY.STATUS.FOUND:x.policyMessage="";x.policyHeader="";break;case o.MANAGEMENT.POLICY.STATUS.FAILED:x.policyHeader=p.instant("bucketproperties.policy.auto.create.error.header");x.policyMessage=p.instant("bucketproperties.policy.account.error.message");x.policyType="warning";break;case o.MANAGEMENT.POLICY.STATUS.WARN:x.policyHeader=p.instant("bucketproperties.policy.auto.create.warn.header");x.policyMessage=p.instant("bucketproperties.policy.auto.create.warn.message");x.policyType="warning";break;case o.MANAGEMENT.POLICY.STATUS.DENY:x.policyHeader=p.instant("bucketproperties.policy.auto.create.deny.header");x.policyMessage=p.instant("bucketproperties.policy.auto.create.deny.message");x.policyType="warning"}}}})();"use strict";(function(){angular.module("s3").directive("initiateRestoreModal",function(){return{scope:{isOpen:"=",countInfo:"=?",operation:"=?"},templateUrl:"/s3/partials/initiaterestore.html",controller:"InitiateRestoreController"}});angular.module("s3").controller("InitiateRestoreController",["$scope","$rootScope","$translate","$filter","APIProxyService","PathService","OperationDispatcherService","CountService","S3Constants","SCLogService","UtilService",function(n,h,o,l,p,c,f,g,m,b,r){var d="ttlObj";var j="ttlSize";var k=1;var i=2147483647;n.headerTitle=o.instant("initiaterestoremodal.header.title");n.params={};n.numOfDaysError=[];n.showBuyConfirmation=false;n.capacityUnitsAvailable=0;n.showCapacityInfo=false;n.capacityUnits=null;n.isPurchaseSuccessful=false;n.errorMessage=null;n.expeditedRetrieval=m.INITIATE_RESTORE.EXPEDITED_RETRIEVAL;n.capacityCost=null;n.learnMoreUrl=r.getPricingUrl();n.learnMoreDataRetrievalUrl=r.getDataRetrievalUrl();n.retrievalOptions=[{value:m.INITIATE_RESTORE.BULK_RETRIEVAL,text:o.instant("initiaterestoremodal.dropdown.bulkRetrieval")},{value:m.INITIATE_RESTORE.STANDARD_RETRIEVAL,text:o.instant("initiaterestoremodal.dropdown.standardRetrieval")},{value:m.INITIATE_RESTORE.EXPEDITED_RETRIEVAL,text:o.instant("initiaterestoremodal.dropdown.ExpeditedRetrieval")}];n.titles=[{txt:o.instant("initiaterestoremodal.titles.capacityId"),info:o.instant("initiaterestoremodal.capacityid.tooltip"),pos:"right"},{txt:o.instant("initiaterestoremodal.titles.purchaseDate"),info:o.instant("initiaterestoremodal.purchaseDate.tooltip"),pos:"right"},{txt:o.instant("initiaterestoremodal.titles.expirationDate"),info:o.instant("initiaterestoremodal.expirationDate.tooltip"),pos:"left"}];var a={flag:true,folders:0,objects:0,size:0,currLevelObjs:0,countResultEachFolder:{}};n.selected={selectedItems:{currFolderPathPrefix:n.operation.initialPath,folders:n.operation.selectedFolders,objects:n.operation.selectedKeys}};if(!n.countInfo||!n.countInfo.countFinish){n.countInfo=_.cloneDeep(a);n.isCounting={flag:false};n.$watch(function(){return n.countInfo},function(u,t){if(u!==t){angular.forEach(n.selected.selectedItems.folders,function(v){var w=n.countInfo.countResultEachFolder&&n.countInfo.countResultEachFolder[v.Prefix];if(w){v.objsCount=n.countInfo.countResultEachFolder[v.Prefix].count;v.folderSize=n.countInfo.countResultEachFolder[v.Prefix].totalSize}})}},true);g.countAllFiles(n.selected.selectedItems,n.countInfo,n.operation,n.isCounting)}else{angular.forEach(n.selected.selectedItems.folders,function(t){var u=n.countInfo.countResultEachFolder&&n.countInfo.countResultEachFolder[t.Prefix];if(u){t.objsCount=n.countInfo.countResultEachFolder[t.Prefix].count;t.folderSize=n.countInfo.countResultEachFolder[t.Prefix].totalSize}})}var q=function q(){var t={};p.getBucketLocation(n.operation,c.getCurrentBucket(),t).then(function(u){n.params.region=u.region;b.log("GetBucketLocation",1,n.operation);n.capacityCost=m.INITIATE_RESTORE.EXPEDITED_RETRIEVAL_COST[u.region]})["catch"](function(u){b.log("GetBucketLocation",0,n.operation,u)})};var s=function s(){p.listProvisionedCapacity(n.operation,c.getCurrentBucket(),n.params.region).then(function(t){b.log("ListProvisionedCapacity",1,n.operation);n.capacityUnits=_.map(t,function(u){return{id:u.CapacityId,purchaseDate:l("date")(u.StartDate,m.DATE_FORMAT),expirationDate:l("date")(u.ExpirationDate,m.DATE_FORMAT)}});n.capacityUnitsAvailable=n.capacityUnits.length})["catch"](function(t){n.retrievalError=r.handleErrors(t);b.log("ListProvisionedCapacity",0,n.operation,t)})};var e=function e(){n.isPurchasingCapacity=true;n.isPurchaseSuccessful=false;p.purchaseProvisionedCapacity(n.operation,c.getCurrentBucket(),n.params.region).then(function(t){b.log("PurchaseProvisionedCapacity",1,n.operation);n.isPurchaseSuccessful=true;n.showBuyConfirmation=false;s()})["catch"](function(t){n.retrievalError=r.handleErrors(t);b.log("PurchaseProvisionedCapacity",0,n.operation,t)})["finally"](function(){n.isPurchasingCapacity=false})};n.$watch("params.retrievalOption",function(t){n.retrievalError=null;if(t&&t.value===m.INITIATE_RESTORE.EXPEDITED_RETRIEVAL){n.showCapacityInfo=true;s()}else{n.showCapacityInfo=false}});n.validateNumOfDays=function(){if(isNaN(n.params.numOfDays)||parseInt(n.params.numOfDays)<k){n.numOfDaysError=[o.instant("initiaterestoremodal.invalidwarning")]}else{if(n.params.numOfDays>i){n.numOfDaysError=[o.instant("initiaterestoremodal.highernumbererror")]}else{n.numOfDaysError=[]}}};n.addCapacity=function(){n.showBuyConfirmation=true;n.isPurchaseSuccessful=false};n.buyCapacity=function(){e()};n.closeModal=function(){n.isOpen.flag=false;n.selected={selectedItems:{currFolderPathPrefix:"",folders:[],objects:[]}};n.countInfo=_.cloneDeep(a);n.countInfo.flag=false;n.operation=null;n.retrievalError=null};n.restore=function(){if(!n.params.numOfDays){n.numOfDaysError=[o.instant("initiaterestoremodal.emptywarning")]}else{if(!n.params.retrievalOption){n.retrievalError=o.instant("initiaterestoremodal.dropboxselectwarning")}else{n.operation.additionalInfo={expirationDays:n.params.numOfDays,numberOfKeysPerBulkOperation:m.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API,tier:n.params.retrievalOption.value};n.operation.totalObjectCount=n.countInfo.objects;b.log(n.operation.name.replace(/\s/g,"")+d,n.operation.totalObjectCount,n.operation);b.log(n.operation.name.replace(/\s/g,"")+j,n.countInfo.size,n.operation);f.addOperation(n.operation);n.closeModal()}}};q()}])})();"use strict";(function(){angular.module("s3").directive("bucketRequesterPays",[function(){return{restrict:"E",scope:{cardOpen:"=",id:"@?"},templateUrl:"/s3/partials/bucketrequesterpays.html",controller:"BucketRequesterPaysController"}}]);angular.module("s3").controller("BucketRequesterPaysController",["$scope","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","PathService","S3Constants","UtilService",a]);function a(k,b,c,d,g,i,e,j){k.docLink=c.getDocUrl(e.LEARN_MORE_LINKS.REQUESTER_PAYS);k.requesterPaysStates={enabled:"Requester",disabled:"BucketOwner"};k.error=null;k.requesterPays={};k.requesterPays.selectedValue=k.requesterPaysStates.disabled;k.scrollCardId="#"+k.id;k.cardSummaryObj=_.cloneDeep(e.CARD_SUMMARY_INIT);k.cardSummaryObj.activeSummary.text=b.instant("bucketproperties.requesterpays.cardsummary.enabled");k.cardSummaryObj.inactiveSummary.text=b.instant("bucketproperties.requesterpays.cardsummary.disabled");function l(){k.cardSummaryObj.isActive=k.requesterPays.selectedValue===k.requesterPaysStates.enabled}l();function h(){var m=i.getCurrentBucket();k.cardSummaryObj.isLoading=true;k.error=null;d.isRequesterPaysEnabled(m).then(function(n){k.requesterPays.selectedValue=n===true?k.requesterPaysStates.enabled:k.requesterPaysStates.disabled})["catch"](function(n){k.requesterPays.selectedValue=null;k.error=j.handleErrors(n)})["finally"](function(){k.cachedRequesterPays=angular.copy(k.requesterPays);l();k.cardSummaryObj.isLoading=false})}k.cancelBucketRequesterPays=function(m){j.analyticsTrackClick(e.ANALYTICS.CANCEL_REQUESTER_PAYS,e.ANALYTICS.DETAILS);m.stopPropagation();k.requesterPays=angular.copy(k.cachedRequesterPays);l();k.error=null;k.cardOpen=false};k.saveBucketRequesterPays=function(o){j.analyticsTrackClick(e.ANALYTICS.SAVE_REQUESTER_PAYS,e.ANALYTICS.DETAILS);o.stopPropagation();k.error=null;k.saving=true;var n=undefined;var m=null;var p=i.getCurrentBucket();if(k.requesterPays.selectedValue===k.requesterPaysStates.enabled){n=d.enableBucketRequestPayment;m=new g("enableBucketVersioning")}else{n=d.disableBucketRequestPayment;m=new g("disableBucketVersioning")}n(p,m).then(function(){k.cachedRequesterPays.selectedValue=angular.copy(k.requesterPays.selectedValue);k.cardOpen=false;k.error=null;l()})["catch"](function(q){k.error=q})["finally"](function(){k.saving=false;l()})};function f(){h()}f()}})();"use strict";(function(){angular.module("s3").constant("QuicksightConstants",{PARAM:{PARTNER_TYPE:"partner_type=",ACCOUNT_ID:"account_id=",USER_ID:"user_id=",BUCKET_NAME:"bucket_name=",CONFIG_TYPE:"config_type=",FILTER_ID:"filter_id=",FILE_PATH:"file_path=",PREFIX:"prefix=",TAG:"tag="},PARTNER_TYPE_VALUES:{S3_ANALYTICS:"s3_analytics"},CONFIG_TYPES:{STORAGE_CLASS_ANALYSIS:"Storage class analysis"},SN_INTEGRATION:"sn/partner-analytics",S3_PREFIX:"s3://"})})();"use strict";(function(){angular.module("s3").service("QuicksightService",["AwsUrlsService","ManagementUtilService","QuicksightConstants","UtilService",a]);function a(b,g,h,i){var d="Prefix",e="Tag";var f={generateQuicksightLink:c};return f;function c(o,k,t){var v=null;var n=h.SN_INTEGRATION;var u=h.PARTNER_TYPE_VALUES.S3_ANALYTICS;var s=i.getUserAccountId();var p=i.getUserNameARN();var r=h.CONFIG_TYPES.STORAGE_CLASS_ANALYSIS;var l=g.getAnalyticsSharedDataFilePath(o,k.Id,t);var q=j(k.Filter);if(l){var m=[];m.push(n+"?"+h.PARAM.PARTNER_TYPE+encodeURIComponent(u),""+h.PARAM.ACCOUNT_ID+encodeURIComponent(s),""+h.PARAM.USER_ID+encodeURIComponent(p),""+h.PARAM.BUCKET_NAME+encodeURIComponent(o),""+h.PARAM.CONFIG_TYPE+encodeURIComponent(r),""+h.PARAM.FILTER_ID+encodeURIComponent(k.Id),""+h.PARAM.FILE_PATH+encodeURIComponent(h.S3_PREFIX+l.fullDataPath));if(q.prefixes){m.push("prefix="+q.prefixes)}if(q.tagKeys){m.push("tagKeys="+q.tagKeys)}if(q.tagVals){m.push("tagVals="+q.tagVals)}v=b.getQuicksightUrl(m.join("&"))}return v}function j(l){var k={};var n=[];var m=[];var o=[];if(l){if(!l.And){if(l.Prefix){n.push(l.Prefix)}else{if(l.Tag){m.push(l.Tag.Key);o.push(l.Tag.Value)}}}else{angular.forEach(l.And,function(q,p){if(p===d){n.push(q)}if(p===e){q=[].concat(q);angular.forEach(q,function(s,r){m.push(s.Key);o.push(s.Value)})}})}if(n.length>0){k.prefixes=encodeURIComponent(n.join())}if(m.length>0){k.tagKeys=encodeURIComponent(m.join());k.tagVals=encodeURIComponent(o.join())}}return k}}})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("bucketReplication",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/bucket-replication/bucketreplication.html",controller:"BucketReplicationController"}}]);angular.module("s3").controller("BucketReplicationController",["$scope","$q","$location","$filter","$translate","$window","BucketPropertiesService","ConsoleOperation","FAC","IAMPropertiesService","KMSPropertiesService","PathService","ReplicationUtilService","Region","ReplicationConstants","S3Constants","SCLogService","UtilService","XMLParser",a]);function a(u,B,h,s,w,o,j,n,l,i,F,d,r,e,C,t,c,D,E){var k;var A=function A(){return{globalSettings:{sourceBucket:{name:null,region:null},destinationBucket:{name:null,region:null},Role:null,accessControlTranslationIds:[],kmsEncryptionIds:{},selectedSourceKmsKeys:[],sourceKmsKeysObj:{initialized:false},destAccountId:null},ruleSettings:{}}};u.showEmptyScreen=true;u.oneIntroImage=true;u.replicationObj=A();u.isConfirmationModalOpen={flag:false};var m=new n("getBucketReplication");var q=undefined;var z=(k={},_defineProperty(k,t.STORAGE_CLASSES.STANDARD,w.instant("replication.storageclasses.standard")),_defineProperty(k,t.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,w.instant("replication.storageclasses.standardia")),_defineProperty(k,t.STORAGE_CLASSES.REDUCED_REDUNDANCY,w.instant("replication.storageclasses.reducedredundancy")),_defineProperty(k,t.STORAGE_CLASSES.DEFAULT,w.instant("replication.storageclass.sameassource")),k);u.state={isDeleting:false,isAdding:false,isEditing:false};u.REPLICATION=C.REPLICATION;u.isLoadingReplication=true;u.selectedRule={flag:false,ruleObj:{}};u.wholeBucketOrPrefix=[{text:w.instant("crr.globalconfig.source.prefix"),value:C.REPLICATION.PREFIX},{text:w.instant("crr.globalconfig.source.entirebucket"),value:C.REPLICATION.ENTIRE_BUCKET}];u.confirmationModalObj={title:null,saveValue:null,contentText:null,isOpen:{flag:false}};u.receiveObjectsModalObj={title:w.instant("crr.receiveobjectmodal.title"),isOpen:{flag:false}};u.replicationModalInfo={isOpen:{flag:false},isAdd:false,selectedRule:null,storageTextMapping:z,showChangeDestinationBtn:false,showChangeRoleBtn:false,modalError:{}};u.globalConfigInfo={flag:false,isEditing:false,prefixOrWholeBucket:{text:null,value:null},storageTextMapping:z,modalError:{},showChangeDestinationBtn:false,showChangeRoleBtn:false,ENTIRE_BUCKET:C.REPLICATION.ENTIRE_BUCKET,PREFIX:C.REPLICATION.PREFIX};u.moreOptions=[{items:[{id:C.REPLICATION.ENABLED,text:w.instant("crr.dropdown.enablerule"),action:function y(){u.updateRuleStatus(C.REPLICATION.ENABLED)},disabled:true},{id:C.REPLICATION.DISABLED,text:w.instant("crr.dropdown.disablerule"),action:function y(){u.updateRuleStatus(C.REPLICATION.DISABLED)},disabled:true}]},{items:[{id:C.REPLICATION.ENABLED_ALL,text:w.instant("crr.dropdown.enableallrules"),action:function y(){u.updateRuleStatus(C.REPLICATION.ENABLED_ALL)},disabled:false},{id:C.REPLICATION.DISABLED_ALL,text:w.instant("crr.dropdown.disableallrules"),action:function y(){u.updateRuleStatus(C.REPLICATION.DISABLED_ALL)},disabled:false}]},{items:[{id:C.REPLICATION.DELETE_ALL,text:w.instant("crr.dropdown.deleteallrules"),action:function y(){u.updateRuleStatus(C.REPLICATION.DELETE_ALL)},disabled:false}]}];b();function b(){if(!l.isFeatureEnabled(t.FAC.CRR_V2)){return}if(l.isFeatureEnabled(t.FAC.CRR_KMS)){u.moreOptions[2].items.push({id:C.REPLICATION.RECEIVE_OBJECTS,text:w.instant("crr.dropdown.receiveobjects"),action:function G(){u.toggleReceiveObjectsModal()},disabled:false})}q=d.getCurrentBucket();u.replicationObj.globalSettings.sourceBucket.name=q;j.getBucketLocation(q).then(function(H){u.replicationObj.globalSettings.sourceBucket.region=e.twoWayMapping[H]})["catch"](function(){u.replicationObj.globalSettings.sourceBucket.region=null});v(q)}function x(H){var G=_.findIndex(u.replicationObj.ruleSettings.Rule,{ID:H.ID});return r.getUpdateReplicationObj(false,u.replicationObj.globalSettings.Role,u.replicationObj.ruleSettings.Rule,u.replicationObj.ruleSettings.Rule[G],G)}function p(I,H){var J=_.findIndex(u.replicationObj.ruleSettings.Rule,{ID:I});var G=_.cloneDeep(u.replicationObj.ruleSettings.Rule[J]);G.Status=H;return r.getUpdateReplicationObj(false,u.replicationObj.globalSettings.Role,u.replicationObj.ruleSettings.Rule,G)}function f(G){var H={};H.destinationBucket=u.replicationObj.globalSettings.destinationBucket.name;H.role=u.replicationObj.globalSettings.Role.value;H.rules=_.cloneDeep(u.replicationObj.ruleSettings.Rule);_.forEach(H.rules,function(I){I.Status=G});return H}u.closeConfirmationModal=function(){g();D.bodyFreezeScroll(false)};function g(){u.confirmationModalObj.isOpen.flag=false;u.confirmationModalObj.contentText=null;u.confirmationModalObj.saveValue=null;u.confirmationModalObj.title=null;u.selectedRule.flag=false;u.selectedRule.ruleObj={}}u.toggleReceiveObjectsModal=function(){u.receiveObjectsModalObj.isOpen={flag:true};u.selectedRule.flag=false;u.selectedRule.ruleObj={};D.bodyFreezeScroll(true)};u.updateRuleStatus=function(G){D.bodyFreezeScroll(true);switch(G){case C.REPLICATION.ENABLED:if(u.selectedRule.ruleObj){u.confirmationModalObj.title=w.instant("crr.confirmationmodal.enablerule");u.confirmationModalObj.isOpen.flag=true;u.confirmationModalObj.saveValue=p(u.selectedRule.ruleObj.ID,C.REPLICATION.ENABLED);u.confirmationModalObj.contentText=w.instant("crr.enablesingleruletext")}break;case C.REPLICATION.DISABLED:if(u.selectedRule.ruleObj){u.confirmationModalObj.title=w.instant("crr.confirmationmodal.disablerule");u.confirmationModalObj.isOpen.flag=true;u.confirmationModalObj.saveValue=p(u.selectedRule.ruleObj.ID,C.REPLICATION.DISABLED);u.confirmationModalObj.contentText=w.instant("crr.disablesingleruletext")}break;case C.REPLICATION.ENABLED_ALL:u.confirmationModalObj.title=w.instant("crr.confirmationmodal.enableallrules");u.confirmationModalObj.isOpen.flag=true;u.confirmationModalObj.saveValue=f(C.REPLICATION.ENABLED);u.confirmationModalObj.contentText=w.instant("crr.enableallrulestext");break;case C.REPLICATION.DISABLED_ALL:u.confirmationModalObj.title=w.instant("crr.confirmationmodal.disableallrules");u.confirmationModalObj.isOpen.flag=true;u.confirmationModalObj.saveValue=f(C.REPLICATION.DISABLED);u.confirmationModalObj.contentText=w.instant("crr.disableallrulestext");break;case C.REPLICATION.DELETE_ALL:u.confirmationModalObj.title=w.instant("crr.confirmationmodal.deleteallrules");u.confirmationModalObj.isOpen.flag=true;u.confirmationModalObj.contentText=w.instant("crr.deleteallrulestext");break;default:g()}};u.deleteRule=function(){if(u.selectedRule.ruleObj){u.confirmationModalObj.title=w.instant("crr.confirmationmodal.deleteruletitle");u.confirmationModalObj.isOpen.flag=true;u.confirmationModalObj.contentText=w.instant("crr.confirmationmodal.deleterulecontent")}};u.saveConfirmation=function(){var G=new n("putBucketReplication","putBucketReplication");var H=new n("deleteBucketReplication","deleteBucketReplication");u.isConfirming=true;if(u.confirmationModalObj.title===w.instant("crr.confirmationmodal.deleteallrules")){j.deleteBucketReplication(u.replicationObj.globalSettings.sourceBucket.name,H).then(function(){c.log("CRR_deleteBucketReplication",1,H);u.replicationObj=A();u.closeConfirmationModal()})["catch"](function(I){c.log("CRR_deleteBucketReplication",0,H);u.confirmationModalError=D.handleErrors(I)})["finally"](function(){u.isConfirming=false})}else{if(u.confirmationModalObj.title===w.instant("crr.confirmationmodal.deleteruletitle")){(function(){var I=x(u.selectedRule.ruleObj);if(I.rules.length<=0){j.deleteBucketReplication(u.replicationObj.globalSettings.sourceBucket.name,H).then(function(){c.log("CRR_deleteBucketReplication",1,H);u.replicationObj=A();u.closeConfirmationModal()})["catch"](function(J){c.log("CRR_deleteBucketReplication",0,H);u.confirmationModalError=D.handleErrors(J)})["finally"](function(){u.isConfirming=false})}else{j.putBucketReplication(u.replicationObj.globalSettings.sourceBucket.name,G,I).then(function(){r.updateIAMPolicyForDeletingRule(I,u.replicationObj);c.log("CRR_putBucketReplication",1,G);r.updateReplicationTable(u.replicationObj,I,u.replicationModalInfo.storageTextMapping);u.replicationObj.errorMessage="";u.closeConfirmationModal()})["catch"](function(J){c.log("CRR_putBucketReplication",0,G);u.confirmationModalError=D.handleErrors(J)})["finally"](function(){u.isConfirming=false})}})()}else{j.putBucketReplication(u.replicationObj.globalSettings.sourceBucket.name,G,u.confirmationModalObj.saveValue).then(function(){c.log("CRR_putBucketReplication",1,G);r.updateReplicationTable(u.replicationObj,u.confirmationModalObj.saveValue,u.replicationModalInfo.storageTextMapping);u.closeConfirmationModal()})["catch"](function(I){c.log("CRR_putBucketReplication",0,G);u.confirmationModalError=D.handleErrors(I)})["finally"](function(){u.isConfirming=false})}}};u.$watch("replicationObj.ruleSettings.Rule",function(G){if(G&&G.length>0){u.moreOptions[1].items[0].disabled=false;u.moreOptions[1].items[1].disabled=false;u.moreOptions[2].items[0].disabled=false;u.globalConfigInfo.flag=true;u.globalConfigInfo.prefixOrWholeBucket=u.replicationObj.globalSettings.isEntireBucket?{text:w.instant("crr.globalconfig.source.entirebucket"),value:u.globalConfigInfo.ENTIRE_BUCKET}:{text:w.instant("crr.globalconfig.source.prefix"),value:u.globalConfigInfo.PREFIX}}else{u.moreOptions[1].items[0].disabled=true;u.moreOptions[1].items[1].disabled=true;u.moreOptions[2].items[0].disabled=true;u.globalConfigInfo.flag=false;u.globalConfigInfo.prefixOrWholeBucket={text:null,value:null}}});u.$watch("replicationModalInfo.isEntireBucket",function(G){u.globalConfigInfo.isEntireBucket=G});u.triggerMoreDropdown=function(){if(!u.selectedRule||!u.selectedRule.flag){u.moreOptions[0].items[0].disabled=true;u.moreOptions[0].items[1].disabled=true}if(u.replicationObj&&u.replicationObj.ruleSettings&&u.replicationObj.ruleSettings.Rule){u.moreOptions[1].items[1].disabled=_.findIndex(u.replicationObj.ruleSettings.Rule,{Status:C.REPLICATION.ENABLED})===-1;u.moreOptions[1].items[0].disabled=_.findIndex(u.replicationObj.ruleSettings.Rule,{Status:C.REPLICATION.DISABLED})===-1}else{u.moreOptions[1].items[1].disabled=true;u.moreOptions[1].items[0].disabled=true}};u.selectRule=function(H){u.selectedRule.flag=true;u.selectedRule.ruleObj=H;var G=H&&H.Status===C.REPLICATION.ENABLED;u.moreOptions[0].items[0].disabled=G;u.moreOptions[0].items[1].disabled=!G;u.globalConfigInfo.isEditing=false};function v(G){j.getBucketReplication(G,m).then(function(J){var H=J.response;c.log("CRR_getBucketReplication",1,m);var I=E.convertXmlStringToJson(H).ReplicationConfiguration;u.replicationObj.globalSettings.Role=_.isEmpty(I.Role)?"":{text:_.last(I.Role.split("/")),value:I.Role};u.replicationObj.ruleSettings.Rule=[].concat(I.Rule);_.forEach(u.replicationObj.ruleSettings.Rule,function(M){var K=r.extractDestinationBucket(M.Destination.Bucket);M.Destination.Bucket={name:K,region:null};u.replicationObj.globalSettings.destinationBucket.name=K;j.getBucketRegion(K).then(function(N){M.Destination.Bucket.region=N.text;u.replicationObj.globalSettings.destinationBucket.region=N.text})["catch"](function(N){if(N.status===t.HTTP_STATUS_CODES.NOT_FOUND){u.replicationObj.errorMessage=w.instant("crr.error.destinationbucketdoesnotexist")}else{u.replicationObj.errorMessage=D.handleErrors(N)}});if(_.get(M,"Destination.Account")){u.replicationObj.globalSettings.destAccountId=M.Destination.Account}if(_.get(M,"Destination.AccessControlTranslation.Owner","")==="Destination"){M.Destination.isAccessControlTranslation=true;u.replicationObj.globalSettings.accessControlTranslationIds.push(M.ID)}var L=_.get(M,"Destination.EncryptionConfiguration.ReplicaKmsKeyID","");if(_.get(M,"SourceSelectionCriteria.SseKmsEncryptedObjects.Status","")==="Enabled"&&!_.isEmpty(L)){M.Destination.isKmsEncryption=true;M.Destination.replicaKmsKeyId=L;u.replicationObj.globalSettings.kmsEncryptionIds[M.ID]=L}M.Destination.changeDefaultStorageClass=!_.isEmpty(M.Destination.StorageClass);M.Destination.StorageClass={value:M.Destination.StorageClass,text:!_.isEmpty(M.Destination.StorageClass)?z[M.Destination.StorageClass]:z[t.STORAGE_CLASSES.DEFAULT]};M.Prefix=_.isEmpty(M.Prefix)?"":M.Prefix;M.isEntireBucket=_.isEmpty(M.Prefix).toString();M.sourceKMSKeys=[];u.globalConfigInfo.prefixOrWholeBucket=M.isEntireBucket==="true"?{text:w.instant("crr.globalconfig.source.entirebucket"),value:u.globalConfigInfo.ENTIRE_BUCKET}:{text:w.instant("crr.globalconfig.source.prefix"),value:u.globalConfigInfo.PREFIX}});u.globalConfigInfo.flag=u.replicationObj.ruleSettings.Rule&&u.replicationObj.ruleSettings.Rule.length>0;u.globalConfigInfo.isEntireBucket=_.findIndex(u.replicationObj.ruleSettings.Rule,function(K){return _.isEmpty(K.Prefix)})>-1;u.replicationObj.globalSettings.isEntireBucket=u.globalConfigInfo.isEntireBucket;if(_.values(u.replicationObj.globalSettings.kmsEncryptionIds).length>0){r.getSourceSelectedKMSKeys(true,{initialized:false,optionList:[]},u.replicationObj,{}).then(function(){},function(K){u.globalConfigInfo.modalError.getKmsKeyError=K})}})["catch"](function(H){if(H!==C.REPLICATION.CONFIGNOTFOUND){c.log("CRR_getBucketReplication",0,m);u.replicationObj.errorMessage=D.handleErrors(H)}else{c.log("CRR_getBucketReplication",1,m)}})["finally"](function(){u.isLoadingReplication=false})}u.checkPrefix=function(){return _.findIndex(u.replicationObj.ruleSettings.Rule,{isEntireBucket:"true"})>-1};u.showReplicationModal=function(){var I=arguments.length<=0||arguments[0]===undefined?true:arguments[0];var G=arguments.length<=1||arguments[1]===undefined?false:arguments[1];var H=arguments.length<=2||arguments[2]===undefined?true:arguments[2];if(!G){u.globalConfigInfo.isEditing=false;D.bodyFreezeScroll(true);if(I||H){u.replicationModalInfo.isOpen={flag:true};u.replicationModalInfo.isAdd=true}else{u.replicationModalInfo.isOpen={flag:true};u.replicationModalInfo.isAdd=false}}};u.signout=function(){var G=h.absUrl().split("/s3/");var H=undefined;if(G&&G.length>0){H=G[0]+"/s3/logout!doLogout";o.location.href=H}};u.closeSignOutWarning=function(){u.replicationObj.showSignoutWarning=false}}})();"use strict";(function(){angular.module("s3").directive("replicationModal",[function(){return{restrict:"E",scope:{modalInfo:"=",replicationObj:"=",selectedRule:"="},templateUrl:"/s3/partials/bucket-replication/replicationmodal.html",controller:"ReplicationModalController"}}]);angular.module("s3").controller("ReplicationModalController",["$scope","$q","$translate","$timeout","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPolicyService","ConsoleOperation","IAMService","IAMPropertiesService","KMSPropertiesService","ReplicationUtilService","Region","ReplicationConstants","S3Constants","SCLogService","UtilService",a]);function a(q,x,r,y,s,d,l,h,m,o,k,B,n,g,z,p,f,A){q.STEP={SOURCE:{name:"SOURCE",value:r.instant("replicationmodal.label.source")},DESTINATION:{name:"DESTINATION",value:r.instant("replicationmodal.label.destination")},PERMISSIONS:{name:"PERMISSIONS",value:r.instant("replicationmodal.label.permissions")},REVIEW:{name:"REVIEW",value:r.instant("replicationmodal.label.review")}};q.REPLICATION=z.REPLICATION;q.showBucketPolicyTemplate=false;q.showKMSPolicyTemplate=false;q.modalState={showNext:true,showSourceVersioningWarning:false,destinationVersioningWarning:null};q.headerTitle=r.instant("replicationmodal.modaltitle");q.state=q.STEP.SOURCE;q.modalInfo.prefixList=_.pluck(q.replicationObj.ruleSettings.Rule,"Prefix").filter(function(C){return C!==""});q.modalInfo.prefixOrWholeBucketOptions=[{text:r.instant("crr.globalconfig.source.prefix"),value:z.REPLICATION.PREFIX},{text:r.instant("crr.globalconfig.source.entirebucket"),value:z.REPLICATION.ENTIRE_BUCKET}];q.bucketSelectorObj={};q.multiSelectorObj={searchPlaceholder:r.instant("crr.multiselector.searchboxplaceholder"),isLoadingData:false,isDropDownOpen:false,errorMsg:null,initialized:false,noSearchResult:{text:r.instant("crr.multiselector.noresultfound"),addInputText:r.instant("crr.multiselector.addcustomarn")},optionList:[],emptyDisplayPlaceholder:r.instant("crr.multiselector.emptydisplayplaceholder"),nonEmptyDisplayPlaceholder:r.instant("crr.multiselector.displayplacehodersuffix"),totalSelectedCount:0};q.modalInfo.regions=[];q.showOverrideDestWarning=false;q.storageClasses=[{value:p.STORAGE_CLASSES.STANDARD,text:r.instant("replication.storageclasses.standard")},{value:p.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,text:r.instant("replication.storageclasses.standardia")},{value:p.STORAGE_CLASSES.REDUCED_REDUNDANCY,text:r.instant("replication.storageclasses.reducedredundancy")}];q.copyKmsKeyPolicyFinished={flag:null};q.copyBucketPolicyFinished={flag:null};q.modalInfo.iamRoles=[];q.modalInfo.iamRoles.push({text:r.instant("replication.roles.createnew"),value:z.REPLICATION.NEWROLE,pinnedTop:true});A.getFACRegions(g.regionMapping,q.modalInfo.regions);q.modalInfo.regions=_.filter(q.modalInfo.regions,function(C){return C.text!==q.replicationObj.globalSettings.sourceBucket.region});q.isEnablingDestinationVersioning={flag:false};q.accountIdForRogueActor={text:null};q.selectedKmsKeyObj={content:null};q.docLink=d.getDocUrl(p.LEARN_MORE_LINKS.CRR_KMS);c();function c(){n.initBucketSelector(q.bucketSelectorObj,q.replicationObj);q.modalInfo.showChangeDestinationBtn=i(q.modalInfo.isAdd);q.modalInfo.showChangeRoleBtn=e(q.modalInfo.isAdd);q.showOverrideDestWarning=q.modalInfo.showChangeDestinationBtn;q.showChangeRoleWarning=q.modalInfo.showChangeRoleBtn;if(q.modalInfo.isOpen&&q.modalInfo.isOpen.flag){if(q.modalInfo.isAdd){q.tmpReplicationObj={Destination:{Bucket:{name:null,region:null},StorageClass:{value:null,text:q.modalInfo.storageTextMapping[p.STORAGE_CLASSES.DEFAULT]},changeDefaultStorageClass:false,isAccessControlTranslation:false,isKmsEncryption:false,Account:null,replicaKmsKeyId:null},ID:null,Prefix:null,Status:z.REPLICATION.ENABLED,isEntireBucket:(!q.replicationObj.ruleSettings.Rule||q.replicationObj.ruleSettings.Rule.length<1).toString(),Role:null,sourceKMSKeys:[]};q.selectedRule.flag=false;q.selectedRule.ruleObj={};if(!q.modalInfo.isEntireBucket){y(function(){angular.element(".replication-modal-input input").focus()})}}else{q.tmpReplicationObj=_.cloneDeep(q.selectedRule.ruleObj)}q.tmpReplicationObj.sourceKMSKeys=[];if(q.replicationObj.globalSettings.selectedSourceKmsKeys.length>0){_.forEach(q.replicationObj.globalSettings.selectedSourceKmsKeys,function(C){q.tmpReplicationObj.sourceKMSKeys.push(C)})}q.tmpReplicationObj.Destination.Bucket=_.clone(q.replicationObj.globalSettings.destinationBucket);q.bucketSelectorObj.destinationBucket.name=_.get(q.tmpReplicationObj,"Destination.Bucket.name","");q.tmpReplicationObj.Role=_.clone(q.replicationObj.globalSettings.Role);u();if(q.tmpReplicationObj.Destination.isKmsEncryption){if(Object.keys(q.replicationObj.globalSettings.kmsEncryptionIds).length>0){n.getSourceSelectedKMSKeys(true,q.multiSelectorObj,q.replicationObj,q.tmpReplicationObj).then(function(){})["finally"](function(){n.initMultiSelector(q.replicationObj,q.multiSelectorObj);q.multiSelectorObj.isLoadingData=false})}else{q.multiSelectorObj.selectAllByDefault=true}}}if(q.modalInfo.flag){j()}v()}q.validateBucketName=function(){A.validateBucketName(q.bucketSelectorObj.destinationBucket.name,q.bucketSelectorObj.destinationBucket.bucketNameValidationErrors,q.bucketSelectorObj.bucketListCurrAccount)};q.hideChangeDestinationBtn=function(){q.modalInfo.showChangeDestinationBtn=false};q.hideChangeRoleBtn=function(){q.modalInfo.showChangeRoleBtn=false};q.getListKMS=function(){var C=new m("getListKMSForCRRModal");return B.getKMSKeys(C,{})};q.fetchSourceSelectedKMSKeys=function(C){if(Object.keys(q.replicationObj.globalSettings.kmsEncryptionIds).length>0){n.getSourceSelectedKMSKeys(C,q.multiSelectorObj,q.replicationObj,q.tmpReplicationObj).then(function(){})["finally"](function(){n.initMultiSelector(q.replicationObj,q.multiSelectorObj)})}else{q.multiSelectorObj.selectAllByDefault=true}if(q.modalInfo.isOverride){w(q.bucketSelectorObj.destinationBucket.name)}};function b(){q.tmpReplicationObj.Destination.Bucket.name=q.bucketSelectorObj.destinationBucket.name;if(_.isEmpty(_.get(q.bucketSelectorObj,"destinationBucket.accountId"))){q.bucketSelectorObj.destinationBucket.accountId=q.accountIdForRogueActor.text}q.tmpReplicationObj.Destination.Account=q.bucketSelectorObj.destinationBucket.accountId;if(!_.isEmpty(_.get(q.selectedKmsKeyObj,"content.value"))&&!q.bucketSelectorObj.isCrossAccount){q.tmpReplicationObj.Destination.replicaKmsKeyId=q.selectedKmsKeyObj.content.value}if(_.isEmpty(q.bucketSelectorObj.destinationBucket.region)){l.getBucketRegion(q.tmpReplicationObj.Destination.Bucket.name).then(function(C){q.tmpReplicationObj.Destination.Bucket.region=C.text})}else{if(_.isObject(q.bucketSelectorObj.destinationBucket.region)){q.tmpReplicationObj.Destination.Bucket.region=q.bucketSelectorObj.destinationBucket.region.text}else{q.tmpReplicationObj.Destination.Bucket.region=q.bucketSelectorObj.destinationBucket.region}}}q.nextCRRStep=function(){q.copyFinished={flag:null};if(q.state===q.STEP.SOURCE){if(q.tmpReplicationObj.isEntireBucket==="true"){q.tmpReplicationObj.Prefix=null}if(q.tmpReplicationObj.Destination.isKmsEncryption){q.tmpReplicationObj.sourceKMSKeys=[];_.forEach(q.multiSelectorObj.optionList,function(C){if(C.selected){q.tmpReplicationObj.sourceKMSKeys.push(C.value)}})}q.nextState()}else{if(q.state===q.STEP.DESTINATION){if(!_.isEmpty(_.get(q.tmpReplicationObj,"Destination.replicaKmsKeyId"))){q.tmpReplicationObj.Destination.replicaKmsKeyId=q.tmpReplicationObj.Destination.replicaKmsKeyId.trim()}b();if(q.bucketSelectorObj.destinationBucket.createNewDestBucket){s.headBucket(new m("checkBucketAvailability"),q.tmpReplicationObj.Destination.Bucket.name).then(function(){q.bucketSelectorObj.destinationBucket.bucketNameValidationErrors=[r.instant("createbucketmodal.bucketname.exists.error")]})["catch"](function(C){if(C.status===p.HTTP_STATUS_CODES.NOT_FOUND){q.nextState()}else{q.bucketSelectorObj.destinationBucket.bucketNameValidationErrors=[r.instant("createbucketmodal.bucketname.exists.error")]}});q.showBucketPolicyTemplate=false;q.showKMSPolicyTemplate=false}else{q.showBucketPolicyTemplate=q.bucketSelectorObj.isCrossAccount;q.showKMSPolicyTemplate=_.get(q.tmpReplicationObj,"Destination.isKmsEncryption",false)&&q.bucketSelectorObj.isCrossAccount;q.nextState()}}else{if(q.state===q.STEP.PERMISSIONS){q.modalInfo.modalError.saveError=null;q.copyKmsKeyPolicyFinished={flag:null};q.copyBucketPolicyFinished={flag:null};q.nextState()}else{q.nextState()}}}};q.checkInputPrefix=function(C){if(C!==q.selectedRule.ruleObj.Prefix){if(q.modalInfo.prefixList.indexOf(C)>-1){q.modalInfo.modalError.inputPrefixError=r.instant("replicationmodal.existprefixwarning")}else{q.modalInfo.modalError.inputPrefixError=null}}};q.resetInputPrefixError=function(){q.modalInfo.modalError.inputPrefixError=null};q.closeReplicationModal=function(){q.selectedRule.flag=false;q.selectedRule.ruleObj={};q.modalInfo.isOpen={flag:false};q.modalInfo.isEntireBucket=q.replicationObj.globalSettings.isEntireBucket;q.modalInfo.modalError.saveError=null;q.modalInfo.modalError.inputPrefixError=null;q.modalInfo.modalError.sourceVersioning=null;q.modalInfo.modalError.listRoleError=null;A.bodyFreezeScroll(false);q.modalInfo.prefixOrWholeBucket=q.replicationObj.globalSettings.isEntireBucket?_.find(q.modalInfo.prefixOrWholeBucketOptions,{value:z.REPLICATION.ENTIRE_BUCKET}):_.find(q.modalInfo.prefixOrWholeBucketOptions,{value:z.REPLICATION.PREFIX});if(q.modalInfo.isOverride){j();n.initBucketSelector(q.bucketSelectorObj,q.replicationObj);q.modalInfo.isEditing=false;q.modalInfo.isOverride=false;q.modalInfo.isAdd=false}q.state=q.STEP.SOURCE};q.enableSourceVersioning=function(){q.modalInfo.modalError.sourceVersioning=null;q.isEnablingSourceVersioning=true;var C=new m("enableBucketVersioning");l.enableBucketVersioning(q.replicationObj.globalSettings.sourceBucket.name,C).then(function(){f.log("CRR_enableBucketVersioning",1,C);q.modalState.showSourceVersioningWarning=false;q.modalState.showNext=true})["catch"](function(D){f.log("CRR_enableBucketVersioning",0,C);q.modalState.showSourceVersioningWarning=true;q.modalInfo.modalError.sourceVersioning=D})["finally"](function(){q.isEnablingSourceVersioning=false})};q.enableDestinationVersioning=function(){n.enableDestinationVersioning(q.isEnablingDestinationVersioning,q.bucketSelectorObj,q.modalState)};q.$watch("bucketSelectorObj.destinationBucket.name",function(D,C){if(q.modalInfo.isEditing&&D!==C){q.bucketSelectorObj.destinationBucket.Errors={};q.modalInfo.modalError.saveError=null;q.showBucketPolicyTemplate=q.bucketSelectorObj.isCrossAccount;q.showKMSPolicyTemplate=_.get(q.tmpReplicationObj,"Destination.isKmsEncryption",false)&&q.bucketSelectorObj.isCrossAccount}else{if(!q.modalInfo.isEditing&&D&&!q.bucketSelectorObj.isCrossAccount&&_.get(q.tmpReplicationObj,"Destination.isKmsEncryption",false)){w(D)}}});q.$watch("bucketSelectorObj.destinationBucket.region",function(C){if(_.get(q.bucketSelectorObj,"destinationBucket.createNewDestBucket")&&!_.isEmpty(C)){w(null,C.value)}});q.$watch("selectedRule.flag",function(C){if(C===true){n.initBucketSelector(q.bucketSelectorObj,q.replicationObj);q.modalInfo.modalError.saveError=null}});function w(D){var E=arguments.length<=1||arguments[1]===undefined?null:arguments[1];q.isListingKmsKeys=true;var C=new m("CRR-getDestinationKmsOperation");var F={};if(E){F.region=E}B.getKMSKeys(C,F,D).then(function(G){q.KMSServiceError=null;q.kmsKeys=G;if(q.selectedKmsKeyObj.content&&_.findIndex(q.kmsKeys,{value:q.selectedKmsKeyObj.content.value})===-1){q.selectedKmsKeyObj.content=null}if(_.get(q.tmpReplicationObj,"Destination.replicaKmsKeyId",null)){var H=_.find(G,{value:q.tmpReplicationObj.Destination.replicaKmsKeyId});if(!_.isEmpty(H)){q.selectedKmsKeyObj.content=H}}})["catch"](function(G){q.KMSServiceError=G})["finally"](function(){q.isListingKmsKeys=false})}q.$watch("bucketSelectorObj.isCrossAccount",function(D,C){if(D!==C&&!D){q.tmpReplicationObj.Destination.isAccessControlTranslation=false}});q.$watch("bucketSelectorObj.destinationBucket.accountId",function(C){q.showAccountIdTextField=_.isEmpty(C)});q.resetAccountIdError=function(){q.accountIdError=null};q.checkAccountId=function(C){C.text=C.text.trim();if(_.isEmpty(C.text)||C.text.match(/^[0-9]+$/)===null){q.accountIdError=r.instant("bucketselector.invalidaccountid")}else{q.accountIdError=null}};q.resetStorageClassValue=function(){q.tmpReplicationObj.Destination.StorageClass={value:null,text:q.modalInfo.storageTextMapping[p.STORAGE_CLASSES.DEFAULT]}};q.updateStorageClassText=function(C){if(q.modalInfo.storageTextMapping&&C){q.tmpReplicationObj.Destination.StorageClass.text=q.modalInfo.storageTextMapping[C]}};q.copyPolicyToClipboard=function(D,C){A.copyPathToClipboard(D,C)};q.scrollIntoView=function(C){A.scrollCardToView(C)};function t(){var C=_.get(q.tmpReplicationObj,"Destination.isAccessControlTranslation",false);var F=_.get(q.tmpReplicationObj,"Destination.isKmsEncryption",false);var E=_.get(q.replicationObj,"globalSettings.accessControlTranslationIds",[]).length>0;var D=Object.keys(_.get(q.replicationObj,"globalSettings.kmsEncryptionIds",{})).length>0;if(C&&!E||F&&!D){q.replicationObj.showSignoutWarning=q.bucketSelectorObj.isCrossAccount}else{if(F&&D){q.replicationObj.showSignoutWarning=q.bucketSelectorObj.isCrossAccount&&_.values(q.replicationObj.globalSettings.kmsEncryptionIds).indexOf(q.tmpReplicationObj.Destination.replicaKmsKeyId)===-1}else{q.replicationObj.showSignoutWarning=false}}}q.savePressed=function(){var C=new m("CRR_saveReplication");q.isSaving={flag:true};n.saveReplication(q.isSaving,q.tmpReplicationObj,q.bucketSelectorObj,q.modalInfo,q.replicationObj,function(D){t();n.updateCRRTableAfterPut(q.modalInfo,q.replicationObj,q.tmpReplicationObj,D,C).then(function(){q.replicationObj.errorMessage=""})["catch"](function(E){q.replicationObj.errorMessage=E})["finally"](function(){q.bucketSelectorObj.destinationBucket.Errors={};q.modalInfo.isEditing=false;q.closeReplicationModal()})},function(E){q.modalInfo.modalError.saveError=E;var D=$(".replication-modal .modal-body");y(function(){D.animate({scrollTop:$(".crr-save-error").offset().top-D.offset().top+D.scrollTop()})},50)})};function v(){var C=new m("listRoles");f.log("CRR_ListRolesRequestReceived",1,C);s.makeProxyRequest(o.listRoles,{region:A.getDefaultRegion(),params:{MaxItems:p.API_MAX_ITEMS.IAM_LIST_ROLES}},p.PROXY_API_NAMES.IAM.LIST_ROLES,C).then(function(E){var D=E.response.ListRolesResponse.ListRolesResult.Roles;f.log("CRR_ListRoles",1,C);q.modalInfo.modalError.listRoleError=null;D.forEach(function(F){if(_.findIndex(q.modalInfo.iamRoles,{value:F.Arn})===-1){q.modalInfo.iamRoles.push({text:F.RoleName,value:F.Arn})}})})["catch"](function(D){f.log("CRR_ListRoles",0,C);q.modalInfo.modalError.listRoleError=A.handleErrors(D)})}function u(){var C=new m("getVersioning");l.getBucketVersioning(q.replicationObj.globalSettings.sourceBucket.name,C).then(function(D){f.log("CRR_getVersioning",1,C);q.modalInfo.modalError.sourceVersioning=null;q.modalState.showSourceVersioningWarning=D!==z.REPLICATION.ENABLED;q.modalState.showNext=D===z.REPLICATION.ENABLED})["catch"](function(D){f.log("CRR_getVersioning",0,C);q.modalState.showSourceVersioningWarning=true;q.modalInfo.modalError.sourceVersioning=D;q.modalState.showNext=false})}function i(C){if(_.isEmpty(q.replicationObj.globalSettings.destinationBucket.name)){return false}else{if(C||q.replicationObj.ruleSettings.Rule&&q.replicationObj.ruleSettings.Rule.length>1){return true}}}function e(C){if(_.isEmpty(q.replicationObj.globalSettings.Role)||_.isEmpty(q.replicationObj.globalSettings.Role.text)){return false}else{if(C||q.replicationObj.ruleSettings.Rule&&q.replicationObj.ruleSettings.Rule.length>1){return true}}}q.policyEditorLoaded=function(D){var C=A.getBucketARN(q.tmpReplicationObj.Destination.Bucket.name);var E=""+A.getIamARNPrefix()+A.getUserAccountId()+":root";if(q.tmpReplicationObj.Destination.isAccessControlTranslation||q.tmpReplicationObj.isEntireBucket==="false"&&(q.replicationObj.globalSettings.accessControlTranslationIds.length>1||q.replicationObj.globalSettings.accessControlTranslationIds.length===1&&q.replicationObj.globalSettings.accessControlTranslationIds.indexOf(q.tmpReplicationObj.ID)===-1)){q.crrBucketPolicy=h.generateBucketPolicyWithArn(C,E,z.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR)}else{q.crrBucketPolicy=h.generateBucketPolicyWithArn(C,E,z.CRR_BUCKET_POLICY_TEMPLATE)}D.getSession().getDocument().setValue(q.crrBucketPolicy)};q.kmsKeyPolicyEditorLoaded=function(C){q.crrKmsKeyPolicy=JSON.stringify(z.KMS_KEY_POLICY,null,"    ").replace(/SOURCE_ACCOUNT_ID/g,A.getUserAccountId());C.getSession().getDocument().setValue(q.crrKmsKeyPolicy)};function j(){if(_.isEmpty(q.tmpReplicationObj)){q.tmpReplicationObj={}}n.initializeTmpReplicationObj(q.replicationObj,q.tmpReplicationObj,q.modalInfo.storageTextMapping)}}})();"use strict";(function(){angular.module("s3").directive("crrErrorModal",[function(){return{restrict:"E",scope:{modalOpen:"=",errorType:"=",bucketSelectorObj:"=",bucket:"=",copyPolicyToClipboard:"=",accessControlTranslationIds:"=?"},templateUrl:"/s3/partials/bucket-replication/crr-errormodal.html",controller:"CrrErrorModalController"}}]);angular.module("s3").controller("CrrErrorModalController",["$scope","$translate","BucketPolicyService","ReplicationUtilService","ReplicationConstants","UtilService",a]);function a(e,f,d,h,g,c){e.copyFinished={flag:null};e.errorModal={};e.isEnablingVersioning={flag:false};b();function b(){c.bodyFreezeScroll(true);switch(e.errorType){case"disabled":e.errorModal.title=f.instant("crr.warningmsg.title.notenabled");e.errorModal.header=f.instant("crr.warningmsg.content.notenabled");e.errorModal.contentText=f.instant("crr.warningmsg.detail.notenabled");e.bucket.name=e.bucketSelectorObj.destinationBucket.name;break;case"getFailure":e.errorModal.title=f.instant("crr.warningmsg.title.accessdenied");e.errorModal.contentText=f.instant("crr.warningmsg.detail.cannotdetectversioning");e.errorModal.header=f.instant("crr.warningmsg.content.cannotdetectversioning");e.bucket.name=e.bucketSelectorObj.destinationBucket.name;break;case"saveFailure":e.errorModal.title=f.instant("crr.warningmsg.title.accessdenied");e.errorModal.contentText=f.instant("crr.warningmsg.detail.cannotenableversioning");e.errorModal.header=f.instant("crr.warningmsg.content.cannotenableversioning");e.bucket.name=e.bucketSelectorObj.destinationBucket.name;break}}e.policyEditorLoaded=function(j){var i=c.getBucketARN(e.bucket.name);var k=""+c.getIamARNPrefix()+c.getUserAccountId()+":root";if(e.accessControlTranslationIds&&e.accessControlTranslationIds.length>0){e.crrBucketPolicy=d.generateBucketPolicyWithArn(i,k,g.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR)}else{e.crrBucketPolicy=d.generateBucketPolicyWithArn(i,k,g.CRR_BUCKET_POLICY_TEMPLATE)}j.getSession().getDocument().setValue(e.crrBucketPolicy)};e.closeErrorModal=function(){e.errorModal.title=null;e.errorModal.header=null;e.modalOpen={flag:false};e.errorModal.contentText=null;c.bodyFreezeScroll(false)};e.enableDestinationVersioning=function(){h.enableDestinationVersioning(e.isEnablingVersioning,e.bucketSelectorObj,null,true,e.closeErrorModal)}}})();"use strict";(function(){angular.module("s3").directive("crrGlobalSettings",[function(){return{restrict:"E",scope:{modalInfo:"=",bucketSelectorObj:"=",multiSelectorObj:"=",replicationObj:"=",tmpReplicationObj:"=",selectedRule:"="},templateUrl:"/s3/partials/bucket-replication/crr-globalsettings.html",controller:"CrrGlobalSettingsController"}}]);angular.module("s3").controller("CrrGlobalSettingsController",["$scope","BucketPolicyService","ConsoleOperation","ReplicationUtilService","ReplicationConstants","UtilService",a]);function a(d,c,e,h,g,b){d.copyFinished={flag:false};d.errorModal={isOpen:null};function f(i){d.modalInfo.isOpen={flag:true};d.modalInfo.isOverride=true;d.modalInfo.isAdd=true;d.modalInfo.isEditing=false;d.modalInfo.showChangeDestinationBtn=false;d.modalInfo.showChangeRoleBtn=false;d.tmpReplicationObj.Destination.Bucket=_.clone(d.bucketSelectorObj.destinationBucket);d.tmpReplicationObj.isEntireBucket=i.toString();if(_.get(d.replicationObj,"ruleSettings.Rule",[]).length>0){d.tmpReplicationObj.ID=d.replicationObj.ruleSettings.Rule[0].ID}b.bodyFreezeScroll(true)}d.$watch("modalInfo.prefixOrWholeBucket.value",function(j,i){if(d.modalInfo.isEditing&&i!==j){if(j===g.REPLICATION.PREFIX&&d.modalInfo.isEntireBucket){f(false)}else{if(j===g.REPLICATION.ENTIRE_BUCKET&&!d.modalInfo.isEntireBucket){f(true)}else{d.modalInfo.isOverride=false;d.modalInfo.isAdd=false;d.modalInfo.showChangeDestinationBtn=false;d.modalInfo.showChangeRoleBtn=false}}}});d.validateBucketName=function(){b.validateBucketName(d.bucketSelectorObj.destinationBucket.name,d.bucketSelectorObj.destinationBucket.bucketNameValidationErrors,d.bucketSelectorObj.bucketListCurrAccount)};d.enableEditGlobalConfig=function(){d.selectedRule.flag=false;d.selectedRule.ruleObj={};h.initializeTmpReplicationObj(d.replicationObj,d.tmpReplicationObj,d.modalInfo.storageTextMapping);h.initBucketSelector(d.bucketSelectorObj,d.replicationObj);d.modalInfo.isEditing=true;if(!d.replicationObj.globalSettings.sourceKmsKeysObj.initialized){h.getSourceSelectedKMSKeys(true,d.multiSelectorObj,d.replicationObj,d.tmpReplicationObj).then(function(){})["finally"](function(){d.multiSelectorObj.isLoadingData=false})}};d.copyPolicyToClipboard=function(j,k){j=!_.isEmpty(d.bucketSelectorObj.destinationBucket.name)?d.bucketSelectorObj.destinationBucket.name:j;var i=b.getBucketARN(j);var l=""+b.getIamARNPrefix()+b.getUserAccountId()+":root";if(_.get(d.replicationObj,"globalSettings.accessControlTranslationIds",[]).length>0){b.copyPathToClipboard(c.generateBucketPolicyWithArn(i,l,g.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR),k)}else{b.copyPathToClipboard(c.generateBucketPolicyWithArn(i,l,g.CRR_BUCKET_POLICY_TEMPLATE),k)}};d.cancelModifyGlobalConfig=function(){d.modalInfo.isEditing=false;h.initializeTmpReplicationObj(d.replicationObj,d.tmpReplicationObj,d.modalInfo.storageTextMapping);h.initBucketSelector(d.bucketSelectorObj,d.replicationObj);d.modalInfo.modalError.saveError=null};d.showGlobalConfigErrorModal=function(i){d.errorType=i;d.errorModal.isOpen={flag:true}};d.savePressed=function(){var i=new e("saveCRROperation");d.tmpReplicationObj.Destination.Account=d.bucketSelectorObj.destinationBucket.accountId;d.isSaving={flag:true};d.tmpReplicationObj.Destination.Bucket.name=d.bucketSelectorObj.destinationBucket.name;d.tmpReplicationObj.Destination.Bucket.region=d.bucketSelectorObj.destinationBucket.region;h.saveReplication(d.isSaving,d.tmpReplicationObj,d.bucketSelectorObj,d.modalInfo,d.replicationObj,function(j){h.updateCRRTableAfterPut(d.modalInfo,d.replicationObj,d.tmpReplicationObj,j,i).then(function(){d.modalInfo.isEditing=false;d.bucketSelectorObj.destinationBucket.Errors={};d.replicationObj.errorMessage="";d.selectedRule.flag=false;d.selectedRule.ruleObj={};d.cancelModifyGlobalConfig()})["catch"](function(k){d.replicationObj.errorMessage=k})},function(j){d.modalInfo.modalError.saveError=j})}}})();"use strict";(function(){angular.module("s3").constant("InventoryConstants",{REPORT_FORMAT:{CSV:"CSV",ORC:"ORC"},SSE_S3:"SSE-S3",SSE_KMS:"SSE-KMS"})})();"use strict";(function(){angular.module("s3").directive("crrReceiveObjectModal",[function(){return{restrict:"E",scope:{modalInfo:"=",replicationObj:"="},templateUrl:"/s3/partials/bucket-replication/crr-receiveobjectmodal.html",controller:"CrrReceiveObjectModalController"}}]);angular.module("s3").controller("CrrReceiveObjectModalController",["$scope","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","ReplicationUtilService","ReplicationConstants","S3Constants","UtilService",a]);function a(m,c,f,g,k,b,e,h,l){m.copyBucketPolicyFinished={flag:null};m.copyKmsPolicyFinished={flag:null};m.docLink=m.docLink=f.getDocUrl(h.LEARN_MORE_LINKS.CRR_KMS);i();function j(){m.modalInfo.sourceAccountId=null;m.modalInfo.bucketPolicyError=null;m.modalInfo.versioningError=null;m.modalInfo.isRogueActorEnabled=true;m.modalInfo.isVersioningEnabled=false;m.modalInfo.crrBucketPolicy=null;m.modalInfo.crrKmsKeyPolicy=null;m.copyBucketPolicyFinished={flag:null};m.modalInfo.isLoading={versioning:false,bucketPolicy:false,getVersioning:false}}function i(){j();m.modalInfo.isLoading.getVersioning=true;g.getBucketVersioning(m.replicationObj.globalSettings.sourceBucket.name,new k("CRR_ReceiveObjectModal_VersioningOperation"),false).then(function(n){m.modalInfo.isVersioningEnabled=n===h.BUCKET_PROPERTIES.VERSIONING.ENABLED;m.modalInfo.versioningError=null})["catch"](function(n){m.modalInfo.versioningError=l.handleErrors(n)})["finally"](function(){m.modalInfo.isLoading.getVersioning=false})}function d(){if(m.modalInfo.sourceAccountId){m.modalInfo.sourceAccountId=m.modalInfo.sourceAccountId.trim();return _.isEmpty(m.modalInfo.sourceAccountId)||m.modalInfo.sourceAccountId.match(/^[0-9]+$/)!==null}return true}m.copyBucketPolicyToClipboard=function(n){l.copyPathToClipboard(m.modalInfo.crrBucketPolicy,n)};m.copyKMSPolicyToClipboard=function(n){l.copyPathToClipboard(m.modalInfo.crrKmsKeyPolicy,n)};m.bucketPolicyEditorLoaded=function(n){m.modalInfo.bucketEditor=n;m.modalInfo.crrBucketPolicy=b.generateBucketPolicyForCRR(m.replicationObj.globalSettings.sourceBucket.name,m.modalInfo.isRogueActorEnabled,m.modalInfo.sourceAccountId);n.getSession().getDocument().setValue(m.modalInfo.crrBucketPolicy)};m.updateEditor=function(){var n=arguments.length<=0||arguments[0]===undefined?false:arguments[0];if(m.modalInfo.sourceAccountId){m.modalInfo.sourceAccountId=m.modalInfo.sourceAccountId.trim()}if(m.modalInfo.bucketEditor){m.bucketPolicyEditorLoaded(m.modalInfo.bucketEditor)}if(m.modalInfo.kmsEditor&&!n){m.kmsPolicyEditorLoaded(m.modalInfo.kmsEditor)}if(!d()){m.accountIdError=c.instant("bucketselector.invalidaccountid")}};m.kmsPolicyEditorLoaded=function(n){m.modalInfo.kmsEditor=n;m.modalInfo.crrKmsKeyPolicy=JSON.stringify(e.KMS_KEY_POLICY,null,"    ");if(m.modalInfo.sourceAccountId){m.modalInfo.crrKmsKeyPolicy=m.modalInfo.crrKmsKeyPolicy.replace(/SOURCE_ACCOUNT_ID/g,m.modalInfo.sourceAccountId)}n.getSession().getDocument().setValue(m.modalInfo.crrKmsKeyPolicy)};m.enableBucketVersion=function(){if(!m.modalInfo.isVersioningEnabled){m.modalInfo.isLoading.versioning=true;var n=new k("CRR_receiveObjectModalOperation");g.enableBucketVersioning(m.replicationObj.globalSettings.sourceBucket.name,n).then(function(){m.modalInfo.isVersioningEnabled=true;m.modalInfo.versioningError=null})["catch"](function(o){m.modalInfo.isVersioningEnabled=false;m.modalInfo.versioningError=l.handleErrors(o)})["finally"](function(){m.modalInfo.isLoading.versioning=false})}};m.scrollIntoView=function(n){l.scrollCardToView(n)};m.updateBucketPolicy=function(){if(d()){m.modalInfo.isLoading.bucketPolicy=true;var n=new k("CRR_receiveObjectModalOperation");b.updateBucketPolicyForCRR(m.replicationObj.globalSettings.sourceBucket.name,m.modalInfo,n).then(function(){m.modalInfo.bucketPolicyError=null})["catch"](function(o){m.modalInfo.bucketPolicyError=l.handleErrors(o)})["finally"](function(){m.modalInfo.isLoading.bucketPolicy=false})}};m.resetAccountIdError=function(){m.accountIdError=null};m.closeReceiveObjectsModal=function(){m.modalInfo.isOpen={flag:false};j()}}})();"use strict";(function(){angular.module("s3").constant("ReplicationConstants",{CRR_BUCKET_POLICY_TEMPLATE:{Version:"2008-10-17",Id:"S3-Console-Replication-Policy",Statement:[{Sid:"S3ReplicationPolicyStmt1",Effect:"Allow",Principal:{AWS:"IAM_ARN"},Action:["s3:GetBucketVersioning","s3:PutBucketVersioning","s3:ReplicateObject","s3:ReplicateDelete"],Resource:["DESTINATION_BUCKET_ARN","DESTINATION_BUCKET_ARN/*"]}]},CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR:{Version:"2008-10-17",Id:"S3-Console-Replication-Policy",Statement:[{Sid:"S3ReplicationPolicyStmt1",Effect:"Allow",Principal:{AWS:"IAM_ARN"},Action:["s3:GetBucketVersioning","s3:PutBucketVersioning","s3:ReplicateObject","s3:ReplicateDelete","s3:ObjectOwnerOverrideToBucketOwner"],Resource:["DESTINATION_BUCKET_ARN","DESTINATION_BUCKET_ARN/*"]}]},IAM_TEMPLATE_TYPE:{BASIC:"basic",ROGUE_ACTOR:"rogue_actor",KMS:"kms",ROGUE_ACTOR_KMS:"rogue_actor_kms"},IAM_POLICY_TEMPLATE:{basic:{type:"basic",name:"s3console_crr_iam_template",versionNum:"2"},rogue_actor:{type:"rogue_actor",name:"s3console_crr_iam_template",versionNum:"4"},kms:{type:"kms",name:"s3console_crr_kms_iam_template",versionNum:"1"},rogue_actor_kms:{type:"rogue_actor_kms",name:"s3console_crr_kms_rogue_iam_template",versionNum:"1"}},REPLICATION:{ENABLED:"Enabled",DISABLED:"Disabled",ENABLED_ALL:"enabledAll",DISABLED_ALL:"disabledAll",DELETE_ALL:"deleteAll",CONFIGNOTFOUND:"The replication configuration was not found",NEWROLE:"newrole",ENTIRE_BUCKET:"entireBucket",PREFIX:"prefix",RECEIVE_OBJECTS:"receiveObjects"},ERROR_CODE:{ENTITY_EXIST:"EntityAlreadyExists",ACCESS_DENIED:"AccessDenied",LIMIT_EXCEED:"LimitExceeded",VALIDATION_ERROR:"validation error"},KMS_KEY_POLICY:{Sid:"Enable cross account encrypt access for S3 Cross Region Replication",Effect:"Allow",Principal:{AWS:"SOURCE_ACCOUNT_ID"},Action:["kms:Encrypt"],Resource:"*"}})})();"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};(function(){angular.module("s3").service("ReplicationUtilService",["$q","$translate","$timeout","APIProxyService","IAMPropertiesService","KMSPropertiesService","XMLParser","BucketPropertiesService","BucketPolicyService","CachingService","ConsoleOperation","Region","ReplicationConstants","S3Constants","SCLogService","UtilService",function(b,A,G,N,e,q,J,I,g,p,f,v,O,S,j,w){function i(U){var W=arguments.length<=1||arguments[1]===undefined?null:arguments[1];var V={Status:U.Status,Prefix:U.Prefix,Destination:{Bucket:{name:U.Destination.Bucket.name}},sourceKMSKeys:[]};h(V,U,W);return V}function h(W,V){var X=arguments.length<=2||arguments[2]===undefined?null:arguments[2];W.Status=V.Status;W.Prefix=V.Prefix;if(_.isEmpty(_.get(V,"Destination.StorageClass.value"))){delete W.Destination.StorageClass;W.Destination.changeDefaultStorageClass=false}else{W.Destination.StorageClass={value:V.Destination.StorageClass.value};W.Destination.changeDefaultStorageClass=true}if(_.get(V,"Destination.isAccessControlTranslation",true)&&!_.isEmpty(X)){W.Destination.AccessControlTranslation={Owner:"Destination"};W.Destination.Account=X}else{W.Destination.isAccessControlTranslation=false;delete W.Destination.AccessControlTranslation}var U=_.get(V,"Destination.replicaKmsKeyId");if(_.get(V,"Destination.isKmsEncryption",false)&&!_.isEmpty(U)){W.Destination.EncryptionConfiguration={ReplicaKmsKeyID:U};W.SourceSelectionCriteria={SseKmsEncryptedObjects:{Status:"Enabled"}}}else{delete W.SourceSelectionCriteria;W.Destination.isKmsEncryption=false;W.Destination.replicaKmsKeyId=null;delete W.Destination.EncryptionConfiguration}if(V.sourceKMSKeys&&V.sourceKMSKeys.length>0){W.sourceKMSKeys=[];_.forEach(V.sourceKMSKeys,function(Y){W.sourceKMSKeys.push(Y)})}if(_.isEmpty(X)){W.Destination.Account=null}}function B(Z,aa,X,ab){var V=arguments.length<=4||arguments[4]===undefined?-1:arguments[4];var U={};var ac=_.get(ab,"Destination.Account");U.destinationBucket=ab.Destination.Bucket.name;U.destAccountId=ac;U.role=aa.value;U.rules=_.cloneDeep(X);if(Z){U.rules.push(i(ab,U.destAccountId))}else{if(V<=-1){var W=_.findIndex(U.rules,{ID:ab.ID});if(W>-1){var Y=U.rules[W];h(Y,ab,U.destAccountId)}if(X.length>1&&ab.isEntireBucket==="true"){U.rules.length=0;U.rules.push(i(ab))}}else{if(V>-1){U.rules.splice(V,1)}}}return U}function l(V,U,W){V.globalSettings.Role={text:_.last(U.role.split("/")),value:U.role};V.ruleSettings.Rule=[].concat(U.rules);V.globalSettings.destinationBucket={name:U.destinationBucket,region:null};V.globalSettings.destAccountId=U.destAccountId;V.globalSettings.accessControlTranslationIds.length=0;V.globalSettings.kmsEncryptionIds={};_.forEach(V.ruleSettings.Rule,function(Y){Y.Destination.Bucket={name:V.globalSettings.destinationBucket.name,region:null};I.getBucketRegion(V.globalSettings.destinationBucket.name).then(function(Z){V.globalSettings.destinationBucket.region=Z.text;Y.Destination.Bucket.region=Z.text});if(Y.Destination.changeDefaultStorageClass){Y.Destination.StorageClass={value:Y.Destination.StorageClass.value,text:W[Y.Destination.StorageClass.value]}}else{Y.Destination.StorageClass={value:null,text:W[S.STORAGE_CLASSES.DEFAULT]}}if(V.globalSettings.destAccountId){Y.Destination.Account=V.globalSettings.destAccountId}if(_.get(Y,"Destination.AccessControlTranslation.Owner","")==="Destination"){Y.Destination.isAccessControlTranslation=!_.isEmpty(V.globalSettings.destAccountId);V.globalSettings.accessControlTranslationIds.push(Y.ID)}if(_.get(Y,"SourceSelectionCriteria.SseKmsEncryptedObjects.Status","")==="Enabled"){Y.Destination.isKmsEncryption=true;var X=_.get(Y,"Destination.EncryptionConfiguration.ReplicaKmsKeyID");Y.Destination.replicaKmsKeyId=X;V.globalSettings.kmsEncryptionIds[Y.ID]=X}else{Y.Destination.isKmsEncryption=false;Y.Destination.replicaKmsKeyId=null;delete V.globalSettings.kmsEncryptionIds[Y.ID]}Y.Prefix=_.isEmpty(Y.Prefix)?"":Y.Prefix;Y.isEntireBucket=_.isEmpty(Y.Prefix).toString()})}function K(V,U){V.isCrossAccount=false;V.bucketListCurrAccount=[];V.sourceBucket=U.globalSettings.sourceBucket.name;V.sourceRegion=U.globalSettings.sourceBucket.region;V.destinationBucket={name:null,region:null,versioningEnabled:null,createNewDestBucket:false,bucketNameValidationErrors:[]};V.destinationBucket.Errors={};if(!_.isEmpty(U.globalSettings.destinationBucket.name)){V.destinationBucket.name=U.globalSettings.destinationBucket.name;V.destinationBucket.region=U.globalSettings.destinationBucket.region}if(!_.isEmpty(U.globalSettings.destAccountId)){V.destinationBucket.accountId=U.globalSettings.destAccountId}}function R(U,V){if(U.globalSettings.sourceKmsKeysObj.initialized){C(U.globalSettings.selectedSourceKmsKeys,U,V)}else{V.isLoadingData=false;V.errorMsg=null;V.initialized=false;V.optionList.length=0;V.totalSelectedCount=0}}function F(V,U,W){U.Destination={Bucket:_.cloneDeep(V.globalSettings.destinationBucket),StorageClass:{value:null,text:W[S.STORAGE_CLASSES.DEFAULT]},changeDefaultStorageClass:false};U.ID=null;U.Prefix=null;U.Status=O.REPLICATION.ENABLED;U.isEntireBucket=V.globalSettings.isEntireBucket.toString();U.Role={text:V.globalSettings.Role.text,value:V.globalSettings.Role.value}}function z(Y,X){var V=arguments.length<=2||arguments[2]===undefined?null:arguments[2];var W=arguments.length<=3||arguments[3]===undefined?false:arguments[3];var Z=arguments.length<=4||arguments[4]===undefined?null:arguments[4];Y.flag=true;var U=new f("enableBucketVersioning");if(X&&X.destinationBucket){I.enableBucketVersioning(X.destinationBucket.name,U).then(function(){j.log("CRR_enableBucketVersioning",1,U);X.destinationBucket.versioningEnabled=true;X.destinationBucket.Errors.getVersioningError=null;X.destinationBucket.Errors.enabledVersioningError=null;if(W){Z()}else{if(V){V.showNext=true}}})["catch"](function(aa){j.log("CRR_enableBucketVersioning",0,U);X.destinationBucket.versioningEnabled=null;X.destinationBucket.Errors.getVersioningError=null;X.destinationBucket.Errors.enabledVersioningError=aa})["finally"](function(){Y.flag=false})}}function a(Z,W,X,aa){var V={};V.sourceBucket=Z;V.destinationBucket=W;V.isExistingRole=X.value!==O.REPLICATION.NEWROLE;if(!V.isExistingRole){var U="s3crr_role_for_"+V.sourceBucket+"_to_"+V.destinationBucket;V.roleName=U.length>S.ENTITY_MAX_LENGTH.ROLE?U.substr(0,S.ENTITY_MAX_LENGTH.ROLE):U}else{V.roleName=X.text}var Y=undefined;if(aa===O.IAM_TEMPLATE_TYPE.BASIC||aa===O.IAM_TEMPLATE_TYPE.ROGUE_ACTOR){Y="s3crr_for_"+V.sourceBucket+"_to_"+V.destinationBucket}else{Y="s3crr_"+aa+"_for_"+V.sourceBucket+"_to_"+V.destinationBucket}V.rolePolicy=Y.length>S.ENTITY_MAX_LENGTH.POLICY?Y.substr(0,S.ENTITY_MAX_LENGTH.POLICY):Y;V.templateObj=O.IAM_POLICY_TEMPLATE[aa];return V}function t(U){return U.substring(U.lastIndexOf(":")+1)}function k(V,W,U){V.currTimes=V.currTimes+1;return I.enableBucketVersioning(W,U).then(function(){return b.when()})["catch"](function(Y){var X=w.handleErrors(Y);if(V.currTimes<=V.maxTimes&&X===S.STATUS_CODE_MAP[S.HTTP_STATUS_CODES.NOT_FOUND]){return G(function(){return k(V,W,U)},V.timeInterval)}else{return b.reject(X)}})}function u(X,aa,U,ab,V,Y,Z){var W=new f("createBucketEnablingVersioning");return N.createBucket(W,X,aa).then(function(){j.log("CRR_createBucket",1,W,{bucketName:X,region:aa});p.evictLamb();Y.destinationBucket.createNewDestBucket=false;return k({currTimes:0,maxTimes:3,timeInterval:6000},X,new f("enableBucketVersioning"))}).then(function(){j.log("CRR_enableBucketVersioning",1,W,{bucketName:X,region:aa});if(Z){return Z(X,ab,V,U)}return b.when()})["catch"](function(ac){j.log("CRR_createBucketAndEnableVersioningVersioning",0,W,{bucketName:X,region:aa});return b.reject(ac)})}function o(V){var U=[];if(V){_.forEach(V,function(X){if(X&&_.isString(X)){var W=X.split(""+w.getKmsARNPrefix());if(W.length===2){U.push(W[1])}}})}return U}function d(ac,ae,Y,Z,V,ab){var aa=arguments.length<=6||arguments[6]===undefined?null:arguments[6];var ad=arguments.length<=7||arguments[7]===undefined?null:arguments[7];var X=new f("createIAMRole");var W={};if(ac.templateObj.type===O.IAM_TEMPLATE_TYPE.KMS||ac.templateObj.type===O.IAM_TEMPLATE_TYPE.ROGUE_ACTOR_KMS){W.SrcBucketName=ac.sourceBucket;W.DstBucketName=ac.destinationBucket;W.SrcRegion=v.twoWayMapping[Z.globalSettings.sourceBucket.region];W.DstRegion=v.twoWayMapping[V.Destination.Bucket.region];if(Y.isEditing){W.ListOfSourceKMSKeys=o(Z.globalSettings.selectedSourceKmsKeys);W.ListOfDestinationKMSKeys=_.unique(_.values(Z.globalSettings.kmsEncryptionIds))}else{W.ListOfSourceKMSKeys=o(V.sourceKMSKeys);if(ad){W.ListOfDestinationKMSKeys=o(ad)}else{var U=_.clone(Z.globalSettings.kmsEncryptionIds);U[V.ID]=V.Destination.replicaKmsKeyId;W.ListOfDestinationKMSKeys=o(_.unique(_.values(U)))}if(_.get(W,"ListOfSourceKMSKeys",[]).length===0||_.get(W,"ListOfDestinationKMSKeys",[]).length===0){return b.when()}}}else{W.srcbucket=ac.sourceBucket;W.dstbucket=ac.destinationBucket}return w.createOrUpdateRoleForReplication(ac.roleName,ac.rolePolicy,W,ac.isExistingRole,ac.templateObj).then(function(ag){var af=undefined;if(ab){af=ab(ag,true)}j.log("CRR_createOrUpdateRole",1,X);if(ae){return ae(af,Y,Z,V)}if(aa){return b.when(aa)}else{return b.when(af)}})["catch"](function(ag){var af=undefined;if(ab){af=ab(null,false)}if(_.get(ag,"response.Error.Code")==="EntityAlreadyExists"||_.get(ag,"response.Error.Code")==="AccessDenied"){j.log("CRR_createOrUpdateRole",1,X);if(ae){return ae(af,Y,Z,V)}if(aa){return b.when(aa)}else{return b.when(af)}}else{j.log("CRR_createOrUpdateRole",0,X);return b.reject(w.handleErrors(ag))}})}function M(aa,V,ab,Z,W){var U=arguments.length<=5||arguments[5]===undefined?null:arguments[5];var Y=undefined;if(ab.isEditing){Y=a(W.globalSettings.sourceBucket.name,Z,V.Role,r(W))}else{Y=a(W.globalSettings.sourceBucket.name,Z,V.Role,E(V,W))}var X=function X(ad,ae){if(ae){var ac=undefined;if(!Y.isExistingRole&&ad){ac={text:_.last(ad.split("/")),value:ad};V.Role.text=ac.text;V.Role.value=ac.value;if(_.findIndex(ab.iamRoles,{value:ac.value})===-1){ab.iamRoles.push(ac)}}else{ac=V.Role}return ac}else{return _.clone(V.Role)}};return d(Y,aa,ab,W,V,X,U)}function E(V,W){var U=undefined,X=undefined;if(V.isEntireBucket!=="true"){U=V.Destination.isAccessControlTranslation||W.globalSettings.accessControlTranslationIds.length>1||W.globalSettings.accessControlTranslationIds.length===1&&W.globalSettings.accessControlTranslationIds.indexOf(V.ID)===-1;X=V.Destination.isKmsEncryption||Object.keys(W.globalSettings.kmsEncryptionIds).length>1||Object.keys(W.globalSettings.kmsEncryptionIds).length===1&&Object.keys(W.globalSettings.kmsEncryptionIds).indexOf(V.ID)===-1}else{U=V.Destination.isAccessControlTranslation;X=V.Destination.isKmsEncryption}if(X){return U?O.IAM_TEMPLATE_TYPE.ROGUE_ACTOR_KMS:O.IAM_TEMPLATE_TYPE.KMS}else{return U?O.IAM_TEMPLATE_TYPE.ROGUE_ACTOR:O.IAM_TEMPLATE_TYPE.BASIC}}function r(V){var U=_.get(V,"globalSettings.accessControlTranslationIds",[]).length>0;var W=_.values(_.get(V,"globalSettings.kmsEncryptionIds",{})).length>0;if(W){return U?O.IAM_TEMPLATE_TYPE.ROGUE_ACTOR_KMS:O.IAM_TEMPLATE_TYPE.KMS}else{return U?O.IAM_TEMPLATE_TYPE.ROGUE_ACTOR:O.IAM_TEMPLATE_TYPE.BASIC}}function x(ab,Z,aa,U,ad){var ac=arguments.length<=5||arguments[5]===undefined?null:arguments[5];var X=new f("putBucketReplication");var W=_.isEmpty(aa.ruleSettings.Rule)?[]:_.cloneDeep(aa.ruleSettings.Rule);var Y=Z.isOverride?_.isEmpty(U.ID):Z.isAdd;var V=undefined;if(Z.isEditing){V={};V.destAccountId=U.Destination.Account;V.destinationBucket=U.Destination.Bucket.name;V.role=ab.value;V.rules=[].concat(aa.ruleSettings.Rule);U.sourceKMSKeys=_.get(aa,"globalSettings.selectedSourceKmsKeys",[])}else{V=B(Y,ab,W,U)}return I.putBucketReplication(aa.globalSettings.sourceBucket.name,X,V).then(function(){j.log("CRR_putBucketReplication",1,X);if(ac){return ac(null,U,Z,ad,aa,V)}return b.when(V)})["catch"](function(ae){j.log("CRR_putBucketReplication",0,X);return b.reject(w.handleErrors(ae))})}function Q(Y,W,V,U,X){if(V.Destination.isKmsEncryption){W.globalSettings.selectedSourceKmsKeys.length=0;_.forEach(V.sourceKMSKeys,function(Z){W.globalSettings.selectedSourceKmsKeys.push(Z)})}else{if(Y.isOverride){W.globalSettings.selectedSourceKmsKeys.length=0}}if(Y.isAdd){return I.getBucketReplication(W.globalSettings.sourceBucket.name,X).then(function(ab){var Z=ab.response;j.log("CRR_getBucketReplication",1,X);var aa=J.convertXmlStringToJson(Z).ReplicationConfiguration;W.globalSettings.Role=_.isEmpty(aa.Role)?"":{text:_.last(aa.Role.split("/")),value:aa.Role};W.ruleSettings.Rule=[].concat(aa.Rule);W.globalSettings.accessControlTranslationIds.length=0;W.globalSettings.kmsEncryptionIds={};_.forEach(W.ruleSettings.Rule,function(ae){var ac=t(ae.Destination.Bucket);ae.Destination.Bucket={name:ac,region:null};W.globalSettings.destinationBucket.name=ac;I.getBucketRegion(ac).then(function(af){ae.Destination.Bucket.region=af.text;W.globalSettings.destinationBucket.region=af.text})["catch"](function(af){ae.Destination.Bucket.region=null;W.globalSettings.destinationBucket.region=null;if(af.status===S.HTTP_STATUS_CODES.NOT_FOUND){W.errorMessage=A.instant("crr.error.destinationbucketdoesnotexist")}else{W.errorMessage=w.handleErrors(af)}});if(_.get(ae,"Destination.Account")){W.globalSettings.destAccountId=ae.Destination.Account}if(_.get(ae,"Destination.AccessControlTranslation.Owner","")==="Destination"){ae.Destination.isAccessControlTranslation=true;W.globalSettings.accessControlTranslationIds.push(ae.ID)}var ad=_.get(ae,"Destination.EncryptionConfiguration.ReplicaKmsKeyID","");if(_.get(ae,"SourceSelectionCriteria.SseKmsEncryptedObjects.Status","")==="Enabled"&&!_.isEmpty(ad)){ae.Destination.isKmsEncryption=true;ae.Destination.replicaKmsKeyId=ad;W.globalSettings.kmsEncryptionIds[ae.ID]=ad}ae.Destination.changeDefaultStorageClass=!_.isEmpty(ae.Destination.StorageClass);ae.Destination.StorageClass={value:ae.Destination.StorageClass,text:!_.isEmpty(ae.Destination.StorageClass)?Y.storageTextMapping[ae.Destination.StorageClass]:Y.storageTextMapping[S.STORAGE_CLASSES.DEFAULT]};ae.Prefix=_.isEmpty(ae.Prefix)?"":ae.Prefix;ae.isEntireBucket=_.isEmpty(ae.Prefix).toString()});Y.isEntireBucket=_.findIndex(W.ruleSettings.Rule,function(ac){return _.isEmpty(ac.Prefix)})>-1;W.globalSettings.isEntireBucket=Y.isEntireBucket;Y.prefixList=_.pluck(W.ruleSettings.Rule,"Prefix").filter(function(ac){return ac!==""});return b.when()})["catch"](function(Z){return b.reject(w.handleErrors(Z))})}else{l(W,U,Y.storageTextMapping);Y.isEntireBucket=_.findIndex(W.ruleSettings.Rule,function(Z){return _.isEmpty(Z.Prefix)})>-1;W.globalSettings.isEntireBucket=Y.isEntireBucket;Y.prefixList=_.pluck(W.ruleSettings.Rule,"Prefix").filter(function(Z){return Z!==""});return b.when()}}function c(ac,U,aa,X,Y,V,Z){ac.flag=true;var W=U.Destination.Bucket.name,ab=_.isObject(U.Destination.Bucket.region)?v.twoWayMapping[U.Destination.Bucket.region.text]:v.twoWayMapping[U.Destination.Bucket.region];if(aa.destinationBucket.createNewDestBucket){u(W,ab,U,X,Y,aa,s).then(function(ad){V(ad)})["catch"](function(ad){Z(ad)})["finally"](function(){ac.flag=false})}else{if(H(W,Y,U)){s(W,X,Y,U,true).then(function(ad){V(ad)})["catch"](function(ad){Z(ad)})["finally"](function(){ac.flag=false})}else{s(W,X,Y,U).then(function(ad){V(ad)})["catch"](function(ad){Z(ad)})["finally"](function(){ac.flag=false})}}}function s(X,Y,V,U){var W=arguments.length<=4||arguments[4]===undefined?false:arguments[4];if(U.Role.value===O.REPLICATION.NEWROLE){return M(x,U,Y,X,V)}else{if(W){return x(U.Role,Y,V,U,X)}else{return x(U.Role,Y,V,U,X,M)}}}function H(W,V,U){if(W===V.globalSettings.destinationBucket.name&&U.Role.value===V.globalSettings.Role.value){return m(V,U)&&P(V,U)}return false}function m(V,U){var W=_.get(U,"Destination.isAccessControlTranslation",false)&&!_.isEmpty(_.get(U,"Destination.Account"));return W&&V.globalSettings.accessControlTranslationIds.length>0||!W&&(V.globalSettings.accessControlTranslationIds.length===0||V.globalSettings.accessControlTranslationIds.filter(function(X){return X!==U.ID}).length>0)}function P(V,U){var Z=_.clone(V.globalSettings.kmsEncryptionIds);var Y=_.get(U,"Destination.isKmsEncryption",false)&&!_.isEmpty(_.get(U,"Destination.replicaKmsKeyId",""));if(!Y&&!_.isEmpty(Z[U.ID])){delete Z[U.ID]}var X=_.isEqual(_.unique(_.values(V.globalSettings.kmsEncryptionIds)),_.unique(_.values(Z)));var W=_.isEqual(U.sourceKMSKeys,V.globalSettings.selectedSourceKmsKeys)||U.sourceKMSKeys&&U.sourceKMSKeys.length===0;return W&&(Y&&_.values(V.globalSettings.kmsEncryptionIds).indexOf(U.Destination.replicaKmsKeyId)>-1||!Y&&X)}function C(X,U,V){var W=arguments.length<=3||arguments[3]===undefined?false:arguments[3];if(W){U.globalSettings.selectedSourceKmsKeys.length=0}_.forEach(X,function(Z){if(W){U.globalSettings.selectedSourceKmsKeys.push(Z)}var Y=_.findIndex(V.optionList,{value:Z});if(Y>-1){V.optionList[Y].selected=true}else{V.optionList.push({value:Z,selected:true})}})}function n(Y,W,V,U){U.getSourceKMSKeyError=null;if(Y&&!W.initialized&&!V.globalSettings.sourceKmsKeysObj.initialized){var X=function(){var aa=new f("listAttachedRolePolicies");var ab=[];var Z=[];W.isLoadingData=true;if(_.isEmpty(_.get(V,"globalSettings.Role.text",""))){return{v:b.when()}}return{v:e.listAttachedRolePolicies(V.globalSettings.Role.text,aa).then(function(ac){var ad=[];if(ac){_.forEach(ac,function(ag){var ae=ag.PolicyArn;var af=e.listPolicyVersions(ae,aa).then(function(ah){var ai=_.find(ah,{IsDefaultVersion:true});if(ai){ab.push({CreateDate:ai.CreateDate,PolicyArn:ae,VersionId:ai.VersionId})}});ad.push(af)})}return b.all(ad)}).then(function(){var ac=[];_.forEach(ab,function(ae){var ad=e.getPolicyVersion(ae.PolicyArn,ae.VersionId,aa).then(function(ai){var aj=JSON.parse(decodeURIComponent(ai));var ag=_.find(aj.Statement,{Action:["kms:Decrypt"]});var al=_.find(aj.Statement,{Action:["kms:Encrypt"]});var af=_.get(ag,"Condition.StringLike",{})["kms:EncryptionContext:"+w.getPartition()+"s3:arn"];var am=_.get(al,"Condition.StringLike",{})["kms:EncryptionContext:"+w.getPartition()+"s3:arn"];var ak=af&&af.indexOf(w.getBucketARN(V.globalSettings.sourceBucket.name)+"/*")>-1;var ah=am&&am.indexOf(w.getBucketARN(V.globalSettings.destinationBucket.name)+"/*")>-1;if(ah&&ak&&ag&&ag.Resource){Z.push({Resource:ag.Resource,Arn:ae.PolicyArn,VersionId:ae.VersionId})}});ac.push(ad)});return b.all(ac)}).then(function(){var ac=undefined;if(Z.length>0){V.globalSettings.sourceKmsKeysObj.policyDocuments=Z;ac=w.getKmsKeysFromIamPolicy(Z);C(ac,V,W,true)}V.globalSettings.sourceKmsKeysObj.initialized=true;return b.when()})["catch"](function(ac){U.getSourceKMSKeyError=ac;W.isDropDownOpen=false;return b.reject(ac)})}}();if((typeof X==="undefined"?"undefined":_typeof(X))==="object"){return X.v}}return b.when()}function y(aa,X,U){var W=undefined;var V={actionsNeedToUpdate:[],resourcesNeedToUpdate:[],hasNoRequiredStatement:true,indexOfStatement:null,effectNeedToUpdate:false};var Y=""+w.getIamARNPrefix()+U.sourceAccountId+":root";var ac=""+w.getBucketARN(X);if(aa&&aa.Statement){W=aa;_.forEach(aa.Statement,function(ag,ae){if(V.hasNoRequiredStatement){var af=_.get(ag,"Principal.AWS");var ai=_.get(ag,"Resource");if(ai&&(_.isString(af)&&af===Y||_.isArray(af)&&af.indexOf(Y)>-1)){var ak=ai?[].concat(ai):[];var aj=ak.indexOf("*")>-1;var ad=ak.indexOf(ac)>-1;var ah=ak.indexOf(ac+"/*")>-1;if(aj||ad||ah){if(!ad&&!aj){V.resourcesNeedToUpdate.push(ac)}if(!ah&&!aj){V.resourcesNeedToUpdate.push(ac+"/*")}if(ag.Effect!=="Allow"){V.effectNeedToUpdate=true}ag.Action=ag.Action?[].concat(ag.Action):[];if(ag.Action.indexOf("s3:*")===-1){ag.Action=[].concat(ag.Action);if(ag.Action.indexOf("s3:GetBucketVersioning")===-1&&ag.Action.indexOf("s3:Get*")===-1){V.actionsNeedToUpdate.push("s3:GetBucketVersioning")}if(ag.Action.indexOf("s3:PutBucketVersioning")===-1&&ag.Action.indexOf("s3:Put*")===-1){V.actionsNeedToUpdate.push("s3:PutBucketVersioning")}if(ag.Action.indexOf("s3:ReplicateObject")===-1){V.actionsNeedToUpdate.push("s3:ReplicateObject")}if(ag.Action.indexOf("s3:ReplicateDelete")===-1){V.actionsNeedToUpdate.push("s3:ReplicateDelete")}if(U.isRogueActorEnabled&&ag.Action.indexOf("s3:ObjectOwnerOverrideToBucketOwner")===-1){V.actionsNeedToUpdate.push("s3:ObjectOwnerOverrideToBucketOwner")}}V.hasNoRequiredStatement=false;V.indexOfStatement=ae}}}});if(!V.hasNoRequiredStatement&&V.actionsNeedToUpdate.length===0&&V.resourcesNeedToUpdate.length===0&&!V.effectNeedToUpdate){W=null}else{if(V.hasNoRequiredStatement){var Z=U.isRogueActorEnabled?g.generateBucketPolicyWithArn(ac,Y,O.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR.Statement[0]):g.generateBucketPolicyWithArn(ac,Y,O.CRR_BUCKET_POLICY_TEMPLATE.Statement[0]);W.Statement.push(JSON.parse(Z))}else{if(V.effectNeedToUpdate){W.Statement[V.indexOfStatement].Effect="Allow"}if(V.indexOfStatement!==null&&V.actionsNeedToUpdate.length>0){W.Statement[V.indexOfStatement].Action=[].concat(W.Statement[V.indexOfStatement].Action);_.forEach(V.actionsNeedToUpdate,function(ad){W.Statement[V.indexOfStatement].Action.push(ad)})}if(V.indexOfStatement!==null&&V.resourcesNeedToUpdate.length>0){W.Statement[V.indexOfStatement].Resource=[].concat(W.Statement[V.indexOfStatement].Resource);_.forEach(V.resourcesNeedToUpdate,function(ad){W.Statement[V.indexOfStatement].Resource.push(ad)})}}}}else{var ab=U.isRogueActorEnabled?g.generateBucketPolicyWithArn(ac,Y,O.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR):g.generateBucketPolicyWithArn(ac,Y,O.CRR_BUCKET_POLICY_TEMPLATE);W=JSON.parse(ab)}return W}function T(V,W,U){return I.getBucketPolicy(V,U,false).then(function(Y){var X=y(Y,V,W);if(X){return I.putBucketPolicy(V,JSON.stringify(X),U).then(function(){return b.when()})["catch"](function(Z){return b.reject(w.handleErrors(Z))})}return b.when()})["catch"](function(X){return b.reject(w.handleErrors(X))})}function L(W,X){var Z=arguments.length<=2||arguments[2]===undefined?null:arguments[2];var V=undefined;var U=W?w.getBucketARN(W):null;var Y=Z?""+w.getIamARNPrefix()+Z+":root":null;if(X){V=g.generateBucketPolicyWithArn(U,Y,O.CRR_BUCKET_POLICY_TEMPLATE_ROGUE_ACTOR)}else{V=g.generateBucketPolicyWithArn(U,Y,O.CRR_BUCKET_POLICY_TEMPLATE)}return V}function D(Z,W){var aa=undefined,ac=undefined;var ae=Object.keys(W.globalSettings.kmsEncryptionIds).length===0;var X=W.globalSettings.accessControlTranslationIds.length>0;var U=Z.rules.reduce(function(af,ah,ag){if(ah.Destination.isKmsEncryption){af[ah.ID]=ah.Destination.replicaKmsKeyId}return af},{});var ab=Z.rules.reduce(function(af,ah,ag){if(ah.Destination.isAccessControlTranslation){af.push(ah.ID)}return af},[]);if(!_.isEqual(_.unique(_.values(W.globalSettings.kmsEncryptionIds)),_.unique(_.values(U)))){aa=true;ae=Object.keys(U).length===0}if(!_.isEqual(W.globalSettings.accessControlTranslationIds,ab)&&ab.length===0){ac=true;X=false}var ad=undefined;if(ac||aa){if(!ae){ad=X?O.IAM_TEMPLATE_TYPE.ROGUE_ACTOR_KMS:O.IAM_TEMPLATE_TYPE.KMS}else{ad=X?O.IAM_TEMPLATE_TYPE.ROGUE_ACTOR:O.IAM_TEMPLATE_TYPE.BASIC}}if(!_.isEmpty(ad)){var Y=a(W.globalSettings.sourceBucket.name,W.globalSettings.destinationBucket.name,W.globalSettings.Role,ad);var V={Destination:{Bucket:{region:W.globalSettings.destinationBucket.region}},sourceKMSKeys:W.globalSettings.selectedSourceKmsKeys};d(Y,null,{},W,V,null,null,_.unique(_.values(U)))}}return{extractDestinationBucket:t,getUpdateReplicationObj:B,updateReplicationTable:l,handleIAMRole:a,initBucketSelector:K,initializeTmpReplicationObj:F,enableDestinationVersioning:z,createNewDestBucketRequest:u,IAMRoleRequest:d,CRRIAMRoleRequest:M,putCRRRequest:x,saveReplication:c,updateSourceKmsKey:C,initMultiSelector:R,updateCRRTableAfterPut:Q,getSourceSelectedKMSKeys:n,generateBucketPolicyForCRR:L,updateBucketPolicyForCRR:T,updateIAMPolicyForDeletingRule:D}}])})();"use strict";(function(){angular.module("s3").directive("bucketReplicationV1",function(){return{restrict:"E",scope:{cardOpen:"=",forCreateBucketModal:"=?",replicationObj:"=?",modalInfo:"=?",versioningStatus:"=",id:"@?"},templateUrl:"/s3/partials/replicationv1.html",controller:"BucketReplicationV1Controller"}});angular.module("s3").controller("BucketReplicationV1Controller",["$filter","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","FAC","IAMService","PathService","Region","S3Constants","SCLogService","UtilService",a]);function a(o,r,w,s,t,c,j,h,m,k,p,e,f,q,d,y){var n,i,l;function b(){if(!k.isFeatureEnabled(q.FAC.CRR)){return}r.cardState={ruleBeingEdited:null,isExpanded:false,isSaving:false};if(!r.forCreateBucketModal){r.replicationObj={role:"",destinationBucket:null,storageClass:"",rulesArray:[],replicationType:"",isEnabled:q.REPLICATION.DISABLED}}r.errorMessage="";r.bucketList=[];r.allMyBuckets=[];r.S3Constants=q;l=new m("getBucketReplication","getBucketReplication");r.iamRoles=[];r.iamRoles.push({text:s.instant("replication.roles.createnew"),value:q.REPLICATION.NEWROLE});r.scrollCardId="#"+r.id;r.cardSummaryObj=_.cloneDeep(q.CARD_SUMMARY_INIT);if(r.forCreateBucketModal){r.$watch("cardOpen",function(A,z){w(function(){y.scrollCardToView(q.BUCKET_PROPERTIES.REPLICATION.CREATE_BUCKET_CARD)},1)})}if(r.forCreateBucketModal){n=r.modalInfo.name;i=r.modalInfo.region;r.regionMapping=[];f.regionMapping.forEach(function(z){if(z.value!==i){r.regionMapping.push(z)}});r.sourceRegion=f.twoWayMapping[i]+" ("+i+")"}else{n=e.getCurrentBucket();j.getBucketLocation(n).then(function(z){i=z;r.regionMapping=[];var A=[];y.getFACRegions(f.regionMapping,A);A.forEach(function(B){if(B.value!==i){r.regionMapping.push(B)}});r.sourceRegion=f.twoWayMapping[z]+" ("+z+")"})["catch"](function(z){r.errorMessage=y.handleErrors(z)})}r.sources=[{value:"bucket",text:s.instant("replication.label.bucket")},{value:"prefix",text:s.instant("replication.label.prefix")}];r.storageClasses=[{value:q.STORAGE_CLASSES.DEFAULT,text:s.instant("replication.storageclasses.default")},{value:q.STORAGE_CLASSES.STANDARD,text:s.instant("replication.storageclasses.standard")},{value:q.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,text:s.instant("replication.storageclasses.standardia")},{value:q.STORAGE_CLASSES.REDUCED_REDUNDANCY,text:s.instant("replication.storageclasses.reducedredundancy")}];if(!k.isFeatureEnabled(q.FAC.S3_RRS)){r.storageClasses=_.reject(r.storageClasses,function(z){return z.value===q.STORAGE_CLASSES.REDUCED_REDUNDANCY})}r.storageClassesMap={};r.storageClasses.forEach(function(z){r.storageClassesMap[z.value]=z.text;r.storageClassesMap[z.text]=z.value});d.log("ListAllMyBucketsRequestReceived",1,l);t.listAllMyBuckets(l).then(function(z){var A=z.response.ListAllMyBucketsResult.Buckets.Bucket;d.log("ListAllMyBucketsSuccess",1,l);r.allMyBuckets=A;r.updateBucketList(false)})["catch"](function(z){d.log("ListAllMyBucketsSuccess",0,l);r.errorMessage=y.handleErrors(z)});v();r.cardSummaryObj.isLoading=true;u(n,false)}r.resetError=function(){r.errorMessage=null};r.$watchCollection("replicationObj.destinationRegion",function(A,z){if(!_.isEmpty(A)&&!_.isEqual(A,z)){if(r.replicationObj.resetDestinationBucket){r.replicationObj.destinationBucket=null}r.updateBucketList();r.resetError();r.replicationObj.resetDestinationBucket=true}});r.displayListRoleError=function(){return !_.isEmpty(r.listRoleError)&&$(".crr-listrole span.awsui-select-target.awsui-select-open.awsui-select-target-focused").length>0};function v(){var z=y.getDefaultRegion();d.log("ListRolesRequestReceived",1,l);t.makeProxyRequest(p.listRoles,{region:z,params:{MaxItems:q.API_MAX_ITEMS.IAM_LIST_ROLES}},q.PROXY_API_NAMES.IAM.LIST_ROLES,l).then(function(B){var A=B.response.ListRolesResponse.ListRolesResult.Roles;d.log("ListRolesSuccess",1,l);A.forEach(function(C){if(_.findIndex(r.iamRoles,{value:C.Arn})===-1){r.iamRoles.push({text:C.RoleName,value:C.Arn})}});r.listRoleError=null})["catch"](function(B){d.log("ListRolesSuccess",0,l);var A=y.handleErrors(B);r.listRoleError=A})}function u(z,A,B){if(!r.forCreateBucketModal){j.getBucketReplication(z,l).then(function(D){var C=D.response;r.replicationObj.resetDestinationBucket=A;h.populateReplicationObj(C,z,r.replicationObj,r.regionMapping,!A).then(function(){r.updateBucketList(A);g()});r.replicationObj.configExists=true})["catch"](function(C){if(C===q.REPLICATION.CONFIGNOTFOUND){r.replicationObj.configExists=false}else{r.errorMessage=y.handleErrors(C)}g()})["finally"](function(){if(r.replicationObj&&r.replicationObj.role&&!B){var C=_.clone(r.replicationObj.role);if(_.findIndex(r.iamRoles,{value:C})===-1){r.iamRoles.push({text:_.last(C.split("/")),value:C})}}})}else{if(r.replicationObj&&r.replicationObj.response!==undefined){h.populateReplicationObj(r.replicationObj.response,z,r.replicationObj).then(function(){r.updateBucketList(A)})}}}r.removeRule=function(B,A,z){if(z){A.stopPropagation()}r.replicationObj.rulesArray.splice(_.findIndex(r.replicationObj.rulesArray,function(C){return B===C}),1);B.storageClass="";B.prefix="";B.markedForDelete=true};r.updateBucketList=function(A){var z=[];r.allMyBuckets.forEach(function(B){j.getBucketLocation(B.Name).then(function(C){if(r.replicationObj&&r.replicationObj.destinationRegion&&(C===r.replicationObj.destinationRegion||C===r.replicationObj.destinationRegion.value)){z.push(B.Name)}if(A){r.errorMessage=""}r.bucketList=y.transformListOfOptionsToDropdown(z)})})};r.allRulesEmpty=function(){return _.every(r.replicationObj.rulesArray,function(z){return z.prefix===""&&z.storageClass===""})};r.addRule=function(z){z.stopPropagation();if(r.completeEdit()){r.cardState.isExpanded=true;var A={prefix:"",status:q.REPLICATION.ENABLED,storageClass:"",isEditing:true};r.replicationObj.rulesArray.push(A);r.cardState.ruleBeingEdited=A}};r.completeEdit=function(){var z=r.cardState.ruleBeingEdited;if(!z){return true}else{if(z.prefix!==""&&z.storageClass!==""||z.markedForDelete){z.prefixError=false;z.storageError=false;z.isEditing=false;r.cardState.ruleBeingEdited=null;return true}else{if(z.prefix===""&&z.storageClass===""){z.storageError=false;z.prefixError=false;r.removeRule(z,"",false);return true}else{if(z.prefix===""){z.prefixError=true;z.storageError=false}else{z.storageError=true;z.prefixError=false}return false}}}};r.editRule=function(A,z){z.stopPropagation();if(r.completeEdit()){A.isEditing=true;r.cardState.ruleBeingEdited=A}};r.isDisable=function(){return r.replicationObj.isEnabled===q.REPLICATION.ENABLED&&(r.replicationObj.destinationBucket===null||r.replicationObj.role===""||r.replicationObj.replicationType==="bucket"&&r.replicationObj.storageClass===""||r.replicationObj.replicationType==="prefix"&&(r.replicationObj.rulesArray.length===0||r.allRulesEmpty()))};r.savePressed=function(C){if(r.isDisable(r.replicationObj)){return}y.analyticsTrackClick(q.ANALYTICS.SAVE_REPLICATION,q.ANALYTICS.DETAILS);if(!r.completeEdit()){return}r.replicationObj.rules=[];h.handleRules(n,r.replicationObj);var A=r.replicationObj.destinationBucket.value||r.replicationObj.destinationBucket;var z="",D=false;if(r.replicationObj.role===q.REPLICATION.NEWROLE){z="replication_role_for_"+n+"_to_"+A}else{D=true;var B=r.replicationObj.role.split("/");z=B[B.length-1]}var E="replication_policy_for_"+n+"_to_"+A;if(z.length>q.ENTITY_MAX_LENGTH.ROLE){z=z.substr(0,q.ENTITY_MAX_LENGTH.ROLE)}if(E.length>q.ENTITY_MAX_LENGTH.POLICY){E=E.substr(0,q.ENTITY_MAX_LENGTH.POLICY)}y.createOrUpdateRoleForReplication_v1(z,E,n,A,D).then(function(F){if(!D){r.replicationObj.role=F}d.log("createOrUpdateRoleSuccess",1,l);x(C,D)})["catch"](function(F){r.errorMessage=y.handleErrors(F);d.log("createOrUpdateRoleSuccess",0,l)})};function x(A,B){var z=new m("putBucketReplication","putBucketReplication");if(r.forCreateBucketModal){r.replicationObj.response=j.parseBucketReplicationObject_v1(r.replicationObj);r.closeCard(A)}else{r.cardState.isSaving=true;j.putBucketReplication(n,z,r.replicationObj,true).then(function(){u(n,true,B);r.closeCard(A)})["catch"](function(C){r.errorMessage=y.handleErrors(C)})["finally"](function(){r.cardState.isSaving=false;r.replicationObj.role=""})}}r.toggleRuleStatus=function(A,z){z.stopPropagation();if(A.markedForDelete){A.markedForDelete=false}else{if(A.status===q.REPLICATION.DISABLED){A.status=q.REPLICATION.ENABLED}else{if(A.status===q.REPLICATION.ENABLED){A.status=q.REPLICATION.DISABLED}}}};r.cancelPressed=function(z){y.analyticsTrackClick(q.ANALYTICS.CANCEL_REPLICATION,q.ANALYTICS.DETAILS);r.closeCard(z);b()};r.deletePressed=function(){var z=new m("deleteReplicationConfiguration","deleteReplicationConfiguration");r.deleting=true;j.deleteBucketReplication(n,z).then(function(A){r.replicationObj.isEnabled=q.REPLICATION.DISABLED;r.replicationObj.configExists=false;r.closeCard();return A})["catch"](function(A){r.errorMessage=y.handleErrors(A)})["finally"](function(){r.deleting=false})};r.closeCard=function(z){if(z){z.stopPropagation()}r.cardOpen=false};function g(){if(r.replicationObj.isEnabled===q.REPLICATION.ENABLED){r.cardSummaryObj.isActive=true;r.cardSummaryObj.activeSummary.text=s.instant("bucketproperties.crossregionreplication.destinationbucket");r.cardSummaryObj.isMultiValue=true;r.cardSummaryObj.activeSummary.value=r.replicationObj.destinationBucket.value||r.replicationObj.destinationBucket}else{r.cardSummaryObj.isActive=false;r.cardSummaryObj.isMultiValue=false;r.cardSummaryObj.inactiveSummary.text=s.instant("bucketproperty.disabled")}r.cardSummaryObj.isLoading=false}r.docLink=c.getDocUrl(q.LEARN_MORE_LINKS.REPLICATION);b()}})();"use strict";(function(){angular.module("s3").directive("cloudTrail",[function(){return{restrict:"E",scope:{cardOpen:"=",forCreateBucketModal:"=?",createBucketValues:"=?",eventSelectors:"=",id:"@?",region:"=?"},templateUrl:"/s3/partials/cloudtrail.html",controller:"CloudTrailController"}}]);angular.module("s3").controller("CloudTrailController",["$scope","$q","$timeout","$translate","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService",a]);function a(p,j,d,c,e,f,k,l,m,h,o,n){p.saving=false;p.cardSummaryObj=_.cloneDeep(h.CARD_SUMMARY_INIT);p.cardSummaryObj.activeSummary.text=c.instant("bucketproperty.enabled");p.cardSummaryObj.inactiveSummary.text=c.instant("bucketproperty.disabled");p.docLink=e.getDocUrl(h.LEARN_MORE_LINKS.CLOUDTRAIL);p.cancelEventSelectors=function(q){n.analyticsTrackClick(h.ANALYTICS.CANCEL_EVENT_SELECTORS,h.ANALYTICS.DETAILS);q.stopPropagation();if(!p.cardSummaryObj.isActive){p.eventSelectors.access={read:false,write:false};p.eventSelectors.targetTrail="";if(p.forCreateBucketModal){p.eventSelectors.enabled=false}}p.cardOpen=false;p.eventSelectorsErrorMessage=""};function g(){n.scrollCardToView(h.BUCKET_PROPERTIES.EVENT_SELECTORS.CREATE_BUCKET_CARD)}function b(t){var s=m.getCurrentBucket();var u=s+"/";var r=j.defer();var q=new l("GetEventSelectors");f.getEventSelectors(t,q,p.eventSelectors.trailRegionMapping[t]).then(function(B){var w=B.response.EventSelectors;for(var y=0;y<w.length;y++){var z=w[y].DataResources;if(!_.isEmpty(z)){var v=z[0].Values;for(var x=0;x<v.length;x++){var A=v[x].split("s3:::");if(A.length===2){if(_.startsWith(A[1],u)){p.cardSummaryObj.isActive=true;break}}else{var C=n.getARNPrefix(h.AWS_SERVICE.S3).slice(0,-3);if(_.isEqual(C,v[x])){p.cardSummaryObj.isActive=true;break}}}}}o.log("GetEventSelectors",1,q,{bucketName:s});r.resolve()})["catch"](function(w){var v=n.handleErrors(w);p.eventSelectorsErrorMessage=v;o.log("GetEventSelectors",0,q,{bucketName:s,error:v});r.reject(w)});return r.promise}p.refreshTrails=function(){p.isRefreshing=true;var q=new l("RefreshTrails");f.describeTrails(q,p.region).then(function(r){p.eventSelectors.trailNames.length=0;p.eventSelectors.trailRegionMapping={};k.populateTrailNames(r,p.eventSelectors.trailNames,p.eventSelectors.trailRegionMapping);o.log("DescribeTrails",1,q);p.isRefreshing=false})["catch"](function(s){var r=n.handleErrors(s);o.log("DescribeTrails",0,q,{error:r});p.eventSelectorsErrorMessage=r;p.isRefreshing=false})};p.getEventSelectors=function(){if(!p.forCreateBucketModal){(function(){var q=new l("GetEventSelectors");var r=[];f.describeTrails(q,p.region).then(function(s){o.log("DescribeTrails",1,q);var t=s.response.trailList;p.eventSelectors.trailRegionMapping={};_.each(t,function(u){var w=n.getTrailName(u.TrailARN);var v=n.getTrailRegionFromARN(u.TrailARN);p.eventSelectors.trailNames.push({value:w,text:w});p.eventSelectors.trailRegionMapping[w]=v;r.push(b(w))});j.all(r).then(function(){p.cardSummaryObj.isLoading=false},function(u){p.cardSummaryObj.isLoading=false;p.eventSelectorsErrorMessage=n.handleErrors(u)})})["catch"](function(t){p.cardSummaryObj.isLoading=false;var s=n.handleErrors(t);o.log("DescribeTrails",0,q,{error:s});p.eventSelectorsErrorMessage=s})})()}};if(p.forCreateBucketModal){p.$watch("cardOpen",function(r,q){if(r){d(g,1)}});if(!_.isEmpty(p.eventSelectors)&&p.eventSelectors.errorMessage){p.eventSelectorsErrorMessage=p.eventSelectors.errorMessage}p.cloudTrailLink=e.getConsoleServiceUrl("cloudtrail",p.region,"#/configuration");p.cardSummaryObj.isActive=p.eventSelectors.targetTrail!==""&&(p.eventSelectors.access.read||p.eventSelectors.access.write)}else{p.scrollCardId="#"+p.id;var i=m.getCurrentBucket();p.cardSummaryObj.isLoading=true;f.getBucketLocation(i).then(function(q){p.region=q;p.getEventSelectors();p.cloudTrailLink=e.getConsoleServiceUrl("cloudtrail",q,"#/configuration")})["catch"](function(q){p.eventSelectorsErrorMessage=n.handleErrors(q)})}p.saveEventSelectors=function(q){n.analyticsTrackClick(h.ANALYTICS.SAVE_EVENT_SELECTORS,h.ANALYTICS.DETAILS);q.stopPropagation();p.eventSelectorsErrorMessage="";if(!p.forCreateBucketModal){(function(){p.saving=true;var s=m.getCurrentBucket();var r=new l("SaveEventSelectors");f.getEventSelectors(p.eventSelectors.targetTrail,r,p.eventSelectors.trailRegionMapping[p.eventSelectors.targetTrail]).then(function(v){var t=_.get(v,"response.EventSelectors");if(t){var u=k.generateEventSelectorsConfig(t,p.eventSelectors.targetTrail,p.eventSelectors.access,s);o.log("GetEventSelectors",1,r,{bucketName:s});f.putEventSelectors(u,r,p.eventSelectors.trailRegionMapping[p.eventSelectors.targetTrail]).then(function(){p.saving=false;p.cardSummaryObj.isActive=true;p.cardOpen=false;o.log("PutEventSelectors",1,r,{bucketName:s})})["catch"](function(x){var w=n.handleErrors(x);p.eventSelectorsErrorMessage=n.handleErrors(x);o.log("PutEventSelectors",0,r,{bucketName:s,error:w});p.cardSummaryObj.isActive=false;p.saving=false})}})["catch"](function(u){var t=n.handleErrors(u);p.eventSelectorsErrorMessage=t;o.log("GetEventSelectors",0,r,{bucketName:s,error:t});p.saving=false})})()}else{p.cardOpen=false;p.eventSelectors.enabled=true;p.cardSummaryObj.isActive=true}}}})();"use strict";angular.module("s3").directive("multiSelector",[function(){return{restrict:"E",controller:"MultiSelectorController",scope:{multiSelectorObj:"=",apiCall:"=?",operation:"=?"},templateUrl:"/s3/partials/multiselector.html"}}]);angular.module("s3").controller("MultiSelectorController",["$scope","$filter","$translate","S3Constants",function(b,f,e,d){a();function a(){b.customerInputList=[];b.tableFilter={filter:""};if(b.apiCall&&!b.multiSelectorObj.initialized){c()}else{b.multiSelectorObj.totalSelectedCount=g()}b.multiSelectorObj.initialized=true}function c(){b.multiSelectorObj.isLoadingData=true;b.apiCall().then(function(h){_.forEach(h,function(i){if(b.multiSelectorObj.selectAllByDefault){i.selected=true;b.multiSelectorObj.optionList.push(i)}else{var j=_.findIndex(b.multiSelectorObj.optionList,{value:i.value});if(j===-1){i.selected=false;b.multiSelectorObj.optionList.push(i)}else{if(_.isEmpty(b.multiSelectorObj.optionList[j].text)){b.multiSelectorObj.optionList[j].text=i.text}}}});b.multiSelectorObj.totalSelectedCount=0;b.multiSelectorObj.isLoadingData=false})["catch"](function(h){b.multiSelectorObj.errorMsg=h;b.multiSelectorObj.isLoadingData=false;b.multiSelectorObj.isDropDownOpen=false})}b.$watch("multiSelectorObj.optionList",function(i,h){if(i!==h){b.multiSelectorObj.totalSelectedCount=g()}},true);function g(){var h=0;_.forEach(b.multiSelectorObj.optionList,function(i){if(i.selected){h+=1}});return h}b.filterKeyDown=function(i,h,j){if(i&&i.keyCode===d.KEY_CODES.ESC){b.clearFilter();$(".input-field").blur()}if(i&&i.keyCode===d.KEY_CODES.ENTER&&j.length===0){$(".input-field").focus();b.addCustomerInput(h)}};b.selectAll=function(){_.forEach(b.multiSelectorObj.optionList,function(h){h.selected=true})};b.clearFilter=function(){b.tableFilter={filter:""}};b.unSelectAll=function(){_.forEach(b.multiSelectorObj.optionList,function(h){h.selected=false})};b.selectRow=function(h,i){h.stopPropagation();i.selected=!i.selected};b.selectCheckBox=function(h,i){h.stopPropagation();i.selected=!i.selected};b.closeDropDown=function(){b.multiSelectorObj.isDropDownOpen=false};b.toggleDropDown=function(){b.multiSelectorObj.isDropDownOpen=!b.multiSelectorObj.isDropDownOpen};b.addCustomerInput=function(h){if(!_.isEmpty(h)){h=h.trim();b.customerInputList.push({text:h,value:h,selected:true});_.forEach(b.customerInputList,function(i){if(_.findIndex(b.multiSelectorObj.optionList,{text:i.text})===-1){b.multiSelectorObj.optionList.splice(0,0,i)}});b.tableFilter={filter:""}}}}]);"use strict";(function(){angular.module("s3").service("KMSPropertiesService",["$window","$q","APIProxyService","PathService","S3Constants","SCLogService","UtilService",function(a,e,b,g,c,i,h){var f={getKMSKeys:d};return f;function d(j,m){var l=arguments.length<=2||arguments[2]===undefined?null:arguments[2];var k=l?l:g.getCurrentBucket();return b.getKmsKeys(j,k,m).then(function(o){var n=o.response.Keys;i.logRequestComplete("getKMSKeys",j);var p=[];_.forEach(n,function(q,r){p.push({value:q.KeyArn,text:h.getKmsKeyAlias(q)})});return p})["catch"](function(n){i.log("getKMSKeys",0,j,n);return e.reject(h.handleErrors(n))})}}])})();"use strict";(function(){angular.module("s3").service("IAMPropertiesService",["$window","$q","APIProxyService","IAMService","PathService","S3Constants","SCLogService","UtilService",function(b,i,c,g,j,d,m,k){var h={listRoles:a,listAttachedRolePolicies:l,listPolicyVersions:e,getPolicyVersion:f};return h;function a(n){var o=d.IAM_ENDPOINT_MAPPING[k.getCloudSystem()];return c.makeProxyRequest(g.listRoles,{region:o,params:{MaxItems:d.API_MAX_ITEMS.IAM_LIST_ROLES}},d.PROXY_API_NAMES.IAM.LIST_ROLES,n).then(function(q){var p=q.response.ListRolesResponse.ListRolesResult.Roles;m.logRequestComplete("listRoles",n);return p})["catch"](function(p){m.log("listRoles",0,n,p);return i.reject(k.handleErrors(p))})}function l(n,o){var p=d.IAM_ENDPOINT_MAPPING[k.getCloudSystem()];return c.makeProxyRequest(g.listAttachedRolePolicies,{region:p,params:{RoleName:n,MaxItems:d.API_MAX_ITEMS.IAM_ATTACHED_POLICIES}},d.PROXY_API_NAMES.IAM.LIST_ATTACHED_ROLE_POLICIES,o).then(function(r){var q=r.response.ListAttachedRolePoliciesResponse.ListAttachedRolePoliciesResult.AttachedPolicies;m.logRequestComplete("listAttachedRolePolicies",o);return q})["catch"](function(q){m.log("listAttachedRolePolicies",0,o,q);return i.reject(k.handleErrors(q))})}function e(o,n){var p=d.IAM_ENDPOINT_MAPPING[k.getCloudSystem()];return c.makeProxyRequest(g.listPolicyVersions,{region:p,params:{PolicyArn:o,MaxItems:d.API_MAX_ITEMS.IAM_ATTACHED_POLICIES_VERSIONS}},d.PROXY_API_NAMES.IAM.LIST_POLICY_VERSIONS,n).then(function(r){var q=r.response.ListPolicyVersionsResponse.ListPolicyVersionsResult.Versions;m.logRequestComplete("listPolicyVersions",n);return q})["catch"](function(q){m.log("listPolicyVersions",0,n,q);return i.reject(k.handleErrors(q))})}function f(p,o,n){var q=d.IAM_ENDPOINT_MAPPING[k.getCloudSystem()];return c.makeProxyRequest(g.getPolicyVersion,{region:q,params:{PolicyArn:p,VersionId:o}},d.PROXY_API_NAMES.IAM.GET_POLICY_VERSIONS,n).then(function(s){var r=s.response.GetPolicyVersionResponse.GetPolicyVersionResult.PolicyVersion.Document;m.logRequestComplete("listPolicyVersions",n);return r})["catch"](function(r){m.log("listPolicyVersions",0,n,r);return i.reject(k.handleErrors(r))})}}])})();"use strict";(function(){angular.module("s3").constant("AnalyzeAccessConstants",{BUCKET_NAME:"bucket_name",ACCESS:"access",WORLD_WRITE:"s3_world_writability",WORLD_READ:"s3_world_readability",ACL_WRITE:"acl_write",ACL_READ:"acl_read",POLICY_WRITE:"policy_write",POLICY_READ:"policy_read",VALUES:{TRUE:"true",FALSE:"false",UNKNOWN:"unknown"},LABELS:{EVERYONE:"modal.permission.allusers",NOT_EVERYONE:"lamb.column.value.not.everyone",PUBLIC:"world.access.public.label",NOT_PUBLIC:"world.access.not.public.label",ACL:"ACL",POLICY:"bucketproperties.sideconfigpanel.bucketPolicy",UNKNOWN:"world.access.public.undetermined.label",NOT_SUPPORTED:"world.access.not.supported.label",ERROR:"error.header"},MAX_CALLS:16,SLEEP_TIME:100})})();"use strict";(function(){angular.module("s3").service("AnalyzeAccessUtilService",["$translate","AnalyzeAccessConstants",a]);function a(d,f){var n=f.VALUES,l=f.LABELS;var m={getAccessStatus:e,getAccessLabels:i};return m;function e(q){var p={};p.bucketReadPublic=h(q,f.WORLD_READ);p.bucketWritePublic=h(q,f.WORLD_WRITE);p.bucketNotPublic=b(q);p.bucketPublic=o(q);p.aclPublic=g(q);p.policyPublic=k(q);return p}function i(t,p){var v={};if(!p){p=e(t)}var s=c(t,f.WORLD_READ);if(s===n.TRUE){v.bucketReadPublic=d.instant(l.EVERYONE)}else{if(s===n.FALSE){v.bucketReadPublic=d.instant(l.NOT_EVERYONE)}else{if(s===n.UNKNOWN){v.bucketReadPublic=d.instant(l.UNKNOWN)}else{v.bucketReadPublic=d.instant(l.ERROR)}}}var r=c(t,f.WORLD_WRITE);if(r===n.TRUE){v.bucketWritePublic=d.instant(l.EVERYONE)}else{if(r===n.FALSE){v.bucketWritePublic=d.instant(l.NOT_EVERYONE)}else{if(r===n.UNKNOWN){v.bucketWritePublic=d.instant(l.UNKNOWN)}else{v.bucketWritePublic=d.instant(l.ERROR)}}}if(p.bucketPublic){v.bucketPublic=d.instant(l.PUBLIC)}else{if(p.bucketNotPublic){v.bucketPublic=d.instant(l.NOT_PUBLIC)}else{if(s===n.UNKNOWN&&r===n.UNKNOWN){v.bucketPublic=d.instant(l.UNKNOWN)}else{v.bucketPublic=d.instant(l.ERROR)}}}var u="";if(p.aclPublic){v.source=l.ACL;u=", "}if(p.policyPublic){var q=d.instant(l.POLICY);if(u){v.source+=u+q}else{v.source=q}}return v}function o(p){return j(p,f.WORLD_READ,f.WORLD_WRITE)===n.TRUE}function b(p){return j(p,f.WORLD_READ,f.WORLD_WRITE)===n.FALSE}function g(p){return j(p,f.ACL_READ,f.ACL_WRITE)===n.TRUE}function k(p){return j(p,f.POLICY_READ,f.POLICY_WRITE)===n.TRUE}function h(p,q){return c(p,q)===n.TRUE}function j(t,r,p){var s=c(t,r);var q=c(t,p);if(s===n.TRUE||q===n.TRUE){return n.TRUE}else{if(s===n.FALSE&&q===n.FALSE){return n.FALSE}}return n.UNKNOWN}function c(p,q){return _.get(p,f.ACCESS+"."+q)}}})();